{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180725.9375, "policy_loss": -181483.296875, "entropy": 29.81870460510254, "entropy_coeff": 0.01, "var_gnorm": 16.000810623168945, "vf_loss": 84680.8359375, "vf_explained_var": 0.0005393624305725098}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2400, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.035, "learner_load_time_ms": 0.084, "learner_load_wait_time_ms": 1186.535, "learner_dequeue_time_ms": 1309.12}}, "env_runners": {"episode_reward_max": -172.811111111111, "episode_reward_min": -218.7333333333333, "episode_reward_mean": -194.43773148148145, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2400, "policy_reward_min": {"default_policy": -218.7333333333333}, "policy_reward_max": {"default_policy": -172.811111111111}, "policy_reward_mean": {"default_policy": -194.43773148148145}, "custom_metrics": {"num_consolidated_mean": 0.6762499999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0620833333333335, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.998750000000001, "num_moves_min": 9.77, "num_moves_max": 10.25, "mean_accuracy_mean": 41.09234722222222, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.0299999999999985, "num_model_switches_min": 5.65, "num_model_switches_max": 6.37, "num_slav_mean": 0.16206597222222222, "num_slav_min": 0.14303333333333332, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5710401509318018, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5936630994624079, "mean_cluster_mem_util_mean": 0.36635456592886806, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.37662231694365517, "reward_consolidation_mean_mean": -0.3189814814814815, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.12777777777777782, "reward_illegal_mean_mean": -1.7701388888888887, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.7645347222222222, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0831666666666668, "reward_sla_mean_mean": -0.6197916666666667, "reward_sla_mean_min": -0.9480000000000001, "reward_sla_mean_max": -0.37433333333333335, "reward_consolidation_sum_mean": -31.898148148148152, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -12.777777777777782, "reward_illegal_sum_mean": -177.01388888888889, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 76.45347222222222, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 108.31666666666669, "reward_sla_sum_mean": -61.97916666666668, "reward_sla_sum_min": -94.80000000000001, "reward_sla_sum_max": -37.43333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 450.0, "global_timestep_min": 100, "global_timestep_max": 800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2396364469785948, "mean_inference_ms": 2.1380957929564137, "mean_action_processing_ms": 0.09150267861377852, "mean_env_wait_ms": 1.561261512137748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073591868082682295, "StateBufferConnector_ms": 0.0034252802530924478, "ViewRequirementAgentConnector_ms": 0.08112490177154541}, "num_episodes": 24, "episode_return_max": -172.811111111111, "episode_return_min": -218.7333333333333, "episode_return_mean": -194.43773148148145, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2400, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.61517563460083, "num_env_steps_trained_throughput_per_sec": 225.52016530315373, "timesteps_total": 2550, "num_env_steps_sampled_lifetime": 2550, "num_agent_steps_sampled_lifetime": 2550, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 2550, "timers": {"training_iteration_time_ms": 10642.071, "restore_workers_time_ms": 0.013, "training_step_time_ms": 629.249, "sample_time_ms": 614.073, "synch_weights_time_ms": 13.728}, "counters": {"num_env_steps_sampled": 2550, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2400}, "done": false, "training_iteration": 1, "trial_id": "3f041_00000", "date": "2024-10-10_23-59-15", "timestamp": 1728601155, "time_this_iter_s": 10.650115728378296, "time_total_s": 10.650115728378296, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b172260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.650115728378296, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.225, "ram_util_percent": 42.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -157121.0, "policy_loss": -157725.671875, "entropy": 29.81857681274414, "entropy_coeff": 0.01, "var_gnorm": 16.000905990600586, "vf_loss": 69413.109375, "vf_explained_var": 0.0009168386459350586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 4800, "learner_queue": {"size_count": 15, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.531, "learner_load_time_ms": 0.095, "learner_load_wait_time_ms": 1319.532, "learner_dequeue_time_ms": 5698.762}}, "env_runners": {"episode_reward_max": -147.63222222222217, "episode_reward_min": -221.29888888888888, "episode_reward_mean": -188.94907407407405, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 4800, "policy_reward_min": {"default_policy": -221.29888888888888}, "policy_reward_max": {"default_policy": -147.63222222222217}, "policy_reward_mean": {"default_policy": -188.94907407407405}, "custom_metrics": {"num_consolidated_mean": 0.6885416666666666, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0508333333333333, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.979166666666666, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08139583333334, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.03625, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.15970069444444446, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.571373670894698, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.36637237371522097, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.31400462962962966, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.1277777777777778, "reward_illegal_mean_mean": -1.7513888888888884, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7826597222222222, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0831666666666668, "reward_sla_mean_mean": -0.6067569444444446, "reward_sla_mean_min": -0.9480000000000001, "reward_sla_mean_max": -0.37433333333333335, "reward_consolidation_sum_mean": -31.400462962962965, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -12.77777777777778, "reward_illegal_sum_mean": -175.13888888888883, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 78.26597222222222, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 108.31666666666669, "reward_sla_sum_mean": -60.675694444444446, "reward_sla_sum_min": -94.80000000000001, "reward_sla_sum_max": -37.43333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 850.0, "global_timestep_min": 100, "global_timestep_max": 1600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24456743156672275, "mean_inference_ms": 2.2253174945549046, "mean_action_processing_ms": 0.09311043753444, "mean_env_wait_ms": 1.5973521143194827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007292131582895915, "StateBufferConnector_ms": 0.0035663445790608725, "ViewRequirementAgentConnector_ms": 0.08614410956700642}, "num_episodes": 24, "episode_return_max": -147.63222222222217, "episode_return_min": -221.29888888888888, "episode_return_mean": -188.94907407407405, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 210.65360563882612, "num_env_steps_trained_throughput_per_sec": 196.61003192957105, "timesteps_total": 4800, "num_env_steps_sampled_lifetime": 4800, "num_agent_steps_sampled_lifetime": 4800, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 10661.561, "restore_workers_time_ms": 0.014, "training_step_time_ms": 723.286, "sample_time_ms": 706.689, "synch_weights_time_ms": 14.915}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 4800}, "done": false, "training_iteration": 2, "trial_id": "3f041_00000", "date": "2024-10-10_23-59-26", "timestamp": 1728601166, "time_this_iter_s": 10.688889741897583, "time_total_s": 21.33900547027588, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa440>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21.33900547027588, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.65333333333334, "ram_util_percent": 42.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -174899.65625, "policy_loss": -175635.71875, "entropy": 29.818443298339844, "entropy_coeff": 0.01, "var_gnorm": 16.001218795776367, "vf_loss": 82551.15625, "vf_explained_var": 0.0013946294784545898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 6900, "num_env_steps_trained": 6600, "num_agent_steps_sampled": 6900, "num_agent_steps_trained": 6600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 46, "num_samples_added_to_queue": 6900, "learner_queue": {"size_count": 22, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.6, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 1379.647, "learner_dequeue_time_ms": 7649.624}}, "env_runners": {"episode_reward_max": -147.63222222222217, "episode_reward_min": -221.29888888888888, "episode_reward_mean": -188.24355877616742, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6900, "policy_reward_min": {"default_policy": -221.29888888888888}, "policy_reward_max": {"default_policy": -147.63222222222217}, "policy_reward_mean": {"default_policy": -188.24355877616742}, "custom_metrics": {"num_consolidated_mean": 0.6773913043478261, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.04768115942029, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.992608695652175, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.089077294685985, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 6.020434782608695, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.16019347826086955, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5707040718470257, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.3658726772657329, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.31626409017713364, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.10000000000000003, "reward_illegal_mean_mean": -1.746135265700483, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7932101449275364, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0951333333333333, "reward_sla_mean_mean": -0.6132463768115942, "reward_sla_mean_min": -0.9480000000000001, "reward_sla_mean_max": -0.3733333333333334, "reward_consolidation_sum_mean": -31.626409017713364, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -10.000000000000004, "reward_illegal_sum_mean": -174.6135265700483, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 79.32101449275365, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 109.51333333333332, "reward_sla_sum_mean": -61.32463768115943, "reward_sla_sum_min": -94.80000000000001, "reward_sla_sum_max": -37.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1200.0, "global_timestep_min": 100, "global_timestep_max": 2300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2477780639919335, "mean_inference_ms": 2.2665914485537093, "mean_action_processing_ms": 0.09431620566081313, "mean_env_wait_ms": 1.620479635669849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006986355436021003, "StateBufferConnector_ms": 0.003598392873570539, "ViewRequirementAgentConnector_ms": 0.08771350418311963}, "num_episodes": 21, "episode_return_max": -147.63222222222217, "episode_return_min": -221.29888888888888, "episode_return_mean": -188.24355877616742, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6900, "num_agent_steps_trained": 6600, "num_env_steps_sampled": 6900, "num_env_steps_trained": 6600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 209.4110254994852, "num_env_steps_trained_throughput_per_sec": 209.4110254994852, "timesteps_total": 6900, "num_env_steps_sampled_lifetime": 6900, "num_agent_steps_sampled_lifetime": 6900, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 6900, "timers": {"training_iteration_time_ms": 10450.419, "restore_workers_time_ms": 0.013, "training_step_time_ms": 700.827, "sample_time_ms": 683.73, "synch_weights_time_ms": 15.515}, "counters": {"num_env_steps_sampled": 6900, "num_env_steps_trained": 6600, "num_agent_steps_sampled": 6900, "num_agent_steps_trained": 6600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 46, "num_samples_added_to_queue": 6900}, "done": false, "training_iteration": 3, "trial_id": "3f041_00000", "date": "2024-10-10_23-59-36", "timestamp": 1728601176, "time_this_iter_s": 10.036870002746582, "time_total_s": 31.37587547302246, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef88b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.37587547302246, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.849999999999998, "ram_util_percent": 43.22142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -185673.875, "policy_loss": -186488.9375, "entropy": 29.818267822265625, "entropy_coeff": 0.01, "var_gnorm": 16.00218391418457, "vf_loss": 90451.296875, "vf_explained_var": 0.0019217133522033691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 9000, "learner_queue": {"size_count": 29, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.589, "learner_load_time_ms": 0.228, "learner_load_wait_time_ms": 1386.399, "learner_dequeue_time_ms": 8587.66}}, "env_runners": {"episode_reward_max": -147.63222222222217, "episode_reward_min": -222.89999999999995, "episode_reward_mean": -189.5306666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9000, "policy_reward_min": {"default_policy": -222.89999999999995}, "policy_reward_max": {"default_policy": -147.63222222222217}, "policy_reward_mean": {"default_policy": -189.5306666666666}, "custom_metrics": {"num_consolidated_mean": 0.6757777777777778, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.049111111111111, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.989222222222223, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.09380740740741, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.999222222222222, "num_model_switches_min": 5.62, "num_model_switches_max": 6.38, "num_slav_mean": 0.16078351851851852, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.570975974651756, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.3660752739984883, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.3137037037037037, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.07222222222222224, "reward_illegal_mean_mean": -1.7485185185185184, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7898451851851853, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.6229296296296296, "reward_sla_mean_min": -1.0036666666666667, "reward_sla_mean_max": -0.3733333333333334, "reward_consolidation_sum_mean": -31.370370370370377, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -7.222222222222225, "reward_illegal_sum_mean": -174.85185185185182, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 78.98451851851851, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -62.29296296296295, "reward_sla_sum_min": -100.36666666666667, "reward_sla_sum_max": -37.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1550.0, "global_timestep_min": 100, "global_timestep_max": 3000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.49777777777774, -173.73666666666668, -204.90999999999997, -196.5499999999999, -218.7333333333333, -181.43555555555542, -196.60999999999996, -172.811111111111, -185.67, -196.68333333333328, -205.8388888888887, -205.92777777777766, -204.1022222222221, -208.61666666666662, -178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508875762696761, "mean_inference_ms": 2.300605097428505, "mean_action_processing_ms": 0.09546841979061059, "mean_env_wait_ms": 1.641551696972506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068238046434190534, "StateBufferConnector_ms": 0.003639856974283854, "ViewRequirementAgentConnector_ms": 0.08996963500976562}, "num_episodes": 21, "episode_return_max": -147.63222222222217, "episode_return_min": -222.89999999999995, "episode_return_mean": -189.5306666666666, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 200.8409242153745, "num_env_steps_trained_throughput_per_sec": 200.8409242153745, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 10451.825, "restore_workers_time_ms": 0.013, "training_step_time_ms": 756.939, "sample_time_ms": 739.068, "synch_weights_time_ms": 15.835}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 9000}, "done": false, "training_iteration": 4, "trial_id": "3f041_00000", "date": "2024-10-10_23-59-47", "timestamp": 1728601187, "time_this_iter_s": 10.47644329071045, "time_total_s": 41.85231876373291, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.85231876373291, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.019999999999996, "ram_util_percent": 42.973333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -188700.140625, "policy_loss": -189529.96875, "entropy": 29.81798553466797, "entropy_coeff": 0.01, "var_gnorm": 16.00347137451172, "vf_loss": 91928.359375, "vf_explained_var": 0.002770721912384033}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11100, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 76, "num_samples_added_to_queue": 11400, "learner_queue": {"size_count": 37, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.035, "learner_load_time_ms": 0.253, "learner_load_wait_time_ms": 1248.196, "learner_dequeue_time_ms": 9175.693}}, "env_runners": {"episode_reward_max": -147.63222222222217, "episode_reward_min": -222.89999999999995, "episode_reward_mean": -188.4155666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -222.89999999999995}, "policy_reward_max": {"default_policy": -147.63222222222217}, "policy_reward_mean": {"default_policy": -188.4155666666666}, "custom_metrics": {"num_consolidated_mean": 0.6789999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0458, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.9817, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.10050666666667, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.989600000000001, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.1615178333333333, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18098333333333333, "mean_cluster_cpu_util_mean": 0.5707848470053405, "mean_cluster_cpu_util_min": 0.5523047903228648, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.3658728785592297, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": -0.3171666666666667, "reward_consolidation_mean_min": -0.5833333333333334, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7429999999999999, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7953043333333332, "reward_accuracy_mean_min": 0.49129999999999996, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.6192933333333334, "reward_sla_mean_min": -1.0036666666666667, "reward_sla_mean_max": -0.3733333333333334, "reward_consolidation_sum_mean": -31.716666666666665, "reward_consolidation_sum_min": -58.333333333333336, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -174.3, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 79.53043333333335, "reward_accuracy_sum_min": 49.129999999999995, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -61.929333333333346, "reward_sla_sum_min": -100.36666666666667, "reward_sla_sum_max": -37.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2166.0, "global_timestep_min": 100, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-178.8777777777777, -201.80777777777772, -211.6644444444443, -204.4144444444444, -191.76888888888888, -196.72444444444437, -186.50777777777773, -201.61666666666662, -178.58333333333334, -182.41666666666666, -201.99999999999986, -184.40333333333328, -162.44666666666663, -147.63222222222217, -187.5755555555555, -195.12444444444452, -182.74888888888887, -216.01333333333335, -202.2544444444445, -178.59444444444438, -190.44111111111096, -162.9644444444444, -175.63333333333333, -169.26444444444436, -171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25369446535154033, "mean_inference_ms": 2.3271505693591323, "mean_action_processing_ms": 0.09627409559257508, "mean_env_wait_ms": 1.6589165558475063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006471395492553711, "StateBufferConnector_ms": 0.003568410873413086, "ViewRequirementAgentConnector_ms": 0.08982491493225098}, "num_episodes": 24, "episode_return_max": -147.63222222222217, "episode_return_min": -222.89999999999995, "episode_return_mean": -188.4155666666666, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11100, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.6951475602641, "num_env_steps_trained_throughput_per_sec": 237.6951475602641, "timesteps_total": 11400, "num_env_steps_sampled_lifetime": 11400, "num_agent_steps_sampled_lifetime": 11400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 11400, "timers": {"training_iteration_time_ms": 10380.855, "restore_workers_time_ms": 0.012, "training_step_time_ms": 619.625, "sample_time_ms": 604.118, "synch_weights_time_ms": 13.76}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 11100, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 76, "num_samples_added_to_queue": 11400}, "done": false, "training_iteration": 5, "trial_id": "3f041_00000", "date": "2024-10-10_23-59-57", "timestamp": 1728601197, "time_this_iter_s": 10.10716962814331, "time_total_s": 51.95948839187622, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876050>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.95948839187622, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.026666666666664, "ram_util_percent": 43.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180490.90625, "policy_loss": -181247.359375, "entropy": 29.81769561767578, "entropy_coeff": 0.01, "var_gnorm": 16.004531860351562, "vf_loss": 84590.9296875, "vf_explained_var": 0.0035938024520874023}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 13950, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13950, "num_agent_steps_trained": 13800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 93, "num_samples_added_to_queue": 13800, "learner_queue": {"size_count": 46, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.286, "learner_load_time_ms": 0.23, "learner_load_wait_time_ms": 1163.837, "learner_dequeue_time_ms": 9273.802}}, "env_runners": {"episode_reward_max": -156.56, "episode_reward_min": -222.89999999999995, "episode_reward_mean": -188.12903333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -222.89999999999995}, "policy_reward_max": {"default_policy": -156.56}, "policy_reward_mean": {"default_policy": -188.12903333333327}, "custom_metrics": {"num_consolidated_mean": 0.674, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0452, "num_overloaded_min": 0.92, "num_overloaded_max": 1.19, "num_moves_mean": 9.9775, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.10405333333333, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.9972, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.1628945, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.18098333333333333, "mean_cluster_cpu_util_mean": 0.5701279511993058, "mean_cluster_cpu_util_min": 0.5523047903228648, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.3655635319613077, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": -0.30866666666666664, "reward_consolidation_mean_min": -0.5833333333333334, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7419999999999993, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7923329999999998, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.6229566666666667, "reward_sla_mean_min": -1.0036666666666667, "reward_sla_mean_max": -0.3733333333333334, "reward_consolidation_sum_mean": -30.866666666666664, "reward_consolidation_sum_min": -58.333333333333336, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -174.19999999999993, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 79.23330000000001, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -62.29566666666667, "reward_sla_sum_min": -100.36666666666667, "reward_sla_sum_max": -37.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2966.0, "global_timestep_min": 900, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-171.67999999999992, -186.85111111111112, -194.82333333333335, -187.79111111111098, -221.29888888888888, -177.8799999999998, -178.99111111111097, -183.42888888888888, -169.88666666666668, -173.3222222222222, -191.83777777777777, -186.85999999999976, -197.4444444444444, -195.66222222222214, -176.53444444444443, -188.39000000000004, -198.01222222222222, -169.69888888888875, -207.45111111111117, -179.45000000000005, -205.16666666666663, -176.23222222222208, -182.60555555555547, -189.9299999999999, -170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2562213320011929, "mean_inference_ms": 2.343638274753197, "mean_action_processing_ms": 0.09694759004489936, "mean_env_wait_ms": 1.672006673129291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006215333938598633, "StateBufferConnector_ms": 0.0035343170166015625, "ViewRequirementAgentConnector_ms": 0.08979940414428711}, "num_episodes": 24, "episode_return_max": -156.56, "episode_return_min": -222.89999999999995, "episode_return_mean": -188.12903333333327, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13950, "num_agent_steps_trained": 13800, "num_env_steps_sampled": 13950, "num_env_steps_trained": 13800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 246.85924402017264, "num_env_steps_trained_throughput_per_sec": 261.38037602135927, "timesteps_total": 13950, "num_env_steps_sampled_lifetime": 13950, "num_agent_steps_sampled_lifetime": 13950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 13950, "timers": {"training_iteration_time_ms": 10372.343, "restore_workers_time_ms": 0.012, "training_step_time_ms": 617.194, "sample_time_ms": 602.145, "synch_weights_time_ms": 13.595}, "counters": {"num_env_steps_sampled": 13950, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13950, "num_agent_steps_trained": 13800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 93, "num_samples_added_to_queue": 13800}, "done": false, "training_iteration": 6, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-07", "timestamp": 1728601207, "time_this_iter_s": 10.340112686157227, "time_total_s": 62.29960107803345, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefada0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.29960107803345, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.78666666666667, "ram_util_percent": 42.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -207237.671875, "policy_loss": -208247.84375, "entropy": 29.817285537719727, "entropy_coeff": 0.01, "var_gnorm": 16.006120681762695, "vf_loss": 109961.9296875, "vf_explained_var": 0.004191875457763672}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 16350, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16350, "num_agent_steps_trained": 16200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 109, "num_samples_added_to_queue": 16200, "learner_queue": {"size_count": 54, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.312, "learner_load_time_ms": 0.248, "learner_load_wait_time_ms": 1204.235, "learner_dequeue_time_ms": 9384.042}}, "env_runners": {"episode_reward_max": -156.56, "episode_reward_min": -228.36222222222221, "episode_reward_mean": -189.0298999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -228.36222222222221}, "policy_reward_max": {"default_policy": -156.56}, "policy_reward_mean": {"default_policy": -189.0298999999999}, "custom_metrics": {"num_consolidated_mean": 0.6721000000000003, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0441, "num_overloaded_min": 0.91, "num_overloaded_max": 1.18, "num_moves_mean": 9.983699999999999, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.10829666666667, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.9969, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.16359633333333332, "num_slav_min": 0.14439999999999997, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5696960628268708, "mean_cluster_cpu_util_min": 0.548860263481005, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.3654580258420879, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": -0.3196666666666667, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7401666666666664, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.5166666666666666, "reward_accuracy_mean_mean": 0.7978343333333333, "reward_accuracy_mean_min": 0.48686666666666667, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.6283000000000001, "reward_sla_mean_min": -1.0070000000000001, "reward_sla_mean_max": -0.3403333333333334, "reward_consolidation_sum_mean": -31.96666666666667, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -174.01666666666668, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -151.66666666666666, "reward_accuracy_sum_mean": 79.78343333333332, "reward_accuracy_sum_min": 48.68666666666667, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -62.829999999999984, "reward_sla_sum_min": -100.7, "reward_sla_sum_max": -34.03333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3767.0, "global_timestep_min": 1700, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-170.03333333333327, -174.4477777777778, -168.6977777777777, -196.4433333333332, -205.47999999999988, -170.14333333333335, -188.72888888888886, -192.00888888888886, -187.92111111111097, -172.49222222222218, -187.9144444444444, -194.90333333333322, -206.36555555555543, -181.17555555555543, -199.60999999999999, -208.09444444444438, -189.67888888888885, -204.34666666666664, -222.89999999999995, -177.58777777777772, -195.8522222222221, -199.1822222222222, -192.16444444444429, -172.7955555555555, -209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2565672252729305, "mean_inference_ms": 2.331885044035051, "mean_action_processing_ms": 0.09680330547012966, "mean_env_wait_ms": 1.6696437048373838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059337615966796875, "StateBufferConnector_ms": 0.0034563541412353516, "ViewRequirementAgentConnector_ms": 0.08863329887390137}, "num_episodes": 24, "episode_return_max": -156.56, "episode_return_min": -228.36222222222221, "episode_return_mean": -189.0298999999999, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16350, "num_agent_steps_trained": 16200, "num_env_steps_sampled": 16350, "num_env_steps_trained": 16200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.53373487767465, "num_env_steps_trained_throughput_per_sec": 236.53373487767465, "timesteps_total": 16350, "num_env_steps_sampled_lifetime": 16350, "num_agent_steps_sampled_lifetime": 16350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 16350, "timers": {"training_iteration_time_ms": 10340.087, "restore_workers_time_ms": 0.011, "training_step_time_ms": 631.131, "sample_time_ms": 615.918, "synch_weights_time_ms": 13.774}, "counters": {"num_env_steps_sampled": 16350, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16350, "num_agent_steps_trained": 16200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 109, "num_samples_added_to_queue": 16200}, "done": false, "training_iteration": 7, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-17", "timestamp": 1728601217, "time_this_iter_s": 10.155199766159058, "time_total_s": 72.4548008441925, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.4548008441925, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.764285714285712, "ram_util_percent": 42.16428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180702.5625, "policy_loss": -181454.71875, "entropy": 29.81663703918457, "entropy_coeff": 0.01, "var_gnorm": 16.00816535949707, "vf_loss": 84160.9453125, "vf_explained_var": 0.005715072154998779}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 18750, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 125, "num_samples_added_to_queue": 18600, "learner_queue": {"size_count": 62, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.028, "learner_load_time_ms": 0.233, "learner_load_wait_time_ms": 1227.073, "learner_dequeue_time_ms": 9485.775}}, "env_runners": {"episode_reward_max": -148.7655555555556, "episode_reward_min": -228.36222222222221, "episode_reward_mean": -188.5285555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -228.36222222222221}, "policy_reward_max": {"default_policy": -148.7655555555556}, "policy_reward_mean": {"default_policy": -188.5285555555555}, "custom_metrics": {"num_consolidated_mean": 0.6797000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0442, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 9.9894, "num_moves_min": 9.6, "num_moves_max": 10.4, "mean_accuracy_mean": 41.11374333333334, "mean_accuracy_min": 40.87833333333334, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.9957, "num_model_switches_min": 5.59, "num_model_switches_max": 6.43, "num_slav_mean": 0.163976, "num_slav_min": 0.14439999999999997, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5693974051302149, "mean_cluster_cpu_util_min": 0.548860263481005, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.36530460749806243, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": -0.31522222222222224, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.740333333333333, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.8020899999999999, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -0.6318200000000002, "reward_sla_mean_min": -1.0070000000000001, "reward_sla_mean_max": -0.3403333333333334, "reward_consolidation_sum_mean": -31.522222222222226, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -174.03333333333327, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 80.209, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -63.18200000000001, "reward_sla_sum_min": -100.7, "reward_sla_sum_max": -34.03333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4578.0, "global_timestep_min": 2700, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-209.12333333333328, -202.78444444444426, -179.7144444444445, -192.33888888888873, -177.15555555555542, -174.73666666666668, -178.03888888888878, -177.81555555555548, -199.79, -208.37555555555545, -209.95333333333332, -203.5011111111111, -179.23888888888888, -201.17777777777766, -177.83333333333323, -201.12888888888895, -198.9988888888888, -188.5033333333333, -203.95111111111106, -175.6633333333333, -200.13888888888874, -194.12888888888878, -177.91111111111107, -169.04999999999995, -180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2551351203595609, "mean_inference_ms": 2.3019067733376466, "mean_action_processing_ms": 0.09592555440447445, "mean_env_wait_ms": 1.654244255517001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850315093994141, "StateBufferConnector_ms": 0.0033762454986572266, "ViewRequirementAgentConnector_ms": 0.08698821067810059}, "num_episodes": 24, "episode_return_max": -148.7655555555556, "episode_return_min": -228.36222222222221, "episode_return_mean": -188.5285555555555, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18600, "num_env_steps_sampled": 18750, "num_env_steps_trained": 18600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 235.42845007974043, "num_env_steps_trained_throughput_per_sec": 235.42845007974043, "timesteps_total": 18750, "num_env_steps_sampled_lifetime": 18750, "num_agent_steps_sampled_lifetime": 18750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 18750, "timers": {"training_iteration_time_ms": 10321.85, "restore_workers_time_ms": 0.014, "training_step_time_ms": 638.03, "sample_time_ms": 621.086, "synch_weights_time_ms": 15.636}, "counters": {"num_env_steps_sampled": 18750, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 125, "num_samples_added_to_queue": 18600}, "done": false, "training_iteration": 8, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-28", "timestamp": 1728601228, "time_this_iter_s": 10.21488642692566, "time_total_s": 82.66968727111816, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9810>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.66968727111816, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.066666666666666, "ram_util_percent": 42.313333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -173819.734375, "policy_loss": -174547.109375, "entropy": 29.816015243530273, "entropy_coeff": 0.01, "var_gnorm": 16.009849548339844, "vf_loss": 81683.484375, "vf_explained_var": 0.006076991558074951}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 141, "num_samples_added_to_queue": 21000, "learner_queue": {"size_count": 70, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.854, "learner_load_time_ms": 0.233, "learner_load_wait_time_ms": 1244.619, "learner_dequeue_time_ms": 9583.151}}, "env_runners": {"episode_reward_max": -148.7655555555556, "episode_reward_min": -228.36222222222221, "episode_reward_mean": -187.13376666666656, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -228.36222222222221}, "policy_reward_max": {"default_policy": -148.7655555555556}, "policy_reward_mean": {"default_policy": -187.13376666666656}, "custom_metrics": {"num_consolidated_mean": 0.6723999999999998, "num_consolidated_min": 0.54, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0335, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 10.004000000000001, "num_moves_min": 9.6, "num_moves_max": 10.4, "mean_accuracy_mean": 41.10759999999999, "mean_accuracy_min": 40.871999999999986, "mean_accuracy_max": 41.31533333333333, "num_model_switches_mean": 6.023199999999999, "num_model_switches_min": 5.59, "num_model_switches_max": 6.43, "num_slav_mean": 0.16363266666666668, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5684224693160104, "mean_cluster_cpu_util_min": 0.5450050708303207, "mean_cluster_cpu_util_max": 0.586186553087136, "mean_cluster_mem_util_mean": 0.36497095206342034, "mean_cluster_mem_util_min": 0.3547529546628778, "mean_cluster_mem_util_max": 0.37444669946037484, "reward_consolidation_mean_mean": -0.3248333333333334, "reward_consolidation_mean_min": -0.6, "reward_consolidation_mean_max": -0.06666666666666674, "reward_illegal_mean_mean": -1.7224999999999997, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.8236323333333331, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -0.6476366666666666, "reward_sla_mean_min": -1.0070000000000001, "reward_sla_mean_max": -0.3403333333333334, "reward_consolidation_sum_mean": -32.483333333333334, "reward_consolidation_sum_min": -59.99999999999999, "reward_consolidation_sum_max": -6.666666666666673, "reward_illegal_sum_mean": -172.24999999999997, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 82.36323333333334, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -64.76366666666667, "reward_sla_sum_min": -100.7, "reward_sla_sum_max": -34.03333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5378.0, "global_timestep_min": 3500, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.35888888888883, -191.4644444444444, -181.1533333333333, -165.85222222222222, -197.71111111111108, -160.2666666666666, -183.60111111111104, -194.22444444444432, -178.76222222222214, -156.56, -182.1999999999999, -185.2844444444443, -199.56777777777776, -207.3077777777777, -187.93555555555548, -182.60888888888886, -203.03666666666658, -189.08333333333343, -197.56333333333325, -171.81888888888886, -171.94444444444454, -179.68222222222224, -198.65999999999994, -194.93444444444435, -186.0033333333333, -179.93555555555548, -168.29222222222214, -205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536304788465623, "mean_inference_ms": 2.2771778396803537, "mean_action_processing_ms": 0.09522204484646568, "mean_env_wait_ms": 1.6418868571154053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005892038345336914, "StateBufferConnector_ms": 0.0034189224243164062, "ViewRequirementAgentConnector_ms": 0.08676457405090332}, "num_episodes": 24, "episode_return_max": -148.7655555555556, "episode_return_min": -228.36222222222221, "episode_return_mean": -187.13376666666656, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 228.7491498881879, "num_env_steps_trained_throughput_per_sec": 228.7491498881879, "timesteps_total": 21150, "num_env_steps_sampled_lifetime": 21150, "num_agent_steps_sampled_lifetime": 21150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 21150, "timers": {"training_iteration_time_ms": 10340.739, "restore_workers_time_ms": 0.012, "training_step_time_ms": 623.161, "sample_time_ms": 607.3, "synch_weights_time_ms": 14.514}, "counters": {"num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 141, "num_samples_added_to_queue": 21000}, "done": false, "training_iteration": 9, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-38", "timestamp": 1728601238, "time_this_iter_s": 10.503422021865845, "time_total_s": 93.17310929298401, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.17310929298401, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.09333333333333, "ram_util_percent": 44.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -179830.125, "policy_loss": -180602.125, "entropy": 29.81557273864746, "entropy_coeff": 0.01, "var_gnorm": 16.010822296142578, "vf_loss": 86145.90625, "vf_explained_var": 0.007315635681152344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 23700, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 158, "num_samples_added_to_queue": 23700, "learner_queue": {"size_count": 78, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.951, "learner_load_time_ms": 0.223, "learner_load_wait_time_ms": 1168.088, "learner_dequeue_time_ms": 9650.74}}, "env_runners": {"episode_reward_max": -148.7655555555556, "episode_reward_min": -228.36222222222221, "episode_reward_mean": -189.20881111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -228.36222222222221}, "policy_reward_max": {"default_policy": -148.7655555555556}, "policy_reward_mean": {"default_policy": -189.20881111111106}, "custom_metrics": {"num_consolidated_mean": 0.6739, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0312000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.18, "num_moves_mean": 10.0113, "num_moves_min": 9.55, "num_moves_max": 10.4, "mean_accuracy_mean": 41.11900000000001, "mean_accuracy_min": 40.871999999999986, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.011700000000001, "num_model_switches_min": 5.59, "num_model_switches_max": 6.43, "num_slav_mean": 0.16358466666666668, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5689648086116974, "mean_cluster_cpu_util_min": 0.5450050708303207, "mean_cluster_cpu_util_max": 0.586186553087136, "mean_cluster_mem_util_mean": 0.3652905376697093, "mean_cluster_mem_util_min": 0.3547529546628778, "mean_cluster_mem_util_max": 0.3748071982907087, "reward_consolidation_mean_mean": -0.34544444444444444, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.0777777777777778, "reward_illegal_mean_mean": -1.7186666666666668, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8386563333333333, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.3107666666666669, "reward_sla_mean_mean": -0.6666333333333334, "reward_sla_mean_min": -1.0070000000000001, "reward_sla_mean_max": -0.3403333333333334, "reward_consolidation_sum_mean": -34.54444444444444, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -7.77777777777778, "reward_illegal_sum_mean": -171.86666666666667, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 83.86563333333334, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 131.07666666666668, "reward_sla_sum_mean": -66.66333333333334, "reward_sla_sum_min": -100.7, "reward_sla_sum_max": -34.03333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6049.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-205.84111111111102, -194.10555555555553, -181.62222222222212, -180.90888888888887, -200.321111111111, -188.171111111111, -191.3244444444444, -174.84444444444446, -210.902222222222, -191.43222222222215, -158.6044444444445, -211.19666666666652, -201.05999999999997, -192.99777777777777, -185.02222222222213, -194.44000000000008, -228.36222222222221, -165.69555555555544, -197.9044444444444, -175.87222222222215, -190.25888888888872, -182.96555555555543, -185.62111111111108, -202.4088888888888, -195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525182150851047, "mean_inference_ms": 2.2614208128849835, "mean_action_processing_ms": 0.09476921060562724, "mean_env_wait_ms": 1.6334572504863194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884885787963867, "StateBufferConnector_ms": 0.0033855438232421875, "ViewRequirementAgentConnector_ms": 0.08639645576477051}, "num_episodes": 27, "episode_return_max": -148.7655555555556, "episode_return_min": -228.36222222222221, "episode_return_mean": -189.20881111111106, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 23700, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.04046390250394, "num_env_steps_trained_throughput_per_sec": 230.62631896706253, "timesteps_total": 23700, "num_env_steps_sampled_lifetime": 23700, "num_agent_steps_sampled_lifetime": 23700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 23700, "timers": {"training_iteration_time_ms": 10347.31, "restore_workers_time_ms": 0.012, "training_step_time_ms": 605.133, "sample_time_ms": 589.981, "synch_weights_time_ms": 13.791}, "counters": {"num_env_steps_sampled": 23700, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 158, "num_samples_added_to_queue": 23700}, "done": false, "training_iteration": 10, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-49", "timestamp": 1728601249, "time_this_iter_s": 10.425718784332275, "time_total_s": 103.59882807731628, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefbb80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.59882807731628, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.63333333333333, "ram_util_percent": 44.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -176506.34375, "policy_loss": -177233.28125, "entropy": 29.8143253326416, "entropy_coeff": 0.01, "var_gnorm": 16.01323699951172, "vf_loss": 81637.234375, "vf_explained_var": 0.009569168090820312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 174, "num_samples_added_to_queue": 26100, "learner_queue": {"size_count": 86, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.073, "learner_load_time_ms": 0.255, "learner_load_wait_time_ms": 1213.264, "learner_dequeue_time_ms": 10511.3}}, "env_runners": {"episode_reward_max": -148.7655555555556, "episode_reward_min": -217.40444444444444, "episode_reward_mean": -188.19797777777774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -217.40444444444444}, "policy_reward_max": {"default_policy": -148.7655555555556}, "policy_reward_mean": {"default_policy": -188.19797777777774}, "custom_metrics": {"num_consolidated_mean": 0.6786, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0232999999999999, "num_overloaded_min": 0.86, "num_overloaded_max": 1.15, "num_moves_mean": 9.985700000000001, "num_moves_min": 9.55, "num_moves_max": 10.4, "mean_accuracy_mean": 41.113426666666676, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.008500000000001, "num_model_switches_min": 5.41, "num_model_switches_max": 6.43, "num_slav_mean": 0.1633441666666667, "num_slav_min": 0.1365, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5687572438032698, "mean_cluster_cpu_util_min": 0.5450050708303207, "mean_cluster_cpu_util_max": 0.5909623057500901, "mean_cluster_mem_util_mean": 0.36527588480402706, "mean_cluster_mem_util_min": 0.3547529546628778, "mean_cluster_mem_util_max": 0.3748071982907087, "reward_consolidation_mean_mean": -0.35044444444444445, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.0777777777777778, "reward_illegal_mean_mean": -1.7054999999999998, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8593646666666668, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -0.6854000000000002, "reward_sla_mean_min": -1.1063333333333334, "reward_sla_mean_max": -0.3916666666666667, "reward_consolidation_sum_mean": -35.044444444444444, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -7.77777777777778, "reward_illegal_sum_mean": -170.54999999999995, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 85.93646666666666, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -68.54, "reward_sla_sum_min": -110.63333333333334, "reward_sla_sum_max": -39.16666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4977.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-195.27333333333326, -183.0177777777777, -212.2288888888888, -184.67222222222213, -191.37000000000006, -192.69777777777776, -202.6977777777777, -203.2833333333332, -184.81000000000006, -193.21999999999986, -176.02777777777766, -203.73111111111106, -184.00333333333342, -197.47555555555545, -217.40444444444444, -184.76111111111103, -177.76111111111112, -176.91999999999996, -175.13333333333333, -186.46888888888873, -148.7655555555556, -168.87111111111102, -197.27333333333323, -173.5344444444445, -192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25199959545115197, "mean_inference_ms": 2.250723362950866, "mean_action_processing_ms": 0.09448365206811868, "mean_env_wait_ms": 1.6283512749769613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005858898162841797, "StateBufferConnector_ms": 0.003365755081176758, "ViewRequirementAgentConnector_ms": 0.08678650856018066}, "num_episodes": 24, "episode_return_max": -148.7655555555556, "episode_return_min": -217.40444444444444, "episode_return_mean": -188.19797777777774, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.48975428501484, "num_env_steps_trained_throughput_per_sec": 233.48975428501484, "timesteps_total": 26100, "num_env_steps_sampled_lifetime": 26100, "num_agent_steps_sampled_lifetime": 26100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 26100, "timers": {"training_iteration_time_ms": 10310.987, "restore_workers_time_ms": 0.012, "training_step_time_ms": 634.577, "sample_time_ms": 618.185, "synch_weights_time_ms": 14.891}, "counters": {"num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 174, "num_samples_added_to_queue": 26100}, "done": false, "training_iteration": 11, "trial_id": "3f041_00000", "date": "2024-10-11_00-00-59", "timestamp": 1728601259, "time_this_iter_s": 10.288654804229736, "time_total_s": 113.88748288154602, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876860>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.88748288154602, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.485714285714288, "ram_util_percent": 44.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -167310.125, "policy_loss": -167991.625, "entropy": 29.813453674316406, "entropy_coeff": 0.01, "var_gnorm": 16.014875411987305, "vf_loss": 77093.9921875, "vf_explained_var": 0.010128796100616455}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 191, "num_samples_added_to_queue": 28500, "learner_queue": {"size_count": 95, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.71, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1167.983, "learner_dequeue_time_ms": 10538.28}}, "env_runners": {"episode_reward_max": -156.4411111111111, "episode_reward_min": -215.72444444444437, "episode_reward_mean": -188.1867888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.72444444444437}, "policy_reward_max": {"default_policy": -156.4411111111111}, "policy_reward_mean": {"default_policy": -188.1867888888888}, "custom_metrics": {"num_consolidated_mean": 0.6729, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0194, "num_overloaded_min": 0.86, "num_overloaded_max": 1.13, "num_moves_mean": 9.9964, "num_moves_min": 9.55, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10455999999999, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.0176, "num_model_switches_min": 5.41, "num_model_switches_max": 6.4, "num_slav_mean": 0.16323100000000001, "num_slav_min": 0.1365, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5678762511359203, "mean_cluster_cpu_util_min": 0.5450050708303207, "mean_cluster_cpu_util_max": 0.5909623057500901, "mean_cluster_mem_util_mean": 0.3649571766303568, "mean_cluster_mem_util_min": 0.3547529546628778, "mean_cluster_mem_util_max": 0.3748071982907087, "reward_consolidation_mean_mean": -0.3572222222222223, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.0777777777777778, "reward_illegal_mean_mean": -1.6989999999999998, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8663643333333333, "reward_accuracy_mean_min": 0.4925666666666666, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -0.6920100000000001, "reward_sla_mean_min": -1.1063333333333334, "reward_sla_mean_max": -0.3743333333333333, "reward_consolidation_sum_mean": -35.722222222222214, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -7.77777777777778, "reward_illegal_sum_mean": -169.9, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 86.63643333333333, "reward_accuracy_sum_min": 49.25666666666666, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -69.20100000000001, "reward_sla_sum_min": -110.63333333333334, "reward_sla_sum_max": -37.43333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3905.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-192.7044444444443, -173.97999999999988, -184.18999999999986, -180.83333333333337, -211.94666666666652, -208.72555555555545, -198.15777777777782, -192.47666666666657, -185.61444444444444, -181.2744444444445, -190.26333333333324, -179.8111111111111, -179.72333333333322, -190.89666666666668, -190.90777777777777, -174.23111111111098, -190.5266666666665, -166.76333333333332, -176.59333333333322, -188.42999999999995, -201.01777777777775, -181.6755555555555, -185.29666666666665, -158.75444444444446, -169.4833333333333, -214.13555555555547, -204.45888888888882, -195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25154232668024545, "mean_inference_ms": 2.2402218076914537, "mean_action_processing_ms": 0.0942395573009486, "mean_env_wait_ms": 1.623509169961863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005895853042602539, "StateBufferConnector_ms": 0.0033762454986572266, "ViewRequirementAgentConnector_ms": 0.08669328689575195}, "num_episodes": 24, "episode_return_max": -156.4411111111111, "episode_return_min": -215.72444444444437, "episode_return_mean": -188.1867888888888, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 243.18356180355562, "num_env_steps_trained_throughput_per_sec": 257.4884772037648, "timesteps_total": 28650, "num_env_steps_sampled_lifetime": 28650, "num_agent_steps_sampled_lifetime": 28650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 28650, "timers": {"training_iteration_time_ms": 10291.473, "restore_workers_time_ms": 0.013, "training_step_time_ms": 616.674, "sample_time_ms": 601.348, "synch_weights_time_ms": 13.753}, "counters": {"num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 191, "num_samples_added_to_queue": 28500}, "done": false, "training_iteration": 12, "trial_id": "3f041_00000", "date": "2024-10-11_00-01-09", "timestamp": 1728601269, "time_this_iter_s": 10.499304294586182, "time_total_s": 124.3867871761322, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877f40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.3867871761322, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.860000000000003, "ram_util_percent": 43.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -195144.453125, "policy_loss": -196023.78125, "entropy": 29.81307601928711, "entropy_coeff": 0.01, "var_gnorm": 16.016599655151367, "vf_loss": 96876.2265625, "vf_explained_var": 0.012343645095825195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 208, "num_samples_added_to_queue": 31200, "learner_queue": {"size_count": 103, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.662, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 1188.973, "learner_dequeue_time_ms": 10377.364}}, "env_runners": {"episode_reward_max": -156.4411111111111, "episode_reward_min": -216.11555555555552, "episode_reward_mean": -188.08121111111103, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -216.11555555555552}, "policy_reward_max": {"default_policy": -156.4411111111111}, "policy_reward_mean": {"default_policy": -188.08121111111103}, "custom_metrics": {"num_consolidated_mean": 0.6716, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0231999999999999, "num_overloaded_min": 0.86, "num_overloaded_max": 1.15, "num_moves_mean": 9.994399999999999, "num_moves_min": 9.55, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10608, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.0067, "num_model_switches_min": 5.41, "num_model_switches_max": 6.37, "num_slav_mean": 0.16281116666666665, "num_slav_min": 0.1365, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5677087322671156, "mean_cluster_cpu_util_min": 0.5482270508070193, "mean_cluster_cpu_util_max": 0.5909623057500901, "mean_cluster_mem_util_mean": 0.36481792995637063, "mean_cluster_mem_util_min": 0.35489733255116385, "mean_cluster_mem_util_max": 0.3748071982907087, "reward_consolidation_mean_mean": -0.3431111111111111, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.0777777777777778, "reward_illegal_mean_mean": -1.7053333333333334, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.852859, "reward_accuracy_mean_min": 0.4925666666666666, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -0.6852266666666667, "reward_sla_mean_min": -1.1063333333333334, "reward_sla_mean_max": -0.3743333333333333, "reward_consolidation_sum_mean": -34.31111111111112, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -7.77777777777778, "reward_illegal_sum_mean": -170.53333333333327, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 85.2859, "reward_accuracy_sum_min": 49.25666666666666, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -68.52266666666668, "reward_sla_sum_min": -110.63333333333334, "reward_sla_sum_max": -37.43333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2698.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-195.39888888888882, -204.37666666666667, -185.2077777777778, -194.51999999999992, -188.75111111111102, -180.95222222222222, -176.1822222222222, -193.21555555555545, -205.81999999999994, -173.8755555555556, -207.00666666666666, -183.89888888888893, -171.58999999999995, -198.1377777777777, -193.54777777777772, -200.90222222222204, -186.67666666666653, -184.89666666666668, -160.57888888888886, -202.54555555555552, -194.26555555555547, -179.37444444444435, -206.99333333333328, -191.5255555555555, -204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509570654610729, "mean_inference_ms": 2.2262099044989196, "mean_action_processing_ms": 0.09388494805527298, "mean_env_wait_ms": 1.61673834532087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00603485107421875, "StateBufferConnector_ms": 0.003337860107421875, "ViewRequirementAgentConnector_ms": 0.08665251731872559}, "num_episodes": 27, "episode_return_max": -156.4411111111111, "episode_return_min": -216.11555555555552, "episode_return_mean": -188.08121111111103, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.6690243130832, "num_env_steps_trained_throughput_per_sec": 227.45319935349008, "timesteps_total": 31200, "num_env_steps_sampled_lifetime": 31200, "num_agent_steps_sampled_lifetime": 31200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 31200, "timers": {"training_iteration_time_ms": 10343.822, "restore_workers_time_ms": 0.012, "training_step_time_ms": 618.134, "sample_time_ms": 603.562, "synch_weights_time_ms": 13.264}, "counters": {"num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 208, "num_samples_added_to_queue": 31200}, "done": false, "training_iteration": 13, "trial_id": "3f041_00000", "date": "2024-10-11_00-01-20", "timestamp": 1728601280, "time_this_iter_s": 10.568816661834717, "time_total_s": 134.95560383796692, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877c10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.95560383796692, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.78666666666667, "ram_util_percent": 43.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -174693.859375, "policy_loss": -175391.171875, "entropy": 29.81189727783203, "entropy_coeff": 0.01, "var_gnorm": 16.01873016357422, "vf_loss": 78675.6328125, "vf_explained_var": 0.014867246150970459}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33300, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 224, "num_samples_added_to_queue": 33600, "learner_queue": {"size_count": 111, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.777, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 1249.392, "learner_dequeue_time_ms": 10228.653}}, "env_runners": {"episode_reward_max": -156.4411111111111, "episode_reward_min": -216.11555555555552, "episode_reward_mean": -187.0673444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -216.11555555555552}, "policy_reward_max": {"default_policy": -156.4411111111111}, "policy_reward_mean": {"default_policy": -187.0673444444443}, "custom_metrics": {"num_consolidated_mean": 0.6697, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0246, "num_overloaded_min": 0.87, "num_overloaded_max": 1.15, "num_moves_mean": 9.991999999999999, "num_moves_min": 9.59, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09189333333334, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.340666666666664, "num_model_switches_mean": 6.010699999999999, "num_model_switches_min": 5.41, "num_model_switches_max": 6.34, "num_slav_mean": 0.16158783333333335, "num_slav_min": 0.1365, "num_slav_max": 0.18249999999999997, "mean_cluster_cpu_util_mean": 0.5671050468548609, "mean_cluster_cpu_util_min": 0.548838585308966, "mean_cluster_cpu_util_max": 0.5909623057500901, "mean_cluster_mem_util_mean": 0.36443619989630865, "mean_cluster_mem_util_min": 0.35489733255116385, "mean_cluster_mem_util_max": 0.37392824349148945, "reward_consolidation_mean_mean": -0.3317777777777778, "reward_consolidation_mean_min": -0.6055555555555555, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.7076666666666669, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.8387076666666666, "reward_accuracy_mean_min": 0.4925666666666666, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -0.6699366666666668, "reward_sla_mean_min": -1.1063333333333334, "reward_sla_mean_max": -0.3743333333333333, "reward_consolidation_sum_mean": -33.17777777777778, "reward_consolidation_sum_min": -60.55555555555555, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -170.76666666666668, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 83.87076666666668, "reward_accuracy_sum_min": 49.25666666666666, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -66.99366666666667, "reward_sla_sum_min": -110.63333333333334, "reward_sla_sum_max": -37.43333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1783.0, "global_timestep_min": 100, "global_timestep_max": 3400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-204.48333333333326, -196.23999999999995, -215.72444444444437, -193.8344444444444, -182.8855555555556, -195.6377777777777, -178.692222222222, -204.58555555555546, -188.20222222222202, -174.14888888888885, -182.0488888888889, -163.67888888888902, -194.03, -171.84777777777757, -188.07333333333332, -156.4411111111111, -182.96555555555548, -198.04444444444437, -191.1822222222222, -184.95888888888877, -179.73000000000002, -189.27333333333317, -181.55333333333326, -196.06666666666658, -200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2507438760651069, "mean_inference_ms": 2.221777833846634, "mean_action_processing_ms": 0.093726586860104, "mean_env_wait_ms": 1.613319576545957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006430625915527344, "StateBufferConnector_ms": 0.003394603729248047, "ViewRequirementAgentConnector_ms": 0.08812999725341797}, "num_episodes": 24, "episode_return_max": -156.4411111111111, "episode_return_min": -216.11555555555552, "episode_return_mean": -187.0673444444443, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33300, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 227.14936319138693, "num_env_steps_trained_throughput_per_sec": 227.14936319138693, "timesteps_total": 33600, "num_env_steps_sampled_lifetime": 33600, "num_agent_steps_sampled_lifetime": 33600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 10354.792, "restore_workers_time_ms": 0.014, "training_step_time_ms": 683.103, "sample_time_ms": 666.05, "synch_weights_time_ms": 15.355}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33300, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 224, "num_samples_added_to_queue": 33600}, "done": false, "training_iteration": 14, "trial_id": "3f041_00000", "date": "2024-10-11_00-01-31", "timestamp": 1728601291, "time_this_iter_s": 10.592780113220215, "time_total_s": 145.54838395118713, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefac20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.54838395118713, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.4875, "ram_util_percent": 43.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -171376.390625, "policy_loss": -172063.71875, "entropy": 29.8105525970459, "entropy_coeff": 0.01, "var_gnorm": 16.021240234375, "vf_loss": 77677.3125, "vf_explained_var": 0.015944182872772217}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 35700, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 35700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 240, "num_samples_added_to_queue": 36000, "learner_queue": {"size_count": 119, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.817, "learner_load_time_ms": 0.283, "learner_load_wait_time_ms": 1224.014, "learner_dequeue_time_ms": 10143.573}}, "env_runners": {"episode_reward_max": -148.2111111111111, "episode_reward_min": -216.11555555555552, "episode_reward_mean": -185.624311111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -216.11555555555552}, "policy_reward_max": {"default_policy": -148.2111111111111}, "policy_reward_mean": {"default_policy": -185.624311111111}, "custom_metrics": {"num_consolidated_mean": 0.6645, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0251000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 10.0075, "num_moves_min": 9.69, "num_moves_max": 10.33, "mean_accuracy_mean": 41.079923333333326, "mean_accuracy_min": 40.86566666666667, "mean_accuracy_max": 41.25833333333334, "num_model_switches_mean": 6.035399999999999, "num_model_switches_min": 5.64, "num_model_switches_max": 6.41, "num_slav_mean": 0.16061016666666666, "num_slav_min": 0.14243333333333333, "num_slav_max": 0.18249999999999997, "mean_cluster_cpu_util_mean": 0.5660602800333742, "mean_cluster_cpu_util_min": 0.5473754803957362, "mean_cluster_cpu_util_max": 0.587079456090131, "mean_cluster_mem_util_mean": 0.3640194397837193, "mean_cluster_mem_util_min": 0.35489733255116385, "mean_cluster_mem_util_max": 0.3743522525043773, "reward_consolidation_mean_mean": -0.3229444444444444, "reward_consolidation_mean_min": -0.5555555555555556, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.7085, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333327, "reward_accuracy_mean_mean": 0.828508, "reward_accuracy_mean_min": 0.4464, "reward_accuracy_mean_max": 1.2361666666666666, "reward_sla_mean_mean": -0.6533066666666667, "reward_sla_mean_min": -1.0026666666666666, "reward_sla_mean_max": -0.31200000000000006, "reward_consolidation_sum_mean": -32.29444444444445, "reward_consolidation_sum_min": -55.55555555555556, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -170.85, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333326, "reward_accuracy_sum_mean": 82.85079999999999, "reward_accuracy_sum_min": 44.64, "reward_accuracy_sum_max": 123.61666666666667, "reward_sla_sum_mean": -65.33066666666667, "reward_sla_sum_min": -100.26666666666667, "reward_sla_sum_max": -31.200000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2583.0, "global_timestep_min": 900, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-200.9544444444444, -213.5422222222221, -157.08111111111108, -199.12111111111105, -189.2877777777776, -182.61111111111097, -195.3777777777778, -176.32111111111118, -174.64111111111114, -171.23888888888885, -205.93999999999988, -173.52, -181.09222222222223, -180.08888888888885, -194.64999999999995, -180.6233333333333, -184.8111111111111, -203.30666666666656, -203.04999999999993, -174.82222222222222, -186.68777777777782, -195.1166666666666, -201.79888888888874, -194.60444444444437, -190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2505158524542682, "mean_inference_ms": 2.2156735116206376, "mean_action_processing_ms": 0.09358757736987618, "mean_env_wait_ms": 1.6100558391051436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006411314010620117, "StateBufferConnector_ms": 0.0033960342407226562, "ViewRequirementAgentConnector_ms": 0.08743715286254883}, "num_episodes": 24, "episode_return_max": -148.2111111111111, "episode_return_min": -216.11555555555552, "episode_return_mean": -185.624311111111, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 35700, "num_env_steps_sampled": 36000, "num_env_steps_trained": 35700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.92730081709965, "num_env_steps_trained_throughput_per_sec": 237.92730081709965, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10353.807, "restore_workers_time_ms": 0.013, "training_step_time_ms": 626.477, "sample_time_ms": 610.453, "synch_weights_time_ms": 14.613}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 35700, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 35700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 240, "num_samples_added_to_queue": 36000}, "done": false, "training_iteration": 15, "trial_id": "3f041_00000", "date": "2024-10-11_00-01-41", "timestamp": 1728601301, "time_this_iter_s": 10.09781813621521, "time_total_s": 155.64620208740234, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefb4c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.64620208740234, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.11428571428571, "ram_util_percent": 44.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -168752.40625, "policy_loss": -169434.921875, "entropy": 29.809118270874023, "entropy_coeff": 0.01, "var_gnorm": 16.02338218688965, "vf_loss": 77193.96875, "vf_explained_var": 0.016797423362731934}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 38400, "learner_queue": {"size_count": 127, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.349, "learner_load_time_ms": 0.315, "learner_load_wait_time_ms": 1207.159, "learner_dequeue_time_ms": 10172.098}}, "env_runners": {"episode_reward_max": -148.2111111111111, "episode_reward_min": -216.11555555555552, "episode_reward_mean": -184.55106666666663, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -216.11555555555552}, "policy_reward_max": {"default_policy": -148.2111111111111}, "policy_reward_mean": {"default_policy": -184.55106666666663}, "custom_metrics": {"num_consolidated_mean": 0.6621000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0201, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 9.9995, "num_moves_min": 9.69, "num_moves_max": 10.28, "mean_accuracy_mean": 41.080683333333326, "mean_accuracy_min": 40.891, "mean_accuracy_max": 41.391333333333336, "num_model_switches_mean": 6.031099999999999, "num_model_switches_min": 5.5, "num_model_switches_max": 6.41, "num_slav_mean": 0.16009050000000002, "num_slav_min": 0.13873333333333335, "num_slav_max": 0.18249999999999997, "mean_cluster_cpu_util_mean": 0.5657406529023439, "mean_cluster_cpu_util_min": 0.541990966514389, "mean_cluster_cpu_util_max": 0.587079456090131, "mean_cluster_mem_util_mean": 0.36380917621236253, "mean_cluster_mem_util_min": 0.35461318188667884, "mean_cluster_mem_util_max": 0.3743522525043773, "reward_consolidation_mean_mean": -0.33149999999999996, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.12777777777777782, "reward_illegal_mean_mean": -1.7001666666666662, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333327, "reward_accuracy_mean_mean": 0.835766, "reward_accuracy_mean_min": 0.4464, "reward_accuracy_mean_max": 1.2361666666666666, "reward_sla_mean_mean": -0.64961, "reward_sla_mean_min": -1.0026666666666666, "reward_sla_mean_max": -0.31200000000000006, "reward_consolidation_sum_mean": -33.15, "reward_consolidation_sum_min": -58.88888888888889, "reward_consolidation_sum_max": -12.777777777777782, "reward_illegal_sum_mean": -170.0166666666666, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333326, "reward_accuracy_sum_mean": 83.5766, "reward_accuracy_sum_min": 44.64, "reward_accuracy_sum_max": 123.61666666666667, "reward_sla_sum_mean": -64.961, "reward_sla_sum_min": -100.26666666666667, "reward_sla_sum_max": -31.200000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3383.0, "global_timestep_min": 1700, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-190.94888888888897, -188.78555555555545, -173.85999999999993, -164.54777777777767, -179.4633333333332, -186.05333333333317, -177.01666666666668, -181.65777777777777, -194.68666666666664, -169.37666666666664, -178.10555555555553, -197.53111111111093, -200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25041179465569197, "mean_inference_ms": 2.2116815421377787, "mean_action_processing_ms": 0.09350540740157222, "mean_env_wait_ms": 1.6080157933017458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006319999694824219, "StateBufferConnector_ms": 0.003394603729248047, "ViewRequirementAgentConnector_ms": 0.0872809886932373}, "num_episodes": 24, "episode_return_max": -148.2111111111111, "episode_return_min": -216.11555555555552, "episode_return_mean": -184.55106666666663, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.33234914128158, "num_env_steps_trained_throughput_per_sec": 237.33234914128158, "timesteps_total": 38400, "num_env_steps_sampled_lifetime": 38400, "num_agent_steps_sampled_lifetime": 38400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 10332.07, "restore_workers_time_ms": 0.013, "training_step_time_ms": 636.603, "sample_time_ms": 621.972, "synch_weights_time_ms": 13.3}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 38400}, "done": false, "training_iteration": 16, "trial_id": "3f041_00000", "date": "2024-10-11_00-01-51", "timestamp": 1728601311, "time_this_iter_s": 10.121922969818115, "time_total_s": 165.76812505722046, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef94b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.76812505722046, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.735714285714288, "ram_util_percent": 44.83571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -179916.171875, "policy_loss": -180668.71875, "entropy": 29.807769775390625, "entropy_coeff": 0.01, "var_gnorm": 16.02539825439453, "vf_loss": 84197.359375, "vf_explained_var": 0.019799888134002686}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 132.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 39750, "num_env_steps_trained": 39600, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 265, "num_samples_added_to_queue": 39600, "learner_queue": {"size_count": 132, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 122.009, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 1604.215, "learner_dequeue_time_ms": 10358.201}}, "env_runners": {"episode_reward_max": -148.2111111111111, "episode_reward_min": -216.11555555555552, "episode_reward_mean": -185.23268888888882, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -216.11555555555552}, "policy_reward_max": {"default_policy": -148.2111111111111}, "policy_reward_mean": {"default_policy": -185.23268888888882}, "custom_metrics": {"num_consolidated_mean": 0.6598, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0210000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 9.9977, "num_moves_min": 9.69, "num_moves_max": 10.29, "mean_accuracy_mean": 41.08024, "mean_accuracy_min": 40.891, "mean_accuracy_max": 41.391333333333336, "num_model_switches_mean": 6.0285, "num_model_switches_min": 5.5, "num_model_switches_max": 6.41, "num_slav_mean": 0.16057300000000002, "num_slav_min": 0.13873333333333335, "num_slav_max": 0.18249999999999997, "mean_cluster_cpu_util_mean": 0.5656069949858987, "mean_cluster_cpu_util_min": 0.541990966514389, "mean_cluster_cpu_util_max": 0.587079456090131, "mean_cluster_mem_util_mean": 0.36378579724410864, "mean_cluster_mem_util_min": 0.35461318188667884, "mean_cluster_mem_util_max": 0.3743522525043773, "reward_consolidation_mean_mean": -0.3347222222222223, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.061111111111111144, "reward_illegal_mean_mean": -1.7016666666666662, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333327, "reward_accuracy_mean_mean": 0.8328953333333334, "reward_accuracy_mean_min": 0.4464, "reward_accuracy_mean_max": 1.1938000000000002, "reward_sla_mean_mean": -0.6488333333333333, "reward_sla_mean_min": -1.0426666666666669, "reward_sla_mean_max": -0.31200000000000006, "reward_consolidation_sum_mean": -33.47222222222222, "reward_consolidation_sum_min": -58.88888888888889, "reward_consolidation_sum_max": -6.111111111111114, "reward_illegal_sum_mean": -170.16666666666669, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333326, "reward_accuracy_sum_mean": 83.28953333333335, "reward_accuracy_sum_min": 44.64, "reward_accuracy_sum_max": 119.38000000000001, "reward_sla_sum_mean": -64.88333333333334, "reward_sla_sum_min": -104.26666666666668, "reward_sla_sum_max": -31.200000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3761.0, "global_timestep_min": 1800, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-200.42888888888888, -197.19888888888875, -205.04666666666668, -209.5699999999999, -182.45666666666662, -207.92999999999995, -196.17555555555546, -182.04777777777772, -179.5066666666667, -176.46, -216.11555555555552, -186.65333333333328, -177.48777777777772, -202.00444444444446, -173.84333333333325, -158.30444444444436, -194.8355555555556, -175.8988888888888, -186.45333333333326, -190.6333333333333, -167.22333333333327, -207.38111111111107, -190.21555555555545, -202.0744444444444, -178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2509080843626137, "mean_inference_ms": 2.2110876169785856, "mean_action_processing_ms": 0.09364867526088201, "mean_env_wait_ms": 1.6109357731877014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006593942642211914, "StateBufferConnector_ms": 0.003662586212158203, "ViewRequirementAgentConnector_ms": 0.09458208084106445}, "num_episodes": 12, "episode_return_max": -148.2111111111111, "episode_return_min": -216.11555555555552, "episode_return_mean": -185.23268888888882, "episodes_this_iter": 12}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39600, "num_env_steps_sampled": 39750, "num_env_steps_trained": 39600, "num_env_steps_sampled_this_iter": 1350, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 132.42507465808572, "num_env_steps_trained_throughput_per_sec": 147.13897184231746, "timesteps_total": 39750, "num_env_steps_sampled_lifetime": 39750, "num_agent_steps_sampled_lifetime": 39750, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 39750, "timers": {"training_iteration_time_ms": 10336.86, "restore_workers_time_ms": 0.018, "training_step_time_ms": 1085.424, "sample_time_ms": 1065.372, "synch_weights_time_ms": 18.554}, "counters": {"num_env_steps_sampled": 39750, "num_env_steps_trained": 39600, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 265, "num_samples_added_to_queue": 39600}, "done": false, "training_iteration": 17, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-01", "timestamp": 1728601321, "time_this_iter_s": 10.205851316452026, "time_total_s": 175.97397637367249, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefabf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.97397637367249, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.63999999999999, "ram_util_percent": 44.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -169670.671875, "policy_loss": -170354.796875, "entropy": 29.805625915527344, "entropy_coeff": 0.01, "var_gnorm": 16.028301239013672, "vf_loss": 77354.375, "vf_explained_var": 0.020786166191101074}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 41700, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 41700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 280, "num_samples_added_to_queue": 42000, "learner_queue": {"size_count": 139, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 118.589, "learner_load_time_ms": 0.342, "learner_load_wait_time_ms": 1477.876, "learner_dequeue_time_ms": 10675.105}}, "env_runners": {"episode_reward_max": -148.2111111111111, "episode_reward_min": -208.96444444444433, "episode_reward_mean": -183.11677777777774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -208.96444444444433}, "policy_reward_max": {"default_policy": -148.2111111111111}, "policy_reward_mean": {"default_policy": -183.11677777777774}, "custom_metrics": {"num_consolidated_mean": 0.6557000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.77, "num_overloaded_mean": 1.0100000000000002, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 9.9971, "num_moves_min": 9.69, "num_moves_max": 10.29, "mean_accuracy_mean": 41.06605333333333, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.391333333333336, "num_model_switches_mean": 6.016, "num_model_switches_min": 5.5, "num_model_switches_max": 6.41, "num_slav_mean": 0.1592, "num_slav_min": 0.13873333333333335, "num_slav_max": 0.18249999999999997, "mean_cluster_cpu_util_mean": 0.5646946364047212, "mean_cluster_cpu_util_min": 0.541990966514389, "mean_cluster_cpu_util_max": 0.587079456090131, "mean_cluster_mem_util_mean": 0.3634227481145412, "mean_cluster_mem_util_min": 0.35461318188667884, "mean_cluster_mem_util_max": 0.3743522525043773, "reward_consolidation_mean_mean": -0.3444444444444445, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.061111111111111144, "reward_illegal_mean_mean": -1.683333333333333, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333327, "reward_accuracy_mean_mean": 0.8505733333333335, "reward_accuracy_mean_min": 0.4464, "reward_accuracy_mean_max": 1.1938000000000002, "reward_sla_mean_mean": -0.6539633333333333, "reward_sla_mean_min": -1.0426666666666669, "reward_sla_mean_max": -0.31200000000000006, "reward_consolidation_sum_mean": -34.44444444444444, "reward_consolidation_sum_min": -58.88888888888889, "reward_consolidation_sum_max": -6.111111111111114, "reward_illegal_sum_mean": -168.33333333333331, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333326, "reward_accuracy_sum_mean": 85.05733333333333, "reward_accuracy_sum_min": 44.64, "reward_accuracy_sum_max": 119.38000000000001, "reward_sla_sum_mean": -65.39633333333333, "reward_sla_sum_min": -104.26666666666668, "reward_sla_sum_max": -31.200000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4562.0, "global_timestep_min": 2700, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-178.15222222222204, -171.28333333333333, -167.7566666666666, -191.99333333333323, -208.96444444444433, -188.42555555555555, -186.8711111111111, -191.77999999999992, -199.1722222222221, -185.3544444444443, -186.8111111111111, -173.57888888888888, -180.64333333333326, -158.84777777777776, -180.03222222222212, -194.47111111111101, -202.9866666666666, -187.76222222222216, -172.49555555555543, -149.4633333333334, -157.46222222222218, -196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2522497365128759, "mean_inference_ms": 2.224833722218532, "mean_action_processing_ms": 0.0941832509638952, "mean_env_wait_ms": 1.6198570983541094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006396055221557617, "StateBufferConnector_ms": 0.003674030303955078, "ViewRequirementAgentConnector_ms": 0.09570169448852539}, "num_episodes": 24, "episode_return_max": -148.2111111111111, "episode_return_min": -208.96444444444433, "episode_return_mean": -183.11677777777774, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 41700, "num_env_steps_sampled": 42000, "num_env_steps_trained": 41700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 222.55461301650965, "num_env_steps_trained_throughput_per_sec": 207.717638815409, "timesteps_total": 42000, "num_env_steps_sampled_lifetime": 42000, "num_agent_steps_sampled_lifetime": 42000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 10328.43, "restore_workers_time_ms": 0.014, "training_step_time_ms": 699.262, "sample_time_ms": 683.358, "synch_weights_time_ms": 14.304}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 41700, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 41700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 280, "num_samples_added_to_queue": 42000}, "done": false, "training_iteration": 18, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-11", "timestamp": 1728601331, "time_this_iter_s": 10.128205299377441, "time_total_s": 186.10218167304993, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876440>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.10218167304993, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.764285714285716, "ram_util_percent": 44.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -166465.078125, "policy_loss": -167137.125, "entropy": 29.80118751525879, "entropy_coeff": 0.01, "var_gnorm": 16.032634735107422, "vf_loss": 76145.46875, "vf_explained_var": 0.02321547269821167}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 44250, "num_env_steps_trained": 44100, "num_agent_steps_sampled": 44250, "num_agent_steps_trained": 44100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 295, "num_samples_added_to_queue": 44100, "learner_queue": {"size_count": 147, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.165, "learner_load_time_ms": 0.331, "learner_load_wait_time_ms": 1276.027, "learner_dequeue_time_ms": 10698.489}}, "env_runners": {"episode_reward_max": -148.2111111111111, "episode_reward_min": -211.68888888888893, "episode_reward_mean": -183.67983333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.68888888888893}, "policy_reward_max": {"default_policy": -148.2111111111111}, "policy_reward_mean": {"default_policy": -183.67983333333333}, "custom_metrics": {"num_consolidated_mean": 0.6592, "num_consolidated_min": 0.51, "num_consolidated_max": 0.77, "num_overloaded_mean": 1.0144, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 10.014899999999999, "num_moves_min": 9.65, "num_moves_max": 10.29, "mean_accuracy_mean": 41.070739999999994, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.41033333333333, "num_model_switches_mean": 6.009700000000001, "num_model_switches_min": 5.5, "num_model_switches_max": 6.41, "num_slav_mean": 0.15933966666666668, "num_slav_min": 0.13873333333333335, "num_slav_max": 0.1758833333333334, "mean_cluster_cpu_util_mean": 0.5655534630285719, "mean_cluster_cpu_util_min": 0.541990966514389, "mean_cluster_cpu_util_max": 0.587079456090131, "mean_cluster_mem_util_mean": 0.36367210587990473, "mean_cluster_mem_util_min": 0.35461318188667884, "mean_cluster_mem_util_max": 0.3743522525043773, "reward_consolidation_mean_mean": -0.3476666666666667, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.061111111111111144, "reward_illegal_mean_mean": -1.6906666666666665, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333327, "reward_accuracy_mean_mean": 0.8556883333333335, "reward_accuracy_mean_min": 0.4464, "reward_accuracy_mean_max": 1.1938000000000002, "reward_sla_mean_mean": -0.6541533333333333, "reward_sla_mean_min": -1.0426666666666669, "reward_sla_mean_max": -0.31200000000000006, "reward_consolidation_sum_mean": -34.766666666666666, "reward_consolidation_sum_min": -58.88888888888889, "reward_consolidation_sum_max": -6.111111111111114, "reward_illegal_sum_mean": -169.06666666666663, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333326, "reward_accuracy_sum_mean": 85.56883333333332, "reward_accuracy_sum_min": 44.64, "reward_accuracy_sum_max": 119.38000000000001, "reward_sla_sum_mean": -65.41533333333332, "reward_sla_sum_min": -104.26666666666668, "reward_sla_sum_max": -31.200000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5275.0, "global_timestep_min": 3500, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-196.15111111111105, -188.48111111111115, -182.04555555555547, -199.80222222222216, -148.2111111111111, -188.06111111111107, -207.67111111111103, -167.77777777777786, -172.78333333333325, -170.6233333333333, -174.981111111111, -186.74777777777774, -192.55555555555534, -194.0544444444444, -185.24999999999986, -205.71888888888873, -181.5477777777778, -186.8666666666666, -150.52555555555554, -207.19222222222217, -173.22999999999988, -177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536209071059565, "mean_inference_ms": 2.239072714206634, "mean_action_processing_ms": 0.09470880277575244, "mean_env_wait_ms": 1.6287270699958025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006302833557128906, "StateBufferConnector_ms": 0.0037491321563720703, "ViewRequirementAgentConnector_ms": 0.09828877449035645}, "num_episodes": 21, "episode_return_max": -148.2111111111111, "episode_return_min": -211.68888888888893, "episode_return_mean": -183.67983333333333, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44250, "num_agent_steps_trained": 44100, "num_env_steps_sampled": 44250, "num_env_steps_trained": 44100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 222.42192222389116, "num_env_steps_trained_throughput_per_sec": 237.25005037215055, "timesteps_total": 44250, "num_env_steps_sampled_lifetime": 44250, "num_agent_steps_sampled_lifetime": 44250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 44250, "timers": {"training_iteration_time_ms": 10290.836, "restore_workers_time_ms": 0.013, "training_step_time_ms": 676.874, "sample_time_ms": 660.067, "synch_weights_time_ms": 15.309}, "counters": {"num_env_steps_sampled": 44250, "num_env_steps_trained": 44100, "num_agent_steps_sampled": 44250, "num_agent_steps_trained": 44100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 295, "num_samples_added_to_queue": 44100}, "done": false, "training_iteration": 19, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-21", "timestamp": 1728601341, "time_this_iter_s": 10.134141445159912, "time_total_s": 196.23632311820984, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.23632311820984, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.03333333333334, "ram_util_percent": 44.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -152003.15625, "policy_loss": -152520.890625, "entropy": 29.794885635375977, "entropy_coeff": 0.01, "var_gnorm": 16.038135528564453, "vf_loss": 60712.93359375, "vf_explained_var": 0.034271180629730225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 154.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 46350, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46350, "num_agent_steps_trained": 46200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 309, "num_samples_added_to_queue": 46200, "learner_queue": {"size_count": 154, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.069, "learner_load_time_ms": 0.366, "learner_load_wait_time_ms": 1417.013, "learner_dequeue_time_ms": 10882.107}}, "env_runners": {"episode_reward_max": -147.9066666666667, "episode_reward_min": -211.68888888888893, "episode_reward_mean": -182.53064444444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.68888888888893}, "policy_reward_max": {"default_policy": -147.9066666666667}, "policy_reward_mean": {"default_policy": -182.53064444444442}, "custom_metrics": {"num_consolidated_mean": 0.6620000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.0099999999999998, "num_overloaded_min": 0.84, "num_overloaded_max": 1.16, "num_moves_mean": 10.0123, "num_moves_min": 9.65, "num_moves_max": 10.29, "mean_accuracy_mean": 41.062443333333334, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.41033333333333, "num_model_switches_mean": 5.989999999999998, "num_model_switches_min": 5.5, "num_model_switches_max": 6.3, "num_slav_mean": 0.15926383333333333, "num_slav_min": 0.13873333333333335, "num_slav_max": 0.1758833333333334, "mean_cluster_cpu_util_mean": 0.5649823987485852, "mean_cluster_cpu_util_min": 0.541990966514389, "mean_cluster_cpu_util_max": 0.582967695868783, "mean_cluster_mem_util_mean": 0.36346847422608275, "mean_cluster_mem_util_min": 0.35461318188667884, "mean_cluster_mem_util_max": 0.371767447580298, "reward_consolidation_mean_mean": -0.34744444444444444, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.061111111111111144, "reward_illegal_mean_mean": -1.683333333333333, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.8742713333333332, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.3012666666666663, "reward_sla_mean_mean": -0.6688, "reward_sla_mean_min": -1.0426666666666669, "reward_sla_mean_max": -0.375, "reward_consolidation_sum_mean": -34.74444444444445, "reward_consolidation_sum_min": -58.88888888888889, "reward_consolidation_sum_max": -6.111111111111114, "reward_illegal_sum_mean": -168.33333333333331, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 87.42713333333332, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 130.12666666666664, "reward_sla_sum_mean": -66.88, "reward_sla_sum_min": -104.26666666666668, "reward_sla_sum_max": -37.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5982.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-177.79444444444422, -170.79777777777772, -198.9099999999998, -167.69333333333333, -184.33333333333334, -205.17444444444445, -166.15222222222235, -193.28666666666678, -185.1011111111111, -163.59888888888887, -201.22666666666646, -193.34111111111105, -171.86555555555557, -202.25999999999993, -162.6577777777778, -152.46, -181.37999999999997, -184.17333333333323, -207.64999999999984, -176.19888888888894, -201.12999999999997, -185.3566666666667, -197.64777777777778, -176.90222222222218, -160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25532763999592845, "mean_inference_ms": 2.257536717430592, "mean_action_processing_ms": 0.09532908593049236, "mean_env_wait_ms": 1.6396311625589362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006506919860839844, "StateBufferConnector_ms": 0.0038650035858154297, "ViewRequirementAgentConnector_ms": 0.10182571411132812}, "num_episodes": 21, "episode_return_max": -147.9066666666667, "episode_return_min": -211.68888888888893, "episode_return_mean": -182.53064444444442, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46350, "num_agent_steps_trained": 46200, "num_env_steps_sampled": 46350, "num_env_steps_trained": 46200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 199.44893188746772, "num_env_steps_trained_throughput_per_sec": 199.44893188746772, "timesteps_total": 46350, "num_env_steps_sampled_lifetime": 46350, "num_agent_steps_sampled_lifetime": 46350, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 46350, "timers": {"training_iteration_time_ms": 10303.094, "restore_workers_time_ms": 0.016, "training_step_time_ms": 730.028, "sample_time_ms": 713.724, "synch_weights_time_ms": 14.815}, "counters": {"num_env_steps_sampled": 46350, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46350, "num_agent_steps_trained": 46200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 309, "num_samples_added_to_queue": 46200}, "done": false, "training_iteration": 20, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-32", "timestamp": 1728601352, "time_this_iter_s": 10.541497707366943, "time_total_s": 206.77782082557678, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875930>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.77782082557678, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.02666666666666, "ram_util_percent": 45.78666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -168237.546875, "policy_loss": -168897.21875, "entropy": 29.784137725830078, "entropy_coeff": 0.01, "var_gnorm": 16.04412841796875, "vf_loss": 74902.6484375, "vf_explained_var": 0.03683137893676758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 162.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 325, "num_samples_added_to_queue": 48600, "learner_queue": {"size_count": 162, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.518, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 1235.93, "learner_dequeue_time_ms": 10929.094}}, "env_runners": {"episode_reward_max": -147.9066666666667, "episode_reward_min": -211.68888888888893, "episode_reward_mean": -182.0239333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.68888888888893}, "policy_reward_max": {"default_policy": -147.9066666666667}, "policy_reward_mean": {"default_policy": -182.0239333333333}, "custom_metrics": {"num_consolidated_mean": 0.6721999999999998, "num_consolidated_min": 0.51, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0124000000000002, "num_overloaded_min": 0.84, "num_overloaded_max": 1.16, "num_moves_mean": 10.0158, "num_moves_min": 9.65, "num_moves_max": 10.29, "mean_accuracy_mean": 41.04990333333333, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.41033333333333, "num_model_switches_mean": 5.975499999999999, "num_model_switches_min": 5.65, "num_model_switches_max": 6.3, "num_slav_mean": 0.1592035, "num_slav_min": 0.13955, "num_slav_max": 0.17676666666666666, "mean_cluster_cpu_util_mean": 0.5653156560269955, "mean_cluster_cpu_util_min": 0.5456251045122923, "mean_cluster_cpu_util_max": 0.5831186160633909, "mean_cluster_mem_util_mean": 0.36379392005726335, "mean_cluster_mem_util_min": 0.3552143391744884, "mean_cluster_mem_util_max": 0.371767447580298, "reward_consolidation_mean_mean": -0.3341666666666667, "reward_consolidation_mean_min": -0.6, "reward_consolidation_mean_max": -0.061111111111111144, "reward_illegal_mean_mean": -1.687333333333333, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.8704773333333334, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.3012666666666663, "reward_sla_mean_mean": -0.6692166666666668, "reward_sla_mean_min": -1.0913333333333333, "reward_sla_mean_max": -0.37233333333333335, "reward_consolidation_sum_mean": -33.416666666666664, "reward_consolidation_sum_min": -59.99999999999999, "reward_consolidation_sum_max": -6.111111111111114, "reward_illegal_sum_mean": -168.73333333333323, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 87.04773333333333, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 130.12666666666664, "reward_sla_sum_mean": -66.92166666666668, "reward_sla_sum_min": -109.13333333333333, "reward_sla_sum_max": -37.233333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5378.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.77111111111108, -189.84666666666664, -168.22, -194.07999999999996, -186.56444444444446, -185.7488888888888, -204.5099999999999, -192.6644444444443, -189.76111111111112, -203.4788888888888, -182.7344444444443, -181.77222222222215, -178.94888888888883, -172.32888888888894, -186.06444444444443, -185.28555555555553, -192.82555555555555, -188.37999999999994, -191.7444444444444, -206.60999999999993, -176.11444444444444, -176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2569016490590188, "mean_inference_ms": 2.27346981464546, "mean_action_processing_ms": 0.09590250215927501, "mean_env_wait_ms": 1.6498826919544194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006308555603027344, "StateBufferConnector_ms": 0.003617525100708008, "ViewRequirementAgentConnector_ms": 0.09506368637084961}, "num_episodes": 24, "episode_return_max": -147.9066666666667, "episode_return_min": -211.68888888888893, "episode_return_mean": -182.0239333333333, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.17549680494474, "num_env_steps_trained_throughput_per_sec": 233.17549680494474, "timesteps_total": 48750, "num_env_steps_sampled_lifetime": 48750, "num_agent_steps_sampled_lifetime": 48750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 48750, "timers": {"training_iteration_time_ms": 10304.478, "restore_workers_time_ms": 0.014, "training_step_time_ms": 655.715, "sample_time_ms": 639.777, "synch_weights_time_ms": 14.449}, "counters": {"num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 325, "num_samples_added_to_queue": 48600}, "done": false, "training_iteration": 21, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-42", "timestamp": 1728601362, "time_this_iter_s": 10.301582336425781, "time_total_s": 217.07940316200256, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698743d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.07940316200256, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.766666666666666, "ram_util_percent": 44.72666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -167541.5625, "policy_loss": -168201.234375, "entropy": 29.77653694152832, "entropy_coeff": 0.01, "var_gnorm": 16.049041748046875, "vf_loss": 74900.71875, "vf_explained_var": 0.03978532552719116}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 169.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 50850, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 50850, "num_agent_steps_trained": 50700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 339, "num_samples_added_to_queue": 50700, "learner_queue": {"size_count": 169, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.248, "learner_load_time_ms": 0.269, "learner_load_wait_time_ms": 1363.1, "learner_dequeue_time_ms": 11066.556}}, "env_runners": {"episode_reward_max": -143.70222222222225, "episode_reward_min": -211.68888888888893, "episode_reward_mean": -180.0769333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.68888888888893}, "policy_reward_max": {"default_policy": -143.70222222222225}, "policy_reward_mean": {"default_policy": -180.0769333333333}, "custom_metrics": {"num_consolidated_mean": 0.6767, "num_consolidated_min": 0.5, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9987, "num_overloaded_min": 0.79, "num_overloaded_max": 1.16, "num_moves_mean": 10.007200000000003, "num_moves_min": 9.65, "num_moves_max": 10.25, "mean_accuracy_mean": 41.040466666666674, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.41033333333333, "num_model_switches_mean": 5.968999999999999, "num_model_switches_min": 5.65, "num_model_switches_max": 6.29, "num_slav_mean": 0.15895749999999997, "num_slav_min": 0.13955, "num_slav_max": 0.17676666666666666, "mean_cluster_cpu_util_mean": 0.5645594166876841, "mean_cluster_cpu_util_min": 0.5456251045122923, "mean_cluster_cpu_util_max": 0.5831186160633909, "mean_cluster_mem_util_mean": 0.3635017943845259, "mean_cluster_mem_util_min": 0.3552143391744884, "mean_cluster_mem_util_max": 0.371767447580298, "reward_consolidation_mean_mean": -0.3498333333333333, "reward_consolidation_mean_min": -0.6, "reward_consolidation_mean_max": -0.1166666666666667, "reward_illegal_mean_mean": -1.6645, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9056073333333333, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.4985333333333335, "reward_sla_mean_mean": -0.6920433333333336, "reward_sla_mean_min": -1.0913333333333333, "reward_sla_mean_max": -0.37233333333333335, "reward_consolidation_sum_mean": -34.98333333333334, "reward_consolidation_sum_min": -59.99999999999999, "reward_consolidation_sum_max": -11.66666666666667, "reward_illegal_sum_mean": -166.44999999999996, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 90.56073333333333, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 149.85333333333335, "reward_sla_sum_mean": -69.20433333333334, "reward_sla_sum_min": -109.13333333333333, "reward_sla_sum_max": -37.233333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4425.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-176.91555555555541, -175.34111111111102, -184.9144444444444, -168.30333333333328, -202.21111111111105, -166.0377777777778, -187.87, -190.19111111111107, -170.93888888888887, -174.96666666666664, -161.08222222222224, -167.8633333333333, -184.91, -193.27111111111114, -191.13777777777776, -167.3233333333332, -197.18222222222218, -196.6955555555555, -168.24333333333323, -167.36555555555552, -154.3933333333333, -190.90222222222226, -173.52666666666659, -181.8833333333332, -185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25705143080234155, "mean_inference_ms": 2.2714663871538954, "mean_action_processing_ms": 0.09590203383379232, "mean_env_wait_ms": 1.6504117461912369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006491661071777344, "StateBufferConnector_ms": 0.003767728805541992, "ViewRequirementAgentConnector_ms": 0.09853887557983398}, "num_episodes": 21, "episode_return_max": -143.70222222222225, "episode_return_min": -211.68888888888893, "episode_return_mean": -180.0769333333333, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50850, "num_agent_steps_trained": 50700, "num_env_steps_sampled": 50850, "num_env_steps_trained": 50700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 203.71059733154158, "num_env_steps_trained_throughput_per_sec": 203.71059733154158, "timesteps_total": 50850, "num_env_steps_sampled_lifetime": 50850, "num_agent_steps_sampled_lifetime": 50850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 50850, "timers": {"training_iteration_time_ms": 10286.762, "restore_workers_time_ms": 0.014, "training_step_time_ms": 751.991, "sample_time_ms": 734.298, "synch_weights_time_ms": 15.791}, "counters": {"num_env_steps_sampled": 50850, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 50850, "num_agent_steps_trained": 50700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 339, "num_samples_added_to_queue": 50700}, "done": false, "training_iteration": 22, "trial_id": "3f041_00000", "date": "2024-10-11_00-02-53", "timestamp": 1728601373, "time_this_iter_s": 10.31732988357544, "time_total_s": 227.396733045578, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698746d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.396733045578, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.713333333333335, "ram_util_percent": 45.62666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -166051.265625, "policy_loss": -166681.3125, "entropy": 29.767330169677734, "entropy_coeff": 0.01, "var_gnorm": 16.05384635925293, "vf_loss": 71934.171875, "vf_explained_var": 0.0498197078704834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 177.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 53250, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 53250, "num_agent_steps_trained": 53100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 355, "num_samples_added_to_queue": 53100, "learner_queue": {"size_count": 177, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.629, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1304.474, "learner_dequeue_time_ms": 11117.194}}, "env_runners": {"episode_reward_max": -143.70222222222225, "episode_reward_min": -211.68888888888893, "episode_reward_mean": -179.8609888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.68888888888893}, "policy_reward_max": {"default_policy": -143.70222222222225}, "policy_reward_mean": {"default_policy": -179.8609888888888}, "custom_metrics": {"num_consolidated_mean": 0.6750000000000002, "num_consolidated_min": 0.5, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.995, "num_overloaded_min": 0.79, "num_overloaded_max": 1.14, "num_moves_mean": 10.0034, "num_moves_min": 9.65, "num_moves_max": 10.25, "mean_accuracy_mean": 41.03001666666667, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.271, "num_model_switches_mean": 5.981000000000002, "num_model_switches_min": 5.61, "num_model_switches_max": 6.56, "num_slav_mean": 0.15895883333333333, "num_slav_min": 0.14126666666666668, "num_slav_max": 0.17676666666666666, "mean_cluster_cpu_util_mean": 0.5633799595790441, "mean_cluster_cpu_util_min": 0.5440277395009607, "mean_cluster_cpu_util_max": 0.5831186160633909, "mean_cluster_mem_util_mean": 0.3631648593530239, "mean_cluster_mem_util_min": 0.35584419956801283, "mean_cluster_mem_util_max": 0.371767447580298, "reward_consolidation_mean_mean": -0.3503888888888889, "reward_consolidation_mean_min": -0.6, "reward_consolidation_mean_max": -0.08888888888888895, "reward_illegal_mean_mean": -1.6583333333333332, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9161989999999999, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.4985333333333335, "reward_sla_mean_mean": -0.7060866666666666, "reward_sla_mean_min": -1.0913333333333333, "reward_sla_mean_max": -0.37233333333333335, "reward_consolidation_sum_mean": -35.03888888888889, "reward_consolidation_sum_min": -59.99999999999999, "reward_consolidation_sum_max": -8.888888888888895, "reward_illegal_sum_mean": -165.8333333333333, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 91.61989999999997, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 149.85333333333335, "reward_sla_sum_mean": -70.60866666666668, "reward_sla_sum_min": -109.13333333333333, "reward_sla_sum_max": -37.233333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3357.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-185.8244444444444, -193.3766666666667, -189.91333333333316, -190.43444444444438, -174.72666666666663, -174.58000000000004, -190.99222222222215, -211.68888888888893, -184.32111111111112, -192.83111111111097, -203.17333333333323, -200.9166666666666, -184.40666666666664, -163.0766666666666, -148.88777777777779, -177.6388888888888, -147.9066666666667, -179.8633333333332, -203.97333333333324, -199.7244444444445, -196.59888888888878, -182.6533333333333, -191.88555555555544, -180.74999999999994, -166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2578300895440043, "mean_inference_ms": 2.2772323678330886, "mean_action_processing_ms": 0.09606563841050048, "mean_env_wait_ms": 1.6538745270994568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006411314010620117, "StateBufferConnector_ms": 0.0037462711334228516, "ViewRequirementAgentConnector_ms": 0.0970909595489502}, "num_episodes": 24, "episode_return_max": -143.70222222222225, "episode_return_min": -211.68888888888893, "episode_return_mean": -179.8609888888888, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53250, "num_agent_steps_trained": 53100, "num_env_steps_sampled": 53250, "num_env_steps_trained": 53100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 230.7222651683061, "num_env_steps_trained_throughput_per_sec": 230.7222651683061, "timesteps_total": 53250, "num_env_steps_sampled_lifetime": 53250, "num_agent_steps_sampled_lifetime": 53250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 53250, "timers": {"training_iteration_time_ms": 10271.812, "restore_workers_time_ms": 0.013, "training_step_time_ms": 657.098, "sample_time_ms": 641.306, "synch_weights_time_ms": 14.127}, "counters": {"num_env_steps_sampled": 53250, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 53250, "num_agent_steps_trained": 53100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 355, "num_samples_added_to_queue": 53100}, "done": false, "training_iteration": 23, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-03", "timestamp": 1728601383, "time_this_iter_s": 10.416627645492554, "time_total_s": 237.81336069107056, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa980>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.81336069107056, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.099999999999998, "ram_util_percent": 45.635714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -173456.625, "policy_loss": -174159.6875, "entropy": 29.759931564331055, "entropy_coeff": 0.01, "var_gnorm": 16.05866050720215, "vf_loss": 79234.328125, "vf_explained_var": 0.050320327281951904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 184.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 55500, "num_env_steps_trained": 55200, "num_agent_steps_sampled": 55500, "num_agent_steps_trained": 55200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 370, "num_samples_added_to_queue": 55500, "learner_queue": {"size_count": 184, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.604, "learner_load_time_ms": 0.266, "learner_load_wait_time_ms": 1322.598, "learner_dequeue_time_ms": 11239.282}}, "env_runners": {"episode_reward_max": -139.12222222222226, "episode_reward_min": -206.14111111111094, "episode_reward_mean": -177.4952444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.14111111111094}, "policy_reward_max": {"default_policy": -139.12222222222226}, "policy_reward_mean": {"default_policy": -177.4952444444444}, "custom_metrics": {"num_consolidated_mean": 0.6791999999999999, "num_consolidated_min": 0.5, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9803000000000002, "num_overloaded_min": 0.79, "num_overloaded_max": 1.12, "num_moves_mean": 10.009499999999997, "num_moves_min": 9.73, "num_moves_max": 10.4, "mean_accuracy_mean": 41.01576666666667, "mean_accuracy_min": 40.77066666666666, "mean_accuracy_max": 41.271, "num_model_switches_mean": 5.9818, "num_model_switches_min": 5.61, "num_model_switches_max": 6.56, "num_slav_mean": 0.1572943333333333, "num_slav_min": 0.14103333333333332, "num_slav_max": 0.17676666666666666, "mean_cluster_cpu_util_mean": 0.5625140150703767, "mean_cluster_cpu_util_min": 0.5440277395009607, "mean_cluster_cpu_util_max": 0.5831186160633909, "mean_cluster_mem_util_mean": 0.3628315979182812, "mean_cluster_mem_util_min": 0.35584419956801283, "mean_cluster_mem_util_max": 0.3717047434269067, "reward_consolidation_mean_mean": -0.3651111111111111, "reward_consolidation_mean_min": -0.6222222222222222, "reward_consolidation_mean_max": -0.08888888888888895, "reward_illegal_mean_mean": -1.6338333333333332, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9404219999999998, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.4985333333333335, "reward_sla_mean_mean": -0.7164299999999999, "reward_sla_mean_min": -1.0913333333333333, "reward_sla_mean_max": -0.37233333333333335, "reward_consolidation_sum_mean": -36.511111111111106, "reward_consolidation_sum_min": -62.22222222222222, "reward_consolidation_sum_max": -8.888888888888895, "reward_illegal_sum_mean": -163.38333333333333, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 94.04220000000001, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 149.85333333333335, "reward_sla_sum_mean": -71.643, "reward_sla_sum_min": -109.13333333333333, "reward_sla_sum_max": -37.233333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2281.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.30222222222218, -153.54666666666674, -174.93555555555542, -201.18777777777765, -150.35555555555555, -170.9555555555556, -166.62000000000006, -203.59999999999997, -195.33888888888887, -181.64666666666665, -186.58444444444447, -190.4477777777777, -175.2977777777778, -168.16222222222217, -171.21555555555554, -181.31333333333328, -161.88444444444443, -206.14111111111094, -167.07777777777773, -193.92555555555558, -188.92777777777764, -159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2585901295589095, "mean_inference_ms": 2.2806637523337914, "mean_action_processing_ms": 0.09616187846922603, "mean_env_wait_ms": 1.656231393074366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006310224533081055, "StateBufferConnector_ms": 0.0036656856536865234, "ViewRequirementAgentConnector_ms": 0.09528017044067383}, "num_episodes": 24, "episode_return_max": -139.12222222222226, "episode_return_min": -206.14111111111094, "episode_return_mean": -177.4952444444444, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55500, "num_agent_steps_trained": 55200, "num_env_steps_sampled": 55500, "num_env_steps_trained": 55200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.34700758268193, "num_env_steps_trained_throughput_per_sec": 200.99054041050314, "timesteps_total": 55500, "num_env_steps_sampled_lifetime": 55500, "num_agent_steps_sampled_lifetime": 55500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 55500, "timers": {"training_iteration_time_ms": 10260.063, "restore_workers_time_ms": 0.015, "training_step_time_ms": 706.968, "sample_time_ms": 689.162, "synch_weights_time_ms": 16.176}, "counters": {"num_env_steps_sampled": 55500, "num_env_steps_trained": 55200, "num_agent_steps_sampled": 55500, "num_agent_steps_trained": 55200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 370, "num_samples_added_to_queue": 55500}, "done": false, "training_iteration": 24, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-14", "timestamp": 1728601394, "time_this_iter_s": 10.45864224433899, "time_total_s": 248.27200293540955, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefaa40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.27200293540955, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.82, "ram_util_percent": 44.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -150020.6875, "policy_loss": -150529.90625, "entropy": 29.74830436706543, "entropy_coeff": 0.01, "var_gnorm": 16.063756942749023, "vf_loss": 59846.23828125, "vf_explained_var": 0.06364589929580688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 192.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 385, "num_samples_added_to_queue": 57600, "learner_queue": {"size_count": 192, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.365, "learner_load_time_ms": 0.266, "learner_load_wait_time_ms": 1298.917, "learner_dequeue_time_ms": 11239.282}}, "env_runners": {"episode_reward_max": -139.12222222222226, "episode_reward_min": -201.92777777777764, "episode_reward_mean": -175.64336666666662, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.92777777777764}, "policy_reward_max": {"default_policy": -139.12222222222226}, "policy_reward_mean": {"default_policy": -175.64336666666662}, "custom_metrics": {"num_consolidated_mean": 0.6753999999999999, "num_consolidated_min": 0.5, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9660999999999998, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 10.002199999999998, "num_moves_min": 9.65, "num_moves_max": 10.4, "mean_accuracy_mean": 40.999300000000005, "mean_accuracy_min": 40.757999999999996, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 5.9879999999999995, "num_model_switches_min": 5.61, "num_model_switches_max": 6.56, "num_slav_mean": 0.1560405, "num_slav_min": 0.14078333333333332, "num_slav_max": 0.1743, "mean_cluster_cpu_util_mean": 0.5607231995876666, "mean_cluster_cpu_util_min": 0.5440277395009607, "mean_cluster_cpu_util_max": 0.5831186160633909, "mean_cluster_mem_util_mean": 0.3620444782194523, "mean_cluster_mem_util_min": 0.35584419956801283, "mean_cluster_mem_util_max": 0.3717047434269067, "reward_consolidation_mean_mean": -0.3795, "reward_consolidation_mean_min": -0.6333333333333334, "reward_consolidation_mean_max": -0.08888888888888895, "reward_illegal_mean_mean": -1.6101666666666665, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.9706396666666666, "reward_accuracy_mean_min": 0.5747666666666668, "reward_accuracy_mean_max": 1.6086000000000005, "reward_sla_mean_mean": -0.7374066666666667, "reward_sla_mean_min": -1.2613333333333336, "reward_sla_mean_max": -0.39333333333333337, "reward_consolidation_sum_mean": -37.95, "reward_consolidation_sum_min": -63.33333333333334, "reward_consolidation_sum_max": -8.888888888888895, "reward_illegal_sum_mean": -161.01666666666665, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 97.06396666666669, "reward_accuracy_sum_min": 57.476666666666674, "reward_accuracy_sum_max": 160.86000000000004, "reward_sla_sum_mean": -73.74066666666667, "reward_sla_sum_min": -126.13333333333335, "reward_sla_sum_max": -39.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2122.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-159.4966666666666, -196.99444444444435, -183.8277777777778, -168.2177777777778, -190.46777777777757, -190.61333333333326, -184.26888888888882, -174.41111111111107, -161.28777777777773, -175.27222222222218, -198.59444444444446, -176.7355555555556, -187.26111111111115, -172.69666666666657, -143.70222222222225, -188.2644444444443, -183.17222222222216, -157.15666666666664, -161.89444444444447, -180.4644444444444, -167.6877777777777, -166.5088888888888, -187.49666666666656, -179.36777777777777, -189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2590363135318538, "mean_inference_ms": 2.2808235756955875, "mean_action_processing_ms": 0.09620456264304497, "mean_env_wait_ms": 1.6574575279521009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006314516067504883, "StateBufferConnector_ms": 0.0036513805389404297, "ViewRequirementAgentConnector_ms": 0.09536004066467285}, "num_episodes": 21, "episode_return_max": -139.12222222222226, "episode_return_min": -201.92777777777764, "episode_return_mean": -175.64336666666662, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 220.73056251749094, "num_env_steps_trained_throughput_per_sec": 235.4459333519903, "timesteps_total": 57750, "num_env_steps_sampled_lifetime": 57750, "num_agent_steps_sampled_lifetime": 57750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 57750, "timers": {"training_iteration_time_ms": 10270.694, "restore_workers_time_ms": 0.015, "training_step_time_ms": 683.153, "sample_time_ms": 666.945, "synch_weights_time_ms": 14.727}, "counters": {"num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 385, "num_samples_added_to_queue": 57600}, "done": false, "training_iteration": 25, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-24", "timestamp": 1728601404, "time_this_iter_s": 10.203957319259644, "time_total_s": 258.4759602546692, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698768c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.4759602546692, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.8, "ram_util_percent": 44.513333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -139321.59375, "policy_loss": -139774.234375, "entropy": 29.735549926757812, "entropy_coeff": 0.01, "var_gnorm": 16.06894302368164, "vf_loss": 54183.75, "vf_explained_var": 0.06374627351760864}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 400, "num_samples_added_to_queue": 60000, "learner_queue": {"size_count": 199, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.996, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1323.959, "learner_dequeue_time_ms": 11269.859}}, "env_runners": {"episode_reward_max": -139.12222222222226, "episode_reward_min": -201.92777777777764, "episode_reward_mean": -174.79614444444437, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.92777777777764}, "policy_reward_max": {"default_policy": -139.12222222222226}, "policy_reward_mean": {"default_policy": -174.79614444444437}, "custom_metrics": {"num_consolidated_mean": 0.6723999999999998, "num_consolidated_min": 0.5, "num_consolidated_max": 0.81, "num_overloaded_mean": 0.9580000000000001, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 9.9978, "num_moves_min": 9.65, "num_moves_max": 10.4, "mean_accuracy_mean": 40.994233333333334, "mean_accuracy_min": 40.757999999999996, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 5.9788999999999985, "num_model_switches_min": 5.59, "num_model_switches_max": 6.56, "num_slav_mean": 0.15539850000000002, "num_slav_min": 0.13705, "num_slav_max": 0.1743, "mean_cluster_cpu_util_mean": 0.5601863050777132, "mean_cluster_cpu_util_min": 0.54023206999296, "mean_cluster_cpu_util_max": 0.5808434157136808, "mean_cluster_mem_util_mean": 0.36170860481249467, "mean_cluster_mem_util_min": 0.3518161516188754, "mean_cluster_mem_util_max": 0.37082562322397317, "reward_consolidation_mean_mean": -0.3834444444444444, "reward_consolidation_mean_min": -0.6333333333333334, "reward_consolidation_mean_max": -0.08888888888888895, "reward_illegal_mean_mean": -1.596666666666667, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.9855496666666665, "reward_accuracy_mean_min": 0.6126999999999999, "reward_accuracy_mean_max": 1.6086000000000005, "reward_sla_mean_mean": -0.7534000000000001, "reward_sla_mean_min": -1.2613333333333336, "reward_sla_mean_max": -0.39333333333333337, "reward_consolidation_sum_mean": -38.34444444444444, "reward_consolidation_sum_min": -63.33333333333334, "reward_consolidation_sum_max": -8.888888888888895, "reward_illegal_sum_mean": -159.66666666666663, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 98.55496666666667, "reward_accuracy_sum_min": 61.269999999999996, "reward_accuracy_sum_max": 160.86000000000004, "reward_sla_sum_mean": -75.34, "reward_sla_sum_min": -126.13333333333335, "reward_sla_sum_max": -39.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2767.0, "global_timestep_min": 700, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-189.17444444444442, -196.84111111111113, -195.02555555555548, -165.74777777777774, -172.15444444444444, -169.83444444444442, -183.97333333333327, -159.74555555555554, -180.89555555555555, -169.26777777777775, -178.16000000000005, -190.77333333333334, -190.14999999999986, -189.65888888888887, -184.301111111111, -166.4822222222222, -176.99666666666656, -150.38555555555558, -189.31333333333328, -178.34555555555565, -170.49555555555548, -165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2598456036870847, "mean_inference_ms": 2.2843987073171026, "mean_action_processing_ms": 0.0963258267816653, "mean_env_wait_ms": 1.6600380713004206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006233930587768555, "StateBufferConnector_ms": 0.003615140914916992, "ViewRequirementAgentConnector_ms": 0.09433627128601074}, "num_episodes": 24, "episode_return_max": -139.12222222222226, "episode_return_min": -201.92777777777764, "episode_return_mean": -174.79614444444437, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.31174557086342, "num_env_steps_trained_throughput_per_sec": 200.95762919947254, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10304.45, "restore_workers_time_ms": 0.013, "training_step_time_ms": 691.649, "sample_time_ms": 676.354, "synch_weights_time_ms": 13.847}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 400, "num_samples_added_to_queue": 60000}, "done": false, "training_iteration": 26, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-34", "timestamp": 1728601414, "time_this_iter_s": 10.460549592971802, "time_total_s": 268.936509847641, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa3b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.936509847641, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.74, "ram_util_percent": 43.68666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -130251.296875, "policy_loss": -130651.390625, "entropy": 29.714387893676758, "entropy_coeff": 0.01, "var_gnorm": 16.076129913330078, "vf_loss": 48923.7890625, "vf_explained_var": 0.07149618864059448}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 62250, "num_env_steps_trained": 62100, "num_agent_steps_sampled": 62250, "num_agent_steps_trained": 62100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 415, "num_samples_added_to_queue": 62100, "learner_queue": {"size_count": 207, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.53, "learner_load_time_ms": 0.323, "learner_load_wait_time_ms": 1318.402, "learner_dequeue_time_ms": 11380.528}}, "env_runners": {"episode_reward_max": -131.51444444444448, "episode_reward_min": -201.92777777777764, "episode_reward_mean": -171.99794444444436, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.92777777777764}, "policy_reward_max": {"default_policy": -131.51444444444448}, "policy_reward_mean": {"default_policy": -171.99794444444436}, "custom_metrics": {"num_consolidated_mean": 0.6779999999999999, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9480000000000001, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 9.9831, "num_moves_min": 9.65, "num_moves_max": 10.4, "mean_accuracy_mean": 40.96611333333333, "mean_accuracy_min": 40.70733333333333, "mean_accuracy_max": 41.22666666666667, "num_model_switches_mean": 5.9501, "num_model_switches_min": 5.59, "num_model_switches_max": 6.37, "num_slav_mean": 0.1538825, "num_slav_min": 0.13705, "num_slav_max": 0.1743, "mean_cluster_cpu_util_mean": 0.5587415299093836, "mean_cluster_cpu_util_min": 0.54023206999296, "mean_cluster_cpu_util_max": 0.5808434157136808, "mean_cluster_mem_util_mean": 0.3610651644511181, "mean_cluster_mem_util_min": 0.3518161516188754, "mean_cluster_mem_util_max": 0.37045405077642873, "reward_consolidation_mean_mean": -0.3821111111111112, "reward_consolidation_mean_min": -0.6333333333333334, "reward_consolidation_mean_max": -0.08888888888888895, "reward_illegal_mean_mean": -1.5799999999999994, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 1.0056683333333332, "reward_accuracy_mean_min": 0.6209333333333334, "reward_accuracy_mean_max": 1.6086000000000005, "reward_sla_mean_mean": -0.7635366666666665, "reward_sla_mean_min": -1.2613333333333336, "reward_sla_mean_max": -0.45400000000000007, "reward_consolidation_sum_mean": -38.21111111111111, "reward_consolidation_sum_min": -63.33333333333334, "reward_consolidation_sum_max": -8.888888888888895, "reward_illegal_sum_mean": -157.99999999999997, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 100.56683333333332, "reward_accuracy_sum_min": 62.09333333333335, "reward_accuracy_sum_max": 160.86000000000004, "reward_sla_sum_mean": -76.35366666666667, "reward_sla_sum_min": -126.13333333333335, "reward_sla_sum_max": -45.400000000000006, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3466.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-165.09111111111108, -179.4777777777777, -168.7788888888889, -173.39888888888876, -196.76333333333335, -161.1955555555556, -181.9288888888889, -189.8144444444445, -185.0555555555555, -195.39999999999992, -199.87555555555545, -169.24888888888879, -176.64111111111114, -161.30000000000004, -160.23333333333335, -170.35111111111107, -192.22444444444437, -172.15333333333325, -176.41888888888877, -185.0833333333333, -176.40444444444447, -181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2602907258737706, "mean_inference_ms": 2.2842590264948197, "mean_action_processing_ms": 0.09637151061763871, "mean_env_wait_ms": 1.661093135868849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006664752960205078, "StateBufferConnector_ms": 0.003603696823120117, "ViewRequirementAgentConnector_ms": 0.09364438056945801}, "num_episodes": 21, "episode_return_max": -131.51444444444448, "episode_return_min": -201.92777777777764, "episode_return_mean": -171.99794444444436, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62250, "num_agent_steps_trained": 62100, "num_env_steps_sampled": 62250, "num_env_steps_trained": 62100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 217.9397925176033, "num_env_steps_trained_throughput_per_sec": 232.46911201877685, "timesteps_total": 62250, "num_env_steps_sampled_lifetime": 62250, "num_agent_steps_sampled_lifetime": 62250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 62250, "timers": {"training_iteration_time_ms": 10317.401, "restore_workers_time_ms": 0.014, "training_step_time_ms": 691.833, "sample_time_ms": 675.764, "synch_weights_time_ms": 14.559}, "counters": {"num_env_steps_sampled": 62250, "num_env_steps_trained": 62100, "num_agent_steps_sampled": 62250, "num_agent_steps_trained": 62100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 415, "num_samples_added_to_queue": 62100}, "done": false, "training_iteration": 27, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-45", "timestamp": 1728601425, "time_this_iter_s": 10.33791732788086, "time_total_s": 279.27442717552185, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877580>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.27442717552185, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.973333333333336, "ram_util_percent": 43.546666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -136938.84375, "policy_loss": -137371.15625, "entropy": 29.69890022277832, "entropy_coeff": 0.01, "var_gnorm": 16.081375122070312, "vf_loss": 52140.71875, "vf_explained_var": 0.08246690034866333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 64200, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 63900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 428, "num_samples_added_to_queue": 64200, "learner_queue": {"size_count": 213, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.875, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 1522.397, "learner_dequeue_time_ms": 11305.487}}, "env_runners": {"episode_reward_max": -131.51444444444448, "episode_reward_min": -201.92777777777764, "episode_reward_mean": -168.96475555555548, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.92777777777764}, "policy_reward_max": {"default_policy": -131.51444444444448}, "policy_reward_mean": {"default_policy": -168.96475555555548}, "custom_metrics": {"num_consolidated_mean": 0.6824000000000001, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9307, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 9.982500000000002, "num_moves_min": 9.65, "num_moves_max": 10.4, "mean_accuracy_mean": 40.960730000000005, "mean_accuracy_min": 40.70099999999999, "mean_accuracy_max": 41.22666666666667, "num_model_switches_mean": 5.955699999999999, "num_model_switches_min": 5.44, "num_model_switches_max": 6.37, "num_slav_mean": 0.1537393333333333, "num_slav_min": 0.13705, "num_slav_max": 0.1743, "mean_cluster_cpu_util_mean": 0.5567738285520902, "mean_cluster_cpu_util_min": 0.5369820591925328, "mean_cluster_cpu_util_max": 0.5808434157136808, "mean_cluster_mem_util_mean": 0.3600383149702918, "mean_cluster_mem_util_min": 0.3517359387109274, "mean_cluster_mem_util_max": 0.37045405077642873, "reward_consolidation_mean_mean": -0.39488888888888896, "reward_consolidation_mean_min": -0.638888888888889, "reward_consolidation_mean_max": -0.12777777777777785, "reward_illegal_mean_mean": -1.5511666666666664, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 1.0444980000000001, "reward_accuracy_mean_min": 0.6209333333333334, "reward_accuracy_mean_max": 1.6086000000000005, "reward_sla_mean_mean": -0.78809, "reward_sla_mean_min": -1.2613333333333336, "reward_sla_mean_max": -0.45400000000000007, "reward_consolidation_sum_mean": -39.488888888888894, "reward_consolidation_sum_min": -63.88888888888889, "reward_consolidation_sum_max": -12.777777777777786, "reward_illegal_sum_mean": -155.11666666666665, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 104.44980000000001, "reward_accuracy_sum_min": 62.09333333333335, "reward_accuracy_sum_max": 160.86000000000004, "reward_sla_sum_mean": -78.809, "reward_sla_sum_min": -126.13333333333335, "reward_sla_sum_max": -45.400000000000006, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4167.0, "global_timestep_min": 2200, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-181.6355555555556, -180.95555555555555, -191.98222222222213, -185.16888888888892, -187.27222222222215, -185.28333333333327, -139.12222222222226, -155.52555555555557, -167.18666666666675, -168.97888888888883, -158.27666666666667, -194.97444444444443, -177.2733333333332, -201.92777777777764, -173.33999999999995, -159.74333333333345, -152.0911111111112, -184.77333333333326, -157.7122222222222, -160.718888888889, -163.60333333333338, -182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.261112274583777, "mean_inference_ms": 2.2890083286045946, "mean_action_processing_ms": 0.09654960923260923, "mean_env_wait_ms": 1.6645067683075154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007029056549072266, "StateBufferConnector_ms": 0.0037212371826171875, "ViewRequirementAgentConnector_ms": 0.0972433090209961}, "num_episodes": 21, "episode_return_max": -131.51444444444448, "episode_return_min": -201.92777777777764, "episode_return_mean": -168.96475555555548, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 63900, "num_env_steps_sampled": 64200, "num_env_steps_trained": 63900, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.6938057265257, "num_env_steps_trained_throughput_per_sec": 164.02505143986988, "timesteps_total": 64200, "num_env_steps_sampled_lifetime": 64200, "num_agent_steps_sampled_lifetime": 64200, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 64200, "timers": {"training_iteration_time_ms": 10403.807, "restore_workers_time_ms": 0.015, "training_step_time_ms": 884.677, "sample_time_ms": 864.77, "synch_weights_time_ms": 17.901}, "counters": {"num_env_steps_sampled": 64200, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 63900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 428, "num_samples_added_to_queue": 64200}, "done": false, "training_iteration": 28, "trial_id": "3f041_00000", "date": "2024-10-11_00-03-56", "timestamp": 1728601436, "time_this_iter_s": 10.98885989189148, "time_total_s": 290.26328706741333, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.26328706741333, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.06, "ram_util_percent": 45.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -131881.765625, "policy_loss": -132271.109375, "entropy": 29.675771713256836, "entropy_coeff": 0.01, "var_gnorm": 16.088714599609375, "vf_loss": 47837.4375, "vf_explained_var": 0.09648668766021729}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 66450, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 66450, "num_agent_steps_trained": 66300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 443, "num_samples_added_to_queue": 66300, "learner_queue": {"size_count": 221, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.567, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1459.35, "learner_dequeue_time_ms": 11275.955}}, "env_runners": {"episode_reward_max": -130.308888888889, "episode_reward_min": -199.6733333333331, "episode_reward_mean": -165.92948888888884, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -199.6733333333331}, "policy_reward_max": {"default_policy": -130.308888888889}, "policy_reward_mean": {"default_policy": -165.92948888888884}, "custom_metrics": {"num_consolidated_mean": 0.6862000000000001, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9154999999999999, "num_overloaded_min": 0.75, "num_overloaded_max": 1.09, "num_moves_mean": 9.9662, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 40.951229999999995, "mean_accuracy_min": 40.70099999999999, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.9598999999999975, "num_model_switches_min": 5.44, "num_model_switches_max": 6.37, "num_slav_mean": 0.15317016666666666, "num_slav_min": 0.13705, "num_slav_max": 0.1743, "mean_cluster_cpu_util_mean": 0.5551235876785703, "mean_cluster_cpu_util_min": 0.5345873813649882, "mean_cluster_cpu_util_max": 0.5808434157136808, "mean_cluster_mem_util_mean": 0.3592582082543988, "mean_cluster_mem_util_min": 0.3490515263067252, "mean_cluster_mem_util_max": 0.37045405077642873, "reward_consolidation_mean_mean": -0.3985555555555556, "reward_consolidation_mean_min": -0.6666666666666665, "reward_consolidation_mean_max": -0.12777777777777785, "reward_illegal_mean_mean": -1.5258333333333332, "reward_illegal_mean_min": -1.8166666666666662, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 1.0718773333333333, "reward_accuracy_mean_min": 0.6209333333333334, "reward_accuracy_mean_max": 1.6086000000000005, "reward_sla_mean_mean": -0.8067833333333333, "reward_sla_mean_min": -1.2613333333333336, "reward_sla_mean_max": -0.5333333333333334, "reward_consolidation_sum_mean": -39.855555555555554, "reward_consolidation_sum_min": -66.66666666666666, "reward_consolidation_sum_max": -12.777777777777786, "reward_illegal_sum_mean": -152.5833333333333, "reward_illegal_sum_min": -181.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 107.18773333333333, "reward_accuracy_sum_min": 62.09333333333335, "reward_accuracy_sum_max": 160.86000000000004, "reward_sla_sum_mean": -80.67833333333334, "reward_sla_sum_min": -126.13333333333335, "reward_sla_sum_max": -53.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4869.0, "global_timestep_min": 3000, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.80333333333326, -159.45333333333338, -161.1599999999999, -166.55222222222218, -163.1888888888889, -167.39333333333323, -164.87111111111108, -199.6733333333331, -174.69333333333324, -172.13888888888874, -191.1688888888888, -159.66555555555553, -153.60666666666663, -187.33111111111094, -198.06999999999994, -186.67222222222216, -176.14777777777775, -174.7766666666665, -164.92000000000004, -140.22444444444454, -182.2966666666667, -167.03777777777768, -164.0266666666666, -172.38999999999984, -170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26182938430778374, "mean_inference_ms": 2.294859755832507, "mean_action_processing_ms": 0.09675219935011398, "mean_env_wait_ms": 1.6682595965642304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007000923156738281, "StateBufferConnector_ms": 0.0036606788635253906, "ViewRequirementAgentConnector_ms": 0.09507513046264648}, "num_episodes": 21, "episode_return_max": -130.308888888889, "episode_return_min": -199.6733333333331, "episode_return_mean": -165.92948888888884, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66450, "num_agent_steps_trained": 66300, "num_env_steps_sampled": 66450, "num_env_steps_trained": 66300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 223.62713342097203, "num_env_steps_trained_throughput_per_sec": 238.53560898237018, "timesteps_total": 66450, "num_env_steps_sampled_lifetime": 66450, "num_agent_steps_sampled_lifetime": 66450, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 66450, "timers": {"training_iteration_time_ms": 10398.355, "restore_workers_time_ms": 0.013, "training_step_time_ms": 653.809, "sample_time_ms": 637.716, "synch_weights_time_ms": 14.694}, "counters": {"num_env_steps_sampled": 66450, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 66450, "num_agent_steps_trained": 66300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 443, "num_samples_added_to_queue": 66300}, "done": false, "training_iteration": 29, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-06", "timestamp": 1728601446, "time_this_iter_s": 10.079296350479126, "time_total_s": 300.34258341789246, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875990>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.34258341789246, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.246666666666666, "ram_util_percent": 48.63999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -134002.546875, "policy_loss": -134409.96875, "entropy": 29.641828536987305, "entropy_coeff": 0.01, "var_gnorm": 16.096935272216797, "vf_loss": 49634.59375, "vf_explained_var": 0.10764986276626587}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 228.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 68700, "num_env_steps_trained": 68400, "num_agent_steps_sampled": 68700, "num_agent_steps_trained": 68400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 458, "num_samples_added_to_queue": 68700, "learner_queue": {"size_count": 228, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.298, "learner_load_time_ms": 0.327, "learner_load_wait_time_ms": 1347.64, "learner_dequeue_time_ms": 11284.099}}, "env_runners": {"episode_reward_max": -130.308888888889, "episode_reward_min": -195.8933333333332, "episode_reward_mean": -162.4908444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -195.8933333333332}, "policy_reward_max": {"default_policy": -130.308888888889}, "policy_reward_mean": {"default_policy": -162.4908444444444}, "custom_metrics": {"num_consolidated_mean": 0.6843000000000002, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.902, "num_overloaded_min": 0.76, "num_overloaded_max": 1.03, "num_moves_mean": 9.9598, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 40.938943333333334, "mean_accuracy_min": 40.675666666666665, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.956800000000002, "num_model_switches_min": 5.44, "num_model_switches_max": 6.4, "num_slav_mean": 0.152353, "num_slav_min": 0.1350333333333333, "num_slav_max": 0.17204999999999998, "mean_cluster_cpu_util_mean": 0.5523300795595842, "mean_cluster_cpu_util_min": 0.5343563957521812, "mean_cluster_cpu_util_max": 0.5773252059731958, "mean_cluster_mem_util_mean": 0.35803787623783684, "mean_cluster_mem_util_min": 0.34745897019145217, "mean_cluster_mem_util_max": 0.36918829759752003, "reward_consolidation_mean_mean": -0.40694444444444444, "reward_consolidation_mean_min": -0.6666666666666665, "reward_consolidation_mean_max": -0.1666666666666667, "reward_illegal_mean_mean": -1.503333333333333, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -1.2666666666666668, "reward_accuracy_mean_mean": 1.1106493333333334, "reward_accuracy_mean_min": 0.7271333333333332, "reward_accuracy_mean_max": 1.4713666666666663, "reward_sla_mean_mean": -0.82528, "reward_sla_mean_min": -1.15, "reward_sla_mean_max": -0.5333333333333334, "reward_consolidation_sum_mean": -40.69444444444445, "reward_consolidation_sum_min": -66.66666666666666, "reward_consolidation_sum_max": -16.66666666666667, "reward_illegal_sum_mean": -150.33333333333331, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -126.66666666666669, "reward_accuracy_sum_mean": 111.06493333333334, "reward_accuracy_sum_min": 72.71333333333332, "reward_accuracy_sum_max": 147.13666666666663, "reward_sla_sum_mean": -82.528, "reward_sla_sum_min": -115.0, "reward_sla_sum_max": -53.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5667.0, "global_timestep_min": 3700, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-170.26555555555555, -144.6844444444444, -176.331111111111, -173.7388888888889, -186.0044444444444, -165.5099999999999, -183.87222222222218, -175.15222222222218, -172.85555555555544, -177.18555555555554, -143.83000000000007, -184.15888888888884, -183.65666666666667, -168.16777777777781, -148.44333333333336, -185.9699999999999, -183.0222222222221, -151.48222222222225, -184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2625853930078766, "mean_inference_ms": 2.3013256123464148, "mean_action_processing_ms": 0.09697929304286611, "mean_env_wait_ms": 1.6724726136738282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071942806243896484, "StateBufferConnector_ms": 0.003807544708251953, "ViewRequirementAgentConnector_ms": 0.0986168384552002}, "num_episodes": 24, "episode_return_max": -130.308888888889, "episode_return_min": -195.8933333333332, "episode_return_mean": -162.4908444444444, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68700, "num_agent_steps_trained": 68400, "num_env_steps_sampled": 68700, "num_env_steps_trained": 68400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 208.6404789833913, "num_env_steps_trained_throughput_per_sec": 194.73111371783187, "timesteps_total": 68700, "num_env_steps_sampled_lifetime": 68700, "num_agent_steps_sampled_lifetime": 68700, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 68700, "timers": {"training_iteration_time_ms": 10423.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 741.024, "sample_time_ms": 722.876, "synch_weights_time_ms": 16.482}, "counters": {"num_env_steps_sampled": 68700, "num_env_steps_trained": 68400, "num_agent_steps_sampled": 68700, "num_agent_steps_trained": 68400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 458, "num_samples_added_to_queue": 68700}, "done": false, "training_iteration": 30, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-17", "timestamp": 1728601457, "time_this_iter_s": 10.795994758605957, "time_total_s": 311.1385781764984, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee16c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.1385781764984, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 21.673333333333332, "ram_util_percent": 48.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -114849.9765625, "policy_loss": -115119.140625, "entropy": 29.606761932373047, "entropy_coeff": 0.01, "var_gnorm": 16.1049747467041, "vf_loss": 35798.66796875, "vf_explained_var": 0.14286333322525024}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 234.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 70500, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 70500, "num_agent_steps_trained": 70200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 470, "num_samples_added_to_queue": 70500, "learner_queue": {"size_count": 234, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.953, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 1529.909, "learner_dequeue_time_ms": 11341.394}}, "env_runners": {"episode_reward_max": -118.86555555555564, "episode_reward_min": -195.8933333333332, "episode_reward_mean": -159.55056666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -195.8933333333332}, "policy_reward_max": {"default_policy": -118.86555555555564}, "policy_reward_mean": {"default_policy": -159.55056666666667}, "custom_metrics": {"num_consolidated_mean": 0.6918000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.8910000000000001, "num_overloaded_min": 0.66, "num_overloaded_max": 1.03, "num_moves_mean": 9.9537, "num_moves_min": 9.7, "num_moves_max": 10.26, "mean_accuracy_mean": 40.92792333333333, "mean_accuracy_min": 40.675666666666665, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.982400000000001, "num_model_switches_min": 5.44, "num_model_switches_max": 6.4, "num_slav_mean": 0.15172933333333335, "num_slav_min": 0.1350333333333333, "num_slav_max": 0.17151666666666665, "mean_cluster_cpu_util_mean": 0.5506309718797721, "mean_cluster_cpu_util_min": 0.5285775177468761, "mean_cluster_cpu_util_max": 0.5707518144003156, "mean_cluster_mem_util_mean": 0.35730268440899565, "mean_cluster_mem_util_min": 0.34745897019145217, "mean_cluster_mem_util_max": 0.3673536431872327, "reward_consolidation_mean_mean": -0.41, "reward_consolidation_mean_min": -0.6666666666666665, "reward_consolidation_mean_max": -0.1666666666666667, "reward_illegal_mean_mean": -1.4849999999999997, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -1.0999999999999999, "reward_accuracy_mean_mean": 1.134771, "reward_accuracy_mean_min": 0.7271333333333332, "reward_accuracy_mean_max": 1.7495666666666665, "reward_sla_mean_mean": -0.8352766666666667, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.5333333333333334, "reward_consolidation_sum_mean": -41.0, "reward_consolidation_sum_min": -66.66666666666666, "reward_consolidation_sum_max": -16.66666666666667, "reward_illegal_sum_mean": -148.49999999999997, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -109.99999999999999, "reward_accuracy_sum_mean": 113.4771, "reward_accuracy_sum_min": 72.71333333333332, "reward_accuracy_sum_max": 174.95666666666665, "reward_sla_sum_mean": -83.52766666666668, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -53.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6041.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-184.50888888888886, -131.51444444444448, -177.20555555555555, -167.2244444444444, -154.51777777777775, -181.67888888888885, -152.25777777777785, -173.56111111111107, -160.69333333333324, -179.13555555555547, -161.80111111111114, -165.8966666666667, -163.7677777777777, -168.44000000000005, -161.3111111111112, -147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26350165657071983, "mean_inference_ms": 2.31062986585033, "mean_action_processing_ms": 0.09727137364445536, "mean_env_wait_ms": 1.677716755202948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073604583740234375, "StateBufferConnector_ms": 0.003972291946411133, "ViewRequirementAgentConnector_ms": 0.10321927070617676}, "num_episodes": 18, "episode_return_max": -118.86555555555564, "episode_return_min": -195.8933333333332, "episode_return_mean": -159.55056666666667, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70500, "num_agent_steps_trained": 70200, "num_env_steps_sampled": 70500, "num_env_steps_trained": 70200, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 179.93504961368677, "num_env_steps_trained_throughput_per_sec": 179.93504961368677, "timesteps_total": 70500, "num_env_steps_sampled_lifetime": 70500, "num_agent_steps_sampled_lifetime": 70500, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 70500, "timers": {"training_iteration_time_ms": 10394.957, "restore_workers_time_ms": 0.013, "training_step_time_ms": 832.374, "sample_time_ms": 813.627, "synch_weights_time_ms": 16.804}, "counters": {"num_env_steps_sampled": 70500, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 70500, "num_agent_steps_trained": 70200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 470, "num_samples_added_to_queue": 70500}, "done": false, "training_iteration": 31, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-27", "timestamp": 1728601467, "time_this_iter_s": 10.015860080718994, "time_total_s": 321.1544382572174, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b07c9d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.1544382572174, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.433333333333334, "ram_util_percent": 48.186666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -128366.4921875, "policy_loss": -128728.015625, "entropy": 29.55516242980957, "entropy_coeff": 0.01, "var_gnorm": 16.112348556518555, "vf_loss": 45019.015625, "vf_explained_var": 0.14065217971801758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 71700, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 71700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 480, "num_samples_added_to_queue": 72000, "learner_queue": {"size_count": 239, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.415, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 1775.325, "learner_dequeue_time_ms": 11341.394}}, "env_runners": {"episode_reward_max": -118.86555555555564, "episode_reward_min": -195.8933333333332, "episode_reward_mean": -157.1712, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -195.8933333333332}, "policy_reward_max": {"default_policy": -118.86555555555564}, "policy_reward_mean": {"default_policy": -157.1712}, "custom_metrics": {"num_consolidated_mean": 0.6931999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.8782, "num_overloaded_min": 0.66, "num_overloaded_max": 1.03, "num_moves_mean": 9.954600000000001, "num_moves_min": 9.52, "num_moves_max": 10.26, "mean_accuracy_mean": 40.91962666666666, "mean_accuracy_min": 40.675666666666665, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.987300000000001, "num_model_switches_min": 5.44, "num_model_switches_max": 6.4, "num_slav_mean": 0.15150266666666667, "num_slav_min": 0.1350333333333333, "num_slav_max": 0.17151666666666665, "mean_cluster_cpu_util_mean": 0.5496538478651175, "mean_cluster_cpu_util_min": 0.5285775177468761, "mean_cluster_cpu_util_max": 0.5712988567176275, "mean_cluster_mem_util_mean": 0.35679939003343963, "mean_cluster_mem_util_min": 0.34745897019145217, "mean_cluster_mem_util_max": 0.3673536431872327, "reward_consolidation_mean_mean": -0.42266666666666675, "reward_consolidation_mean_min": -0.6666666666666665, "reward_consolidation_mean_max": -0.1666666666666667, "reward_illegal_mean_mean": -1.4636666666666662, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -1.0999999999999999, "reward_accuracy_mean_mean": 1.1665313333333334, "reward_accuracy_mean_min": 0.8080666666666666, "reward_accuracy_mean_max": 1.7495666666666665, "reward_sla_mean_mean": -0.8519100000000002, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.5393333333333333, "reward_consolidation_sum_mean": -42.26666666666667, "reward_consolidation_sum_min": -66.66666666666666, "reward_consolidation_sum_max": -16.66666666666667, "reward_illegal_sum_mean": -146.36666666666667, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -109.99999999999999, "reward_accuracy_sum_mean": 116.65313333333336, "reward_accuracy_sum_min": 80.80666666666666, "reward_accuracy_sum_max": 174.95666666666665, "reward_sla_sum_mean": -85.191, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -53.93333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5379.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-147.3022222222223, -157.34111111111113, -146.61333333333337, -167.20444444444442, -195.8933333333332, -157.6433333333334, -170.61666666666665, -184.54222222222216, -146.10444444444445, -171.54333333333335, -181.24666666666653, -172.05111111111097, -156.57222222222217, -147.02333333333328, -160.52444444444438, -164.01333333333324, -171.66777777777781, -148.23222222222222, -157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26479375269394806, "mean_inference_ms": 2.325303616477488, "mean_action_processing_ms": 0.09766787645272615, "mean_env_wait_ms": 1.6850144378107805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007310152053833008, "StateBufferConnector_ms": 0.004152536392211914, "ViewRequirementAgentConnector_ms": 0.10818243026733398}, "num_episodes": 15, "episode_return_max": -118.86555555555564, "episode_return_min": -195.8933333333332, "episode_return_mean": -157.1712, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 71700, "num_env_steps_sampled": 72000, "num_env_steps_trained": 71700, "num_env_steps_sampled_this_iter": 1500, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 146.24893441976647, "num_env_steps_trained_throughput_per_sec": 146.24893441976647, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10389.732, "restore_workers_time_ms": 0.016, "training_step_time_ms": 1025.61, "sample_time_ms": 1004.339, "synch_weights_time_ms": 18.977}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 71700, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 71700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 480, "num_samples_added_to_queue": 72000}, "done": false, "training_iteration": 32, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-37", "timestamp": 1728601477, "time_this_iter_s": 10.271571636199951, "time_total_s": 331.42600989341736, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876e90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 331.42600989341736, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 36.84285714285715, "ram_util_percent": 50.85714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -122848.9296875, "policy_loss": -123173.9140625, "entropy": 29.481454849243164, "entropy_coeff": 0.01, "var_gnorm": 16.124719619750977, "vf_loss": 41342.9765625, "vf_explained_var": 0.16538244485855103}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 246.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 73950, "num_env_steps_trained": 73800, "num_agent_steps_sampled": 73950, "num_agent_steps_trained": 73800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 493, "num_samples_added_to_queue": 73800, "learner_queue": {"size_count": 246, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.987, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1688.449, "learner_dequeue_time_ms": 11877.733}}, "env_runners": {"episode_reward_max": -118.86555555555564, "episode_reward_min": -181.2988888888889, "episode_reward_mean": -153.91933333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.2988888888889}, "policy_reward_max": {"default_policy": -118.86555555555564}, "policy_reward_mean": {"default_policy": -153.91933333333336}, "custom_metrics": {"num_consolidated_mean": 0.6966000000000001, "num_consolidated_min": 0.57, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.8671, "num_overloaded_min": 0.66, "num_overloaded_max": 1.03, "num_moves_mean": 9.9468, "num_moves_min": 9.52, "num_moves_max": 10.27, "mean_accuracy_mean": 40.90829, "mean_accuracy_min": 40.669333333333334, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.9868999999999994, "num_model_switches_min": 5.48, "num_model_switches_max": 6.4, "num_slav_mean": 0.15024916666666666, "num_slav_min": 0.1324, "num_slav_max": 0.1660833333333333, "mean_cluster_cpu_util_mean": 0.5479939090162848, "mean_cluster_cpu_util_min": 0.5269321414133151, "mean_cluster_cpu_util_max": 0.5712988567176275, "mean_cluster_mem_util_mean": 0.3559739970058699, "mean_cluster_mem_util_min": 0.34745897019145217, "mean_cluster_mem_util_max": 0.36641933573007274, "reward_consolidation_mean_mean": -0.42483333333333334, "reward_consolidation_mean_min": -0.6666666666666665, "reward_consolidation_mean_max": -0.1666666666666667, "reward_illegal_mean_mean": -1.4451666666666665, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -1.0999999999999999, "reward_accuracy_mean_mean": 1.1963499999999998, "reward_accuracy_mean_min": 0.8080666666666666, "reward_accuracy_mean_max": 1.7495666666666665, "reward_sla_mean_mean": -0.8655433333333333, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.5393333333333333, "reward_consolidation_sum_mean": -42.48333333333333, "reward_consolidation_sum_min": -66.66666666666666, "reward_consolidation_sum_max": -16.66666666666667, "reward_illegal_sum_mean": -144.51666666666662, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -109.99999999999999, "reward_accuracy_sum_mean": 119.635, "reward_accuracy_sum_min": 80.80666666666666, "reward_accuracy_sum_max": 174.95666666666665, "reward_sla_sum_mean": -86.55433333333332, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -53.93333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4570.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-157.56444444444446, -170.47111111111118, -165.45000000000005, -141.20111111111117, -145.86222222222221, -169.2377777777779, -130.308888888889, -175.601111111111, -180.59333333333333, -158.00999999999993, -160.4366666666667, -179.25000000000006, -140.09888888888892, -173.9633333333332, -158.26666666666668, -179.11555555555537, -130.51888888888897, -135.56444444444443, -167.68777777777785, -141.06111111111113, -171.33222222222216, -174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26579216332104205, "mean_inference_ms": 2.3341568983891485, "mean_action_processing_ms": 0.0980029820736886, "mean_env_wait_ms": 1.6910414204129973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007458686828613281, "StateBufferConnector_ms": 0.0042836666107177734, "ViewRequirementAgentConnector_ms": 0.11162257194519043}, "num_episodes": 18, "episode_return_max": -118.86555555555564, "episode_return_min": -181.2988888888889, "episode_return_mean": -153.91933333333336, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73950, "num_agent_steps_trained": 73800, "num_env_steps_sampled": 73950, "num_env_steps_trained": 73800, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 183.64292019646166, "num_env_steps_trained_throughput_per_sec": 197.76929867311256, "timesteps_total": 73950, "num_env_steps_sampled_lifetime": 73950, "num_agent_steps_sampled_lifetime": 73950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 73950, "timers": {"training_iteration_time_ms": 10411.363, "restore_workers_time_ms": 0.012, "training_step_time_ms": 799.664, "sample_time_ms": 781.845, "synch_weights_time_ms": 16.153}, "counters": {"num_env_steps_sampled": 73950, "num_env_steps_trained": 73800, "num_agent_steps_sampled": 73950, "num_agent_steps_trained": 73800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 493, "num_samples_added_to_queue": 73800}, "done": false, "training_iteration": 33, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-48", "timestamp": 1728601488, "time_this_iter_s": 10.629142761230469, "time_total_s": 342.0551526546478, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef89a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.0551526546478, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 50.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -76054.8046875, "policy_loss": -76169.4609375, "entropy": 29.399662017822266, "entropy_coeff": 0.01, "var_gnorm": 16.13646125793457, "vf_loss": 20285.203125, "vf_explained_var": 0.16723030805587769}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 252.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 75900, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75900, "num_agent_steps_trained": 75600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 506, "num_samples_added_to_queue": 75900, "learner_queue": {"size_count": 252, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.239, "learner_load_time_ms": 0.418, "learner_load_wait_time_ms": 1558.117, "learner_dequeue_time_ms": 11967.363}}, "env_runners": {"episode_reward_max": -73.8488888888889, "episode_reward_min": -181.2988888888889, "episode_reward_mean": -148.4536888888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.2988888888889}, "policy_reward_max": {"default_policy": -73.8488888888889}, "policy_reward_mean": {"default_policy": -148.4536888888889}, "custom_metrics": {"num_consolidated_mean": 0.6977999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.8478999999999999, "num_overloaded_min": 0.58, "num_overloaded_max": 1.03, "num_moves_mean": 9.9368, "num_moves_min": 9.51, "num_moves_max": 10.27, "mean_accuracy_mean": 40.883399999999995, "mean_accuracy_min": 40.586999999999996, "mean_accuracy_max": 41.18233333333333, "num_model_switches_mean": 5.993500000000001, "num_model_switches_min": 5.48, "num_model_switches_max": 6.4, "num_slav_mean": 0.14815883333333335, "num_slav_min": 0.1284, "num_slav_max": 0.1660833333333333, "mean_cluster_cpu_util_mean": 0.544698860355895, "mean_cluster_cpu_util_min": 0.5167149329956742, "mean_cluster_cpu_util_max": 0.5712988567176275, "mean_cluster_mem_util_mean": 0.35449828279909007, "mean_cluster_mem_util_min": 0.34096259759177927, "mean_cluster_mem_util_max": 0.36641933573007274, "reward_consolidation_mean_mean": -0.4337222222222223, "reward_consolidation_mean_min": -0.7, "reward_consolidation_mean_max": -0.1666666666666667, "reward_illegal_mean_mean": -1.4131666666666667, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.239622, "reward_accuracy_mean_min": 0.8573999999999998, "reward_accuracy_mean_max": 1.9423999999999992, "reward_sla_mean_mean": -0.87727, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.55, "reward_consolidation_sum_mean": -43.37222222222223, "reward_consolidation_sum_min": -70.0, "reward_consolidation_sum_max": -16.66666666666667, "reward_illegal_sum_mean": -141.31666666666663, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 123.9622, "reward_accuracy_sum_min": 85.73999999999998, "reward_accuracy_sum_max": 194.23999999999992, "reward_sla_sum_mean": -87.727, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -55.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3632.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-174.12000000000003, -137.48222222222228, -138.8544444444445, -176.65333333333328, -181.2988888888889, -157.36111111111103, -169.54888888888883, -152.01666666666668, -134.21555555555557, -161.65555555555548, -140.56777777777774, -145.35666666666668, -161.2233333333333, -166.6622222222222, -156.01777777777778, -158.41333333333336, -137.91666666666666, -163.6955555555555, -156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.267336293511745, "mean_inference_ms": 2.3483399043277045, "mean_action_processing_ms": 0.09851724020046701, "mean_env_wait_ms": 1.7000359647213223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007772207260131836, "StateBufferConnector_ms": 0.004469871520996094, "ViewRequirementAgentConnector_ms": 0.11548590660095215}, "num_episodes": 21, "episode_return_max": -73.8488888888889, "episode_return_min": -181.2988888888889, "episode_return_mean": -148.4536888888889, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75900, "num_agent_steps_trained": 75600, "num_env_steps_sampled": 75900, "num_env_steps_trained": 75600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 184.22344598988346, "num_env_steps_trained_throughput_per_sec": 170.05241168296934, "timesteps_total": 75900, "num_env_steps_sampled_lifetime": 75900, "num_agent_steps_sampled_lifetime": 75900, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 75900, "timers": {"training_iteration_time_ms": 10425.036, "restore_workers_time_ms": 0.015, "training_step_time_ms": 820.273, "sample_time_ms": 802.449, "synch_weights_time_ms": 15.89}, "counters": {"num_env_steps_sampled": 75900, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75900, "num_agent_steps_trained": 75600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 506, "num_samples_added_to_queue": 75900}, "done": false, "training_iteration": 34, "trial_id": "3f041_00000", "date": "2024-10-11_00-04-59", "timestamp": 1728601499, "time_this_iter_s": 10.597781419754028, "time_total_s": 352.65293407440186, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee28f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 352.65293407440186, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 26.293333333333333, "ram_util_percent": 49.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -75055.0390625, "policy_loss": -75178.375, "entropy": 29.302650451660156, "entropy_coeff": 0.01, "var_gnorm": 16.15105628967285, "vf_loss": 21124.455078125, "vf_explained_var": 0.16684532165527344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 259.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 77850, "num_env_steps_trained": 77700, "num_agent_steps_sampled": 77850, "num_agent_steps_trained": 77700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 519, "num_samples_added_to_queue": 77700, "learner_queue": {"size_count": 259, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.371, "learner_load_time_ms": 0.416, "learner_load_wait_time_ms": 1568.544, "learner_dequeue_time_ms": 12249.03}}, "env_runners": {"episode_reward_max": -73.8488888888889, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -143.9379777777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": -73.8488888888889}, "policy_reward_mean": {"default_policy": -143.9379777777778}, "custom_metrics": {"num_consolidated_mean": 0.7091000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8251, "num_overloaded_min": 0.58, "num_overloaded_max": 1.03, "num_moves_mean": 9.928, "num_moves_min": 9.51, "num_moves_max": 10.27, "mean_accuracy_mean": 40.86414666666666, "mean_accuracy_min": 40.586999999999996, "mean_accuracy_max": 41.10633333333333, "num_model_switches_mean": 5.9753, "num_model_switches_min": 5.55, "num_model_switches_max": 6.26, "num_slav_mean": 0.14574716666666668, "num_slav_min": 0.12336666666666668, "num_slav_max": 0.1656666666666667, "mean_cluster_cpu_util_mean": 0.5426665151310471, "mean_cluster_cpu_util_min": 0.5167149329956742, "mean_cluster_cpu_util_max": 0.5712988567176275, "mean_cluster_mem_util_mean": 0.35348407637991913, "mean_cluster_mem_util_min": 0.34096259759177927, "mean_cluster_mem_util_max": 0.36641933573007274, "reward_consolidation_mean_mean": -0.4456111111111112, "reward_consolidation_mean_min": -0.7, "reward_consolidation_mean_max": -0.21111111111111117, "reward_illegal_mean_mean": -1.3751666666666664, "reward_illegal_mean_min": -1.7166666666666666, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.2920013333333333, "reward_accuracy_mean_min": 0.8573999999999998, "reward_accuracy_mean_max": 1.9423999999999992, "reward_sla_mean_mean": -0.9106033333333334, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.5703333333333332, "reward_consolidation_sum_mean": -44.561111111111124, "reward_consolidation_sum_min": -70.0, "reward_consolidation_sum_max": -21.111111111111118, "reward_illegal_sum_mean": -137.51666666666665, "reward_illegal_sum_min": -171.66666666666666, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 129.20013333333335, "reward_accuracy_sum_min": 85.73999999999998, "reward_accuracy_sum_max": 194.23999999999992, "reward_sla_sum_mean": -91.06033333333335, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -57.033333333333324, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2816.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-156.34222222222223, -151.70666666666668, -152.27777777777786, -159.69444444444434, -178.56444444444438, -137.24444444444447, -173.1577777777778, -152.20999999999995, -180.21555555555543, -159.0344444444445, -169.85777777777778, -127.09222222222236, -138.03555555555565, -176.11888888888888, -153.61888888888888, -165.3422222222223, -161.04333333333327, -138.10222222222228, -160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2685796402924441, "mean_inference_ms": 2.35862003316795, "mean_action_processing_ms": 0.09894218940257965, "mean_env_wait_ms": 1.7073976759190401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007847309112548828, "StateBufferConnector_ms": 0.0045278072357177734, "ViewRequirementAgentConnector_ms": 0.11787128448486328}, "num_episodes": 18, "episode_return_max": -73.8488888888889, "episode_return_min": -181.69555555555553, "episode_return_mean": -143.9379777777778, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77850, "num_agent_steps_trained": 77700, "num_env_steps_sampled": 77850, "num_env_steps_trained": 77700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 186.1635449171929, "num_env_steps_trained_throughput_per_sec": 200.4838176031308, "timesteps_total": 77850, "num_env_steps_sampled_lifetime": 77850, "num_agent_steps_sampled_lifetime": 77850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 77850, "timers": {"training_iteration_time_ms": 10453.16, "restore_workers_time_ms": 0.014, "training_step_time_ms": 816.246, "sample_time_ms": 798.05, "synch_weights_time_ms": 16.542}, "counters": {"num_env_steps_sampled": 77850, "num_env_steps_trained": 77700, "num_agent_steps_sampled": 77850, "num_agent_steps_trained": 77700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 519, "num_samples_added_to_queue": 77700}, "done": false, "training_iteration": 35, "trial_id": "3f041_00000", "date": "2024-10-11_00-05-09", "timestamp": 1728601509, "time_this_iter_s": 10.486180543899536, "time_total_s": 363.1391146183014, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee2c80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.1391146183014, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.486666666666665, "ram_util_percent": 48.81333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -85836.1015625, "policy_loss": -86000.90625, "entropy": 29.205810546875, "entropy_coeff": 0.01, "var_gnorm": 16.1621150970459, "vf_loss": 25241.837890625, "vf_explained_var": 0.18876785039901733}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 264.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 530, "num_samples_added_to_queue": 79500, "learner_queue": {"size_count": 264, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.646, "learner_load_time_ms": 0.51, "learner_load_wait_time_ms": 1729.999, "learner_dequeue_time_ms": 12616.677}}, "env_runners": {"episode_reward_max": -73.8488888888889, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -135.84880000000007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": -73.8488888888889}, "policy_reward_mean": {"default_policy": -135.84880000000007}, "custom_metrics": {"num_consolidated_mean": 0.7089000000000002, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 0.7979, "num_overloaded_min": 0.58, "num_overloaded_max": 0.96, "num_moves_mean": 9.9069, "num_moves_min": 9.51, "num_moves_max": 10.27, "mean_accuracy_mean": 40.82545, "mean_accuracy_min": 40.42866666666666, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.939499999999999, "num_model_switches_min": 5.55, "num_model_switches_max": 6.26, "num_slav_mean": 0.141427, "num_slav_min": 0.11721666666666668, "num_slav_max": 0.1656666666666667, "mean_cluster_cpu_util_mean": 0.5391064115735568, "mean_cluster_cpu_util_min": 0.5167149329956742, "mean_cluster_cpu_util_max": 0.5712988567176275, "mean_cluster_mem_util_mean": 0.35178839354243807, "mean_cluster_mem_util_min": 0.34096259759177927, "mean_cluster_mem_util_max": 0.36641933573007274, "reward_consolidation_mean_mean": -0.45650000000000013, "reward_consolidation_mean_min": -0.8111111111111111, "reward_consolidation_mean_max": -0.14444444444444457, "reward_illegal_mean_mean": -1.3298333333333332, "reward_illegal_mean_min": -1.6, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.3588086666666666, "reward_accuracy_mean_min": 0.9370666666666668, "reward_accuracy_mean_max": 1.9423999999999992, "reward_sla_mean_mean": -0.9309633333333336, "reward_sla_mean_min": -1.3493333333333333, "reward_sla_mean_max": -0.5873333333333334, "reward_consolidation_sum_mean": -45.650000000000006, "reward_consolidation_sum_min": -81.11111111111111, "reward_consolidation_sum_max": -14.444444444444457, "reward_illegal_sum_mean": -132.9833333333333, "reward_illegal_sum_min": -160.0, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 135.88086666666666, "reward_accuracy_sum_min": 93.70666666666668, "reward_accuracy_sum_max": 194.23999999999992, "reward_sla_sum_mean": -93.09633333333335, "reward_sla_sum_min": -134.93333333333334, "reward_sla_sum_max": -58.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2098.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.3099999999999, -169.4455555555555, -118.86555555555564, -177.15333333333325, -146.39444444444442, -157.16222222222225, -144.17444444444453, -174.70666666666668, -136.5655555555556, -166.31444444444443, -156.96111111111102, -153.8033333333333, -162.68555555555545, -149.96333333333334, -141.16555555555564, -149.52333333333343, -139.32888888888886, -151.63888888888889, -160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27028420257582014, "mean_inference_ms": 2.375277983779268, "mean_action_processing_ms": 0.09952745708857917, "mean_env_wait_ms": 1.7177040245965502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008113384246826172, "StateBufferConnector_ms": 0.004714012145996094, "ViewRequirementAgentConnector_ms": 0.12178230285644531}, "num_episodes": 18, "episode_return_max": -73.8488888888889, "episode_return_min": -181.69555555555553, "episode_return_mean": -135.84880000000007, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 153.75731664017658, "num_env_steps_trained_throughput_per_sec": 139.77937876379687, "timesteps_total": 79500, "num_env_steps_sampled_lifetime": 79500, "num_agent_steps_sampled_lifetime": 79500, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 79500, "timers": {"training_iteration_time_ms": 10481.283, "restore_workers_time_ms": 0.021, "training_step_time_ms": 964.323, "sample_time_ms": 941.165, "synch_weights_time_ms": 21.001}, "counters": {"num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 530, "num_samples_added_to_queue": 79500}, "done": false, "training_iteration": 36, "trial_id": "3f041_00000", "date": "2024-10-11_00-05-20", "timestamp": 1728601520, "time_this_iter_s": 10.741603374481201, "time_total_s": 373.8807179927826, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.8807179927826, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.32666666666667, "ram_util_percent": 49.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -26340.49609375, "policy_loss": -26322.7890625, "entropy": 29.065534591674805, "entropy_coeff": 0.01, "var_gnorm": 16.175947189331055, "vf_loss": 6949.0, "vf_explained_var": 0.18100512027740479}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 270.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 81300, "num_env_steps_trained": 81000, "num_agent_steps_sampled": 81300, "num_agent_steps_trained": 81000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 542, "num_samples_added_to_queue": 81300, "learner_queue": {"size_count": 270, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.323, "learner_load_time_ms": 0.51, "learner_load_wait_time_ms": 1744.577, "learner_dequeue_time_ms": 12616.677}}, "env_runners": {"episode_reward_max": -30.91555555555558, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -125.4103666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": -30.91555555555558}, "policy_reward_mean": {"default_policy": -125.4103666666667}, "custom_metrics": {"num_consolidated_mean": 0.7197, "num_consolidated_min": 0.53, "num_consolidated_max": 0.89, "num_overloaded_mean": 0.7626999999999999, "num_overloaded_min": 0.47, "num_overloaded_max": 0.96, "num_moves_mean": 9.8959, "num_moves_min": 9.51, "num_moves_max": 10.27, "mean_accuracy_mean": 40.791059999999995, "mean_accuracy_min": 40.42866666666666, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.925699999999999, "num_model_switches_min": 5.52, "num_model_switches_max": 6.26, "num_slav_mean": 0.13719316666666664, "num_slav_min": 0.11056666666666666, "num_slav_max": 0.1621833333333333, "mean_cluster_cpu_util_mean": 0.5350955593183098, "mean_cluster_cpu_util_min": 0.5121050677402315, "mean_cluster_cpu_util_max": 0.5543908320121566, "mean_cluster_mem_util_mean": 0.3499599887015987, "mean_cluster_mem_util_min": 0.3393775772123196, "mean_cluster_mem_util_max": 0.35934473704038583, "reward_consolidation_mean_mean": -0.4728333333333333, "reward_consolidation_mean_min": -0.8111111111111111, "reward_consolidation_mean_max": -0.14444444444444457, "reward_illegal_mean_mean": -1.2711666666666668, "reward_illegal_mean_min": -1.6, "reward_illegal_mean_max": -0.7833333333333334, "reward_accuracy_mean_mean": 1.454593, "reward_accuracy_mean_min": 0.9370666666666668, "reward_accuracy_mean_max": 2.4248333333333325, "reward_sla_mean_mean": -0.9646966666666669, "reward_sla_mean_min": -1.3946666666666667, "reward_sla_mean_max": -0.6786666666666668, "reward_consolidation_sum_mean": -47.28333333333333, "reward_consolidation_sum_min": -81.11111111111111, "reward_consolidation_sum_max": -14.444444444444457, "reward_illegal_sum_mean": -127.11666666666665, "reward_illegal_sum_min": -160.0, "reward_illegal_sum_max": -78.33333333333334, "reward_accuracy_sum_mean": 145.4593, "reward_accuracy_sum_min": 93.70666666666668, "reward_accuracy_sum_max": 242.48333333333326, "reward_sla_sum_mean": -96.46966666666667, "reward_sla_sum_min": -139.46666666666667, "reward_sla_sum_max": -67.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2077.0, "global_timestep_min": 200, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.75444444444446, -165.671111111111, -148.50000000000003, -173.14222222222222, -129.57111111111118, -132.25555555555565, -130.6133333333334, -135.70777777777784, -130.80555555555563, -144.10666666666668, -131.6855555555556, -139.428888888889, -154.70555555555558, -134.38222222222225, -140.4277777777779, -142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27187763420803757, "mean_inference_ms": 2.3916165346138767, "mean_action_processing_ms": 0.10008493605334337, "mean_env_wait_ms": 1.727464438329206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007982015609741211, "StateBufferConnector_ms": 0.004559040069580078, "ViewRequirementAgentConnector_ms": 0.11828923225402832}, "num_episodes": 18, "episode_return_max": -30.91555555555558, "episode_return_min": -181.69555555555553, "episode_return_mean": -125.4103666666667, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81300, "num_agent_steps_trained": 81000, "num_env_steps_sampled": 81300, "num_env_steps_trained": 81000, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.17754322116951, "num_env_steps_trained_throughput_per_sec": 171.17754322116951, "timesteps_total": 81300, "num_env_steps_sampled_lifetime": 81300, "num_agent_steps_sampled_lifetime": 81300, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 81300, "timers": {"training_iteration_time_ms": 10500.428, "restore_workers_time_ms": 0.022, "training_step_time_ms": 856.907, "sample_time_ms": 837.528, "synch_weights_time_ms": 17.345}, "counters": {"num_env_steps_sampled": 81300, "num_env_steps_trained": 81000, "num_agent_steps_sampled": 81300, "num_agent_steps_trained": 81000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 542, "num_samples_added_to_queue": 81300}, "done": false, "training_iteration": 37, "trial_id": "3f041_00000", "date": "2024-10-11_00-05-30", "timestamp": 1728601530, "time_this_iter_s": 10.525607824325562, "time_total_s": 384.40632581710815, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee3100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.40632581710815, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 27.01333333333333, "ram_util_percent": 49.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -47875.125, "policy_loss": -47891.45703125, "entropy": 28.870010375976562, "entropy_coeff": 0.01, "var_gnorm": 16.19085121154785, "vf_loss": 10294.18359375, "vf_explained_var": 0.26505064964294434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 276.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 82950, "num_env_steps_trained": 82800, "num_agent_steps_sampled": 82950, "num_agent_steps_trained": 82800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 553, "num_samples_added_to_queue": 82800, "learner_queue": {"size_count": 276, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.219, "learner_load_time_ms": 0.496, "learner_load_wait_time_ms": 1714.356, "learner_dequeue_time_ms": 12933.989}}, "env_runners": {"episode_reward_max": -30.91555555555558, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -117.14672222222227, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": -30.91555555555558}, "policy_reward_mean": {"default_policy": -117.14672222222227}, "custom_metrics": {"num_consolidated_mean": 0.7297, "num_consolidated_min": 0.53, "num_consolidated_max": 0.96, "num_overloaded_mean": 0.7365999999999999, "num_overloaded_min": 0.47, "num_overloaded_max": 0.96, "num_moves_mean": 9.8654, "num_moves_min": 9.51, "num_moves_max": 10.27, "mean_accuracy_mean": 40.76927333333333, "mean_accuracy_min": 40.42866666666666, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.917099999999998, "num_model_switches_min": 5.52, "num_model_switches_max": 6.26, "num_slav_mean": 0.1334528333333333, "num_slav_min": 0.10836666666666667, "num_slav_max": 0.1621833333333333, "mean_cluster_cpu_util_mean": 0.5321440743651683, "mean_cluster_cpu_util_min": 0.5121050677402315, "mean_cluster_cpu_util_max": 0.552742114696845, "mean_cluster_mem_util_mean": 0.34851189587638864, "mean_cluster_mem_util_min": 0.3393775772123196, "mean_cluster_mem_util_max": 0.35934473704038583, "reward_consolidation_mean_mean": -0.4875555555555556, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.08888888888888903, "reward_illegal_mean_mean": -1.2276666666666667, "reward_illegal_mean_min": -1.6, "reward_illegal_mean_max": -0.7833333333333334, "reward_accuracy_mean_mean": 1.5268250000000003, "reward_accuracy_mean_min": 0.9370666666666668, "reward_accuracy_mean_max": 2.4248333333333325, "reward_sla_mean_mean": -0.98307, "reward_sla_mean_min": -1.3946666666666667, "reward_sla_mean_max": -0.6050000000000001, "reward_consolidation_sum_mean": -48.75555555555557, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -8.888888888888903, "reward_illegal_sum_mean": -122.76666666666667, "reward_illegal_sum_min": -160.0, "reward_illegal_sum_max": -78.33333333333334, "reward_accuracy_sum_mean": 152.6825, "reward_accuracy_sum_min": 93.70666666666668, "reward_accuracy_sum_max": 242.48333333333326, "reward_sla_sum_mean": -98.307, "reward_sla_sum_min": -139.46666666666667, "reward_sla_sum_max": -60.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2574.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-142.53222222222226, -155.19222222222226, -146.04555555555552, -161.14888888888896, -150.21555555555562, -174.84888888888884, -160.63888888888886, -121.88888888888894, -165.02777777777786, -132.16000000000005, -142.18111111111114, -127.43333333333344, -128.24222222222232, -134.85777777777787, -130.808888888889, -103.2000000000001, -140.88666666666654, -161.25111111111102, -137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27298019527618095, "mean_inference_ms": 2.4019834557491255, "mean_action_processing_ms": 0.10049766425124176, "mean_env_wait_ms": 1.734603857852999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008075237274169922, "StateBufferConnector_ms": 0.004609107971191406, "ViewRequirementAgentConnector_ms": 0.12011289596557617}, "num_episodes": 15, "episode_return_max": -30.91555555555558, "episode_return_min": -181.69555555555553, "episode_return_mean": -117.14672222222227, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82950, "num_agent_steps_trained": 82800, "num_env_steps_sampled": 82950, "num_env_steps_trained": 82800, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.4630929064141, "num_env_steps_trained_throughput_per_sec": 172.868828625179, "timesteps_total": 82950, "num_env_steps_sampled_lifetime": 82950, "num_agent_steps_sampled_lifetime": 82950, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 82950, "timers": {"training_iteration_time_ms": 10444.286, "restore_workers_time_ms": 0.014, "training_step_time_ms": 952.54, "sample_time_ms": 931.952, "synch_weights_time_ms": 18.549}, "counters": {"num_env_steps_sampled": 82950, "num_env_steps_trained": 82800, "num_agent_steps_sampled": 82950, "num_agent_steps_trained": 82800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 553, "num_samples_added_to_queue": 82800}, "done": false, "training_iteration": 38, "trial_id": "3f041_00000", "date": "2024-10-11_00-05-41", "timestamp": 1728601541, "time_this_iter_s": 10.430997133255005, "time_total_s": 394.83732295036316, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877130>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 394.83732295036316, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.206666666666667, "ram_util_percent": 49.57333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -26988.8359375, "policy_loss": -26973.248046875, "entropy": 28.627735137939453, "entropy_coeff": 0.01, "var_gnorm": 16.206722259521484, "vf_loss": 7029.4697265625, "vf_explained_var": 0.23467957973480225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 84600, "num_env_steps_trained": 84300, "num_agent_steps_sampled": 84600, "num_agent_steps_trained": 84300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 564, "num_samples_added_to_queue": 84600, "learner_queue": {"size_count": 281, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.409, "learner_load_time_ms": 0.48, "learner_load_wait_time_ms": 1847.052, "learner_dequeue_time_ms": 13386.582}}, "env_runners": {"episode_reward_max": 8.213333333333281, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -100.99198888888894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": 8.213333333333281}, "policy_reward_mean": {"default_policy": -100.99198888888894}, "custom_metrics": {"num_consolidated_mean": 0.7463, "num_consolidated_min": 0.53, "num_consolidated_max": 0.96, "num_overloaded_mean": 0.6909000000000001, "num_overloaded_min": 0.41, "num_overloaded_max": 0.91, "num_moves_mean": 9.833099999999998, "num_moves_min": 9.49, "num_moves_max": 10.2, "mean_accuracy_mean": 40.71461666666667, "mean_accuracy_min": 40.42233333333332, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.884400000000002, "num_model_switches_min": 5.52, "num_model_switches_max": 6.26, "num_slav_mean": 0.1281945, "num_slav_min": 0.10465000000000002, "num_slav_max": 0.15401666666666666, "mean_cluster_cpu_util_mean": 0.5268552609686257, "mean_cluster_cpu_util_min": 0.5025823769179987, "mean_cluster_cpu_util_max": 0.552742114696845, "mean_cluster_mem_util_mean": 0.3460258809380292, "mean_cluster_mem_util_min": 0.33397855079795635, "mean_cluster_mem_util_max": 0.35934473704038583, "reward_consolidation_mean_mean": -0.4892222222222222, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.08888888888888903, "reward_illegal_mean_mean": -1.1515, "reward_illegal_mean_min": -1.5166666666666666, "reward_illegal_mean_max": -0.6833333333333332, "reward_accuracy_mean_mean": 1.659529, "reward_accuracy_mean_min": 1.0489666666666664, "reward_accuracy_mean_max": 2.5152666666666663, "reward_sla_mean_mean": -1.0287266666666666, "reward_sla_mean_min": -1.3956666666666666, "reward_sla_mean_max": -0.6050000000000001, "reward_consolidation_sum_mean": -48.92222222222222, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -8.888888888888903, "reward_illegal_sum_mean": -115.15, "reward_illegal_sum_min": -151.66666666666666, "reward_illegal_sum_max": -68.33333333333333, "reward_accuracy_sum_mean": 165.9529, "reward_accuracy_sum_min": 104.89666666666665, "reward_accuracy_sum_max": 251.52666666666664, "reward_sla_sum_mean": -102.87266666666669, "reward_sla_sum_min": -139.56666666666666, "reward_sla_sum_max": -60.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3169.0, "global_timestep_min": 1300, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-137.0900000000001, -151.0244444444443, -156.02333333333334, -159.9633333333334, -125.09888888888902, -89.51444444444452, -153.6444444444445, -96.44444444444458, -140.0066666666667, -167.45111111111115, -73.8488888888889, -127.57666666666677, -138.48333333333335, -108.70666666666672, -128.06555555555562, -121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744943215563476, "mean_inference_ms": 2.415917023779398, "mean_action_processing_ms": 0.10102864719203647, "mean_env_wait_ms": 1.7438739877462845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008350372314453125, "StateBufferConnector_ms": 0.004823923110961914, "ViewRequirementAgentConnector_ms": 0.12565350532531738}, "num_episodes": 18, "episode_return_max": 8.213333333333281, "episode_return_min": -181.69555555555553, "episode_return_mean": -100.99198888888894, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84600, "num_agent_steps_trained": 84300, "num_env_steps_sampled": 84600, "num_env_steps_trained": 84300, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 157.11743448261709, "num_env_steps_trained_throughput_per_sec": 142.8340313478337, "timesteps_total": 84600, "num_env_steps_sampled_lifetime": 84600, "num_agent_steps_sampled_lifetime": 84600, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 84600, "timers": {"training_iteration_time_ms": 10488.316, "restore_workers_time_ms": 0.014, "training_step_time_ms": 958.731, "sample_time_ms": 938.296, "synch_weights_time_ms": 18.298}, "counters": {"num_env_steps_sampled": 84600, "num_env_steps_trained": 84300, "num_agent_steps_sampled": 84600, "num_agent_steps_trained": 84300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 564, "num_samples_added_to_queue": 84600}, "done": false, "training_iteration": 39, "trial_id": "3f041_00000", "date": "2024-10-11_00-05-51", "timestamp": 1728601551, "time_this_iter_s": 10.515744924545288, "time_total_s": 405.35306787490845, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee3670>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 405.35306787490845, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.95333333333333, "ram_util_percent": 49.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 31840.787109375, "policy_loss": 31851.07421875, "entropy": 28.25775718688965, "entropy_coeff": 0.01, "var_gnorm": 16.227554321289062, "vf_loss": 7448.66552734375, "vf_explained_var": -0.03832864761352539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 86250, "num_env_steps_trained": 86100, "num_agent_steps_sampled": 86250, "num_agent_steps_trained": 86100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 575, "num_samples_added_to_queue": 86100, "learner_queue": {"size_count": 287, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 99.549, "learner_load_time_ms": 0.48, "learner_load_wait_time_ms": 1839.779, "learner_dequeue_time_ms": 13386.582}}, "env_runners": {"episode_reward_max": 8.549999999999953, "episode_reward_min": -181.69555555555553, "episode_reward_mean": -84.45663333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.69555555555553}, "policy_reward_max": {"default_policy": 8.549999999999953}, "policy_reward_mean": {"default_policy": -84.45663333333337}, "custom_metrics": {"num_consolidated_mean": 0.765, "num_consolidated_min": 0.62, "num_consolidated_max": 0.98, "num_overloaded_mean": 0.6435, "num_overloaded_min": 0.39, "num_overloaded_max": 0.91, "num_moves_mean": 9.8075, "num_moves_min": 9.41, "num_moves_max": 10.2, "mean_accuracy_mean": 40.68326666666667, "mean_accuracy_min": 40.42233333333332, "mean_accuracy_max": 40.992333333333335, "num_model_switches_mean": 5.843900000000001, "num_model_switches_min": 5.5, "num_model_switches_max": 6.22, "num_slav_mean": 0.12376650000000002, "num_slav_min": 0.10038333333333334, "num_slav_max": 0.15103333333333332, "mean_cluster_cpu_util_mean": 0.5219321345272985, "mean_cluster_cpu_util_min": 0.49560975813830643, "mean_cluster_cpu_util_max": 0.5499462999189312, "mean_cluster_mem_util_mean": 0.3436110950012917, "mean_cluster_mem_util_min": 0.3298074141048824, "mean_cluster_mem_util_max": 0.35785015069318865, "reward_consolidation_mean_mean": -0.4923333333333334, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.08888888888888903, "reward_illegal_mean_mean": -1.0725, "reward_illegal_mean_min": -1.5166666666666666, "reward_illegal_mean_max": -0.6499999999999999, "reward_accuracy_mean_mean": 1.8009336666666664, "reward_accuracy_mean_min": 1.0489666666666664, "reward_accuracy_mean_max": 2.5904999999999996, "reward_sla_mean_mean": -1.0806666666666667, "reward_sla_mean_min": -1.501333333333333, "reward_sla_mean_max": -0.6050000000000001, "reward_consolidation_sum_mean": -49.23333333333333, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -8.888888888888903, "reward_illegal_sum_mean": -107.25, "reward_illegal_sum_min": -151.66666666666666, "reward_illegal_sum_max": -64.99999999999999, "reward_accuracy_sum_mean": 180.09336666666667, "reward_accuracy_sum_min": 104.89666666666665, "reward_accuracy_sum_max": 259.04999999999995, "reward_sla_sum_mean": -108.06666666666669, "reward_sla_sum_min": -150.1333333333333, "reward_sla_sum_max": -60.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3682.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-121.67222222222232, -125.50111111111121, -132.42999999999998, -94.27222222222235, -119.26888888888895, -156.6333333333333, -149.04222222222228, -139.15555555555562, -114.25888888888903, -111.28888888888893, -153.1244444444445, -181.69555555555553, -128.08333333333348, -125.13000000000012, -121.85666666666677, -151.30333333333337, -125.31888888888895, -120.87777777777791, -124.01666666666678, -86.52888888888893, -139.3811111111111, -101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27620383157663403, "mean_inference_ms": 2.4353669420960586, "mean_action_processing_ms": 0.10161676599777644, "mean_env_wait_ms": 1.7542367205620042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008510112762451172, "StateBufferConnector_ms": 0.004896402359008789, "ViewRequirementAgentConnector_ms": 0.12978219985961914}, "num_episodes": 15, "episode_return_max": 8.549999999999953, "episode_return_min": -181.69555555555553, "episode_return_mean": -84.45663333333337, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86250, "num_agent_steps_trained": 86100, "num_env_steps_sampled": 86250, "num_env_steps_trained": 86100, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.83358473950784, "num_env_steps_trained_throughput_per_sec": 170.0002742612813, "timesteps_total": 86250, "num_env_steps_sampled_lifetime": 86250, "num_agent_steps_sampled_lifetime": 86250, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 86250, "timers": {"training_iteration_time_ms": 10468.728, "restore_workers_time_ms": 0.018, "training_step_time_ms": 961.387, "sample_time_ms": 938.78, "synch_weights_time_ms": 20.164}, "counters": {"num_env_steps_sampled": 86250, "num_env_steps_trained": 86100, "num_agent_steps_sampled": 86250, "num_agent_steps_trained": 86100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 575, "num_samples_added_to_queue": 86100}, "done": false, "training_iteration": 40, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-02", "timestamp": 1728601562, "time_this_iter_s": 10.601527452468872, "time_total_s": 415.9545953273773, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877d00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.9545953273773, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.013333333333332, "ram_util_percent": 49.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 79534.3125, "policy_loss": 79401.2109375, "entropy": 27.720901489257812, "entropy_coeff": 0.01, "var_gnorm": 16.25128936767578, "vf_loss": 21626.623046875, "vf_explained_var": -0.3949474096298218}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 294.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 88350, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88350, "num_agent_steps_trained": 88200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 589, "num_samples_added_to_queue": 88200, "learner_queue": {"size_count": 294, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.013, "learner_load_time_ms": 0.523, "learner_load_wait_time_ms": 1529.891, "learner_dequeue_time_ms": 13748.157}}, "env_runners": {"episode_reward_max": 63.42888888888884, "episode_reward_min": -136.94333333333338, "episode_reward_mean": -52.21603333333339, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -136.94333333333338}, "policy_reward_max": {"default_policy": 63.42888888888884}, "policy_reward_mean": {"default_policy": -52.21603333333339}, "custom_metrics": {"num_consolidated_mean": 0.8103999999999999, "num_consolidated_min": 0.62, "num_consolidated_max": 1.07, "num_overloaded_mean": 0.5752, "num_overloaded_min": 0.36, "num_overloaded_max": 0.79, "num_moves_mean": 9.739199999999999, "num_moves_min": 9.24, "num_moves_max": 10.08, "mean_accuracy_mean": 40.60884999999999, "mean_accuracy_min": 40.32099999999999, "mean_accuracy_max": 40.86566666666667, "num_model_switches_mean": 5.790700000000002, "num_model_switches_min": 5.21, "num_model_switches_max": 6.22, "num_slav_mean": 0.11505616666666667, "num_slav_min": 0.08773333333333333, "num_slav_max": 0.1432, "mean_cluster_cpu_util_mean": 0.5139237084683983, "mean_cluster_cpu_util_min": 0.4894838183255027, "mean_cluster_cpu_util_max": 0.5427865823983283, "mean_cluster_mem_util_mean": 0.3395772110798961, "mean_cluster_mem_util_min": 0.32594762137977557, "mean_cluster_mem_util_max": 0.35339461218031526, "reward_consolidation_mean_mean": -0.4635000000000001, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.0555555555555558, "reward_illegal_mean_mean": -0.9586666666666666, "reward_illegal_mean_min": -1.3166666666666667, "reward_illegal_mean_max": -0.6, "reward_accuracy_mean_mean": 2.0088263333333334, "reward_accuracy_mean_min": 1.3, "reward_accuracy_mean_max": 2.7650333333333337, "reward_sla_mean_mean": -1.1088200000000001, "reward_sla_mean_min": -1.501333333333333, "reward_sla_mean_max": -0.6050000000000001, "reward_consolidation_sum_mean": -46.350000000000016, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -5.55555555555558, "reward_illegal_sum_mean": -95.86666666666666, "reward_illegal_sum_min": -131.66666666666666, "reward_illegal_sum_max": -59.99999999999999, "reward_accuracy_sum_mean": 200.88263333333327, "reward_accuracy_sum_min": 130.0, "reward_accuracy_sum_max": 276.5033333333334, "reward_sla_sum_mean": -110.882, "reward_sla_sum_min": -150.1333333333333, "reward_sla_sum_max": -60.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4375.0, "global_timestep_min": 2600, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-101.62222222222232, -127.52111111111122, -115.17333333333342, -126.34555555555566, -99.8944444444445, -113.48111111111118, -129.94333333333344, -89.44444444444451, -98.42333333333343, -82.54111111111115, -127.95555555555566, -102.33444444444456, -109.93777777777784, -116.45000000000014, -121.99444444444453, -136.94333333333338, -97.14777777777783, -86.50333333333336, -61.44222222222219, -121.63333333333343, -101.61888888888897, -110.31444444444448, -56.22666666666668, -47.53888888888892, -82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2777784644918291, "mean_inference_ms": 2.449318942485123, "mean_action_processing_ms": 0.10216391228705071, "mean_env_wait_ms": 1.7639127380922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008319616317749023, "StateBufferConnector_ms": 0.004772186279296875, "ViewRequirementAgentConnector_ms": 0.12655949592590332}, "num_episodes": 21, "episode_return_max": 63.42888888888884, "episode_return_min": -136.94333333333338, "episode_return_mean": -52.21603333333339, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88350, "num_agent_steps_trained": 88200, "num_env_steps_sampled": 88350, "num_env_steps_trained": 88200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 206.950654607818, "num_env_steps_trained_throughput_per_sec": 206.950654607818, "timesteps_total": 88350, "num_env_steps_sampled_lifetime": 88350, "num_agent_steps_sampled_lifetime": 88350, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 88350, "timers": {"training_iteration_time_ms": 10483.102, "restore_workers_time_ms": 0.013, "training_step_time_ms": 717.408, "sample_time_ms": 700.627, "synch_weights_time_ms": 15.27}, "counters": {"num_env_steps_sampled": 88350, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88350, "num_agent_steps_trained": 88200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 589, "num_samples_added_to_queue": 88200}, "done": false, "training_iteration": 41, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-12", "timestamp": 1728601572, "time_this_iter_s": 10.160807132720947, "time_total_s": 426.11540246009827, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae52950>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 426.11540246009827, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.846666666666668, "ram_util_percent": 49.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 116882.453125, "policy_loss": 116495.90625, "entropy": 27.142656326293945, "entropy_coeff": 0.01, "var_gnorm": 16.270931243896484, "vf_loss": 46798.0390625, "vf_explained_var": -0.3553839921951294}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 301.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 604, "num_samples_added_to_queue": 90600, "learner_queue": {"size_count": 301, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.897, "learner_load_time_ms": 0.539, "learner_load_wait_time_ms": 1341.523, "learner_dequeue_time_ms": 13585.28}}, "env_runners": {"episode_reward_max": 112.22666666666655, "episode_reward_min": -121.5077777777779, "episode_reward_mean": -7.676744444444497, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -121.5077777777779}, "policy_reward_max": {"default_policy": 112.22666666666655}, "policy_reward_mean": {"default_policy": -7.676744444444497}, "custom_metrics": {"num_consolidated_mean": 0.8902000000000001, "num_consolidated_min": 0.62, "num_consolidated_max": 1.22, "num_overloaded_mean": 0.4881, "num_overloaded_min": 0.22, "num_overloaded_max": 0.77, "num_moves_mean": 9.630900000000002, "num_moves_min": 9.24, "num_moves_max": 10.08, "mean_accuracy_mean": 40.54139999999998, "mean_accuracy_min": 40.16899999999999, "mean_accuracy_max": 40.86566666666667, "num_model_switches_mean": 5.703799999999998, "num_model_switches_min": 5.2, "num_model_switches_max": 6.22, "num_slav_mean": 0.10648800000000001, "num_slav_min": 0.07734999999999999, "num_slav_max": 0.1432, "mean_cluster_cpu_util_mean": 0.5042422933009904, "mean_cluster_cpu_util_min": 0.4687310324761818, "mean_cluster_cpu_util_max": 0.5327330842507148, "mean_cluster_mem_util_mean": 0.33432719370533026, "mean_cluster_mem_util_min": 0.31591123937971816, "mean_cluster_mem_util_max": 0.34856314493096824, "reward_consolidation_mean_mean": -0.3881111111111113, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": 0.22222222222222193, "reward_illegal_mean_mean": -0.8134999999999999, "reward_illegal_mean_min": -1.2833333333333334, "reward_illegal_mean_max": -0.36666666666666664, "reward_accuracy_mean_mean": 2.283943666666666, "reward_accuracy_mean_min": 1.3803, "reward_accuracy_mean_max": 3.2752666666666665, "reward_sla_mean_mean": -1.1591, "reward_sla_mean_min": -1.501333333333333, "reward_sla_mean_max": -0.6050000000000001, "reward_consolidation_sum_mean": -38.811111111111124, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": 22.222222222222193, "reward_illegal_sum_mean": -81.35, "reward_illegal_sum_min": -128.33333333333334, "reward_illegal_sum_max": -36.666666666666664, "reward_accuracy_sum_mean": 228.3943666666666, "reward_accuracy_sum_min": 138.03, "reward_accuracy_sum_max": 327.52666666666664, "reward_sla_sum_mean": -115.91000000000003, "reward_sla_sum_min": -150.1333333333333, "reward_sla_sum_max": -60.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5173.0, "global_timestep_min": 3200, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-82.07666666666675, -115.39888888888899, -108.75777777777782, -118.10666666666671, -98.50888888888892, -30.91555555555558, -100.74111111111118, -101.75111111111114, -120.77000000000007, -92.50000000000006, -105.03555555555565, -74.88111111111114, -121.5077777777779, -65.5988888888889, -87.41333333333337, -70.46555555555555, -85.34888888888898, -82.49111111111118, -58.22111111111113, -48.44888888888891, -98.03666666666675, -112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27920862810971664, "mean_inference_ms": 2.4640120124754095, "mean_action_processing_ms": 0.10266137002338765, "mean_env_wait_ms": 1.7726681977780998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007878780364990234, "StateBufferConnector_ms": 0.00446319580078125, "ViewRequirementAgentConnector_ms": 0.11815190315246582}, "num_episodes": 24, "episode_return_max": 112.22666666666655, "episode_return_min": -121.5077777777779, "episode_return_mean": -7.676744444444497, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.2466809561036, "num_env_steps_trained_throughput_per_sec": 200.8969022256967, "timesteps_total": 90600, "num_env_steps_sampled_lifetime": 90600, "num_agent_steps_sampled_lifetime": 90600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 90600, "timers": {"training_iteration_time_ms": 10502.765, "restore_workers_time_ms": 0.014, "training_step_time_ms": 688.785, "sample_time_ms": 672.026, "synch_weights_time_ms": 15.265}, "counters": {"num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 604, "num_samples_added_to_queue": 90600}, "done": false, "training_iteration": 42, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-23", "timestamp": 1728601583, "time_this_iter_s": 10.463539123535156, "time_total_s": 436.5789415836334, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee0e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.5789415836334, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.873333333333335, "ram_util_percent": 49.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 163757.4375, "policy_loss": 162886.015625, "entropy": 26.5982723236084, "entropy_coeff": 0.01, "var_gnorm": 16.28583526611328, "vf_loss": 95122.5625, "vf_explained_var": -0.26270341873168945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 309.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 92850, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 92850, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 619, "num_samples_added_to_queue": 92700, "learner_queue": {"size_count": 309, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.758, "learner_load_time_ms": 0.505, "learner_load_wait_time_ms": 1317.005, "learner_dequeue_time_ms": 13634.139}}, "env_runners": {"episode_reward_max": 213.3911111111111, "episode_reward_min": -112.92333333333345, "episode_reward_mean": 38.86149999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -112.92333333333345}, "policy_reward_max": {"default_policy": 213.3911111111111}, "policy_reward_mean": {"default_policy": 38.86149999999995}, "custom_metrics": {"num_consolidated_mean": 0.9671000000000001, "num_consolidated_min": 0.66, "num_consolidated_max": 1.35, "num_overloaded_mean": 0.40510000000000007, "num_overloaded_min": 0.2, "num_overloaded_max": 0.68, "num_moves_mean": 9.5336, "num_moves_min": 9.0, "num_moves_max": 10.08, "mean_accuracy_mean": 40.46615999999999, "mean_accuracy_min": 40.15633333333332, "mean_accuracy_max": 40.834, "num_model_switches_mean": 5.596900000000001, "num_model_switches_min": 5.1, "num_model_switches_max": 6.18, "num_slav_mean": 0.09718783333333335, "num_slav_min": 0.06776666666666667, "num_slav_max": 0.13231666666666667, "mean_cluster_cpu_util_mean": 0.49515612244350193, "mean_cluster_cpu_util_min": 0.4687310324761818, "mean_cluster_cpu_util_max": 0.5272671164443231, "mean_cluster_mem_util_mean": 0.32941074270931997, "mean_cluster_mem_util_min": 0.3154658714013031, "mean_cluster_mem_util_max": 0.34533017720801396, "reward_consolidation_mean_mean": -0.2928333333333335, "reward_consolidation_mean_min": -0.7888888888888889, "reward_consolidation_mean_max": 0.41111111111111065, "reward_illegal_mean_mean": -0.6751666666666667, "reward_illegal_mean_min": -1.1333333333333333, "reward_illegal_mean_max": -0.33333333333333326, "reward_accuracy_mean_mean": 2.5432149999999996, "reward_accuracy_mean_min": 1.6338666666666668, "reward_accuracy_mean_max": 3.2752666666666665, "reward_sla_mean_mean": -1.1866, "reward_sla_mean_min": -1.501333333333333, "reward_sla_mean_max": -0.8939999999999999, "reward_consolidation_sum_mean": -29.28333333333335, "reward_consolidation_sum_min": -78.88888888888889, "reward_consolidation_sum_max": 41.111111111111065, "reward_illegal_sum_mean": -67.51666666666667, "reward_illegal_sum_min": -113.33333333333333, "reward_illegal_sum_max": -33.33333333333333, "reward_accuracy_sum_mean": 254.32150000000001, "reward_accuracy_sum_min": 163.38666666666668, "reward_accuracy_sum_max": 327.52666666666664, "reward_sla_sum_mean": -118.66, "reward_sla_sum_min": -150.1333333333333, "reward_sla_sum_max": -89.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5883.0, "global_timestep_min": 4200, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-112.92333333333345, -46.966666666666676, -63.10555555555556, -54.937777777777775, -68.84111111111115, -89.38444444444448, -29.653333333333393, 8.213333333333281, -53.85000000000003, -73.95333333333335, -34.12666666666671, -75.51111111111106, -45.68111111111111, -74.5766666666667, -93.56888888888895, -50.41000000000002, -55.56333333333334, -11.817777777777811, -49.35222222222225, -44.698888888888874, 8.549999999999953, -60.16555555555557, -33.39888888888893, -20.772222222222265, -35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802152893603064, "mean_inference_ms": 2.475023959354777, "mean_action_processing_ms": 0.10299923297440096, "mean_env_wait_ms": 1.7787777969811214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007905721664428711, "StateBufferConnector_ms": 0.004265785217285156, "ViewRequirementAgentConnector_ms": 0.11199164390563965}, "num_episodes": 21, "episode_return_max": 213.3911111111111, "episode_return_min": -112.92333333333345, "episode_return_mean": 38.86149999999995, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92850, "num_agent_steps_trained": 92700, "num_env_steps_sampled": 92850, "num_env_steps_trained": 92700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 214.92822682750736, "num_env_steps_trained_throughput_per_sec": 229.25677528267454, "timesteps_total": 92850, "num_env_steps_sampled_lifetime": 92850, "num_agent_steps_sampled_lifetime": 92850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 92850, "timers": {"training_iteration_time_ms": 10487.783, "restore_workers_time_ms": 0.016, "training_step_time_ms": 696.008, "sample_time_ms": 679.578, "synch_weights_time_ms": 14.729}, "counters": {"num_env_steps_sampled": 92850, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 92850, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 619, "num_samples_added_to_queue": 92700}, "done": false, "training_iteration": 43, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-33", "timestamp": 1728601593, "time_this_iter_s": 10.4802827835083, "time_total_s": 447.0592243671417, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee2980>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.0592243671417, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.84666666666667, "ram_util_percent": 50.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 217560.96875, "policy_loss": 215838.421875, "entropy": 26.095443725585938, "entropy_coeff": 0.01, "var_gnorm": 16.292015075683594, "vf_loss": 180082.53125, "vf_explained_var": -0.19192814826965332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 316.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 95100, "num_env_steps_trained": 94800, "num_agent_steps_sampled": 95100, "num_agent_steps_trained": 94800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 634, "num_samples_added_to_queue": 95100, "learner_queue": {"size_count": 316, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.262, "learner_load_time_ms": 0.484, "learner_load_wait_time_ms": 1323.092, "learner_dequeue_time_ms": 13469.64}}, "env_runners": {"episode_reward_max": 273.3633333333332, "episode_reward_min": -42.875555555555586, "episode_reward_mean": 93.81982222222217, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -42.875555555555586}, "policy_reward_max": {"default_policy": 273.3633333333332}, "policy_reward_mean": {"default_policy": 93.81982222222217}, "custom_metrics": {"num_consolidated_mean": 1.0658999999999998, "num_consolidated_min": 0.69, "num_consolidated_max": 1.41, "num_overloaded_mean": 0.327, "num_overloaded_min": 0.12, "num_overloaded_max": 0.53, "num_moves_mean": 9.3903, "num_moves_min": 8.83, "num_moves_max": 10.08, "mean_accuracy_mean": 40.38997, "mean_accuracy_min": 40.01066666666666, "mean_accuracy_max": 40.834, "num_model_switches_mean": 5.4468000000000005, "num_model_switches_min": 4.83, "num_model_switches_max": 5.9, "num_slav_mean": 0.08687266666666668, "num_slav_min": 0.05923333333333333, "num_slav_max": 0.11938333333333334, "mean_cluster_cpu_util_mean": 0.486517599959561, "mean_cluster_cpu_util_min": 0.46467808398636024, "mean_cluster_cpu_util_max": 0.5123504221782187, "mean_cluster_mem_util_mean": 0.3244575383657682, "mean_cluster_mem_util_min": 0.3114003347541548, "mean_cluster_mem_util_max": 0.33893544447314794, "reward_consolidation_mean_mean": -0.1484444444444447, "reward_consolidation_mean_min": -0.7722222222222221, "reward_consolidation_mean_max": 0.48333333333333284, "reward_illegal_mean_mean": -0.545, "reward_illegal_mean_min": -0.8833333333333333, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 2.8039959999999993, "reward_accuracy_mean_min": 2.0972999999999993, "reward_accuracy_mean_max": 3.5376333333333334, "reward_sla_mean_mean": -1.1723533333333334, "reward_sla_mean_min": -1.501333333333333, "reward_sla_mean_max": -0.9563333333333334, "reward_consolidation_sum_mean": -14.844444444444468, "reward_consolidation_sum_min": -77.22222222222221, "reward_consolidation_sum_max": 48.333333333333286, "reward_illegal_sum_mean": -54.5, "reward_illegal_sum_min": -88.33333333333333, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 280.39959999999996, "reward_accuracy_sum_min": 209.72999999999993, "reward_accuracy_sum_max": 353.7633333333333, "reward_sla_sum_mean": -117.23533333333334, "reward_sla_sum_min": -150.1333333333333, "reward_sla_sum_max": -95.63333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5505.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-35.422222222222274, -18.23444444444449, -14.328888888888919, 4.939999999999964, 5.516666666666596, -42.875555555555586, -27.203333333333404, -28.800000000000026, 3.3788888888888455, 4.107777777777729, 20.46999999999995, 31.88222222222217, 47.84111111111107, 46.70333333333327, 32.216666666666605, 63.06555555555553, 63.42888888888884, -13.320000000000043, 7.749999999999966, 28.632222222222175, 49.9755555555555, 41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28016453391854873, "mean_inference_ms": 2.471449264099758, "mean_action_processing_ms": 0.10298274638785744, "mean_env_wait_ms": 1.7787047961663627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072782039642333984, "StateBufferConnector_ms": 0.003934621810913086, "ViewRequirementAgentConnector_ms": 0.10170531272888184}, "num_episodes": 24, "episode_return_max": 273.3633333333332, "episode_return_min": -42.875555555555586, "episode_return_mean": 93.81982222222217, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95100, "num_agent_steps_trained": 94800, "num_env_steps_sampled": 95100, "num_env_steps_trained": 94800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.81589912173922, "num_env_steps_trained_throughput_per_sec": 204.22817251362326, "timesteps_total": 95100, "num_env_steps_sampled_lifetime": 95100, "num_agent_steps_sampled_lifetime": 95100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 95100, "timers": {"training_iteration_time_ms": 10457.548, "restore_workers_time_ms": 0.015, "training_step_time_ms": 695.501, "sample_time_ms": 678.188, "synch_weights_time_ms": 15.683}, "counters": {"num_env_steps_sampled": 95100, "num_env_steps_trained": 94800, "num_agent_steps_sampled": 95100, "num_agent_steps_trained": 94800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 634, "num_samples_added_to_queue": 95100}, "done": false, "training_iteration": 44, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-44", "timestamp": 1728601604, "time_this_iter_s": 10.294315338134766, "time_total_s": 457.3535397052765, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9ba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.3535397052765, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.66, "ram_util_percent": 49.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 198000.96875, "policy_loss": 196703.875, "entropy": 25.952558517456055, "entropy_coeff": 0.01, "var_gnorm": 16.29578399658203, "vf_loss": 137495.53125, "vf_explained_var": -0.2881394624710083}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 324.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 97350, "num_env_steps_trained": 97200, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 649, "num_samples_added_to_queue": 97200, "learner_queue": {"size_count": 324, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.893, "learner_load_time_ms": 0.476, "learner_load_wait_time_ms": 1300.024, "learner_dequeue_time_ms": 13021.095}}, "env_runners": {"episode_reward_max": 273.3633333333332, "episode_reward_min": -15.741111111111163, "episode_reward_mean": 133.65807777777772, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -15.741111111111163}, "policy_reward_max": {"default_policy": 273.3633333333332}, "policy_reward_mean": {"default_policy": 133.65807777777772}, "custom_metrics": {"num_consolidated_mean": 1.1434999999999997, "num_consolidated_min": 0.81, "num_consolidated_max": 1.43, "num_overloaded_mean": 0.2795, "num_overloaded_min": 0.12, "num_overloaded_max": 0.52, "num_moves_mean": 9.255, "num_moves_min": 8.74, "num_moves_max": 9.89, "mean_accuracy_mean": 40.32391333333332, "mean_accuracy_min": 40.01066666666666, "mean_accuracy_max": 40.65033333333333, "num_model_switches_mean": 5.340599999999999, "num_model_switches_min": 4.74, "num_model_switches_max": 5.87, "num_slav_mean": 0.07912833333333333, "num_slav_min": 0.0504, "num_slav_max": 0.10581666666666666, "mean_cluster_cpu_util_mean": 0.4809904525872561, "mean_cluster_cpu_util_min": 0.46467808398636024, "mean_cluster_cpu_util_max": 0.5077410117315025, "mean_cluster_mem_util_mean": 0.32122781660818334, "mean_cluster_mem_util_min": 0.3114003347541548, "mean_cluster_mem_util_max": 0.33893544447314794, "reward_consolidation_mean_mean": -0.024722222222222503, "reward_consolidation_mean_min": -0.6666666666666667, "reward_consolidation_mean_max": 0.6111111111111107, "reward_illegal_mean_mean": -0.4658333333333332, "reward_illegal_mean_min": -0.8666666666666665, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 2.9624596666666667, "reward_accuracy_mean_min": 2.182033333333333, "reward_accuracy_mean_max": 3.5376333333333334, "reward_sla_mean_mean": -1.1353233333333332, "reward_sla_mean_min": -1.4196666666666664, "reward_sla_mean_max": -0.7963333333333334, "reward_consolidation_sum_mean": -2.4722222222222503, "reward_consolidation_sum_min": -66.66666666666667, "reward_consolidation_sum_max": 61.11111111111107, "reward_illegal_sum_mean": -46.58333333333332, "reward_illegal_sum_min": -86.66666666666664, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 296.24596666666673, "reward_accuracy_sum_min": 218.2033333333333, "reward_accuracy_sum_max": 353.7633333333333, "reward_sla_sum_mean": -113.53233333333336, "reward_sla_sum_min": -141.96666666666664, "reward_sla_sum_max": -79.63333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4563.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [41.05888888888884, 11.799999999999956, 9.883333333333299, -15.741111111111163, -7.288888888888924, 6.22555555555552, 7.43999999999996, 24.772222222222172, 1.9499999999999647, 44.474444444444416, 57.99222222222221, 44.93111111111109, 68.94111111111107, 98.44222222222211, 109.10333333333318, 66.82555555555551, 89.88444444444436, 95.27333333333318, 90.8855555555555, 91.49333333333325, 94.52999999999993, 55.20111111111106, 88.38555555555548, 75.02333333333327, 100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27986995748775323, "mean_inference_ms": 2.468479472135462, "mean_action_processing_ms": 0.10290747557798376, "mean_env_wait_ms": 1.777615411642521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006870269775390625, "StateBufferConnector_ms": 0.003741741180419922, "ViewRequirementAgentConnector_ms": 0.09556889533996582}, "num_episodes": 21, "episode_return_max": 273.3633333333332, "episode_return_min": -15.741111111111163, "episode_return_mean": 133.65807777777772, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97200, "num_env_steps_sampled": 97350, "num_env_steps_trained": 97200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 214.89000929175666, "num_env_steps_trained_throughput_per_sec": 229.2160099112071, "timesteps_total": 97350, "num_env_steps_sampled_lifetime": 97350, "num_agent_steps_sampled_lifetime": 97350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 97350, "timers": {"training_iteration_time_ms": 10457.129, "restore_workers_time_ms": 0.014, "training_step_time_ms": 691.971, "sample_time_ms": 676.338, "synch_weights_time_ms": 14.184}, "counters": {"num_env_steps_sampled": 97350, "num_env_steps_trained": 97200, "num_agent_steps_sampled": 97350, "num_agent_steps_trained": 97200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 649, "num_samples_added_to_queue": 97200}, "done": false, "training_iteration": 45, "trial_id": "3f041_00000", "date": "2024-10-11_00-06-54", "timestamp": 1728601614, "time_this_iter_s": 10.480326175689697, "time_total_s": 467.8338658809662, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698750f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 467.8338658809662, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.96, "ram_util_percent": 49.986666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 230989.6875, "policy_loss": 229067.1875, "entropy": 25.713539123535156, "entropy_coeff": 0.01, "var_gnorm": 16.29856300354004, "vf_loss": 199964.265625, "vf_explained_var": -0.20194995403289795}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 99600, "num_env_steps_trained": 99300, "num_agent_steps_sampled": 99600, "num_agent_steps_trained": 99300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 664, "num_samples_added_to_queue": 99600, "learner_queue": {"size_count": 331, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.012, "learner_load_time_ms": 0.441, "learner_load_wait_time_ms": 1306.991, "learner_dequeue_time_ms": 12863.534}}, "env_runners": {"episode_reward_max": 287.39555555555535, "episode_reward_min": 10.859999999999943, "episode_reward_mean": 177.69049999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 10.859999999999943}, "policy_reward_max": {"default_policy": 287.39555555555535}, "policy_reward_mean": {"default_policy": 177.69049999999996}, "custom_metrics": {"num_consolidated_mean": 1.2178, "num_consolidated_min": 0.89, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.22930000000000003, "num_overloaded_min": 0.12, "num_overloaded_max": 0.42, "num_moves_mean": 9.1128, "num_moves_min": 8.63, "num_moves_max": 9.65, "mean_accuracy_mean": 40.254879999999986, "mean_accuracy_min": 39.883999999999986, "mean_accuracy_max": 40.605999999999995, "num_model_switches_mean": 5.219600000000001, "num_model_switches_min": 4.74, "num_model_switches_max": 5.66, "num_slav_mean": 0.07173449999999999, "num_slav_min": 0.05031666666666666, "num_slav_max": 0.09363333333333333, "mean_cluster_cpu_util_mean": 0.475101570749258, "mean_cluster_cpu_util_min": 0.4589955418855331, "mean_cluster_cpu_util_max": 0.4949269611200103, "mean_cluster_mem_util_mean": 0.3178254107250495, "mean_cluster_mem_util_min": 0.30964664600017217, "mean_cluster_mem_util_max": 0.3299120439737076, "reward_consolidation_mean_mean": 0.11733333333333298, "reward_consolidation_mean_min": -0.5333333333333335, "reward_consolidation_mean_max": 0.7555555555555551, "reward_illegal_mean_mean": -0.3821666666666665, "reward_illegal_mean_min": -0.6999999999999998, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 3.1404916666666667, "reward_accuracy_mean_min": 2.472266666666666, "reward_accuracy_mean_max": 3.5888666666666666, "reward_sla_mean_mean": -1.0987533333333335, "reward_sla_mean_min": -1.4196666666666664, "reward_sla_mean_max": -0.7963333333333334, "reward_consolidation_sum_mean": 11.7333333333333, "reward_consolidation_sum_min": -53.33333333333336, "reward_consolidation_sum_max": 75.55555555555551, "reward_illegal_sum_mean": -38.21666666666667, "reward_illegal_sum_min": -69.99999999999999, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 314.0491666666667, "reward_accuracy_sum_min": 247.22666666666663, "reward_accuracy_sum_max": 358.88666666666666, "reward_sla_sum_mean": -109.87533333333333, "reward_sla_sum_min": -141.96666666666664, "reward_sla_sum_max": -79.63333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3486.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [100.76666666666652, 83.09666666666661, 10.859999999999943, 94.61666666666653, 72.19444444444434, 96.32444444444432, 112.22666666666655, 86.4266666666665, 89.35444444444434, 98.71888888888881, 114.18666666666655, 110.11333333333327, 129.09333333333322, 103.73777777777767, 189.41777777777781, 141.99999999999997, 110.67444444444438, 106.80333333333326, 74.55111111111106, 110.00888888888875, 128.50444444444437, 175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27957248959128483, "mean_inference_ms": 2.465206522644642, "mean_action_processing_ms": 0.10282179505991668, "mean_env_wait_ms": 1.77632524658747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006805896759033203, "StateBufferConnector_ms": 0.0037779808044433594, "ViewRequirementAgentConnector_ms": 0.09587693214416504}, "num_episodes": 24, "episode_return_max": 287.39555555555535, "episode_return_min": 10.859999999999943, "episode_return_mean": 177.69049999999996, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99600, "num_agent_steps_trained": 99300, "num_env_steps_sampled": 99600, "num_env_steps_trained": 99300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.9509195712924, "num_env_steps_trained_throughput_per_sec": 204.3541915998729, "timesteps_total": 99600, "num_env_steps_sampled_lifetime": 99600, "num_agent_steps_sampled_lifetime": 99600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 99600, "timers": {"training_iteration_time_ms": 10411.637, "restore_workers_time_ms": 0.013, "training_step_time_ms": 695.156, "sample_time_ms": 679.427, "synch_weights_time_ms": 14.205}, "counters": {"num_env_steps_sampled": 99600, "num_env_steps_trained": 99300, "num_agent_steps_sampled": 99600, "num_agent_steps_trained": 99300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 664, "num_samples_added_to_queue": 99600}, "done": false, "training_iteration": 46, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-05", "timestamp": 1728601625, "time_this_iter_s": 10.287071228027344, "time_total_s": 478.12093710899353, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874dc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 478.12093710899353, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.764285714285712, "ram_util_percent": 50.128571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 215996.171875, "policy_loss": 214293.15625, "entropy": 25.516063690185547, "entropy_coeff": 0.01, "var_gnorm": 16.30341339111328, "vf_loss": 177956.296875, "vf_explained_var": -0.1991826295852661}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 339.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 101850, "num_env_steps_trained": 101700, "num_agent_steps_sampled": 101850, "num_agent_steps_trained": 101700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 679, "num_samples_added_to_queue": 101700, "learner_queue": {"size_count": 339, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.107, "learner_load_time_ms": 0.448, "learner_load_wait_time_ms": 1302.215, "learner_dequeue_time_ms": 12654.631}}, "env_runners": {"episode_reward_max": 287.39555555555535, "episode_reward_min": 81.55444444444436, "episode_reward_mean": 204.58906666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 81.55444444444436}, "policy_reward_max": {"default_policy": 287.39555555555535}, "policy_reward_mean": {"default_policy": 204.58906666666667}, "custom_metrics": {"num_consolidated_mean": 1.2727, "num_consolidated_min": 0.93, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.20920000000000002, "num_overloaded_min": 0.1, "num_overloaded_max": 0.36, "num_moves_mean": 9.0109, "num_moves_min": 8.42, "num_moves_max": 9.39, "mean_accuracy_mean": 40.20680999999999, "mean_accuracy_min": 39.883999999999986, "mean_accuracy_max": 40.57433333333333, "num_model_switches_mean": 5.1491, "num_model_switches_min": 4.74, "num_model_switches_max": 5.6, "num_slav_mean": 0.06677433333333332, "num_slav_min": 0.043916666666666666, "num_slav_max": 0.08901666666666667, "mean_cluster_cpu_util_mean": 0.4721497863353698, "mean_cluster_cpu_util_min": 0.4589955418855331, "mean_cluster_cpu_util_max": 0.4897832005249937, "mean_cluster_mem_util_mean": 0.315935894457361, "mean_cluster_mem_util_min": 0.3079810820847327, "mean_cluster_mem_util_max": 0.32408699840695776, "reward_consolidation_mean_mean": 0.23716666666666633, "reward_consolidation_mean_min": -0.3555555555555558, "reward_consolidation_mean_max": 0.7555555555555551, "reward_illegal_mean_mean": -0.3486666666666666, "reward_illegal_mean_min": -0.6, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.2086273333333333, "reward_accuracy_mean_min": 2.5790999999999995, "reward_accuracy_mean_max": 3.604633333333333, "reward_sla_mean_mean": -1.0512366666666666, "reward_sla_mean_min": -1.401, "reward_sla_mean_max": -0.7, "reward_consolidation_sum_mean": 23.71666666666663, "reward_consolidation_sum_min": -35.55555555555558, "reward_consolidation_sum_max": 75.55555555555551, "reward_illegal_sum_mean": -34.86666666666666, "reward_illegal_sum_min": -59.99999999999999, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 320.86273333333327, "reward_accuracy_sum_min": 257.90999999999997, "reward_accuracy_sum_max": 360.4633333333333, "reward_sla_sum_mean": -105.12366666666667, "reward_sla_sum_min": -140.1, "reward_sla_sum_max": -70.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2553.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [175.86999999999998, 154.56111111111105, 213.3911111111111, 81.55444444444436, 103.06777777777768, 152.15333333333328, 153.74555555555546, 158.9788888888889, 156.1088888888889, 118.32666666666663, 183.7355555555555, 141.61444444444444, 174.96444444444438, 140.30222222222216, 222.17222222222216, 213.30444444444439, 273.3633333333332, 213.7766666666667, 131.60555555555547, 192.20666666666665, 161.19555555555553, 143.85666666666674, 195.94777777777776, 200.96111111111117, 168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27929276653987073, "mean_inference_ms": 2.462422481452071, "mean_action_processing_ms": 0.10275270024017435, "mean_env_wait_ms": 1.7753427083675422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064334869384765625, "StateBufferConnector_ms": 0.0037546157836914062, "ViewRequirementAgentConnector_ms": 0.09464859962463379}, "num_episodes": 21, "episode_return_max": 287.39555555555535, "episode_return_min": 81.55444444444436, "episode_return_mean": 204.58906666666667, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101850, "num_agent_steps_trained": 101700, "num_env_steps_sampled": 101850, "num_env_steps_trained": 101700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 217.59567394017387, "num_env_steps_trained_throughput_per_sec": 232.10205220285212, "timesteps_total": 101850, "num_env_steps_sampled_lifetime": 101850, "num_agent_steps_sampled_lifetime": 101850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 101850, "timers": {"training_iteration_time_ms": 10394.125, "restore_workers_time_ms": 0.014, "training_step_time_ms": 684.679, "sample_time_ms": 666.359, "synch_weights_time_ms": 16.834}, "counters": {"num_env_steps_sampled": 101850, "num_env_steps_trained": 101700, "num_agent_steps_sampled": 101850, "num_agent_steps_trained": 101700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 679, "num_samples_added_to_queue": 101700}, "done": false, "training_iteration": 47, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-15", "timestamp": 1728601635, "time_this_iter_s": 10.353992700576782, "time_total_s": 488.4749298095703, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefb250>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.4749298095703, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.166666666666668, "ram_util_percent": 50.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 222859.765625, "policy_loss": 220913.5, "entropy": 25.236148834228516, "entropy_coeff": 0.01, "var_gnorm": 16.308353424072266, "vf_loss": 202196.15625, "vf_explained_var": -0.16815364360809326}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 346.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 104100, "num_env_steps_trained": 103800, "num_agent_steps_sampled": 104100, "num_agent_steps_trained": 103800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 694, "num_samples_added_to_queue": 104100, "learner_queue": {"size_count": 346, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.108, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1272.729, "learner_dequeue_time_ms": 12256.504}}, "env_runners": {"episode_reward_max": 346.33333333333314, "episode_reward_min": 138.23888888888882, "episode_reward_mean": 226.53436666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 138.23888888888882}, "policy_reward_max": {"default_policy": 346.33333333333314}, "policy_reward_mean": {"default_policy": 226.53436666666667}, "custom_metrics": {"num_consolidated_mean": 1.3174000000000001, "num_consolidated_min": 1.07, "num_consolidated_max": 1.54, "num_overloaded_mean": 0.19089999999999996, "num_overloaded_min": 0.09, "num_overloaded_max": 0.3, "num_moves_mean": 8.9088, "num_moves_min": 8.38, "num_moves_max": 9.39, "mean_accuracy_mean": 40.16551666666666, "mean_accuracy_min": 39.82699999999999, "mean_accuracy_max": 40.57433333333333, "num_model_switches_mean": 5.0889, "num_model_switches_min": 4.52, "num_model_switches_max": 5.45, "num_slav_mean": 0.06332383333333333, "num_slav_min": 0.043916666666666666, "num_slav_max": 0.08438333333333334, "mean_cluster_cpu_util_mean": 0.46957548079503647, "mean_cluster_cpu_util_min": 0.4589955418855331, "mean_cluster_cpu_util_max": 0.48440292559696474, "mean_cluster_mem_util_mean": 0.3143568764010879, "mean_cluster_mem_util_min": 0.3074920182841069, "mean_cluster_mem_util_max": 0.32357914962398454, "reward_consolidation_mean_mean": 0.331333333333333, "reward_consolidation_mean_min": -0.26111111111111135, "reward_consolidation_mean_max": 0.966666666666666, "reward_illegal_mean_mean": -0.3181666666666666, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.15, "reward_accuracy_mean_mean": 3.2740703333333334, "reward_accuracy_mean_min": 2.8573000000000004, "reward_accuracy_mean_max": 3.6533333333333333, "reward_sla_mean_mean": -1.0218933333333333, "reward_sla_mean_min": -1.401, "reward_sla_mean_max": -0.7, "reward_consolidation_sum_mean": 33.1333333333333, "reward_consolidation_sum_min": -26.111111111111136, "reward_consolidation_sum_max": 96.6666666666666, "reward_illegal_sum_mean": -31.816666666666666, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -14.999999999999998, "reward_accuracy_sum_mean": 327.40703333333335, "reward_accuracy_sum_min": 285.73, "reward_accuracy_sum_max": 365.3333333333333, "reward_sla_sum_mean": -102.18933333333334, "reward_sla_sum_min": -140.1, "reward_sla_sum_max": -70.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2100.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [168.93666666666658, 166.5755555555556, 143.84999999999997, 158.5855555555555, 138.23888888888882, 169.4744444444443, 189.51888888888897, 159.08999999999986, 154.7144444444444, 231.34555555555553, 224.1355555555555, 268.33111111111117, 191.01222222222216, 201.42444444444448, 251.04777777777778, 200.08999999999992, 220.1555555555555, 173.70000000000005, 171.02888888888887, 154.67666666666653, 158.12777777777774, 164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278886890277215, "mean_inference_ms": 2.458311109085254, "mean_action_processing_ms": 0.10264995767563163, "mean_env_wait_ms": 1.7737256571943498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006087541580200195, "StateBufferConnector_ms": 0.0036590099334716797, "ViewRequirementAgentConnector_ms": 0.09195256233215332}, "num_episodes": 24, "episode_return_max": 346.33333333333314, "episode_return_min": 138.23888888888882, "episode_return_mean": 226.53436666666667, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104100, "num_agent_steps_trained": 103800, "num_env_steps_sampled": 104100, "num_env_steps_trained": 103800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 224.45382046037562, "num_env_steps_trained_throughput_per_sec": 209.4902324296839, "timesteps_total": 104100, "num_env_steps_sampled_lifetime": 104100, "num_agent_steps_sampled_lifetime": 104100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 104100, "timers": {"training_iteration_time_ms": 10355.307, "restore_workers_time_ms": 0.013, "training_step_time_ms": 653.629, "sample_time_ms": 637.216, "synch_weights_time_ms": 14.875}, "counters": {"num_env_steps_sampled": 104100, "num_env_steps_trained": 103800, "num_agent_steps_sampled": 104100, "num_agent_steps_trained": 103800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 694, "num_samples_added_to_queue": 104100}, "done": false, "training_iteration": 48, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-25", "timestamp": 1728601645, "time_this_iter_s": 10.034137725830078, "time_total_s": 498.5090675354004, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefbdc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.5090675354004, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.457142857142856, "ram_util_percent": 50.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 209423.953125, "policy_loss": 207710.5, "entropy": 24.75667381286621, "entropy_coeff": 0.01, "var_gnorm": 16.316434860229492, "vf_loss": 178771.25, "vf_explained_var": -0.18634343147277832}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 354.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 106350, "num_env_steps_trained": 106200, "num_agent_steps_sampled": 106350, "num_agent_steps_trained": 106200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 709, "num_samples_added_to_queue": 106200, "learner_queue": {"size_count": 354, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.034, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 1278.205, "learner_dequeue_time_ms": 11908.716}}, "env_runners": {"episode_reward_max": 346.33333333333314, "episode_reward_min": 155.86777777777766, "episode_reward_mean": 244.51722222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 155.86777777777766}, "policy_reward_max": {"default_policy": 346.33333333333314}, "policy_reward_mean": {"default_policy": 244.51722222222222}, "custom_metrics": {"num_consolidated_mean": 1.3526999999999998, "num_consolidated_min": 1.07, "num_consolidated_max": 1.54, "num_overloaded_mean": 0.17740000000000003, "num_overloaded_min": 0.08, "num_overloaded_max": 0.3, "num_moves_mean": 8.8256, "num_moves_min": 8.34, "num_moves_max": 9.39, "mean_accuracy_mean": 40.12967, "mean_accuracy_min": 39.82699999999999, "mean_accuracy_max": 40.44766666666666, "num_model_switches_mean": 5.0467, "num_model_switches_min": 4.52, "num_model_switches_max": 5.45, "num_slav_mean": 0.06004883333333333, "num_slav_min": 0.043916666666666666, "num_slav_max": 0.07541666666666667, "mean_cluster_cpu_util_mean": 0.46810045723742344, "mean_cluster_cpu_util_min": 0.4548716505190159, "mean_cluster_cpu_util_max": 0.4825429201056561, "mean_cluster_mem_util_mean": 0.31345113205028846, "mean_cluster_mem_util_min": 0.30655142584459943, "mean_cluster_mem_util_max": 0.3203461223413416, "reward_consolidation_mean_mean": 0.40722222222222193, "reward_consolidation_mean_min": -0.20555555555555582, "reward_consolidation_mean_max": 0.966666666666666, "reward_illegal_mean_mean": -0.2956666666666667, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 3.318913333333333, "reward_accuracy_mean_min": 2.8573000000000004, "reward_accuracy_mean_max": 3.6804999999999994, "reward_sla_mean_mean": -0.9852966666666668, "reward_sla_mean_min": -1.2796666666666667, "reward_sla_mean_max": -0.7, "reward_consolidation_sum_mean": 40.722222222222186, "reward_consolidation_sum_min": -20.555555555555582, "reward_consolidation_sum_max": 96.6666666666666, "reward_illegal_sum_mean": -29.566666666666666, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 331.8913333333333, "reward_accuracy_sum_min": 285.73, "reward_accuracy_sum_max": 368.04999999999995, "reward_sla_sum_mean": -98.52966666666669, "reward_sla_sum_min": -127.96666666666667, "reward_sla_sum_max": -70.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2571.0, "global_timestep_min": 600, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [164.86666666666667, 197.8133333333333, 176.83333333333334, 197.36444444444447, 155.86777777777766, 272.5944444444444, 206.6877777777778, 212.00000000000003, 231.84999999999994, 183.9422222222221, 225.5555555555556, 247.55, 237.28111111111113, 203.85444444444454, 172.52555555555554, 247.8255555555555, 247.9066666666666, 218.04222222222208, 202.59333333333325, 235.38444444444457, 243.30444444444447, 273.38555555555547, 244.26333333333326, 255.231111111111, 247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27858977246846967, "mean_inference_ms": 2.4550875099225125, "mean_action_processing_ms": 0.10256886810310945, "mean_env_wait_ms": 1.7725145830066678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006097555160522461, "StateBufferConnector_ms": 0.0036509037017822266, "ViewRequirementAgentConnector_ms": 0.09212088584899902}, "num_episodes": 21, "episode_return_max": 346.33333333333314, "episode_return_min": 155.86777777777766, "episode_return_mean": 244.51722222222222, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106350, "num_agent_steps_trained": 106200, "num_env_steps_sampled": 106350, "num_env_steps_trained": 106200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 220.53154708054595, "num_env_steps_trained_throughput_per_sec": 235.233650219249, "timesteps_total": 106350, "num_env_steps_sampled_lifetime": 106350, "num_agent_steps_sampled_lifetime": 106350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 106350, "timers": {"training_iteration_time_ms": 10325.399, "restore_workers_time_ms": 0.014, "training_step_time_ms": 678.375, "sample_time_ms": 662.089, "synch_weights_time_ms": 14.778}, "counters": {"num_env_steps_sampled": 106350, "num_env_steps_trained": 106200, "num_agent_steps_sampled": 106350, "num_agent_steps_trained": 106200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 709, "num_samples_added_to_queue": 106200}, "done": false, "training_iteration": 49, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-35", "timestamp": 1728601655, "time_this_iter_s": 10.213670492172241, "time_total_s": 508.72273802757263, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefb0a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 508.72273802757263, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.073333333333334, "ram_util_percent": 50.53333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 266486.0, "policy_loss": 263698.59375, "entropy": 24.396656036376953, "entropy_coeff": 0.01, "var_gnorm": 16.322032928466797, "vf_loss": 286060.875, "vf_explained_var": -0.17001616954803467}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 361.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108600, "learner_queue": {"size_count": 361, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.41, "learner_load_time_ms": 0.417, "learner_load_wait_time_ms": 1312.17, "learner_dequeue_time_ms": 11456.407}}, "env_runners": {"episode_reward_max": 368.643333333333, "episode_reward_min": 157.40111111111105, "episode_reward_mean": 267.22038888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 157.40111111111105}, "policy_reward_max": {"default_policy": 368.643333333333}, "policy_reward_mean": {"default_policy": 267.22038888888886}, "custom_metrics": {"num_consolidated_mean": 1.3973000000000002, "num_consolidated_min": 1.07, "num_consolidated_max": 1.65, "num_overloaded_mean": 0.16270000000000004, "num_overloaded_min": 0.08, "num_overloaded_max": 0.3, "num_moves_mean": 8.697, "num_moves_min": 8.15, "num_moves_max": 9.31, "mean_accuracy_mean": 40.089896666666654, "mean_accuracy_min": 39.82699999999999, "mean_accuracy_max": 40.339999999999996, "num_model_switches_mean": 4.972799999999999, "num_model_switches_min": 4.52, "num_model_switches_max": 5.45, "num_slav_mean": 0.0566315, "num_slav_min": 0.03641666666666667, "num_slav_max": 0.07366666666666667, "mean_cluster_cpu_util_mean": 0.4664388041122537, "mean_cluster_cpu_util_min": 0.4548716505190159, "mean_cluster_cpu_util_max": 0.47944722743687174, "mean_cluster_mem_util_mean": 0.31245607096034617, "mean_cluster_mem_util_min": 0.30579110533453885, "mean_cluster_mem_util_max": 0.31867210974052074, "reward_consolidation_mean_mean": 0.5162222222222218, "reward_consolidation_mean_min": -0.20555555555555582, "reward_consolidation_mean_max": 1.2333333333333332, "reward_illegal_mean_mean": -0.2711666666666666, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 3.368915, "reward_accuracy_mean_min": 2.8573000000000004, "reward_accuracy_mean_max": 3.6804999999999994, "reward_sla_mean_mean": -0.9417666666666666, "reward_sla_mean_min": -1.2723333333333335, "reward_sla_mean_max": -0.632, "reward_consolidation_sum_mean": 51.62222222222218, "reward_consolidation_sum_min": -20.555555555555582, "reward_consolidation_sum_max": 123.33333333333331, "reward_illegal_sum_mean": -27.116666666666664, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 336.89149999999995, "reward_accuracy_sum_min": 285.73, "reward_accuracy_sum_max": 368.04999999999995, "reward_sla_sum_mean": -94.17666666666668, "reward_sla_sum_min": -127.23333333333335, "reward_sla_sum_max": -63.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3366.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [247.1588888888889, 287.07666666666654, 239.18555555555548, 253.96666666666664, 157.40111111111105, 212.50444444444437, 246.03666666666658, 287.39555555555535, 219.78999999999996, 249.51000000000002, 214.0188888888888, 211.49888888888896, 239.20333333333335, 262.7200000000001, 228.22111111111113, 224.45444444444442, 210.93444444444435, 245.65222222222224, 225.04000000000002, 234.1355555555555, 235.06333333333336, 199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27825568439533443, "mean_inference_ms": 2.4511290786551503, "mean_action_processing_ms": 0.10246065507336385, "mean_env_wait_ms": 1.7708256300209495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006026029586791992, "StateBufferConnector_ms": 0.0035829544067382812, "ViewRequirementAgentConnector_ms": 0.09097957611083984}, "num_episodes": 24, "episode_return_max": 368.643333333333, "episode_return_min": 157.40111111111105, "episode_return_mean": 267.22038888888886, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.71688211338918, "num_env_steps_trained_throughput_per_sec": 204.13575663916322, "timesteps_total": 108600, "num_env_steps_sampled_lifetime": 108600, "num_agent_steps_sampled_lifetime": 108600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 108600, "timers": {"training_iteration_time_ms": 10295.305, "restore_workers_time_ms": 0.012, "training_step_time_ms": 696.191, "sample_time_ms": 679.034, "synch_weights_time_ms": 15.41}, "counters": {"num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108600}, "done": false, "training_iteration": 50, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-46", "timestamp": 1728601666, "time_this_iter_s": 10.316581726074219, "time_total_s": 519.0393197536469, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875ff0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.0393197536469, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.52, "ram_util_percent": 50.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 253201.8125, "policy_loss": 250575.703125, "entropy": 24.046140670776367, "entropy_coeff": 0.01, "var_gnorm": 16.32829475402832, "vf_loss": 269824.25, "vf_explained_var": -0.1557537317276001}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 369.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 110850, "num_env_steps_trained": 110700, "num_agent_steps_sampled": 110850, "num_agent_steps_trained": 110700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 739, "num_samples_added_to_queue": 110700, "learner_queue": {"size_count": 369, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.844, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1291.475, "learner_dequeue_time_ms": 11066.16}}, "env_runners": {"episode_reward_max": 393.9666666666666, "episode_reward_min": 188.08555555555554, "episode_reward_mean": 288.33584444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 188.08555555555554}, "policy_reward_max": {"default_policy": 393.9666666666666}, "policy_reward_mean": {"default_policy": 288.33584444444443}, "custom_metrics": {"num_consolidated_mean": 1.4369, "num_consolidated_min": 1.22, "num_consolidated_max": 1.7, "num_overloaded_mean": 0.14800000000000002, "num_overloaded_min": 0.07, "num_overloaded_max": 0.3, "num_moves_mean": 8.583400000000001, "num_moves_min": 7.88, "num_moves_max": 9.27, "mean_accuracy_mean": 40.06468999999999, "mean_accuracy_min": 39.807999999999986, "mean_accuracy_max": 40.339999999999996, "num_model_switches_mean": 4.8964, "num_model_switches_min": 4.44, "num_model_switches_max": 5.45, "num_slav_mean": 0.053779999999999994, "num_slav_min": 0.03641666666666667, "num_slav_max": 0.07366666666666667, "mean_cluster_cpu_util_mean": 0.46468611178090824, "mean_cluster_cpu_util_min": 0.44695165430214234, "mean_cluster_cpu_util_max": 0.47944722743687174, "mean_cluster_mem_util_mean": 0.31138696692643303, "mean_cluster_mem_util_min": 0.30309424208501967, "mean_cluster_mem_util_max": 0.31867210974052074, "reward_consolidation_mean_mean": 0.6176111111111108, "reward_consolidation_mean_min": 0.05555555555555517, "reward_consolidation_mean_max": 1.3499999999999996, "reward_illegal_mean_mean": -0.24666666666666665, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.11666666666666665, "reward_accuracy_mean_mean": 3.424887333333333, "reward_accuracy_mean_min": 2.8573000000000004, "reward_accuracy_mean_max": 3.7298333333333336, "reward_sla_mean_mean": -0.9124733333333335, "reward_sla_mean_min": -1.2723333333333335, "reward_sla_mean_max": -0.632, "reward_consolidation_sum_mean": 61.76111111111107, "reward_consolidation_sum_min": 5.555555555555517, "reward_consolidation_sum_max": 134.99999999999997, "reward_illegal_sum_mean": -24.66666666666666, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -11.666666666666666, "reward_accuracy_sum_mean": 342.4887333333333, "reward_accuracy_sum_min": 285.73, "reward_accuracy_sum_max": 372.98333333333335, "reward_sla_sum_mean": -91.24733333333333, "reward_sla_sum_min": -127.23333333333335, "reward_sla_sum_max": -63.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4071.0, "global_timestep_min": 2100, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [199.1977777777778, 255.6477777777778, 250.13444444444448, 242.6188888888889, 254.12888888888887, 188.08555555555554, 237.50444444444443, 212.4466666666667, 228.40111111111102, 254.42555555555558, 247.29333333333335, 261.40999999999997, 312.66999999999985, 256.6655555555555, 282.0566666666666, 252.58222222222233, 274.0588888888888, 346.33333333333314, 278.9144444444443, 229.03222222222226, 243.97, 200.6844444444445, 194.56, 268.5199999999998, 277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2779674299553697, "mean_inference_ms": 2.448168603848199, "mean_action_processing_ms": 0.10237575894841879, "mean_env_wait_ms": 1.7695671332405698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059757232666015625, "StateBufferConnector_ms": 0.0035247802734375, "ViewRequirementAgentConnector_ms": 0.09032964706420898}, "num_episodes": 21, "episode_return_max": 393.9666666666666, "episode_return_min": 188.08555555555554, "episode_return_mean": 288.33584444444443, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110850, "num_agent_steps_trained": 110700, "num_env_steps_sampled": 110850, "num_env_steps_trained": 110700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 221.90734687110276, "num_env_steps_trained_throughput_per_sec": 236.70116999584295, "timesteps_total": 110850, "num_env_steps_sampled_lifetime": 110850, "num_agent_steps_sampled_lifetime": 110850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 110850, "timers": {"training_iteration_time_ms": 10294.507, "restore_workers_time_ms": 0.013, "training_step_time_ms": 662.602, "sample_time_ms": 645.414, "synch_weights_time_ms": 15.774}, "counters": {"num_env_steps_sampled": 110850, "num_env_steps_trained": 110700, "num_agent_steps_sampled": 110850, "num_agent_steps_trained": 110700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 739, "num_samples_added_to_queue": 110700}, "done": false, "training_iteration": 51, "trial_id": "3f041_00000", "date": "2024-10-11_00-07-56", "timestamp": 1728601676, "time_this_iter_s": 10.152175664901733, "time_total_s": 529.1914954185486, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef8070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.1914954185486, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.921428571428574, "ram_util_percent": 50.73571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 284559.4375, "policy_loss": 281212.96875, "entropy": 23.810338973999023, "entropy_coeff": 0.01, "var_gnorm": 16.331623077392578, "vf_loss": 341791.625, "vf_explained_var": -0.14028966426849365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 376.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 754, "num_samples_added_to_queue": 113100, "learner_queue": {"size_count": 376, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.321, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1281.112, "learner_dequeue_time_ms": 11013.213}}, "env_runners": {"episode_reward_max": 420.1344444444444, "episode_reward_min": 191.83333333333331, "episode_reward_mean": 312.93201111111097, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 191.83333333333331}, "policy_reward_max": {"default_policy": 420.1344444444444}, "policy_reward_mean": {"default_policy": 312.93201111111097}, "custom_metrics": {"num_consolidated_mean": 1.4810999999999999, "num_consolidated_min": 1.23, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.1318, "num_overloaded_min": 0.06, "num_overloaded_max": 0.24, "num_moves_mean": 8.4505, "num_moves_min": 7.87, "num_moves_max": 9.1, "mean_accuracy_mean": 40.03827999999999, "mean_accuracy_min": 39.801666666666655, "mean_accuracy_max": 40.339999999999996, "num_model_switches_mean": 4.7959000000000005, "num_model_switches_min": 4.15, "num_model_switches_max": 5.45, "num_slav_mean": 0.05060883333333333, "num_slav_min": 0.0334, "num_slav_max": 0.0717, "mean_cluster_cpu_util_mean": 0.4626102021079051, "mean_cluster_cpu_util_min": 0.44695165430214234, "mean_cluster_cpu_util_max": 0.4733152820001058, "mean_cluster_mem_util_mean": 0.31023213481658485, "mean_cluster_mem_util_min": 0.30309424208501967, "mean_cluster_mem_util_max": 0.31840866198800194, "reward_consolidation_mean_mean": 0.7382777777777774, "reward_consolidation_mean_min": 0.14999999999999974, "reward_consolidation_mean_max": 1.5166666666666664, "reward_illegal_mean_mean": -0.21966666666666665, "reward_illegal_mean_min": -0.3999999999999999, "reward_illegal_mean_max": -0.1, "reward_accuracy_mean_mean": 3.486082333333333, "reward_accuracy_mean_min": 3.0285999999999995, "reward_accuracy_mean_max": 3.7468666666666666, "reward_sla_mean_mean": -0.8753733333333333, "reward_sla_mean_min": -1.2723333333333335, "reward_sla_mean_max": -0.5700000000000001, "reward_consolidation_sum_mean": 73.82777777777774, "reward_consolidation_sum_min": 14.999999999999973, "reward_consolidation_sum_max": 151.66666666666663, "reward_illegal_sum_mean": -21.96666666666667, "reward_illegal_sum_min": -39.99999999999999, "reward_illegal_sum_max": -10.0, "reward_accuracy_sum_mean": 348.6082333333333, "reward_accuracy_sum_min": 302.85999999999996, "reward_accuracy_sum_max": 374.68666666666667, "reward_sla_sum_mean": -87.53733333333332, "reward_sla_sum_min": -127.23333333333335, "reward_sla_sum_max": -57.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4866.0, "global_timestep_min": 2800, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [277.02666666666653, 252.24000000000004, 299.8122222222221, 191.83333333333331, 262.87222222222204, 276.7422222222221, 220.83000000000004, 316.5344444444442, 255.13777777777773, 249.51444444444442, 314.4955555555555, 244.63111111111112, 243.7033333333333, 222.99888888888879, 321.49111111111085, 283.5877777777776, 207.38555555555553, 253.40555555555554, 292.5655555555554, 307.31999999999994, 283.041111111111, 326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27765004235975754, "mean_inference_ms": 2.4444855054409924, "mean_action_processing_ms": 0.10227692865025732, "mean_env_wait_ms": 1.7679340130314818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060634613037109375, "StateBufferConnector_ms": 0.0035517215728759766, "ViewRequirementAgentConnector_ms": 0.09096407890319824}, "num_episodes": 24, "episode_return_max": 420.1344444444444, "episode_return_min": 191.83333333333331, "episode_return_mean": 312.93201111111097, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 221.0557375892577, "num_env_steps_trained_throughput_per_sec": 206.3186884166405, "timesteps_total": 113100, "num_env_steps_sampled_lifetime": 113100, "num_agent_steps_sampled_lifetime": 113100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 113100, "timers": {"training_iteration_time_ms": 10267.038, "restore_workers_time_ms": 0.013, "training_step_time_ms": 696.123, "sample_time_ms": 679.996, "synch_weights_time_ms": 14.628}, "counters": {"num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 754, "num_samples_added_to_queue": 113100}, "done": false, "training_iteration": 52, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-06", "timestamp": 1728601686, "time_this_iter_s": 10.188565731048584, "time_total_s": 539.3800611495972, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877940>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.3800611495972, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.58, "ram_util_percent": 50.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 243783.34375, "policy_loss": 241300.625, "entropy": 23.61166763305664, "entropy_coeff": 0.01, "var_gnorm": 16.33401870727539, "vf_loss": 255355.4375, "vf_explained_var": -0.16689300537109375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 384.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 115350, "num_env_steps_trained": 115200, "num_agent_steps_sampled": 115350, "num_agent_steps_trained": 115200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 769, "num_samples_added_to_queue": 115200, "learner_queue": {"size_count": 384, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.729, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1289.322, "learner_dequeue_time_ms": 11013.213}}, "env_runners": {"episode_reward_max": 421.8233333333333, "episode_reward_min": 233.87222222222212, "episode_reward_mean": 331.9505999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 233.87222222222212}, "policy_reward_max": {"default_policy": 421.8233333333333}, "policy_reward_mean": {"default_policy": 331.9505999999999}, "custom_metrics": {"num_consolidated_mean": 1.5226000000000002, "num_consolidated_min": 1.29, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.12300000000000003, "num_overloaded_min": 0.06, "num_overloaded_max": 0.21, "num_moves_mean": 8.3479, "num_moves_min": 7.87, "num_moves_max": 9.1, "mean_accuracy_mean": 40.01250333333333, "mean_accuracy_min": 39.78266666666666, "mean_accuracy_max": 40.270333333333326, "num_model_switches_mean": 4.7299, "num_model_switches_min": 4.15, "num_model_switches_max": 5.15, "num_slav_mean": 0.047776500000000006, "num_slav_min": 0.0334, "num_slav_max": 0.06265, "mean_cluster_cpu_util_mean": 0.461263228026251, "mean_cluster_cpu_util_min": 0.44695165430214234, "mean_cluster_cpu_util_max": 0.4733152820001058, "mean_cluster_mem_util_mean": 0.30936342229972164, "mean_cluster_mem_util_min": 0.30309424208501967, "mean_cluster_mem_util_max": 0.31840866198800194, "reward_consolidation_mean_mean": 0.8464999999999995, "reward_consolidation_mean_min": 0.18888888888888847, "reward_consolidation_mean_max": 1.5166666666666664, "reward_illegal_mean_mean": -0.20499999999999996, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.1, "reward_accuracy_mean_mean": 3.5167759999999992, "reward_accuracy_mean_min": 3.1967999999999996, "reward_accuracy_mean_max": 3.7607999999999997, "reward_sla_mean_mean": -0.8387700000000001, "reward_sla_mean_min": -1.128, "reward_sla_mean_max": -0.5700000000000001, "reward_consolidation_sum_mean": 84.64999999999996, "reward_consolidation_sum_min": 18.888888888888847, "reward_consolidation_sum_max": 151.66666666666663, "reward_illegal_sum_mean": -20.5, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -10.0, "reward_accuracy_sum_mean": 351.67760000000004, "reward_accuracy_sum_min": 319.67999999999995, "reward_accuracy_sum_max": 376.08, "reward_sla_sum_mean": -83.87700000000001, "reward_sla_sum_min": -112.8, "reward_sla_sum_max": -57.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5571.0, "global_timestep_min": 3600, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [326.84999999999974, 324.29, 265.0288888888889, 244.80888888888887, 239.4666666666666, 262.83888888888873, 247.0166666666666, 272.98777777777764, 249.9844444444444, 284.44777777777773, 311.8999999999997, 233.87222222222212, 326.0544444444444, 274.21444444444444, 313.3633333333333, 349.42444444444425, 308.65333333333314, 343.941111111111, 296.6033333333333, 337.5599999999999, 322.12666666666667, 286.03222222222195, 317.3766666666666, 323.15555555555557, 364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27741138058601034, "mean_inference_ms": 2.4417118785942424, "mean_action_processing_ms": 0.10220483611789088, "mean_env_wait_ms": 1.7668473452072053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006093025207519531, "StateBufferConnector_ms": 0.0036051273345947266, "ViewRequirementAgentConnector_ms": 0.09182405471801758}, "num_episodes": 21, "episode_return_max": 421.8233333333333, "episode_return_min": 233.87222222222212, "episode_return_mean": 331.9505999999999, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115350, "num_agent_steps_trained": 115200, "num_env_steps_sampled": 115350, "num_env_steps_trained": 115200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 221.2428990080203, "num_env_steps_trained_throughput_per_sec": 235.99242560855498, "timesteps_total": 115350, "num_env_steps_sampled_lifetime": 115350, "num_agent_steps_sampled_lifetime": 115350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 115350, "timers": {"training_iteration_time_ms": 10237.158, "restore_workers_time_ms": 0.012, "training_step_time_ms": 682.22, "sample_time_ms": 665.773, "synch_weights_time_ms": 14.735}, "counters": {"num_env_steps_sampled": 115350, "num_env_steps_trained": 115200, "num_agent_steps_sampled": 115350, "num_agent_steps_trained": 115200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 769, "num_samples_added_to_queue": 115200}, "done": false, "training_iteration": 53, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-16", "timestamp": 1728601696, "time_this_iter_s": 10.179708003997803, "time_total_s": 549.559769153595, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.559769153595, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.89333333333333, "ram_util_percent": 50.80666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 290184.59375, "policy_loss": 286381.375, "entropy": 23.15006446838379, "entropy_coeff": 0.01, "var_gnorm": 16.33757781982422, "vf_loss": 387264.6875, "vf_explained_var": -0.1287367343902588}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 391.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 117600, "num_env_steps_trained": 117300, "num_agent_steps_sampled": 117600, "num_agent_steps_trained": 117300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 784, "num_samples_added_to_queue": 117600, "learner_queue": {"size_count": 391, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.361, "learner_load_time_ms": 0.387, "learner_load_wait_time_ms": 1269.941, "learner_dequeue_time_ms": 10995.868}}, "env_runners": {"episode_reward_max": 437.3488888888886, "episode_reward_min": 279.2744444444443, "episode_reward_mean": 350.96522222222217, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 279.2744444444443}, "policy_reward_max": {"default_policy": 437.3488888888886}, "policy_reward_mean": {"default_policy": 350.96522222222217}, "custom_metrics": {"num_consolidated_mean": 1.571, "num_consolidated_min": 1.32, "num_consolidated_max": 1.78, "num_overloaded_mean": 0.11560000000000001, "num_overloaded_min": 0.03, "num_overloaded_max": 0.2, "num_moves_mean": 8.2583, "num_moves_min": 7.76, "num_moves_max": 8.65, "mean_accuracy_mean": 39.98533333333332, "mean_accuracy_min": 39.78266666666666, "mean_accuracy_max": 40.270333333333326, "num_model_switches_mean": 4.6677, "num_model_switches_min": 4.15, "num_model_switches_max": 5.15, "num_slav_mean": 0.04560266666666665, "num_slav_min": 0.0334, "num_slav_max": 0.06051666666666667, "mean_cluster_cpu_util_mean": 0.45967849461008675, "mean_cluster_cpu_util_min": 0.44695165430214234, "mean_cluster_cpu_util_max": 0.4733152820001058, "mean_cluster_mem_util_mean": 0.30823089431204975, "mean_cluster_mem_util_min": 0.3015636719983352, "mean_cluster_mem_util_max": 0.3161162217629668, "reward_consolidation_mean_mean": 0.9672222222222219, "reward_consolidation_mean_min": 0.27777777777777735, "reward_consolidation_mean_max": 1.561111111111111, "reward_illegal_mean_mean": -0.19266666666666665, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.543100000000001, "reward_accuracy_mean_min": 3.1967999999999996, "reward_accuracy_mean_max": 3.887266666666667, "reward_sla_mean_mean": -0.8080033333333335, "reward_sla_mean_min": -1.128, "reward_sla_mean_max": -0.5700000000000001, "reward_consolidation_sum_mean": 96.72222222222217, "reward_consolidation_sum_min": 27.777777777777736, "reward_consolidation_sum_max": 156.1111111111111, "reward_illegal_sum_mean": -19.266666666666666, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 354.3100000000002, "reward_accuracy_sum_min": 319.67999999999995, "reward_accuracy_sum_max": 388.7266666666667, "reward_sla_sum_mean": -80.80033333333333, "reward_sla_sum_min": -112.8, "reward_sla_sum_max": -57.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5898.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [364.4455555555554, 336.1811111111111, 306.61999999999995, 279.35, 319.02999999999975, 291.2844444444444, 319.19222222222203, 294.4277777777776, 301.38777777777767, 368.643333333333, 317.2411111111108, 288.83777777777783, 327.12333333333333, 355.24444444444435, 358.8044444444442, 363.30888888888893, 331.56222222222203, 329.95000000000016, 279.5999999999998, 324.55555555555554, 383.2833333333332, 279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2771159315425503, "mean_inference_ms": 2.4377890595974336, "mean_action_processing_ms": 0.10210297345514037, "mean_env_wait_ms": 1.7652021559447975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00606536865234375, "StateBufferConnector_ms": 0.0035848617553710938, "ViewRequirementAgentConnector_ms": 0.09184670448303223}, "num_episodes": 24, "episode_return_max": 437.3488888888886, "episode_return_min": 279.2744444444443, "episode_return_mean": 350.96522222222217, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117600, "num_agent_steps_trained": 117300, "num_env_steps_sampled": 117600, "num_env_steps_trained": 117300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 223.99171515018426, "num_env_steps_trained_throughput_per_sec": 209.05893414017197, "timesteps_total": 117600, "num_env_steps_sampled_lifetime": 117600, "num_agent_steps_sampled_lifetime": 117600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 117600, "timers": {"training_iteration_time_ms": 10213.397, "restore_workers_time_ms": 0.015, "training_step_time_ms": 664.239, "sample_time_ms": 646.754, "synch_weights_time_ms": 15.59}, "counters": {"num_env_steps_sampled": 117600, "num_env_steps_trained": 117300, "num_agent_steps_sampled": 117600, "num_agent_steps_trained": 117300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 784, "num_samples_added_to_queue": 117600}, "done": false, "training_iteration": 54, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-26", "timestamp": 1728601706, "time_this_iter_s": 10.056622743606567, "time_total_s": 559.6163918972015, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 559.6163918972015, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.807142857142857, "ram_util_percent": 50.72857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 295967.21875, "policy_loss": 291693.125, "entropy": 22.44001007080078, "entropy_coeff": 0.01, "var_gnorm": 16.346656799316406, "vf_loss": 434140.96875, "vf_explained_var": -0.12543833255767822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 399.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 119850, "num_env_steps_trained": 119700, "num_agent_steps_sampled": 119850, "num_agent_steps_trained": 119700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 799, "num_samples_added_to_queue": 119700, "learner_queue": {"size_count": 399, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.849, "learner_load_time_ms": 0.391, "learner_load_wait_time_ms": 1260.92, "learner_dequeue_time_ms": 10971.315}}, "env_runners": {"episode_reward_max": 482.97777777777776, "episode_reward_min": 279.2744444444443, "episode_reward_mean": 370.45807777777765, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 279.2744444444443}, "policy_reward_max": {"default_policy": 482.97777777777776}, "policy_reward_mean": {"default_policy": 370.45807777777765}, "custom_metrics": {"num_consolidated_mean": 1.6196999999999997, "num_consolidated_min": 1.33, "num_consolidated_max": 1.88, "num_overloaded_mean": 0.1085, "num_overloaded_min": 0.03, "num_overloaded_max": 0.2, "num_moves_mean": 8.145700000000001, "num_moves_min": 7.56, "num_moves_max": 8.61, "mean_accuracy_mean": 39.950056666666654, "mean_accuracy_min": 39.71933333333332, "mean_accuracy_max": 40.270333333333326, "num_model_switches_mean": 4.5758, "num_model_switches_min": 4.14, "num_model_switches_max": 5.09, "num_slav_mean": 0.04267699999999999, "num_slav_min": 0.022899999999999997, "num_slav_max": 0.05858333333333333, "mean_cluster_cpu_util_mean": 0.4585934245519014, "mean_cluster_cpu_util_min": 0.44493765236104243, "mean_cluster_cpu_util_max": 0.4711222670424073, "mean_cluster_mem_util_mean": 0.30722134449001115, "mean_cluster_mem_util_min": 0.2995429116794397, "mean_cluster_mem_util_max": 0.31491356920405295, "reward_consolidation_mean_mean": 1.081944444444444, "reward_consolidation_mean_min": 0.4666666666666663, "reward_consolidation_mean_max": 1.8666666666666663, "reward_illegal_mean_mean": -0.18083333333333332, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.5662429999999996, "reward_accuracy_mean_min": 3.1967999999999996, "reward_accuracy_mean_max": 3.887266666666667, "reward_sla_mean_mean": -0.7627733333333332, "reward_sla_mean_min": -1.032, "reward_sla_mean_max": -0.44199999999999995, "reward_consolidation_sum_mean": 108.19444444444441, "reward_consolidation_sum_min": 46.66666666666663, "reward_consolidation_sum_max": 186.66666666666663, "reward_illegal_sum_mean": -18.083333333333332, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 356.62429999999983, "reward_accuracy_sum_min": 319.67999999999995, "reward_accuracy_sum_max": 388.7266666666667, "reward_sla_sum_mean": -76.27733333333333, "reward_sla_sum_min": -103.2, "reward_sla_sum_max": -44.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4965.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [279.2744444444443, 341.59222222222206, 287.76666666666654, 354.77333333333326, 335.94555555555553, 318.6599999999998, 371.2611111111112, 343.9588888888886, 393.9666666666666, 355.8033333333333, 383.7966666666664, 370.78999999999996, 396.18666666666655, 335.9022222222221, 316.9222222222221, 337.6633333333331, 364.872222222222, 417.16666666666663, 331.39444444444433, 340.9266666666666, 292.84999999999997, 279.741111111111, 341.0144444444444, 372.4188888888886, 360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2768896992794194, "mean_inference_ms": 2.4345566660731803, "mean_action_processing_ms": 0.10202524501777001, "mean_env_wait_ms": 1.764003082379615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00620722770690918, "StateBufferConnector_ms": 0.0036644935607910156, "ViewRequirementAgentConnector_ms": 0.09371042251586914}, "num_episodes": 21, "episode_return_max": 482.97777777777776, "episode_return_min": 279.2744444444443, "episode_return_mean": 370.45807777777765, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119850, "num_agent_steps_trained": 119700, "num_env_steps_sampled": 119850, "num_env_steps_trained": 119700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 223.86810158332415, "num_env_steps_trained_throughput_per_sec": 238.7926416888791, "timesteps_total": 119850, "num_env_steps_sampled_lifetime": 119850, "num_agent_steps_sampled_lifetime": 119850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 119850, "timers": {"training_iteration_time_ms": 10171.406, "restore_workers_time_ms": 0.016, "training_step_time_ms": 668.92, "sample_time_ms": 653.897, "synch_weights_time_ms": 13.498}, "counters": {"num_env_steps_sampled": 119850, "num_env_steps_trained": 119700, "num_agent_steps_sampled": 119850, "num_agent_steps_trained": 119700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 799, "num_samples_added_to_queue": 119700}, "done": false, "training_iteration": 55, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-36", "timestamp": 1728601716, "time_this_iter_s": 10.071072340011597, "time_total_s": 569.6874642372131, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698744c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.6874642372131, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.928571428571427, "ram_util_percent": 50.85714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 302918.59375, "policy_loss": 298164.0, "entropy": 22.087554931640625, "entropy_coeff": 0.01, "var_gnorm": 16.353113174438477, "vf_loss": 482084.15625, "vf_explained_var": -0.10522246360778809}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 406.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 122100, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 122100, "num_agent_steps_trained": 121800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 814, "num_samples_added_to_queue": 122100, "learner_queue": {"size_count": 406, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.906, "learner_load_time_ms": 0.409, "learner_load_wait_time_ms": 1281.852, "learner_dequeue_time_ms": 10899.751}}, "env_runners": {"episode_reward_max": 518.7477777777777, "episode_reward_min": 280.0299999999999, "episode_reward_mean": 394.9489111111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 280.0299999999999}, "policy_reward_max": {"default_policy": 518.7477777777777}, "policy_reward_mean": {"default_policy": 394.9489111111111}, "custom_metrics": {"num_consolidated_mean": 1.6776999999999997, "num_consolidated_min": 1.43, "num_consolidated_max": 1.95, "num_overloaded_mean": 0.09949999999999999, "num_overloaded_min": 0.03, "num_overloaded_max": 0.2, "num_moves_mean": 8.0151, "num_moves_min": 7.28, "num_moves_max": 8.6, "mean_accuracy_mean": 39.90597666666665, "mean_accuracy_min": 39.56733333333332, "mean_accuracy_max": 40.14366666666666, "num_model_switches_mean": 4.4585, "num_model_switches_min": 3.7, "num_model_switches_max": 5.09, "num_slav_mean": 0.039507999999999995, "num_slav_min": 0.022899999999999997, "num_slav_max": 0.05858333333333333, "mean_cluster_cpu_util_mean": 0.4572064574035975, "mean_cluster_cpu_util_min": 0.44493765236104243, "mean_cluster_cpu_util_max": 0.4711222670424073, "mean_cluster_mem_util_mean": 0.3062120310248572, "mean_cluster_mem_util_min": 0.2995429116794397, "mean_cluster_mem_util_max": 0.31388072490599617, "reward_consolidation_mean_mean": 1.2307777777777773, "reward_consolidation_mean_min": 0.6666666666666663, "reward_consolidation_mean_max": 1.9999999999999993, "reward_illegal_mean_mean": -0.16583333333333333, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.5970479999999996, "reward_accuracy_mean_min": 3.1967999999999996, "reward_accuracy_mean_max": 3.887266666666667, "reward_sla_mean_mean": -0.7125033333333335, "reward_sla_mean_min": -1.032, "reward_sla_mean_max": -0.4103333333333334, "reward_consolidation_sum_mean": 123.07777777777774, "reward_consolidation_sum_min": 66.66666666666663, "reward_consolidation_sum_max": 199.99999999999994, "reward_illegal_sum_mean": -16.583333333333332, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 359.70480000000003, "reward_accuracy_sum_min": 319.67999999999995, "reward_accuracy_sum_max": 388.7266666666667, "reward_sla_sum_mean": -71.25033333333334, "reward_sla_sum_min": -103.2, "reward_sla_sum_max": -41.03333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3888.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [360.9933333333333, 364.76888888888874, 340.55444444444413, 348.09111111111093, 420.1344444444444, 336.06777777777774, 351.54444444444437, 305.5777777777777, 354.91444444444414, 366.66666666666663, 357.88222222222214, 412.9911111111112, 358.6888888888887, 346.66222222222206, 390.74666666666644, 359.76333333333326, 312.28555555555556, 351.28999999999985, 403.71444444444427, 372.2788888888888, 373.1799999999998, 319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2766220233863696, "mean_inference_ms": 2.430635971460563, "mean_action_processing_ms": 0.10192228815898657, "mean_env_wait_ms": 1.7624367449451446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006531715393066406, "StateBufferConnector_ms": 0.003643512725830078, "ViewRequirementAgentConnector_ms": 0.09372854232788086}, "num_episodes": 24, "episode_return_max": 518.7477777777777, "episode_return_min": 280.0299999999999, "episode_return_mean": 394.9489111111111, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122100, "num_agent_steps_trained": 121800, "num_env_steps_sampled": 122100, "num_env_steps_trained": 121800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 224.13136953400394, "num_env_steps_trained_throughput_per_sec": 209.189278231737, "timesteps_total": 122100, "num_env_steps_sampled_lifetime": 122100, "num_agent_steps_sampled_lifetime": 122100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 122100, "timers": {"training_iteration_time_ms": 10147.654, "restore_workers_time_ms": 0.013, "training_step_time_ms": 670.748, "sample_time_ms": 653.404, "synch_weights_time_ms": 15.765}, "counters": {"num_env_steps_sampled": 122100, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 122100, "num_agent_steps_trained": 121800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 814, "num_samples_added_to_queue": 122100}, "done": false, "training_iteration": 56, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-47", "timestamp": 1728601727, "time_this_iter_s": 10.048842191696167, "time_total_s": 579.7363064289093, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefb400>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 579.7363064289093, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.626666666666665, "ram_util_percent": 51.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 314290.78125, "policy_loss": 309427.90625, "entropy": 22.019855499267578, "entropy_coeff": 0.01, "var_gnorm": 16.35907745361328, "vf_loss": 492893.40625, "vf_explained_var": -0.0988762378692627}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 414.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 124350, "num_env_steps_trained": 124200, "num_agent_steps_sampled": 124350, "num_agent_steps_trained": 124200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 829, "num_samples_added_to_queue": 124200, "learner_queue": {"size_count": 414, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.749, "learner_load_time_ms": 0.409, "learner_load_wait_time_ms": 1303.552, "learner_dequeue_time_ms": 10908.517}}, "env_runners": {"episode_reward_max": 518.7477777777777, "episode_reward_min": 280.0299999999999, "episode_reward_mean": 415.069411111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 280.0299999999999}, "policy_reward_max": {"default_policy": 518.7477777777777}, "policy_reward_mean": {"default_policy": 415.069411111111}, "custom_metrics": {"num_consolidated_mean": 1.7258999999999998, "num_consolidated_min": 1.43, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.0922, "num_overloaded_min": 0.03, "num_overloaded_max": 0.2, "num_moves_mean": 7.8935, "num_moves_min": 7.28, "num_moves_max": 8.53, "mean_accuracy_mean": 39.87259999999999, "mean_accuracy_min": 39.56733333333332, "mean_accuracy_max": 40.14366666666666, "num_model_switches_mean": 4.3488999999999995, "num_model_switches_min": 3.7, "num_model_switches_max": 5.09, "num_slav_mean": 0.036909, "num_slav_min": 0.022899999999999997, "num_slav_max": 0.05858333333333333, "mean_cluster_cpu_util_mean": 0.4561776312190276, "mean_cluster_cpu_util_min": 0.442218589886942, "mean_cluster_cpu_util_max": 0.4711222670424073, "mean_cluster_mem_util_mean": 0.30531312288311946, "mean_cluster_mem_util_min": 0.2958699935775998, "mean_cluster_mem_util_max": 0.31388072490599617, "reward_consolidation_mean_mean": 1.353444444444444, "reward_consolidation_mean_min": 0.6666666666666663, "reward_consolidation_mean_max": 1.9999999999999993, "reward_illegal_mean_mean": -0.15366666666666665, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.620823, "reward_accuracy_mean_min": 3.1967999999999996, "reward_accuracy_mean_max": 3.887266666666667, "reward_sla_mean_mean": -0.6699066666666667, "reward_sla_mean_min": -1.032, "reward_sla_mean_max": -0.4073333333333333, "reward_consolidation_sum_mean": 135.3444444444444, "reward_consolidation_sum_min": 66.66666666666663, "reward_consolidation_sum_max": 199.99999999999994, "reward_illegal_sum_mean": -15.366666666666667, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 362.0823, "reward_accuracy_sum_min": 319.67999999999995, "reward_accuracy_sum_max": 388.7266666666667, "reward_sla_sum_mean": -66.99066666666667, "reward_sla_sum_min": -103.2, "reward_sla_sum_max": -40.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2955.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [319.09888888888895, 403.3166666666664, 313.0488888888887, 324.9799999999999, 362.5900000000001, 280.0299999999999, 345.53777777777765, 421.8233333333333, 336.9277777777779, 332.191111111111, 315.44000000000005, 329.9588888888888, 353.4499999999999, 387.74888888888887, 385.2877777777776, 340.6588888888888, 387.8588888888887, 394.73444444444453, 437.3488888888886, 350.26555555555535, 342.4322222222219, 362.55777777777763, 366.6622222222221, 352.8133333333333, 408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2764453595518013, "mean_inference_ms": 2.427766962490098, "mean_action_processing_ms": 0.10184589822798235, "mean_env_wait_ms": 1.7613033522390464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006758689880371094, "StateBufferConnector_ms": 0.003646373748779297, "ViewRequirementAgentConnector_ms": 0.09390640258789062}, "num_episodes": 21, "episode_return_max": 518.7477777777777, "episode_return_min": 280.0299999999999, "episode_return_mean": 415.069411111111, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124350, "num_agent_steps_trained": 124200, "num_env_steps_sampled": 124350, "num_env_steps_trained": 124200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 218.55648491136245, "num_env_steps_trained_throughput_per_sec": 233.1269172387866, "timesteps_total": 124350, "num_env_steps_sampled_lifetime": 124350, "num_agent_steps_sampled_lifetime": 124350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 124350, "timers": {"training_iteration_time_ms": 10143.108, "restore_workers_time_ms": 0.014, "training_step_time_ms": 666.546, "sample_time_ms": 648.822, "synch_weights_time_ms": 16.032}, "counters": {"num_env_steps_sampled": 124350, "num_env_steps_trained": 124200, "num_agent_steps_sampled": 124350, "num_agent_steps_trained": 124200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 829, "num_samples_added_to_queue": 124200}, "done": false, "training_iteration": 57, "trial_id": "3f041_00000", "date": "2024-10-11_00-08-57", "timestamp": 1728601737, "time_this_iter_s": 10.305087804794312, "time_total_s": 590.0413942337036, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9540>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.0413942337036, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.442857142857147, "ram_util_percent": 51.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 314448.875, "policy_loss": 309314.0625, "entropy": 22.064619064331055, "entropy_coeff": 0.01, "var_gnorm": 16.358320236206055, "vf_loss": 520099.71875, "vf_explained_var": -0.08744406700134277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 421.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 126600, "learner_queue": {"size_count": 421, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.655, "learner_load_time_ms": 0.425, "learner_load_wait_time_ms": 1292.017, "learner_dequeue_time_ms": 10885.904}}, "env_runners": {"episode_reward_max": 518.7477777777777, "episode_reward_min": 300.8311111111112, "episode_reward_mean": 436.28189999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 300.8311111111112}, "policy_reward_max": {"default_policy": 518.7477777777777}, "policy_reward_mean": {"default_policy": 436.28189999999995}, "custom_metrics": {"num_consolidated_mean": 1.7701999999999998, "num_consolidated_min": 1.54, "num_consolidated_max": 1.99, "num_overloaded_mean": 0.0821, "num_overloaded_min": 0.03, "num_overloaded_max": 0.18, "num_moves_mean": 7.7970999999999995, "num_moves_min": 7.28, "num_moves_max": 8.53, "mean_accuracy_mean": 39.847963333333325, "mean_accuracy_min": 39.56733333333332, "mean_accuracy_max": 40.09299999999998, "num_model_switches_mean": 4.2351, "num_model_switches_min": 3.68, "num_model_switches_max": 4.84, "num_slav_mean": 0.03461616666666666, "num_slav_min": 0.022583333333333334, "num_slav_max": 0.056499999999999995, "mean_cluster_cpu_util_mean": 0.45509503697190423, "mean_cluster_cpu_util_min": 0.442218589886942, "mean_cluster_cpu_util_max": 0.46862891655699535, "mean_cluster_mem_util_mean": 0.30459576844735786, "mean_cluster_mem_util_min": 0.2958699935775998, "mean_cluster_mem_util_max": 0.311607473305778, "reward_consolidation_mean_mean": 1.4751666666666663, "reward_consolidation_mean_min": 0.7111111111111106, "reward_consolidation_mean_max": 1.9999999999999993, "reward_illegal_mean_mean": -0.13683333333333333, "reward_illegal_mean_min": -0.3, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.6581490000000003, "reward_accuracy_mean_min": 3.2688666666666664, "reward_accuracy_mean_max": 3.872066666666666, "reward_sla_mean_mean": -0.6336633333333334, "reward_sla_mean_min": -1.032, "reward_sla_mean_max": -0.4073333333333333, "reward_consolidation_sum_mean": 147.51666666666665, "reward_consolidation_sum_min": 71.11111111111106, "reward_consolidation_sum_max": 199.99999999999994, "reward_illegal_sum_mean": -13.683333333333332, "reward_illegal_sum_min": -30.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 365.81489999999997, "reward_accuracy_sum_min": 326.88666666666666, "reward_accuracy_sum_max": 387.2066666666666, "reward_sla_sum_mean": -63.366333333333344, "reward_sla_sum_min": -103.2, "reward_sla_sum_max": -40.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2034.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [408.8277777777777, 421.08777777777755, 360.0477777777778, 383.2155555555553, 398.8566666666665, 381.4833333333332, 351.3277777777776, 390.5877777777775, 353.4877777777778, 407.32, 388.75222222222226, 434.3366666666665, 407.91222222222206, 394.80777777777763, 428.72444444444443, 457.70111111111106, 414.5899999999995, 417.29222222222216, 392.2411111111111, 442.7511111111108, 382.1099999999999, 392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27622111254416754, "mean_inference_ms": 2.4245562917970345, "mean_action_processing_ms": 0.10175529217832327, "mean_env_wait_ms": 1.7598674984308844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006714582443237305, "StateBufferConnector_ms": 0.003628969192504883, "ViewRequirementAgentConnector_ms": 0.09343314170837402}, "num_episodes": 24, "episode_return_max": 518.7477777777777, "episode_return_min": 300.8311111111112, "episode_return_mean": 436.28189999999995, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 219.3327051666731, "num_env_steps_trained_throughput_per_sec": 204.71052482222822, "timesteps_total": 126600, "num_env_steps_sampled_lifetime": 126600, "num_agent_steps_sampled_lifetime": 126600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 126600, "timers": {"training_iteration_time_ms": 10166.514, "restore_workers_time_ms": 0.013, "training_step_time_ms": 675.925, "sample_time_ms": 659.503, "synch_weights_time_ms": 15.002}, "counters": {"num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 126600}, "done": false, "training_iteration": 58, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-07", "timestamp": 1728601747, "time_this_iter_s": 10.268903017044067, "time_total_s": 600.3102972507477, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefaaa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 600.3102972507477, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.540000000000003, "ram_util_percent": 51.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 300005.5625, "policy_loss": 295246.78125, "entropy": 21.963376998901367, "entropy_coeff": 0.01, "var_gnorm": 16.359384536743164, "vf_loss": 482467.0, "vf_explained_var": -0.07268154621124268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 429.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 128850, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 128850, "num_agent_steps_trained": 128700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 859, "num_samples_added_to_queue": 128700, "learner_queue": {"size_count": 429, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.12, "learner_load_time_ms": 0.411, "learner_load_wait_time_ms": 1292.277, "learner_dequeue_time_ms": 10882.602}}, "env_runners": {"episode_reward_max": 518.7477777777777, "episode_reward_min": 300.8311111111112, "episode_reward_mean": 447.0130333333332, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 300.8311111111112}, "policy_reward_max": {"default_policy": 518.7477777777777}, "policy_reward_mean": {"default_policy": 447.0130333333332}, "custom_metrics": {"num_consolidated_mean": 1.797, "num_consolidated_min": 1.54, "num_consolidated_max": 1.99, "num_overloaded_mean": 0.0781, "num_overloaded_min": 0.03, "num_overloaded_max": 0.18, "num_moves_mean": 7.7263, "num_moves_min": 7.28, "num_moves_max": 8.25, "mean_accuracy_mean": 39.82883666666665, "mean_accuracy_min": 39.56733333333332, "mean_accuracy_max": 40.02966666666665, "num_model_switches_mean": 4.156199999999999, "num_model_switches_min": 3.68, "num_model_switches_max": 4.78, "num_slav_mean": 0.03343633333333333, "num_slav_min": 0.022583333333333334, "num_slav_max": 0.04623333333333334, "mean_cluster_cpu_util_mean": 0.45411812051261313, "mean_cluster_cpu_util_min": 0.4398587777584077, "mean_cluster_cpu_util_max": 0.46862891655699535, "mean_cluster_mem_util_mean": 0.30408434819814, "mean_cluster_mem_util_min": 0.2958699935775998, "mean_cluster_mem_util_max": 0.311607473305778, "reward_consolidation_mean_mean": 1.5426666666666662, "reward_consolidation_mean_min": 0.7111111111111106, "reward_consolidation_mean_max": 1.9999999999999993, "reward_illegal_mean_mean": -0.13016666666666665, "reward_illegal_mean_min": -0.3, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.6722836666666665, "reward_accuracy_mean_min": 3.2688666666666664, "reward_accuracy_mean_max": 3.872066666666666, "reward_sla_mean_mean": -0.6146533333333333, "reward_sla_mean_min": -0.8413333333333335, "reward_sla_mean_max": -0.4073333333333333, "reward_consolidation_sum_mean": 154.26666666666665, "reward_consolidation_sum_min": 71.11111111111106, "reward_consolidation_sum_max": 199.99999999999994, "reward_illegal_sum_mean": -13.016666666666666, "reward_illegal_sum_min": -30.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 367.2283666666666, "reward_accuracy_sum_min": 326.88666666666666, "reward_accuracy_sum_max": 387.2066666666666, "reward_sla_sum_mean": -61.46533333333335, "reward_sla_sum_min": -84.13333333333335, "reward_sla_sum_max": -40.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2271.0, "global_timestep_min": 300, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [392.55666666666673, 473.696666666667, 429.61, 461.72222222222246, 385.7666666666666, 300.8311111111112, 415.2177777777778, 442.7699999999999, 482.97777777777776, 442.9911111111109, 438.39777777777766, 448.31222222222215, 514.3911111111114, 392.9433333333331, 448.0777777777779, 466.67222222222216, 422.88999999999993, 426.6599999999999, 416.20888888888857, 441.8999999999999, 448.11222222222204, 386.7544444444441, 452.51444444444434, 408.7344444444445, 468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.276062424087459, "mean_inference_ms": 2.4222936034465565, "mean_action_processing_ms": 0.10169661155828802, "mean_env_wait_ms": 1.7589376822562948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006673097610473633, "StateBufferConnector_ms": 0.003621339797973633, "ViewRequirementAgentConnector_ms": 0.0924689769744873}, "num_episodes": 21, "episode_return_max": 518.7477777777777, "episode_return_min": 300.8311111111112, "episode_return_mean": 447.0130333333332, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128850, "num_agent_steps_trained": 128700, "num_env_steps_sampled": 128850, "num_env_steps_trained": 128700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 219.10845239011502, "num_env_steps_trained_throughput_per_sec": 233.71568254945603, "timesteps_total": 128850, "num_env_steps_sampled_lifetime": 128850, "num_agent_steps_sampled_lifetime": 128850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 128850, "timers": {"training_iteration_time_ms": 10173.14, "restore_workers_time_ms": 0.013, "training_step_time_ms": 695.438, "sample_time_ms": 678.243, "synch_weights_time_ms": 15.605}, "counters": {"num_env_steps_sampled": 128850, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 128850, "num_agent_steps_trained": 128700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 859, "num_samples_added_to_queue": 128700}, "done": false, "training_iteration": 59, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-18", "timestamp": 1728601758, "time_this_iter_s": 10.280921459197998, "time_total_s": 610.5912187099457, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9180>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.5912187099457, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.540000000000003, "ram_util_percent": 51.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 313282.625, "policy_loss": 308125.46875, "entropy": 21.783544540405273, "entropy_coeff": 0.01, "var_gnorm": 16.36233139038086, "vf_loss": 522251.34375, "vf_explained_var": -0.0766446590423584}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 436.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 131100, "num_env_steps_trained": 130800, "num_agent_steps_sampled": 131100, "num_agent_steps_trained": 130800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 874, "num_samples_added_to_queue": 131100, "learner_queue": {"size_count": 436, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.716, "learner_load_time_ms": 0.386, "learner_load_wait_time_ms": 1297.74, "learner_dequeue_time_ms": 10906.013}}, "env_runners": {"episode_reward_max": 518.7477777777777, "episode_reward_min": 375.7055555555554, "episode_reward_mean": 453.83372222222226, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 375.7055555555554}, "policy_reward_max": {"default_policy": 518.7477777777777}, "policy_reward_mean": {"default_policy": 453.83372222222226}, "custom_metrics": {"num_consolidated_mean": 1.8175000000000003, "num_consolidated_min": 1.64, "num_consolidated_max": 1.99, "num_overloaded_mean": 0.0762, "num_overloaded_min": 0.02, "num_overloaded_max": 0.17, "num_moves_mean": 7.692199999999998, "num_moves_min": 7.28, "num_moves_max": 8.25, "mean_accuracy_mean": 39.82269333333332, "mean_accuracy_min": 39.62433333333332, "mean_accuracy_max": 40.02966666666665, "num_model_switches_mean": 4.1338, "num_model_switches_min": 3.68, "num_model_switches_max": 4.78, "num_slav_mean": 0.0331245, "num_slav_min": 0.022583333333333334, "num_slav_max": 0.04623333333333334, "mean_cluster_cpu_util_mean": 0.45315308165343227, "mean_cluster_cpu_util_min": 0.4398587777584077, "mean_cluster_cpu_util_max": 0.46862891655699535, "mean_cluster_mem_util_mean": 0.3036255529453343, "mean_cluster_mem_util_min": 0.2958699935775998, "mean_cluster_mem_util_max": 0.31010039126410055, "reward_consolidation_mean_mean": 1.596722222222222, "reward_consolidation_mean_min": 1.105555555555555, "reward_consolidation_mean_max": 1.9999999999999993, "reward_illegal_mean_mean": -0.127, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.6804516666666673, "reward_accuracy_mean_min": 3.3169333333333326, "reward_accuracy_mean_max": 3.9131666666666667, "reward_sla_mean_mean": -0.6118366666666667, "reward_sla_mean_min": -0.8413333333333335, "reward_sla_mean_max": -0.4073333333333333, "reward_consolidation_sum_mean": 159.67222222222216, "reward_consolidation_sum_min": 110.55555555555549, "reward_consolidation_sum_max": 199.99999999999994, "reward_illegal_sum_mean": -12.699999999999998, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 368.04516666666655, "reward_accuracy_sum_min": 331.69333333333327, "reward_accuracy_sum_max": 391.31666666666666, "reward_sla_sum_mean": -61.18366666666666, "reward_sla_sum_min": -84.13333333333335, "reward_sla_sum_max": -40.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3066.0, "global_timestep_min": 1000, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [468.4177777777776, 515.7533333333336, 456.2555555555553, 461.57, 439.73888888888894, 379.2988888888888, 509.7888888888891, 427.3266666666666, 424.2644444444442, 518.7477777777777, 462.9777777777778, 493.4833333333334, 489.2244444444445, 460.8822222222221, 462.56222222222215, 476.85777777777804, 452.43444444444435, 456.3977777777779, 411.8266666666665, 482.01999999999975, 394.33222222222224, 456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2758952314817028, "mean_inference_ms": 2.419824966094238, "mean_action_processing_ms": 0.10163371844562104, "mean_env_wait_ms": 1.757869585639081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00653529167175293, "StateBufferConnector_ms": 0.003641366958618164, "ViewRequirementAgentConnector_ms": 0.0933687686920166}, "num_episodes": 24, "episode_return_max": 518.7477777777777, "episode_return_min": 375.7055555555554, "episode_return_mean": 453.83372222222226, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131100, "num_agent_steps_trained": 130800, "num_env_steps_sampled": 131100, "num_env_steps_trained": 130800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 222.6495086364832, "num_env_steps_trained_throughput_per_sec": 207.80620806071767, "timesteps_total": 131100, "num_env_steps_sampled_lifetime": 131100, "num_agent_steps_sampled_lifetime": 131100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 131100, "timers": {"training_iteration_time_ms": 10154.97, "restore_workers_time_ms": 0.013, "training_step_time_ms": 674.187, "sample_time_ms": 657.108, "synch_weights_time_ms": 15.493}, "counters": {"num_env_steps_sampled": 131100, "num_env_steps_trained": 130800, "num_agent_steps_sampled": 131100, "num_agent_steps_trained": 130800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 874, "num_samples_added_to_queue": 131100}, "done": false, "training_iteration": 60, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-28", "timestamp": 1728601768, "time_this_iter_s": 10.116988897323608, "time_total_s": 620.7082076072693, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae532e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 620.7082076072693, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.771428571428572, "ram_util_percent": 51.464285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 309252.90625, "policy_loss": 304060.4375, "entropy": 21.34344482421875, "entropy_coeff": 0.01, "var_gnorm": 16.3681583404541, "vf_loss": 525648.5625, "vf_explained_var": -0.07446956634521484}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 444.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 889, "num_samples_added_to_queue": 133200, "learner_queue": {"size_count": 444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.682, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1326.015, "learner_dequeue_time_ms": 10909.001}}, "env_runners": {"episode_reward_max": 518.95, "episode_reward_min": 375.7055555555554, "episode_reward_mean": 458.57696666666664, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 375.7055555555554}, "policy_reward_max": {"default_policy": 518.95}, "policy_reward_mean": {"default_policy": 458.57696666666664}, "custom_metrics": {"num_consolidated_mean": 1.8222, "num_consolidated_min": 1.64, "num_consolidated_max": 1.99, "num_overloaded_mean": 0.0727, "num_overloaded_min": 0.02, "num_overloaded_max": 0.14, "num_moves_mean": 7.6639, "num_moves_min": 7.25, "num_moves_max": 8.11, "mean_accuracy_mean": 39.81091333333332, "mean_accuracy_min": 39.573666666666654, "mean_accuracy_max": 40.02966666666665, "num_model_switches_mean": 4.0924000000000005, "num_model_switches_min": 3.68, "num_model_switches_max": 4.78, "num_slav_mean": 0.032415333333333324, "num_slav_min": 0.022183333333333333, "num_slav_max": 0.04623333333333334, "mean_cluster_cpu_util_mean": 0.4524290190329248, "mean_cluster_cpu_util_min": 0.4398587777584077, "mean_cluster_cpu_util_max": 0.46862891655699535, "mean_cluster_mem_util_mean": 0.3033320440759637, "mean_cluster_mem_util_min": 0.2958699935775998, "mean_cluster_mem_util_max": 0.31010039126410055, "reward_consolidation_mean_mean": 1.6144999999999998, "reward_consolidation_mean_min": 1.1277777777777773, "reward_consolidation_mean_max": 1.994444444444444, "reward_illegal_mean_mean": -0.12116666666666663, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.6931963333333324, "reward_accuracy_mean_min": 3.435166666666666, "reward_accuracy_mean_max": 3.9131666666666667, "reward_sla_mean_mean": -0.60076, "reward_sla_mean_min": -0.8413333333333335, "reward_sla_mean_max": -0.4073333333333333, "reward_consolidation_sum_mean": 161.44999999999996, "reward_consolidation_sum_min": 112.77777777777774, "reward_consolidation_sum_max": 199.4444444444444, "reward_illegal_sum_mean": -12.116666666666667, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 369.3196333333334, "reward_accuracy_sum_min": 343.5166666666666, "reward_accuracy_sum_max": 391.31666666666666, "reward_sla_sum_mean": -60.07599999999999, "reward_sla_sum_min": -84.13333333333335, "reward_sla_sum_max": -40.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3771.0, "global_timestep_min": 1800, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [456.2266666666668, 459.9833333333332, 497.4844444444445, 491.6844444444445, 449.60444444444437, 416.05444444444413, 512.9811111111112, 408.1555555555554, 453.28222222222195, 412.391111111111, 436.221111111111, 483.0000000000001, 433.26999999999975, 461.4144444444444, 451.57444444444434, 491.49000000000007, 478.20666666666665, 420.4688888888885, 401.9155555555555, 462.5622222222223, 441.5322222222223, 448.9633333333334, 463.0377777777777, 393.52444444444444, 446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.275758084043739, "mean_inference_ms": 2.41787648779024, "mean_action_processing_ms": 0.10159039947736012, "mean_env_wait_ms": 1.7571666627276983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006281137466430664, "StateBufferConnector_ms": 0.0036325454711914062, "ViewRequirementAgentConnector_ms": 0.0928342342376709}, "num_episodes": 21, "episode_return_max": 518.95, "episode_return_min": 375.7055555555554, "episode_return_mean": 458.57696666666664, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 217.8003205804966, "num_env_steps_trained_throughput_per_sec": 232.32034195252967, "timesteps_total": 133350, "num_env_steps_sampled_lifetime": 133350, "num_agent_steps_sampled_lifetime": 133350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 133350, "timers": {"training_iteration_time_ms": 10174.089, "restore_workers_time_ms": 0.013, "training_step_time_ms": 691.033, "sample_time_ms": 674.288, "synch_weights_time_ms": 15.182}, "counters": {"num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 889, "num_samples_added_to_queue": 133200}, "done": false, "training_iteration": 61, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-38", "timestamp": 1728601778, "time_this_iter_s": 10.340151309967041, "time_total_s": 631.0483589172363, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae528f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 631.0483589172363, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.100000000000005, "ram_util_percent": 51.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 312040.03125, "policy_loss": 306778.6875, "entropy": 20.947111129760742, "entropy_coeff": 0.01, "var_gnorm": 16.37406349182129, "vf_loss": 532419.5, "vf_explained_var": -0.07453298568725586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 451.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 135600, "num_env_steps_trained": 135300, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 904, "num_samples_added_to_queue": 135600, "learner_queue": {"size_count": 451, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.272, "learner_load_time_ms": 0.324, "learner_load_wait_time_ms": 1294.81, "learner_dequeue_time_ms": 10897.273}}, "env_runners": {"episode_reward_max": 548.5411111111108, "episode_reward_min": 375.7055555555554, "episode_reward_mean": 467.5178222222223, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 375.7055555555554}, "policy_reward_max": {"default_policy": 548.5411111111108}, "policy_reward_mean": {"default_policy": 467.5178222222223}, "custom_metrics": {"num_consolidated_mean": 1.8395, "num_consolidated_min": 1.64, "num_consolidated_max": 2.01, "num_overloaded_mean": 0.0691, "num_overloaded_min": 0.02, "num_overloaded_max": 0.14, "num_moves_mean": 7.5761, "num_moves_min": 7.02, "num_moves_max": 8.11, "mean_accuracy_mean": 39.796916666666654, "mean_accuracy_min": 39.55466666666665, "mean_accuracy_max": 39.98533333333332, "num_model_switches_mean": 4.027299999999999, "num_model_switches_min": 3.57, "num_model_switches_max": 4.62, "num_slav_mean": 0.031157666666666667, "num_slav_min": 0.021083333333333332, "num_slav_max": 0.04623333333333334, "mean_cluster_cpu_util_mean": 0.45186521093782006, "mean_cluster_cpu_util_min": 0.4398587777584077, "mean_cluster_cpu_util_max": 0.46603991909622694, "mean_cluster_mem_util_mean": 0.30310473586354364, "mean_cluster_mem_util_min": 0.29668011226642554, "mean_cluster_mem_util_max": 0.3109459709305663, "reward_consolidation_mean_mean": 1.661888888888889, "reward_consolidation_mean_min": 1.1333333333333329, "reward_consolidation_mean_max": 2.211111111111111, "reward_illegal_mean_mean": -0.11516666666666665, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.706579333333333, "reward_accuracy_mean_min": 3.435166666666666, "reward_accuracy_mean_max": 3.9131666666666667, "reward_sla_mean_mean": -0.5781233333333333, "reward_sla_mean_min": -0.8413333333333335, "reward_sla_mean_max": -0.4053333333333334, "reward_consolidation_sum_mean": 166.18888888888887, "reward_consolidation_sum_min": 113.33333333333329, "reward_consolidation_sum_max": 221.1111111111111, "reward_illegal_sum_mean": -11.516666666666666, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 370.6579333333333, "reward_accuracy_sum_min": 343.5166666666666, "reward_accuracy_sum_max": 391.31666666666666, "reward_sla_sum_mean": -57.812333333333335, "reward_sla_sum_min": -84.13333333333335, "reward_sla_sum_max": -40.53333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4566.0, "global_timestep_min": 2500, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [446.6944444444445, 416.3177777777774, 463.64000000000004, 433.5555555555555, 405.0966666666664, 473.12444444444475, 432.50333333333333, 437.81444444444435, 480.2333333333336, 411.84999999999985, 451.87777777777796, 432.6144444444444, 423.02444444444427, 375.7055555555554, 463.83555555555563, 480.427777777778, 450.9244444444444, 460.18666666666684, 489.54000000000013, 393.632222222222, 462.2833333333334, 473.36999999999995, 474.2155555555554, 477.29333333333346, 458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27554146501858306, "mean_inference_ms": 2.415270420193614, "mean_action_processing_ms": 0.10152760356169148, "mean_env_wait_ms": 1.756202429844236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006086111068725586, "StateBufferConnector_ms": 0.003589153289794922, "ViewRequirementAgentConnector_ms": 0.09163045883178711}, "num_episodes": 24, "episode_return_max": 548.5411111111108, "episode_return_min": 375.7055555555554, "episode_return_mean": 467.5178222222223, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135300, "num_env_steps_sampled": 135600, "num_env_steps_trained": 135300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 221.67037077046697, "num_env_steps_trained_throughput_per_sec": 206.89234605243584, "timesteps_total": 135600, "num_env_steps_sampled_lifetime": 135600, "num_agent_steps_sampled_lifetime": 135600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 135600, "timers": {"training_iteration_time_ms": 10171.266, "restore_workers_time_ms": 0.013, "training_step_time_ms": 685.478, "sample_time_ms": 668.705, "synch_weights_time_ms": 15.279}, "counters": {"num_env_steps_sampled": 135600, "num_env_steps_trained": 135300, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 904, "num_samples_added_to_queue": 135600}, "done": false, "training_iteration": 62, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-48", "timestamp": 1728601788, "time_this_iter_s": 10.161516189575195, "time_total_s": 641.2098751068115, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae514e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.2098751068115, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.779999999999998, "ram_util_percent": 51.73999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 305045.46875, "policy_loss": 299363.53125, "entropy": 20.59383773803711, "entropy_coeff": 0.01, "var_gnorm": 16.379085540771484, "vf_loss": 574370.8125, "vf_explained_var": -0.06026768684387207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 459.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 137700, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 137700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 920, "num_samples_added_to_queue": 138000, "learner_queue": {"size_count": 459, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.323, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 1266.084, "learner_dequeue_time_ms": 10889.075}}, "env_runners": {"episode_reward_max": 557.606666666667, "episode_reward_min": 413.6177777777779, "episode_reward_mean": 483.76943333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 413.6177777777779}, "policy_reward_max": {"default_policy": 557.606666666667}, "policy_reward_mean": {"default_policy": 483.76943333333327}, "custom_metrics": {"num_consolidated_mean": 1.8713, "num_consolidated_min": 1.68, "num_consolidated_max": 2.05, "num_overloaded_mean": 0.0632, "num_overloaded_min": 0.02, "num_overloaded_max": 0.14, "num_moves_mean": 7.458599999999999, "num_moves_min": 6.91, "num_moves_max": 8.11, "mean_accuracy_mean": 39.78513666666665, "mean_accuracy_min": 39.55466666666665, "mean_accuracy_max": 40.00433333333332, "num_model_switches_mean": 3.9379000000000004, "num_model_switches_min": 3.55, "num_model_switches_max": 4.4, "num_slav_mean": 0.029026333333333328, "num_slav_min": 0.0147, "num_slav_max": 0.04623333333333334, "mean_cluster_cpu_util_mean": 0.4508480853567166, "mean_cluster_cpu_util_min": 0.44188213560228035, "mean_cluster_cpu_util_max": 0.46294550202397855, "mean_cluster_mem_util_mean": 0.30224613461027866, "mean_cluster_mem_util_min": 0.29535326358391456, "mean_cluster_mem_util_max": 0.3109459709305663, "reward_consolidation_mean_mean": 1.7563333333333333, "reward_consolidation_mean_min": 1.2499999999999998, "reward_consolidation_mean_max": 2.299999999999999, "reward_illegal_mean_mean": -0.10533333333333332, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.7295609999999986, "reward_accuracy_mean_min": 3.4616999999999996, "reward_accuracy_mean_max": 3.9131666666666667, "reward_sla_mean_mean": -0.5428666666666667, "reward_sla_mean_min": -0.8413333333333335, "reward_sla_mean_max": -0.29400000000000004, "reward_consolidation_sum_mean": 175.6333333333333, "reward_consolidation_sum_min": 124.99999999999997, "reward_consolidation_sum_max": 229.99999999999991, "reward_illegal_sum_mean": -10.533333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 372.9561, "reward_accuracy_sum_min": 346.16999999999996, "reward_accuracy_sum_max": 391.31666666666666, "reward_sla_sum_mean": -54.28666666666667, "reward_sla_sum_min": -84.13333333333335, "reward_sla_sum_max": -29.400000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5367.0, "global_timestep_min": 3300, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [458.3188888888889, 455.7422222222222, 473.3477777777779, 442.08888888888885, 479.66222222222217, 458.8655555555556, 413.6177777777779, 462.9944444444444, 417.40333333333353, 478.36222222222233, 416.08333333333337, 499.738888888889, 460.6877777777776, 484.3566666666665, 485.58555555555535, 474.0188888888887, 454.8788888888889, 463.0700000000001, 455.9111111111111, 447.8211111111111, 453.72333333333347, 459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2753733805477315, "mean_inference_ms": 2.414474770499769, "mean_action_processing_ms": 0.10149472746877558, "mean_env_wait_ms": 1.7557412929088696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006086111068725586, "StateBufferConnector_ms": 0.003614187240600586, "ViewRequirementAgentConnector_ms": 0.09214138984680176}, "num_episodes": 24, "episode_return_max": 557.606666666667, "episode_return_min": 413.6177777777779, "episode_return_mean": 483.76943333333327, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 137700, "num_env_steps_sampled": 138000, "num_env_steps_trained": 137700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 226.7020865255201, "num_env_steps_trained_throughput_per_sec": 226.7020865255201, "timesteps_total": 138000, "num_env_steps_sampled_lifetime": 138000, "num_agent_steps_sampled_lifetime": 138000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 10212.943, "restore_workers_time_ms": 0.013, "training_step_time_ms": 668.661, "sample_time_ms": 650.717, "synch_weights_time_ms": 16.253}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 137700, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 137700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 920, "num_samples_added_to_queue": 138000}, "done": false, "training_iteration": 63, "trial_id": "3f041_00000", "date": "2024-10-11_00-09-59", "timestamp": 1728601799, "time_this_iter_s": 10.596997737884521, "time_total_s": 651.806872844696, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef8af0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 651.806872844696, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 18.519999999999996, "ram_util_percent": 51.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 338532.03125, "policy_loss": 330878.5, "entropy": 19.88208770751953, "entropy_coeff": 0.01, "var_gnorm": 16.390270233154297, "vf_loss": 771318.1875, "vf_explained_var": -0.04758262634277344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 467.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 140250, "num_env_steps_trained": 140100, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 140100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 935, "num_samples_added_to_queue": 140100, "learner_queue": {"size_count": 467, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.52, "learner_load_time_ms": 0.298, "learner_load_wait_time_ms": 1302.116, "learner_dequeue_time_ms": 10897.561}}, "env_runners": {"episode_reward_max": 601.4322222222224, "episode_reward_min": 415.29888888888877, "episode_reward_mean": 499.0986111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 415.29888888888877}, "policy_reward_max": {"default_policy": 601.4322222222224}, "policy_reward_mean": {"default_policy": 499.0986111111113}, "custom_metrics": {"num_consolidated_mean": 1.8961000000000001, "num_consolidated_min": 1.68, "num_consolidated_max": 2.14, "num_overloaded_mean": 0.05539999999999999, "num_overloaded_min": 0.01, "num_overloaded_max": 0.13, "num_moves_mean": 7.316399999999999, "num_moves_min": 6.64, "num_moves_max": 8.06, "mean_accuracy_mean": 39.77405333333332, "mean_accuracy_min": 39.55466666666665, "mean_accuracy_max": 40.00433333333332, "num_model_switches_mean": 3.8338999999999994, "num_model_switches_min": 3.37, "num_model_switches_max": 4.37, "num_slav_mean": 0.026985166666666668, "num_slav_min": 0.0147, "num_slav_max": 0.039733333333333336, "mean_cluster_cpu_util_mean": 0.45021521420456223, "mean_cluster_cpu_util_min": 0.44188213560228035, "mean_cluster_cpu_util_max": 0.46282551158837015, "mean_cluster_mem_util_mean": 0.3019382604606188, "mean_cluster_mem_util_min": 0.29535326358391456, "mean_cluster_mem_util_max": 0.3109459709305663, "reward_consolidation_mean_mean": 1.8336111111111106, "reward_consolidation_mean_min": 1.2499999999999998, "reward_consolidation_mean_max": 2.4888888888888885, "reward_illegal_mean_mean": -0.09233333333333334, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.7579483333333332, "reward_accuracy_mean_min": 3.4705666666666666, "reward_accuracy_mean_max": 3.9371666666666663, "reward_sla_mean_mean": -0.50824, "reward_sla_mean_min": -0.778, "reward_sla_mean_max": -0.2826666666666667, "reward_consolidation_sum_mean": 183.3611111111111, "reward_consolidation_sum_min": 124.99999999999997, "reward_consolidation_sum_max": 248.88888888888886, "reward_illegal_sum_mean": -9.233333333333334, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 375.7948333333334, "reward_accuracy_sum_min": 347.0566666666667, "reward_accuracy_sum_max": 393.71666666666664, "reward_sla_sum_mean": -50.824, "reward_sla_sum_min": -77.8, "reward_sla_sum_max": -28.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6066.0, "global_timestep_min": 4000, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [459.12444444444424, 440.6633333333333, 486.1777777777778, 470.4411111111111, 475.99555555555526, 415.29888888888877, 457.23111111111115, 437.8933333333333, 488.8366666666669, 436.47999999999996, 465.0733333333333, 464.8344444444445, 504.12666666666695, 478.98444444444436, 507.63222222222225, 499.6411111111112, 493.16333333333347, 453.24888888888876, 465.7511111111111, 472.8144444444447, 479.07111111111107, 518.95, 514.7555555555555, 457.62777777777757, 466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27512085838297806, "mean_inference_ms": 2.41075780118372, "mean_action_processing_ms": 0.10142042863282205, "mean_env_wait_ms": 1.7545460419820773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006163597106933594, "StateBufferConnector_ms": 0.0036699771881103516, "ViewRequirementAgentConnector_ms": 0.09337282180786133}, "num_episodes": 21, "episode_return_max": 601.4322222222224, "episode_return_min": 415.29888888888877, "episode_return_mean": 499.0986111111113, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 140100, "num_env_steps_sampled": 140250, "num_env_steps_trained": 140100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 215.75324638062526, "num_env_steps_trained_throughput_per_sec": 230.1367961393336, "timesteps_total": 140250, "num_env_steps_sampled_lifetime": 140250, "num_agent_steps_sampled_lifetime": 140250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 140250, "timers": {"training_iteration_time_ms": 10251.3, "restore_workers_time_ms": 0.013, "training_step_time_ms": 693.373, "sample_time_ms": 677.34, "synch_weights_time_ms": 14.549}, "counters": {"num_env_steps_sampled": 140250, "num_env_steps_trained": 140100, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 140100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 935, "num_samples_added_to_queue": 140100}, "done": false, "training_iteration": 64, "trial_id": "3f041_00000", "date": "2024-10-11_00-10-09", "timestamp": 1728601809, "time_this_iter_s": 10.446465730667114, "time_total_s": 662.2533385753632, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae51cf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 662.2533385753632, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 18.766666666666662, "ram_util_percent": 52.02666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 325643.59375, "policy_loss": 318139.84375, "entropy": 18.987586975097656, "entropy_coeff": 0.01, "var_gnorm": 16.395503997802734, "vf_loss": 756070.375, "vf_explained_var": -0.04947304725646973}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 474.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 950, "num_samples_added_to_queue": 142500, "learner_queue": {"size_count": 474, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.155, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1308.402, "learner_dequeue_time_ms": 10913.376}}, "env_runners": {"episode_reward_max": 609.7800000000002, "episode_reward_min": 438.882222222222, "episode_reward_mean": 522.6905000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 438.882222222222}, "policy_reward_max": {"default_policy": 609.7800000000002}, "policy_reward_mean": {"default_policy": 522.6905000000002}, "custom_metrics": {"num_consolidated_mean": 1.9487, "num_consolidated_min": 1.73, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.049100000000000005, "num_overloaded_min": 0.01, "num_overloaded_max": 0.13, "num_moves_mean": 7.080400000000001, "num_moves_min": 6.23, "num_moves_max": 7.63, "mean_accuracy_mean": 39.763223333333315, "mean_accuracy_min": 39.55466666666665, "mean_accuracy_max": 40.00433333333332, "num_model_switches_mean": 3.687299999999999, "num_model_switches_min": 3.07, "num_model_switches_max": 4.25, "num_slav_mean": 0.024172333333333334, "num_slav_min": 0.010766666666666667, "num_slav_max": 0.03899999999999999, "mean_cluster_cpu_util_mean": 0.4496690447146615, "mean_cluster_cpu_util_min": 0.44192235649721306, "mean_cluster_cpu_util_max": 0.46282551158837015, "mean_cluster_mem_util_mean": 0.3012967544257154, "mean_cluster_mem_util_min": 0.29318056219323174, "mean_cluster_mem_util_max": 0.3109459709305663, "reward_consolidation_mean_mean": 1.9846666666666661, "reward_consolidation_mean_min": 1.3888888888888886, "reward_consolidation_mean_max": 2.716666666666666, "reward_illegal_mean_mean": -0.08183333333333334, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.781138333333333, "reward_accuracy_mean_min": 3.4705666666666666, "reward_accuracy_mean_max": 3.9371666666666663, "reward_sla_mean_mean": -0.4570666666666666, "reward_sla_mean_min": -0.7643333333333334, "reward_sla_mean_max": -0.19866666666666666, "reward_consolidation_sum_mean": 198.46666666666667, "reward_consolidation_sum_min": 138.88888888888886, "reward_consolidation_sum_max": 271.6666666666666, "reward_illegal_sum_mean": -8.183333333333334, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 378.11383333333316, "reward_accuracy_sum_min": 347.0566666666667, "reward_accuracy_sum_max": 393.71666666666664, "reward_sla_sum_mean": -45.70666666666668, "reward_sla_sum_min": -76.43333333333334, "reward_sla_sum_max": -19.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5229.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [466.94888888888875, 491.18666666666695, 445.8599999999999, 457.2800000000002, 465.86333333333357, 513.0566666666667, 502.6155555555557, 500.1955555555557, 548.5411111111108, 480.8166666666666, 516.4566666666667, 459.6122222222226, 497.61333333333357, 483.2733333333334, 464.848888888889, 451.8066666666666, 510.986666666667, 445.5544444444446, 482.89333333333315, 493.76000000000005, 438.882222222222, 460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2749774620295407, "mean_inference_ms": 2.4103860219002855, "mean_action_processing_ms": 0.1013917386253657, "mean_env_wait_ms": 1.7541977868089378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006143331527709961, "StateBufferConnector_ms": 0.0036885738372802734, "ViewRequirementAgentConnector_ms": 0.09333968162536621}, "num_episodes": 24, "episode_return_max": 609.7800000000002, "episode_return_min": 438.882222222222, "episode_return_mean": 522.6905000000002, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.96922889158765, "num_env_steps_trained_throughput_per_sec": 204.37128029881512, "timesteps_total": 142500, "num_env_steps_sampled_lifetime": 142500, "num_agent_steps_sampled_lifetime": 142500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 142500, "timers": {"training_iteration_time_ms": 10273.785, "restore_workers_time_ms": 0.013, "training_step_time_ms": 690.216, "sample_time_ms": 675.15, "synch_weights_time_ms": 13.485}, "counters": {"num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 950, "num_samples_added_to_queue": 142500}, "done": false, "training_iteration": 65, "trial_id": "3f041_00000", "date": "2024-10-11_00-10-20", "timestamp": 1728601820, "time_this_iter_s": 10.287311315536499, "time_total_s": 672.5406498908997, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae533a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 672.5406498908997, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.014285714285716, "ram_util_percent": 52.157142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 320339.875, "policy_loss": 312460.46875, "entropy": 18.56268310546875, "entropy_coeff": 0.01, "var_gnorm": 16.396772384643555, "vf_loss": 793509.1875, "vf_explained_var": -0.04430735111236572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 482.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 144750, "num_env_steps_trained": 144600, "num_agent_steps_sampled": 144750, "num_agent_steps_trained": 144600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 965, "num_samples_added_to_queue": 144600, "learner_queue": {"size_count": 482, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.144, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 1297.074, "learner_dequeue_time_ms": 10941.782}}, "env_runners": {"episode_reward_max": 627.9866666666671, "episode_reward_min": 460.15555555555557, "episode_reward_mean": 543.7607555555558, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 460.15555555555557}, "policy_reward_max": {"default_policy": 627.9866666666671}, "policy_reward_mean": {"default_policy": 543.7607555555558}, "custom_metrics": {"num_consolidated_mean": 1.9963000000000006, "num_consolidated_min": 1.78, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.044599999999999994, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 6.8863, "num_moves_min": 6.11, "num_moves_max": 7.6, "mean_accuracy_mean": 39.74390666666665, "mean_accuracy_min": 39.55466666666665, "mean_accuracy_max": 40.00433333333332, "num_model_switches_mean": 3.5709000000000004, "num_model_switches_min": 3.03, "num_model_switches_max": 4.08, "num_slav_mean": 0.021313999999999996, "num_slav_min": 0.010733333333333333, "num_slav_max": 0.034249999999999996, "mean_cluster_cpu_util_mean": 0.4495390127494458, "mean_cluster_cpu_util_min": 0.4383579114319723, "mean_cluster_cpu_util_max": 0.46391662568279657, "mean_cluster_mem_util_mean": 0.3010579873632998, "mean_cluster_mem_util_min": 0.29226237029621976, "mean_cluster_mem_util_max": 0.3095847277835185, "reward_consolidation_mean_mean": 2.1202222222222225, "reward_consolidation_mean_min": 1.422222222222222, "reward_consolidation_mean_max": 2.7999999999999994, "reward_illegal_mean_mean": -0.07433333333333332, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.7971253333333332, "reward_accuracy_mean_min": 3.578033333333333, "reward_accuracy_mean_max": 3.9371666666666663, "reward_sla_mean_mean": -0.40540666666666675, "reward_sla_mean_min": -0.653, "reward_sla_mean_max": -0.19866666666666666, "reward_consolidation_sum_mean": 212.02222222222224, "reward_consolidation_sum_min": 142.2222222222222, "reward_consolidation_sum_max": 279.99999999999994, "reward_illegal_sum_mean": -7.433333333333334, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 379.71253333333317, "reward_accuracy_sum_min": 357.8033333333333, "reward_accuracy_sum_max": 393.71666666666664, "reward_sla_sum_mean": -40.540666666666674, "reward_sla_sum_min": -65.3, "reward_sla_sum_max": -19.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4290.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [460.15555555555557, 519.8555555555556, 481.4688888888889, 495.46888888888907, 479.887777777778, 505.43777777777785, 515.0533333333333, 505.6011111111109, 464.3144444444445, 516.63, 518.1633333333336, 519.8777777777781, 476.5255555555555, 466.71999999999986, 495.5399999999999, 512.5333333333336, 504.7088888888888, 500.3311111111113, 524.5166666666669, 481.26444444444456, 526.0988888888888, 536.867777777778, 547.9044444444447, 508.138888888889, 480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274766018582684, "mean_inference_ms": 2.406544482709567, "mean_action_processing_ms": 0.10131947507247663, "mean_env_wait_ms": 1.7529770356791312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062389373779296875, "StateBufferConnector_ms": 0.0037102699279785156, "ViewRequirementAgentConnector_ms": 0.09396481513977051}, "num_episodes": 21, "episode_return_max": 627.9866666666671, "episode_return_min": 460.15555555555557, "episode_return_mean": 543.7607555555558, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144750, "num_agent_steps_trained": 144600, "num_env_steps_sampled": 144750, "num_env_steps_trained": 144600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 223.76909244041792, "num_env_steps_trained_throughput_per_sec": 238.68703193644578, "timesteps_total": 144750, "num_env_steps_sampled_lifetime": 144750, "num_agent_steps_sampled_lifetime": 144750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 144750, "timers": {"training_iteration_time_ms": 10275.41, "restore_workers_time_ms": 0.014, "training_step_time_ms": 672.27, "sample_time_ms": 656.012, "synch_weights_time_ms": 14.71}, "counters": {"num_env_steps_sampled": 144750, "num_env_steps_trained": 144600, "num_agent_steps_sampled": 144750, "num_agent_steps_trained": 144600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 965, "num_samples_added_to_queue": 144600}, "done": false, "training_iteration": 66, "trial_id": "3f041_00000", "date": "2024-10-11_00-10-30", "timestamp": 1728601830, "time_this_iter_s": 10.065900087356567, "time_total_s": 682.6065499782562, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae52dd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 682.6065499782562, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.813333333333333, "ram_util_percent": 52.246666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 323150.0, "policy_loss": 316014.1875, "entropy": 18.9809513092041, "entropy_coeff": 0.01, "var_gnorm": 16.39735221862793, "vf_loss": 719276.1875, "vf_explained_var": -0.039501190185546875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 489.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 980, "num_samples_added_to_queue": 147000, "learner_queue": {"size_count": 489, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.893, "learner_load_time_ms": 0.241, "learner_load_wait_time_ms": 1322.609, "learner_dequeue_time_ms": 10936.979}}, "env_runners": {"episode_reward_max": 627.9866666666671, "episode_reward_min": 471.37, "episode_reward_mean": 562.098577777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 471.37}, "policy_reward_max": {"default_policy": 627.9866666666671}, "policy_reward_mean": {"default_policy": 562.098577777778}, "custom_metrics": {"num_consolidated_mean": 2.0435999999999996, "num_consolidated_min": 1.81, "num_consolidated_max": 2.24, "num_overloaded_mean": 0.041899999999999986, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 6.7010000000000005, "num_moves_min": 6.11, "num_moves_max": 7.46, "mean_accuracy_mean": 39.726109999999984, "mean_accuracy_min": 39.54833333333332, "mean_accuracy_max": 39.93466666666666, "num_model_switches_mean": 3.4776000000000007, "num_model_switches_min": 3.03, "num_model_switches_max": 4.05, "num_slav_mean": 0.019029166666666666, "num_slav_min": 0.006533333333333333, "num_slav_max": 0.03041666666666666, "mean_cluster_cpu_util_mean": 0.4495923780215595, "mean_cluster_cpu_util_min": 0.4383369765722421, "mean_cluster_cpu_util_max": 0.46391662568279657, "mean_cluster_mem_util_mean": 0.30098368653125807, "mean_cluster_mem_util_min": 0.29226237029621976, "mean_cluster_mem_util_max": 0.3095847277835185, "reward_consolidation_mean_mean": 2.248277777777777, "reward_consolidation_mean_min": 1.622222222222222, "reward_consolidation_mean_max": 2.8222222222222215, "reward_illegal_mean_mean": -0.06983333333333333, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.805544666666666, "reward_accuracy_mean_min": 3.578033333333333, "reward_accuracy_mean_max": 3.9371666666666663, "reward_sla_mean_mean": -0.36300333333333334, "reward_sla_mean_min": -0.5770000000000001, "reward_sla_mean_max": -0.114, "reward_consolidation_sum_mean": 224.8277777777777, "reward_consolidation_sum_min": 162.2222222222222, "reward_consolidation_sum_max": 282.2222222222222, "reward_illegal_sum_mean": -6.983333333333333, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 380.55446666666666, "reward_accuracy_sum_min": 357.8033333333333, "reward_accuracy_sum_max": 393.71666666666664, "reward_sla_sum_mean": -36.300333333333334, "reward_sla_sum_min": -57.7, "reward_sla_sum_max": -11.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3218.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [480.08222222222236, 522.1788888888891, 516.8477777777779, 557.606666666667, 525.2477777777781, 544.4355555555558, 512.9622222222224, 546.3422222222224, 513.4377777777783, 496.59, 519.5555555555559, 474.77222222222235, 503.07444444444457, 519.6600000000003, 528.1333333333338, 553.1177777777781, 601.4322222222224, 512.2855555555557, 560.1744444444447, 518.2533333333336, 578.0422222222226, 551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2746259417683598, "mean_inference_ms": 2.4045211644598337, "mean_action_processing_ms": 0.10127281540819244, "mean_env_wait_ms": 1.7522306253481172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006306171417236328, "StateBufferConnector_ms": 0.0037276744842529297, "ViewRequirementAgentConnector_ms": 0.09506821632385254}, "num_episodes": 24, "episode_return_max": 627.9866666666671, "episode_return_min": 471.37, "episode_return_mean": 562.098577777778, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 216.89287445300658, "num_env_steps_trained_throughput_per_sec": 202.43334948947282, "timesteps_total": 147000, "num_env_steps_sampled_lifetime": 147000, "num_agent_steps_sampled_lifetime": 147000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 10283.307, "restore_workers_time_ms": 0.014, "training_step_time_ms": 701.229, "sample_time_ms": 685.242, "synch_weights_time_ms": 14.323}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 980, "num_samples_added_to_queue": 147000}, "done": false, "training_iteration": 67, "trial_id": "3f041_00000", "date": "2024-10-11_00-10-40", "timestamp": 1728601840, "time_this_iter_s": 10.3881676197052, "time_total_s": 692.9947175979614, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef84f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.9947175979614, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.633333333333333, "ram_util_percent": 52.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 327355.0, "policy_loss": 319059.5625, "entropy": 18.929859161376953, "entropy_coeff": 0.01, "var_gnorm": 16.40147590637207, "vf_loss": 835221.625, "vf_explained_var": -0.027746915817260742}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 497.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 149250, "num_env_steps_trained": 149100, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 995, "num_samples_added_to_queue": 149100, "learner_queue": {"size_count": 497, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.771, "learner_load_time_ms": 0.219, "learner_load_wait_time_ms": 1338.185, "learner_dequeue_time_ms": 10972.932}}, "env_runners": {"episode_reward_max": 627.9866666666671, "episode_reward_min": 471.37, "episode_reward_mean": 574.1308222222224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 471.37}, "policy_reward_max": {"default_policy": 627.9866666666671}, "policy_reward_mean": {"default_policy": 574.1308222222224}, "custom_metrics": {"num_consolidated_mean": 2.0701, "num_consolidated_min": 1.82, "num_consolidated_max": 2.24, "num_overloaded_mean": 0.037, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 6.569699999999999, "num_moves_min": 6.0, "num_moves_max": 7.26, "mean_accuracy_mean": 39.707109999999986, "mean_accuracy_min": 39.54833333333332, "mean_accuracy_max": 39.93466666666666, "num_model_switches_mean": 3.4205999999999994, "num_model_switches_min": 3.03, "num_model_switches_max": 3.96, "num_slav_mean": 0.018128666666666664, "num_slav_min": 0.006533333333333333, "num_slav_max": 0.03041666666666666, "mean_cluster_cpu_util_mean": 0.449577982972299, "mean_cluster_cpu_util_min": 0.4383369765722421, "mean_cluster_cpu_util_max": 0.46391662568279657, "mean_cluster_mem_util_mean": 0.3009355817546428, "mean_cluster_mem_util_min": 0.29226237029621976, "mean_cluster_mem_util_max": 0.3095847277835185, "reward_consolidation_mean_mean": 2.327222222222222, "reward_consolidation_mean_min": 1.7166666666666663, "reward_consolidation_mean_max": 2.8222222222222215, "reward_illegal_mean_mean": -0.061666666666666654, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.823169333333333, "reward_accuracy_mean_min": 3.578033333333333, "reward_accuracy_mean_max": 3.9592666666666663, "reward_sla_mean_mean": -0.34741666666666665, "reward_sla_mean_min": -0.5770000000000001, "reward_sla_mean_max": -0.114, "reward_consolidation_sum_mean": 232.72222222222211, "reward_consolidation_sum_min": 171.66666666666663, "reward_consolidation_sum_max": 282.2222222222222, "reward_illegal_sum_mean": -6.166666666666666, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 382.3169333333332, "reward_accuracy_sum_min": 357.8033333333333, "reward_accuracy_sum_max": 395.9266666666666, "reward_sla_sum_mean": -34.74166666666667, "reward_sla_sum_min": -57.7, "reward_sla_sum_max": -11.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2285.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [551.3000000000002, 495.48888888888894, 524.7388888888888, 521.326666666667, 471.37, 489.4333333333333, 557.1922222222227, 573.5388888888893, 552.5866666666666, 563.7199999999999, 546.1555555555559, 554.7233333333332, 566.1722222222224, 599.0811111111113, 602.9666666666669, 609.7800000000002, 587.4411111111115, 594.8900000000001, 584.3988888888888, 575.6300000000002, 564.0322222222226, 560.7100000000002, 537.6511111111113, 537.1800000000002, 576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2745182919889942, "mean_inference_ms": 2.4035550734544793, "mean_action_processing_ms": 0.10125004253321979, "mean_env_wait_ms": 1.7519399296332887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006244182586669922, "StateBufferConnector_ms": 0.0036935806274414062, "ViewRequirementAgentConnector_ms": 0.09391999244689941}, "num_episodes": 21, "episode_return_max": 627.9866666666671, "episode_return_min": 471.37, "episode_return_mean": 574.1308222222224, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149100, "num_env_steps_sampled": 149250, "num_env_steps_trained": 149100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 213.25271662552154, "num_env_steps_trained_throughput_per_sec": 227.46956440055632, "timesteps_total": 149250, "num_env_steps_sampled_lifetime": 149250, "num_agent_steps_sampled_lifetime": 149250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 149250, "timers": {"training_iteration_time_ms": 10312.554, "restore_workers_time_ms": 0.013, "training_step_time_ms": 705.796, "sample_time_ms": 689.424, "synch_weights_time_ms": 14.851}, "counters": {"num_env_steps_sampled": 149250, "num_env_steps_trained": 149100, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 995, "num_samples_added_to_queue": 149100}, "done": false, "training_iteration": 68, "trial_id": "3f041_00000", "date": "2024-10-11_00-10-51", "timestamp": 1728601851, "time_this_iter_s": 10.569141149520874, "time_total_s": 703.5638587474823, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae52230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 703.5638587474823, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.779999999999998, "ram_util_percent": 52.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 298432.84375, "policy_loss": 290884.21875, "entropy": 18.2746639251709, "entropy_coeff": 0.01, "var_gnorm": 16.409801483154297, "vf_loss": 760344.1875, "vf_explained_var": -0.024642229080200195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 504.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 151500, "num_env_steps_trained": 151200, "num_agent_steps_sampled": 151500, "num_agent_steps_trained": 151200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1010, "num_samples_added_to_queue": 151500, "learner_queue": {"size_count": 504, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.766, "learner_load_time_ms": 0.227, "learner_load_wait_time_ms": 1336.879, "learner_dequeue_time_ms": 11015.275}}, "env_runners": {"episode_reward_max": 655.4244444444446, "episode_reward_min": 498.58444444444456, "episode_reward_mean": 584.230677777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 498.58444444444456}, "policy_reward_max": {"default_policy": 655.4244444444446}, "policy_reward_mean": {"default_policy": 584.230677777778}, "custom_metrics": {"num_consolidated_mean": 2.09, "num_consolidated_min": 1.88, "num_consolidated_max": 2.25, "num_overloaded_mean": 0.034, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 6.4349, "num_moves_min": 5.73, "num_moves_max": 7.05, "mean_accuracy_mean": 39.67360666666665, "mean_accuracy_min": 39.484999999999985, "mean_accuracy_max": 39.922, "num_model_switches_mean": 3.3752, "num_model_switches_min": 2.89, "num_model_switches_max": 3.76, "num_slav_mean": 0.016607666666666666, "num_slav_min": 0.006533333333333333, "num_slav_max": 0.02553333333333333, "mean_cluster_cpu_util_mean": 0.4492402280092527, "mean_cluster_cpu_util_min": 0.4383369765722421, "mean_cluster_cpu_util_max": 0.46391662568279657, "mean_cluster_mem_util_mean": 0.30089009369887193, "mean_cluster_mem_util_min": 0.29226237029621976, "mean_cluster_mem_util_max": 0.3095847277835185, "reward_consolidation_mean_mean": 2.386111111111111, "reward_consolidation_mean_min": 1.7499999999999998, "reward_consolidation_mean_max": 2.894444444444444, "reward_illegal_mean_mean": -0.056666666666666664, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8317689999999995, "reward_accuracy_mean_min": 3.6102666666666665, "reward_accuracy_mean_max": 3.962433333333333, "reward_sla_mean_mean": -0.31890666666666667, "reward_sla_mean_min": -0.5096666666666667, "reward_sla_mean_max": -0.114, "reward_consolidation_sum_mean": 238.6111111111111, "reward_consolidation_sum_min": 174.99999999999997, "reward_consolidation_sum_max": 289.4444444444444, "reward_illegal_sum_mean": -5.666666666666666, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 383.1768999999999, "reward_accuracy_sum_min": 361.02666666666664, "reward_accuracy_sum_max": 396.2433333333333, "reward_sla_sum_mean": -31.89066666666667, "reward_sla_sum_min": -50.966666666666676, "reward_sla_sum_max": -11.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2144.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [576.707777777778, 589.536666666667, 567.0344444444445, 535.8466666666667, 582.7033333333335, 567.3411111111113, 600.8000000000003, 522.1866666666668, 572.9588888888891, 567.0777777777781, 627.9866666666671, 557.1688888888891, 599.5777777777781, 598.958888888889, 587.5900000000004, 498.58444444444456, 620.4444444444446, 611.2722222222224, 585.0344444444446, 603.4222222222223, 579.6966666666665, 600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27441675011997146, "mean_inference_ms": 2.4023340262935595, "mean_action_processing_ms": 0.10121973046628288, "mean_env_wait_ms": 1.7515228419962525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006514310836791992, "StateBufferConnector_ms": 0.0036547183990478516, "ViewRequirementAgentConnector_ms": 0.09320950508117676}, "num_episodes": 24, "episode_return_max": 655.4244444444446, "episode_return_min": 498.58444444444456, "episode_return_mean": 584.230677777778, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151500, "num_agent_steps_trained": 151200, "num_env_steps_sampled": 151500, "num_env_steps_trained": 151200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 214.68946912381105, "num_env_steps_trained_throughput_per_sec": 200.37683784889032, "timesteps_total": 151500, "num_env_steps_sampled_lifetime": 151500, "num_agent_steps_sampled_lifetime": 151500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 151500, "timers": {"training_iteration_time_ms": 10333.691, "restore_workers_time_ms": 0.015, "training_step_time_ms": 690.952, "sample_time_ms": 671.969, "synch_weights_time_ms": 17.107}, "counters": {"num_env_steps_sampled": 151500, "num_env_steps_trained": 151200, "num_agent_steps_sampled": 151500, "num_agent_steps_trained": 151200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1010, "num_samples_added_to_queue": 151500}, "done": false, "training_iteration": 69, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-01", "timestamp": 1728601861, "time_this_iter_s": 10.492653131484985, "time_total_s": 714.0565118789673, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef8af0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 714.0565118789673, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.486666666666665, "ram_util_percent": 52.646666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 315570.625, "policy_loss": 306500.21875, "entropy": 17.651432037353516, "entropy_coeff": 0.01, "var_gnorm": 16.41857147216797, "vf_loss": 912337.9375, "vf_explained_var": -0.017635583877563477}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 512.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 153750, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153750, "num_agent_steps_trained": 153600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1025, "num_samples_added_to_queue": 153600, "learner_queue": {"size_count": 512, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.909, "learner_load_time_ms": 0.227, "learner_load_wait_time_ms": 1324.414, "learner_dequeue_time_ms": 11015.275}}, "env_runners": {"episode_reward_max": 656.8688888888887, "episode_reward_min": 516.6766666666671, "episode_reward_mean": 591.3215111111112, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 516.6766666666671}, "policy_reward_max": {"default_policy": 656.8688888888887}, "policy_reward_mean": {"default_policy": 591.3215111111112}, "custom_metrics": {"num_consolidated_mean": 2.1067, "num_consolidated_min": 1.88, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.0324, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 6.2924, "num_moves_min": 5.45, "num_moves_max": 6.86, "mean_accuracy_mean": 39.64820999999999, "mean_accuracy_min": 39.44699999999998, "mean_accuracy_max": 39.922, "num_model_switches_mean": 3.3192000000000004, "num_model_switches_min": 2.89, "num_model_switches_max": 3.76, "num_slav_mean": 0.015619500000000001, "num_slav_min": 0.006533333333333333, "num_slav_max": 0.02448333333333333, "mean_cluster_cpu_util_mean": 0.4484482041933879, "mean_cluster_cpu_util_min": 0.4375519631383921, "mean_cluster_cpu_util_max": 0.46391662568279657, "mean_cluster_mem_util_mean": 0.30053984702129793, "mean_cluster_mem_util_min": 0.29226237029621976, "mean_cluster_mem_util_max": 0.3095847277835185, "reward_consolidation_mean_mean": 2.432444444444444, "reward_consolidation_mean_min": 1.7499999999999998, "reward_consolidation_mean_max": 2.894444444444444, "reward_illegal_mean_mean": -0.05399999999999999, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8357039999999993, "reward_accuracy_mean_min": 3.6102666666666665, "reward_accuracy_mean_max": 3.9681333333333333, "reward_sla_mean_mean": -0.3009333333333334, "reward_sla_mean_min": -0.4896666666666667, "reward_sla_mean_max": -0.114, "reward_consolidation_sum_mean": 243.2444444444444, "reward_consolidation_sum_min": 174.99999999999997, "reward_consolidation_sum_max": 289.4444444444444, "reward_illegal_sum_mean": -5.4, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 383.5704, "reward_accuracy_sum_min": 361.02666666666664, "reward_accuracy_sum_max": 396.81333333333333, "reward_sla_sum_mean": -30.09333333333334, "reward_sla_sum_min": -48.96666666666667, "reward_sla_sum_max": -11.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2771.0, "global_timestep_min": 800, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [600.5255555555556, 548.2611111111112, 596.3744444444447, 568.5477777777778, 572.8877777777781, 568.1311111111115, 581.5533333333334, 565.8855555555556, 539.9266666666668, 613.2477777777782, 621.9155555555558, 574.1822222222223, 593.7366666666668, 616.6011111111114, 516.6766666666671, 574.6366666666668, 570.1788888888891, 599.9644444444447, 589.3266666666668, 578.0444444444446, 566.7044444444448, 611.2922222222227, 597.0444444444446, 565.67, 599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2743283560304222, "mean_inference_ms": 2.4013262970626412, "mean_action_processing_ms": 0.10119574118003555, "mean_env_wait_ms": 1.7512400508688943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067138671875, "StateBufferConnector_ms": 0.0036466121673583984, "ViewRequirementAgentConnector_ms": 0.09258580207824707}, "num_episodes": 21, "episode_return_max": 656.8688888888887, "episode_return_min": 516.6766666666671, "episode_return_mean": 591.3215111111112, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153750, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153750, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 214.89211826737528, "num_env_steps_trained_throughput_per_sec": 229.2182594852003, "timesteps_total": 153750, "num_env_steps_sampled_lifetime": 153750, "num_agent_steps_sampled_lifetime": 153750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 153750, "timers": {"training_iteration_time_ms": 10370.171, "restore_workers_time_ms": 0.016, "training_step_time_ms": 699.141, "sample_time_ms": 680.881, "synch_weights_time_ms": 16.371}, "counters": {"num_env_steps_sampled": 153750, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153750, "num_agent_steps_trained": 153600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1025, "num_samples_added_to_queue": 153600}, "done": false, "training_iteration": 70, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-12", "timestamp": 1728601872, "time_this_iter_s": 10.48503303527832, "time_total_s": 724.5415449142456, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36f3d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.5415449142456, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.093333333333337, "ram_util_percent": 52.76666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 287587.59375, "policy_loss": 279407.71875, "entropy": 17.00716781616211, "entropy_coeff": 0.01, "var_gnorm": 16.42919921875, "vf_loss": 823090.5, "vf_explained_var": -0.014472484588623047}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 519.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 155700, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 155700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1040, "num_samples_added_to_queue": 156000, "learner_queue": {"size_count": 519, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.789, "learner_load_time_ms": 0.222, "learner_load_wait_time_ms": 1339.832, "learner_dequeue_time_ms": 11047.811}}, "env_runners": {"episode_reward_max": 659.5688888888891, "episode_reward_min": 534.1288888888889, "episode_reward_mean": 603.8375555555559, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 534.1288888888889}, "policy_reward_max": {"default_policy": 659.5688888888891}, "policy_reward_mean": {"default_policy": 603.8375555555559}, "custom_metrics": {"num_consolidated_mean": 2.1325999999999996, "num_consolidated_min": 1.92, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.026500000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 6.0851999999999995, "num_moves_min": 5.29, "num_moves_max": 6.86, "mean_accuracy_mean": 39.611033333333324, "mean_accuracy_min": 39.41533333333331, "mean_accuracy_max": 39.922, "num_model_switches_mean": 3.2311, "num_model_switches_min": 2.48, "num_model_switches_max": 3.76, "num_slav_mean": 0.015058000000000002, "num_slav_min": 0.0074, "num_slav_max": 0.02448333333333333, "mean_cluster_cpu_util_mean": 0.4470487600143002, "mean_cluster_cpu_util_min": 0.43661900885003907, "mean_cluster_cpu_util_max": 0.4584479091885318, "mean_cluster_mem_util_mean": 0.3000535301117282, "mean_cluster_mem_util_min": 0.2944028777017136, "mean_cluster_mem_util_max": 0.30780734091104794, "reward_consolidation_mean_mean": 2.5197222222222213, "reward_consolidation_mean_min": 1.955555555555555, "reward_consolidation_mean_max": 3.038888888888888, "reward_illegal_mean_mean": -0.04416666666666665, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8555133333333322, "reward_accuracy_mean_min": 3.6330666666666662, "reward_accuracy_mean_max": 3.9681333333333333, "reward_sla_mean_mean": -0.2926933333333334, "reward_sla_mean_min": -0.4896666666666667, "reward_sla_mean_max": -0.14733333333333337, "reward_consolidation_sum_mean": 251.97222222222214, "reward_consolidation_sum_min": 195.55555555555551, "reward_consolidation_sum_max": 303.8888888888888, "reward_illegal_sum_mean": -4.416666666666666, "reward_illegal_sum_min": -14.999999999999998, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 385.55133333333333, "reward_accuracy_sum_min": 363.3066666666666, "reward_accuracy_sum_max": 396.81333333333333, "reward_sla_sum_mean": -29.26933333333333, "reward_sla_sum_min": -48.96666666666667, "reward_sla_sum_max": -14.733333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3566.0, "global_timestep_min": 1500, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [599.3388888888887, 581.7222222222225, 563.701111111111, 567.2522222222225, 599.1433333333338, 554.3477777777779, 560.8288888888891, 534.1288888888889, 574.9144444444449, 585.4944444444446, 625.7411111111113, 599.9433333333333, 572.8955555555559, 547.7455555555557, 576.0244444444446, 586.2088888888892, 618.3600000000005, 571.5844444444446, 589.358888888889, 585.108888888889, 578.6622222222226, 573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742661892420377, "mean_inference_ms": 2.400683786035955, "mean_action_processing_ms": 0.10117192429289319, "mean_env_wait_ms": 1.7510023187597283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006709098815917969, "StateBufferConnector_ms": 0.0036351680755615234, "ViewRequirementAgentConnector_ms": 0.09195613861083984}, "num_episodes": 24, "episode_return_max": 659.5688888888891, "episode_return_min": 534.1288888888889, "episode_return_mean": 603.8375555555559, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 155700, "num_env_steps_sampled": 156000, "num_env_steps_trained": 155700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 214.77925574624015, "num_env_steps_trained_throughput_per_sec": 200.4606386964908, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10384.702, "restore_workers_time_ms": 0.015, "training_step_time_ms": 719.108, "sample_time_ms": 700.843, "synch_weights_time_ms": 16.529}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 155700, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 155700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1040, "num_samples_added_to_queue": 156000}, "done": false, "training_iteration": 71, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-22", "timestamp": 1728601882, "time_this_iter_s": 10.485267877578735, "time_total_s": 735.0268127918243, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae528c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 735.0268127918243, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.919999999999998, "ram_util_percent": 52.959999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 291530.5625, "policy_loss": 283036.84375, "entropy": 16.56156349182129, "entropy_coeff": 0.01, "var_gnorm": 16.4375, "vf_loss": 854341.3125, "vf_explained_var": -0.008374333381652832}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 158250, "num_env_steps_trained": 158100, "num_agent_steps_sampled": 158250, "num_agent_steps_trained": 158100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1055, "num_samples_added_to_queue": 158100, "learner_queue": {"size_count": 527, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.421, "learner_load_time_ms": 0.231, "learner_load_wait_time_ms": 1357.337, "learner_dequeue_time_ms": 11047.35}}, "env_runners": {"episode_reward_max": 680.8144444444447, "episode_reward_min": 541.2600000000003, "episode_reward_mean": 618.0583666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 541.2600000000003}, "policy_reward_max": {"default_policy": 680.8144444444447}, "policy_reward_mean": {"default_policy": 618.0583666666669}, "custom_metrics": {"num_consolidated_mean": 2.1644, "num_consolidated_min": 1.96, "num_consolidated_max": 2.37, "num_overloaded_mean": 0.022399999999999996, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 5.857499999999999, "num_moves_min": 5.11, "num_moves_max": 6.86, "mean_accuracy_mean": 39.56606666666665, "mean_accuracy_min": 39.408999999999985, "mean_accuracy_max": 39.78266666666666, "num_model_switches_mean": 3.0963000000000007, "num_model_switches_min": 2.48, "num_model_switches_max": 3.62, "num_slav_mean": 0.01376533333333333, "num_slav_min": 0.0074, "num_slav_max": 0.023866666666666668, "mean_cluster_cpu_util_mean": 0.44604826702594463, "mean_cluster_cpu_util_min": 0.43661900885003907, "mean_cluster_cpu_util_max": 0.4584479091885318, "mean_cluster_mem_util_mean": 0.29989071529392347, "mean_cluster_mem_util_min": 0.2944028777017136, "mean_cluster_mem_util_max": 0.30780734091104794, "reward_consolidation_mean_mean": 2.618833333333333, "reward_consolidation_mean_min": 2.0, "reward_consolidation_mean_max": 3.227777777777778, "reward_illegal_mean_mean": -0.03733333333333332, "reward_illegal_mean_min": -0.1, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8674369999999993, "reward_accuracy_mean_min": 3.718366666666666, "reward_accuracy_mean_max": 3.9681333333333333, "reward_sla_mean_mean": -0.26835333333333333, "reward_sla_mean_min": -0.47700000000000004, "reward_sla_mean_max": -0.14733333333333337, "reward_consolidation_sum_mean": 261.88333333333327, "reward_consolidation_sum_min": 200.0, "reward_consolidation_sum_max": 322.77777777777777, "reward_illegal_sum_mean": -3.733333333333333, "reward_illegal_sum_min": -10.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 386.74369999999993, "reward_accuracy_sum_min": 371.8366666666666, "reward_accuracy_sum_max": 396.81333333333333, "reward_sla_sum_mean": -26.835333333333327, "reward_sla_sum_min": -47.7, "reward_sla_sum_max": -14.733333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4271.0, "global_timestep_min": 2300, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [573.478888888889, 611.2377777777778, 625.497777777778, 585.5655555555558, 607.8066666666668, 591.4311111111114, 544.7455555555557, 557.9944444444448, 555.5511111111111, 582.5144444444446, 603.0266666666672, 598.1444444444448, 566.7588888888889, 607.2522222222224, 561.888888888889, 592.2000000000004, 581.5844444444444, 606.6566666666669, 541.2600000000003, 647.7644444444448, 595.7466666666671, 595.2911111111115, 655.4244444444446, 634.0566666666668, 646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27421134538221364, "mean_inference_ms": 2.4000299285800115, "mean_action_processing_ms": 0.10115691699599366, "mean_env_wait_ms": 1.750886996017913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006712913513183594, "StateBufferConnector_ms": 0.0036420822143554688, "ViewRequirementAgentConnector_ms": 0.09200286865234375}, "num_episodes": 21, "episode_return_max": 680.8144444444447, "episode_return_min": 541.2600000000003, "episode_return_mean": 618.0583666666669, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158250, "num_agent_steps_trained": 158100, "num_env_steps_sampled": 158250, "num_env_steps_trained": 158100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 215.54538657358174, "num_env_steps_trained_throughput_per_sec": 229.91507901182052, "timesteps_total": 158250, "num_env_steps_sampled_lifetime": 158250, "num_agent_steps_sampled_lifetime": 158250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 158250, "timers": {"training_iteration_time_ms": 10413.545, "restore_workers_time_ms": 0.014, "training_step_time_ms": 709.6, "sample_time_ms": 691.075, "synch_weights_time_ms": 16.948}, "counters": {"num_env_steps_sampled": 158250, "num_env_steps_trained": 158100, "num_agent_steps_sampled": 158250, "num_agent_steps_trained": 158100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1055, "num_samples_added_to_queue": 158100}, "done": false, "training_iteration": 72, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-33", "timestamp": 1728601893, "time_this_iter_s": 10.457507133483887, "time_total_s": 745.4843199253082, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef8340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 745.4843199253082, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.92, "ram_util_percent": 53.046666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 301214.90625, "policy_loss": 291764.34375, "entropy": 16.33311653137207, "entropy_coeff": 0.01, "var_gnorm": 16.441431045532227, "vf_loss": 949957.625, "vf_explained_var": -0.0032879114151000977}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 534.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 160500, "num_env_steps_trained": 160200, "num_agent_steps_sampled": 160500, "num_agent_steps_trained": 160200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1070, "num_samples_added_to_queue": 160500, "learner_queue": {"size_count": 534, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.477, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1321.732, "learner_dequeue_time_ms": 11089.666}}, "env_runners": {"episode_reward_max": 691.0088888888891, "episode_reward_min": 554.5311111111114, "episode_reward_mean": 632.3800888888891, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 554.5311111111114}, "policy_reward_max": {"default_policy": 691.0088888888891}, "policy_reward_mean": {"default_policy": 632.3800888888891}, "custom_metrics": {"num_consolidated_mean": 2.1997000000000004, "num_consolidated_min": 1.97, "num_consolidated_max": 2.39, "num_overloaded_mean": 0.019000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 5.633500000000001, "num_moves_min": 4.96, "num_moves_max": 6.46, "mean_accuracy_mean": 39.532056666666655, "mean_accuracy_min": 39.40266666666665, "mean_accuracy_max": 39.725666666666655, "num_model_switches_mean": 2.9800999999999997, "num_model_switches_min": 2.48, "num_model_switches_max": 3.59, "num_slav_mean": 0.012377833333333333, "num_slav_min": 0.003633333333333333, "num_slav_max": 0.019749999999999997, "mean_cluster_cpu_util_mean": 0.44485658671864803, "mean_cluster_cpu_util_min": 0.4365809591595005, "mean_cluster_cpu_util_max": 0.455290700195146, "mean_cluster_mem_util_mean": 0.2994960553653951, "mean_cluster_mem_util_min": 0.2938402275467149, "mean_cluster_mem_util_max": 0.30419659092539963, "reward_consolidation_mean_mean": 2.7213888888888884, "reward_consolidation_mean_min": 2.044444444444444, "reward_consolidation_mean_max": 3.305555555555555, "reward_illegal_mean_mean": -0.031666666666666655, "reward_illegal_mean_min": -0.1, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.877655333333334, "reward_accuracy_mean_min": 3.718366666666666, "reward_accuracy_mean_max": 3.9681333333333333, "reward_sla_mean_mean": -0.24357666666666666, "reward_sla_mean_min": -0.381, "reward_sla_mean_max": -0.07266666666666667, "reward_consolidation_sum_mean": 272.1388888888889, "reward_consolidation_sum_min": 204.4444444444444, "reward_consolidation_sum_max": 330.5555555555555, "reward_illegal_sum_mean": -3.166666666666667, "reward_illegal_sum_min": -10.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 387.7655333333333, "reward_accuracy_sum_min": 371.8366666666666, "reward_accuracy_sum_max": 396.81333333333333, "reward_sla_sum_mean": -24.35766666666667, "reward_sla_sum_min": -38.1, "reward_sla_sum_max": -7.2666666666666675, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5066.0, "global_timestep_min": 3000, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [646.0766666666666, 594.5611111111112, 574.1355555555557, 584.837777777778, 578.6188888888892, 609.0711111111112, 607.3644444444446, 568.4577777777781, 626.7833333333335, 554.5311111111114, 598.6622222222223, 619.2311111111112, 610.8744444444446, 600.0277777777779, 623.9322222222225, 607.4966666666667, 656.8688888888887, 565.2366666666669, 599.7266666666666, 595.2055555555557, 613.7522222222226, 605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2741457319792021, "mean_inference_ms": 2.3990559995295384, "mean_action_processing_ms": 0.10113518292123368, "mean_env_wait_ms": 1.7506069298902667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597995758056641, "StateBufferConnector_ms": 0.0036771297454833984, "ViewRequirementAgentConnector_ms": 0.09293317794799805}, "num_episodes": 24, "episode_return_max": 691.0088888888891, "episode_return_min": 554.5311111111114, "episode_return_mean": 632.3800888888891, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160500, "num_agent_steps_trained": 160200, "num_env_steps_sampled": 160500, "num_env_steps_trained": 160200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 217.44873026657262, "num_env_steps_trained_throughput_per_sec": 202.9521482488011, "timesteps_total": 160500, "num_env_steps_sampled_lifetime": 160500, "num_agent_steps_sampled_lifetime": 160500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 160500, "timers": {"training_iteration_time_ms": 10389.613, "restore_workers_time_ms": 0.014, "training_step_time_ms": 683.073, "sample_time_ms": 666.49, "synch_weights_time_ms": 15.017}, "counters": {"num_env_steps_sampled": 160500, "num_env_steps_trained": 160200, "num_agent_steps_sampled": 160500, "num_agent_steps_trained": 160200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1070, "num_samples_added_to_queue": 160500}, "done": false, "training_iteration": 73, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-43", "timestamp": 1728601903, "time_this_iter_s": 10.358246803283691, "time_total_s": 755.8425667285919, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae53ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 755.8425667285919, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.586666666666666, "ram_util_percent": 53.226666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 283633.8125, "policy_loss": 274448.84375, "entropy": 16.1286563873291, "entropy_coeff": 0.01, "var_gnorm": 16.444393157958984, "vf_loss": 923335.375, "vf_explained_var": 0.0018231868743896484}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 541.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 162600, "num_env_steps_trained": 162300, "num_agent_steps_sampled": 162600, "num_agent_steps_trained": 162300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1084, "num_samples_added_to_queue": 162600, "learner_queue": {"size_count": 541, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.404, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1362.256, "learner_dequeue_time_ms": 11135.925}}, "env_runners": {"episode_reward_max": 704.2544444444447, "episode_reward_min": 574.776666666667, "episode_reward_mean": 644.6034111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 574.776666666667}, "policy_reward_max": {"default_policy": 704.2544444444447}, "policy_reward_mean": {"default_policy": 644.6034111111113}, "custom_metrics": {"num_consolidated_mean": 2.2287, "num_consolidated_min": 2.08, "num_consolidated_max": 2.41, "num_overloaded_mean": 0.0159, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 5.462000000000001, "num_moves_min": 4.67, "num_moves_max": 6.41, "mean_accuracy_mean": 39.51096666666665, "mean_accuracy_min": 39.35833333333332, "mean_accuracy_max": 39.725666666666655, "num_model_switches_mean": 2.8912000000000004, "num_model_switches_min": 2.43, "num_model_switches_max": 3.59, "num_slav_mean": 0.011363333333333335, "num_slav_min": 0.003633333333333333, "num_slav_max": 0.019666666666666666, "mean_cluster_cpu_util_mean": 0.4443777800048846, "mean_cluster_cpu_util_min": 0.4365809591595005, "mean_cluster_cpu_util_max": 0.4544051996197582, "mean_cluster_mem_util_mean": 0.2995578549237205, "mean_cluster_mem_util_min": 0.2938402275467149, "mean_cluster_mem_util_max": 0.3043398621157324, "reward_consolidation_mean_mean": 2.8091111111111102, "reward_consolidation_mean_min": 2.2499999999999996, "reward_consolidation_mean_max": 3.3111111111111104, "reward_illegal_mean_mean": -0.026499999999999996, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.887863, "reward_accuracy_mean_min": 3.747433333333333, "reward_accuracy_mean_max": 3.9668666666666663, "reward_sla_mean_mean": -0.22444000000000003, "reward_sla_mean_min": -0.377, "reward_sla_mean_max": -0.07266666666666667, "reward_consolidation_sum_mean": 280.91111111111104, "reward_consolidation_sum_min": 224.99999999999994, "reward_consolidation_sum_max": 331.11111111111103, "reward_illegal_sum_mean": -2.6499999999999995, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 388.7863, "reward_accuracy_sum_min": 374.7433333333333, "reward_accuracy_sum_max": 396.6866666666666, "reward_sla_sum_mean": -22.444000000000006, "reward_sla_sum_min": -37.7, "reward_sla_sum_max": -7.2666666666666675, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5771.0, "global_timestep_min": 3800, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [605.5811111111112, 608.2544444444446, 650.4155555555559, 616.9111111111112, 609.6222222222227, 611.3822222222224, 596.1155555555558, 634.0966666666669, 611.1700000000002, 626.4500000000004, 630.0066666666669, 628.2933333333337, 621.4444444444448, 639.928888888889, 638.4144444444447, 659.5688888888891, 595.9944444444446, 652.338888888889, 647.0122222222224, 647.8044444444444, 645.9300000000003, 631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274134753540213, "mean_inference_ms": 2.3984485315747737, "mean_action_processing_ms": 0.10112845933795189, "mean_env_wait_ms": 1.7505301348368862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006373167037963867, "StateBufferConnector_ms": 0.003724813461303711, "ViewRequirementAgentConnector_ms": 0.09399580955505371}, "num_episodes": 21, "episode_return_max": 704.2544444444447, "episode_return_min": 574.776666666667, "episode_return_mean": 644.6034111111113, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162600, "num_agent_steps_trained": 162300, "num_env_steps_sampled": 162600, "num_env_steps_trained": 162300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 209.2030410693136, "num_env_steps_trained_throughput_per_sec": 209.2030410693136, "timesteps_total": 162600, "num_env_steps_sampled_lifetime": 162600, "num_agent_steps_sampled_lifetime": 162600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 162600, "timers": {"training_iteration_time_ms": 10350.565, "restore_workers_time_ms": 0.012, "training_step_time_ms": 713.331, "sample_time_ms": 696.868, "synch_weights_time_ms": 14.908}, "counters": {"num_env_steps_sampled": 162600, "num_env_steps_trained": 162300, "num_agent_steps_sampled": 162600, "num_agent_steps_trained": 162300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1084, "num_samples_added_to_queue": 162600}, "done": false, "training_iteration": 74, "trial_id": "3f041_00000", "date": "2024-10-11_00-11-53", "timestamp": 1728601913, "time_this_iter_s": 10.051047563552856, "time_total_s": 765.8936142921448, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae534c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 765.8936142921448, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.092857142857138, "ram_util_percent": 53.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 281006.9375, "policy_loss": 271320.84375, "entropy": 15.387994766235352, "entropy_coeff": 0.01, "var_gnorm": 16.444272994995117, "vf_loss": 973225.0625, "vf_explained_var": 0.006564676761627197}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 548.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1098, "num_samples_added_to_queue": 164700, "learner_queue": {"size_count": 548, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.363, "learner_load_time_ms": 0.268, "learner_load_wait_time_ms": 1378.699, "learner_dequeue_time_ms": 11177.587}}, "env_runners": {"episode_reward_max": 717.0511111111113, "episode_reward_min": 574.776666666667, "episode_reward_mean": 653.8956000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 574.776666666667}, "policy_reward_max": {"default_policy": 717.0511111111113}, "policy_reward_mean": {"default_policy": 653.8956000000002}, "custom_metrics": {"num_consolidated_mean": 2.2528, "num_consolidated_min": 2.08, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.014600000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 5.3079, "num_moves_min": 4.67, "num_moves_max": 5.97, "mean_accuracy_mean": 39.486393333333325, "mean_accuracy_min": 39.28233333333331, "mean_accuracy_max": 39.668666666666645, "num_model_switches_mean": 2.8182, "num_model_switches_min": 2.43, "num_model_switches_max": 3.36, "num_slav_mean": 0.010533666666666665, "num_slav_min": 0.0026999999999999997, "num_slav_max": 0.018116666666666666, "mean_cluster_cpu_util_mean": 0.44437421930475735, "mean_cluster_cpu_util_min": 0.4365809591595005, "mean_cluster_cpu_util_max": 0.45269282956128115, "mean_cluster_mem_util_mean": 0.29987266446008787, "mean_cluster_mem_util_min": 0.2938402275467149, "mean_cluster_mem_util_max": 0.30544755285025404, "reward_consolidation_mean_mean": 2.8811666666666658, "reward_consolidation_mean_min": 2.2499999999999996, "reward_consolidation_mean_max": 3.4888888888888885, "reward_illegal_mean_mean": -0.024333333333333332, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.890609333333334, "reward_accuracy_mean_min": 3.747433333333333, "reward_accuracy_mean_max": 3.9668666666666663, "reward_sla_mean_mean": -0.2084866666666667, "reward_sla_mean_min": -0.3623333333333334, "reward_sla_mean_max": -0.054000000000000006, "reward_consolidation_sum_mean": 288.1166666666666, "reward_consolidation_sum_min": 224.99999999999994, "reward_consolidation_sum_max": 348.88888888888886, "reward_illegal_sum_mean": -2.433333333333333, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.06093333333325, "reward_accuracy_sum_min": 374.7433333333333, "reward_accuracy_sum_max": 396.6866666666666, "reward_sla_sum_mean": -20.848666666666666, "reward_sla_sum_min": -36.23333333333334, "reward_sla_sum_max": -5.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5765.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [631.3844444444445, 612.4622222222224, 632.998888888889, 655.5777777777779, 657.4344444444445, 611.9888888888887, 604.2788888888891, 643.3111111111114, 637.5888888888891, 613.6788888888891, 625.4922222222222, 620.4033333333335, 629.5833333333335, 655.3988888888889, 600.2333333333338, 654.5933333333334, 655.9388888888891, 668.5422222222223, 647.2677777777778, 657.9755555555556, 653.2422222222223, 671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274111714306305, "mean_inference_ms": 2.396271797597397, "mean_action_processing_ms": 0.10110604919296151, "mean_env_wait_ms": 1.7501343631893191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006365060806274414, "StateBufferConnector_ms": 0.003783702850341797, "ViewRequirementAgentConnector_ms": 0.09602046012878418}, "num_episodes": 21, "episode_return_max": 717.0511111111113, "episode_return_min": 574.776666666667, "episode_return_mean": 653.8956000000002, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 207.6630881955295, "num_env_steps_trained_throughput_per_sec": 207.6630881955295, "timesteps_total": 164700, "num_env_steps_sampled_lifetime": 164700, "num_agent_steps_sampled_lifetime": 164700, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 164700, "timers": {"training_iteration_time_ms": 10334.276, "restore_workers_time_ms": 0.012, "training_step_time_ms": 726.481, "sample_time_ms": 709.512, "synch_weights_time_ms": 15.092}, "counters": {"num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1098, "num_samples_added_to_queue": 164700}, "done": false, "training_iteration": 75, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-04", "timestamp": 1728601924, "time_this_iter_s": 10.124631881713867, "time_total_s": 776.0182461738586, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b07e170>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 776.0182461738586, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.307142857142857, "ram_util_percent": 53.564285714285724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 271301.1875, "policy_loss": 261668.484375, "entropy": 15.296967506408691, "entropy_coeff": 0.01, "var_gnorm": 16.44641876220703, "vf_loss": 967859.25, "vf_explained_var": 0.012220382690429688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 556.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 166950, "num_env_steps_trained": 166800, "num_agent_steps_sampled": 166950, "num_agent_steps_trained": 166800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1113, "num_samples_added_to_queue": 166800, "learner_queue": {"size_count": 556, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.984, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 1350.636, "learner_dequeue_time_ms": 11236.242}}, "env_runners": {"episode_reward_max": 734.3511111111109, "episode_reward_min": 574.776666666667, "episode_reward_mean": 665.8393555555557, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 574.776666666667}, "policy_reward_max": {"default_policy": 734.3511111111109}, "policy_reward_mean": {"default_policy": 665.8393555555557}, "custom_metrics": {"num_consolidated_mean": 2.2861, "num_consolidated_min": 2.08, "num_consolidated_max": 2.52, "num_overloaded_mean": 0.013500000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 5.145300000000001, "num_moves_min": 4.26, "num_moves_max": 5.71, "mean_accuracy_mean": 39.469419999999985, "mean_accuracy_min": 39.28233333333331, "mean_accuracy_max": 39.668666666666645, "num_model_switches_mean": 2.7610999999999994, "num_model_switches_min": 2.36, "num_model_switches_max": 3.36, "num_slav_mean": 0.009493333333333333, "num_slav_min": 0.0026999999999999997, "num_slav_max": 0.018116666666666666, "mean_cluster_cpu_util_mean": 0.4447421000793539, "mean_cluster_cpu_util_min": 0.4365809591595005, "mean_cluster_cpu_util_max": 0.45624999547799094, "mean_cluster_mem_util_mean": 0.3002425974769655, "mean_cluster_mem_util_min": 0.2938402275467149, "mean_cluster_mem_util_max": 0.30651060736530905, "reward_consolidation_mean_mean": 2.9755555555555553, "reward_consolidation_mean_min": 2.2499999999999996, "reward_consolidation_mean_max": 3.544444444444444, "reward_illegal_mean_mean": -0.022499999999999996, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8933379999999995, "reward_accuracy_mean_min": 3.747433333333333, "reward_accuracy_mean_max": 3.9668666666666663, "reward_sla_mean_mean": -0.188, "reward_sla_mean_min": -0.3623333333333334, "reward_sla_mean_max": -0.054000000000000006, "reward_consolidation_sum_mean": 297.5555555555555, "reward_consolidation_sum_min": 224.99999999999994, "reward_consolidation_sum_max": 354.4444444444444, "reward_illegal_sum_mean": -2.2499999999999996, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.3337999999999, "reward_accuracy_sum_min": 374.7433333333333, "reward_accuracy_sum_max": 396.6866666666666, "reward_sla_sum_mean": -18.8, "reward_sla_sum_min": -36.23333333333334, "reward_sla_sum_max": -5.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4829.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [671.8511111111111, 658.6899999999999, 638.8277777777782, 655.9733333333335, 641.6277777777782, 663.6833333333335, 648.638888888889, 652.0444444444446, 632.0166666666668, 652.0177777777778, 630.4322222222221, 680.8144444444447, 574.776666666667, 664.5777777777779, 623.7511111111111, 641.1877777777783, 646.0133333333333, 654.858888888889, 602.457777777778, 657.4077777777778, 651.2244444444448, 658.2111111111116, 644.1488888888891, 673.9200000000001, 672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2741573606716958, "mean_inference_ms": 2.3958252332492807, "mean_action_processing_ms": 0.10111120368491515, "mean_env_wait_ms": 1.7502847314225292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006366729736328125, "StateBufferConnector_ms": 0.003794431686401367, "ViewRequirementAgentConnector_ms": 0.09623479843139648}, "num_episodes": 21, "episode_return_max": 734.3511111111109, "episode_return_min": 574.776666666667, "episode_return_mean": 665.8393555555557, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166950, "num_agent_steps_trained": 166800, "num_env_steps_sampled": 166950, "num_env_steps_trained": 166800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 214.50920911198807, "num_env_steps_trained_throughput_per_sec": 228.80982305278727, "timesteps_total": 166950, "num_env_steps_sampled_lifetime": 166950, "num_agent_steps_sampled_lifetime": 166950, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 166950, "timers": {"training_iteration_time_ms": 10377.682, "restore_workers_time_ms": 0.013, "training_step_time_ms": 696.978, "sample_time_ms": 679.549, "synch_weights_time_ms": 15.776}, "counters": {"num_env_steps_sampled": 166950, "num_env_steps_trained": 166800, "num_agent_steps_sampled": 166950, "num_agent_steps_trained": 166800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1113, "num_samples_added_to_queue": 166800}, "done": false, "training_iteration": 76, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-14", "timestamp": 1728601934, "time_this_iter_s": 10.499237537384033, "time_total_s": 786.5174837112427, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36f820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 786.5174837112427, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.326666666666664, "ram_util_percent": 53.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 258147.984375, "policy_loss": 248475.015625, "entropy": 14.567912101745605, "entropy_coeff": 0.01, "var_gnorm": 16.45220947265625, "vf_loss": 971667.0, "vf_explained_var": 0.018886685371398926}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1128, "num_samples_added_to_queue": 169200, "learner_queue": {"size_count": 563, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.503, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 1325.307, "learner_dequeue_time_ms": 11273.504}}, "env_runners": {"episode_reward_max": 737.2755555555559, "episode_reward_min": 608.3244444444448, "episode_reward_mean": 677.9780444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 608.3244444444448}, "policy_reward_max": {"default_policy": 737.2755555555559}, "policy_reward_mean": {"default_policy": 677.9780444444444}, "custom_metrics": {"num_consolidated_mean": 2.3217000000000003, "num_consolidated_min": 2.13, "num_consolidated_max": 2.52, "num_overloaded_mean": 0.012700000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.9852, "num_moves_min": 4.26, "num_moves_max": 5.59, "mean_accuracy_mean": 39.44332666666665, "mean_accuracy_min": 39.22533333333331, "mean_accuracy_max": 39.668666666666645, "num_model_switches_mean": 2.6905, "num_model_switches_min": 2.26, "num_model_switches_max": 3.22, "num_slav_mean": 0.008570666666666666, "num_slav_min": 0.0026999999999999997, "num_slav_max": 0.018116666666666666, "mean_cluster_cpu_util_mean": 0.44518018100530554, "mean_cluster_cpu_util_min": 0.4365809591595005, "mean_cluster_cpu_util_max": 0.45624999547799094, "mean_cluster_mem_util_mean": 0.3006009996358248, "mean_cluster_mem_util_min": 0.2938402275467149, "mean_cluster_mem_util_max": 0.30666273357444246, "reward_consolidation_mean_mean": 3.075944444444444, "reward_consolidation_mean_min": 2.511111111111111, "reward_consolidation_mean_max": 3.555555555555555, "reward_illegal_mean_mean": -0.021166666666666657, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.893902666666666, "reward_accuracy_mean_min": 3.748066666666667, "reward_accuracy_mean_max": 3.9668666666666663, "reward_sla_mean_mean": -0.1689, "reward_sla_mean_min": -0.3623333333333334, "reward_sla_mean_max": -0.054000000000000006, "reward_consolidation_sum_mean": 307.5944444444444, "reward_consolidation_sum_min": 251.1111111111111, "reward_consolidation_sum_max": 355.5555555555555, "reward_illegal_sum_mean": -2.1166666666666667, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.39026666666666, "reward_accuracy_sum_min": 374.8066666666667, "reward_accuracy_sum_max": 396.6866666666666, "reward_sla_sum_mean": -16.89, "reward_sla_sum_min": -36.23333333333334, "reward_sla_sum_max": -5.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3755.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [672.3522222222224, 659.3322222222223, 683.5655555555555, 691.0088888888891, 635.5711111111113, 646.7211111111113, 619.1844444444447, 644.5455555555558, 668.2233333333336, 661.0444444444447, 643.1677777777778, 641.468888888889, 671.1066666666669, 649.2444444444444, 669.9344444444446, 633.0855555555559, 697.2444444444443, 622.7011111111113, 669.4755555555554, 681.7833333333336, 651.2699999999999, 657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742081085084131, "mean_inference_ms": 2.395619657054614, "mean_action_processing_ms": 0.10111589098473354, "mean_env_wait_ms": 1.7504408899790196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064356327056884766, "StateBufferConnector_ms": 0.0038247108459472656, "ViewRequirementAgentConnector_ms": 0.09730291366577148}, "num_episodes": 24, "episode_return_max": 737.2755555555559, "episode_return_min": 608.3244444444448, "episode_return_mean": 677.9780444444444, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.63436819893562, "num_env_steps_trained_throughput_per_sec": 201.25874365233992, "timesteps_total": 169200, "num_env_steps_sampled_lifetime": 169200, "num_agent_steps_sampled_lifetime": 169200, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 169200, "timers": {"training_iteration_time_ms": 10383.737, "restore_workers_time_ms": 0.013, "training_step_time_ms": 686.096, "sample_time_ms": 668.969, "synch_weights_time_ms": 15.518}, "counters": {"num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1128, "num_samples_added_to_queue": 169200}, "done": false, "training_iteration": 77, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-25", "timestamp": 1728601945, "time_this_iter_s": 10.445489645004272, "time_total_s": 796.962973356247, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefafb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.962973356247, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.780000000000005, "ram_util_percent": 53.70666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 273306.25, "policy_loss": 263548.4375, "entropy": 14.992450714111328, "entropy_coeff": 0.01, "var_gnorm": 16.458953857421875, "vf_loss": 980279.0, "vf_explained_var": 0.023823201656341553}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 571.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 171450, "num_env_steps_trained": 171300, "num_agent_steps_sampled": 171450, "num_agent_steps_trained": 171300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1143, "num_samples_added_to_queue": 171300, "learner_queue": {"size_count": 571, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.506, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 1324.842, "learner_dequeue_time_ms": 11287.742}}, "env_runners": {"episode_reward_max": 744.4755555555555, "episode_reward_min": 608.3244444444448, "episode_reward_mean": 687.8895222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 608.3244444444448}, "policy_reward_max": {"default_policy": 744.4755555555555}, "policy_reward_mean": {"default_policy": 687.8895222222222}, "custom_metrics": {"num_consolidated_mean": 2.3494, "num_consolidated_min": 2.13, "num_consolidated_max": 2.53, "num_overloaded_mean": 0.011300000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 4.834300000000001, "num_moves_min": 4.25, "num_moves_max": 5.47, "mean_accuracy_mean": 39.419006666666654, "mean_accuracy_min": 39.22533333333331, "mean_accuracy_max": 39.662333333333315, "num_model_switches_mean": 2.6382999999999996, "num_model_switches_min": 2.26, "num_model_switches_max": 3.22, "num_slav_mean": 0.007942166666666669, "num_slav_min": 0.0019166666666666666, "num_slav_max": 0.015599999999999998, "mean_cluster_cpu_util_mean": 0.4456592161786171, "mean_cluster_cpu_util_min": 0.43746856104015613, "mean_cluster_cpu_util_max": 0.45624999547799094, "mean_cluster_mem_util_mean": 0.30116982324944747, "mean_cluster_mem_util_min": 0.29545185298803067, "mean_cluster_mem_util_max": 0.30666273357444246, "reward_consolidation_mean_mean": 3.1573888888888884, "reward_consolidation_mean_min": 2.511111111111111, "reward_consolidation_mean_max": 3.644444444444444, "reward_illegal_mean_mean": -0.01883333333333333, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8970029999999993, "reward_accuracy_mean_min": 3.7809333333333326, "reward_accuracy_mean_max": 3.966233333333333, "reward_sla_mean_mean": -0.15666333333333335, "reward_sla_mean_min": -0.3106666666666667, "reward_sla_mean_max": -0.03833333333333334, "reward_consolidation_sum_mean": 315.7388888888888, "reward_consolidation_sum_min": 251.1111111111111, "reward_consolidation_sum_max": 364.4444444444444, "reward_illegal_sum_mean": -1.8833333333333335, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.7002999999999, "reward_accuracy_sum_min": 378.09333333333325, "reward_accuracy_sum_max": 396.6233333333333, "reward_sla_sum_mean": -15.666333333333332, "reward_sla_sum_min": -31.06666666666667, "reward_sla_sum_max": -3.8333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2819.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [657.8222222222223, 702.0033333333333, 674.0644444444446, 654.3022222222223, 704.2544444444447, 635.1133333333333, 688.3611111111112, 633.4200000000002, 653.3977777777778, 608.3244444444448, 639.7688888888891, 666.4255555555558, 665.7877777777779, 678.1544444444447, 630.6700000000001, 678.9788888888891, 661.4466666666667, 649.9522222222225, 672.0300000000002, 675.7833333333335, 662.2822222222225, 668.5233333333337, 625.1977777777778, 655.4033333333334, 689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742338465972533, "mean_inference_ms": 2.3953958917763547, "mean_action_processing_ms": 0.10112065424988056, "mean_env_wait_ms": 1.7505908283643612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00641179084777832, "StateBufferConnector_ms": 0.0038194656372070312, "ViewRequirementAgentConnector_ms": 0.09717917442321777}, "num_episodes": 21, "episode_return_max": 744.4755555555555, "episode_return_min": 608.3244444444448, "episode_return_mean": 687.8895222222222, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171450, "num_agent_steps_trained": 171300, "num_env_steps_sampled": 171450, "num_env_steps_trained": 171300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 211.4761051338213, "num_env_steps_trained_throughput_per_sec": 225.57451214274272, "timesteps_total": 171450, "num_env_steps_sampled_lifetime": 171450, "num_agent_steps_sampled_lifetime": 171450, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 171450, "timers": {"training_iteration_time_ms": 10392.601, "restore_workers_time_ms": 0.015, "training_step_time_ms": 706.504, "sample_time_ms": 689.485, "synch_weights_time_ms": 15.475}, "counters": {"num_env_steps_sampled": 171450, "num_env_steps_trained": 171300, "num_agent_steps_sampled": 171450, "num_agent_steps_trained": 171300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1143, "num_samples_added_to_queue": 171300}, "done": false, "training_iteration": 78, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-35", "timestamp": 1728601955, "time_this_iter_s": 10.6489417552948, "time_total_s": 807.6119151115417, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae51ff0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 807.6119151115417, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.31875, "ram_util_percent": 53.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 275363.75, "policy_loss": 265416.5, "entropy": 14.77054500579834, "entropy_coeff": 0.01, "var_gnorm": 16.46417808532715, "vf_loss": 999157.3125, "vf_explained_var": 0.029207170009613037}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 173700, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173700, "num_agent_steps_trained": 173400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1158, "num_samples_added_to_queue": 173700, "learner_queue": {"size_count": 578, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.902, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1348.115, "learner_dequeue_time_ms": 11275.027}}, "env_runners": {"episode_reward_max": 764.2322222222222, "episode_reward_min": 623.4822222222223, "episode_reward_mean": 701.0157, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 623.4822222222223}, "policy_reward_max": {"default_policy": 764.2322222222222}, "policy_reward_mean": {"default_policy": 701.0157}, "custom_metrics": {"num_consolidated_mean": 2.3853999999999997, "num_consolidated_min": 2.21, "num_consolidated_max": 2.57, "num_overloaded_mean": 0.0096, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 4.6994, "num_moves_min": 4.23, "num_moves_max": 5.25, "mean_accuracy_mean": 39.40551666666665, "mean_accuracy_min": 39.22533333333331, "mean_accuracy_max": 39.662333333333315, "num_model_switches_mean": 2.5656, "num_model_switches_min": 2.09, "num_model_switches_max": 3.05, "num_slav_mean": 0.007029166666666666, "num_slav_min": 0.0019166666666666666, "num_slav_max": 0.015599999999999998, "mean_cluster_cpu_util_mean": 0.44647627470648316, "mean_cluster_cpu_util_min": 0.43746856104015613, "mean_cluster_cpu_util_max": 0.4579947259799452, "mean_cluster_mem_util_mean": 0.30183821805304406, "mean_cluster_mem_util_min": 0.29545185298803067, "mean_cluster_mem_util_max": 0.3103348418797899, "reward_consolidation_mean_mean": 3.261999999999999, "reward_consolidation_mean_min": 2.7055555555555553, "reward_consolidation_mean_max": 3.805555555555555, "reward_illegal_mean_mean": -0.016, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.902400333333333, "reward_accuracy_mean_min": 3.7809333333333326, "reward_accuracy_mean_max": 3.966233333333333, "reward_sla_mean_mean": -0.13824333333333333, "reward_sla_mean_min": -0.3106666666666667, "reward_sla_mean_max": -0.03833333333333334, "reward_consolidation_sum_mean": 326.19999999999993, "reward_consolidation_sum_min": 270.55555555555554, "reward_consolidation_sum_max": 380.5555555555555, "reward_illegal_sum_mean": -1.5999999999999996, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.24003333333326, "reward_accuracy_sum_min": 378.09333333333325, "reward_accuracy_sum_max": 396.6233333333333, "reward_sla_sum_mean": -13.824333333333334, "reward_sla_sum_min": -31.06666666666667, "reward_sla_sum_max": -3.8333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1983.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [689.5644444444445, 700.1811111111115, 717.0511111111113, 662.387777777778, 623.4822222222223, 691.7233333333335, 676.4655555555559, 661.9377777777778, 709.4900000000004, 715.2488888888889, 706.2811111111109, 699.2622222222222, 695.6288888888886, 663.7177777777777, 705.7066666666666, 695.0133333333334, 674.7288888888892, 673.8822222222226, 663.8344444444443, 670.468888888889, 723.2844444444448, 734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27432032302611997, "mean_inference_ms": 2.3969707758913104, "mean_action_processing_ms": 0.10115346527835062, "mean_env_wait_ms": 1.7512241018790697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006370067596435547, "StateBufferConnector_ms": 0.0037772655487060547, "ViewRequirementAgentConnector_ms": 0.0963430404663086}, "num_episodes": 24, "episode_return_max": 764.2322222222222, "episode_return_min": 623.4822222222223, "episode_return_mean": 701.0157, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173700, "num_agent_steps_trained": 173400, "num_env_steps_sampled": 173700, "num_env_steps_trained": 173400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.45884933793187, "num_env_steps_trained_throughput_per_sec": 201.0949260487364, "timesteps_total": 173700, "num_env_steps_sampled_lifetime": 173700, "num_agent_steps_sampled_lifetime": 173700, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 173700, "timers": {"training_iteration_time_ms": 10388.859, "restore_workers_time_ms": 0.014, "training_step_time_ms": 705.06, "sample_time_ms": 687.351, "synch_weights_time_ms": 15.892}, "counters": {"num_env_steps_sampled": 173700, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173700, "num_agent_steps_trained": 173400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1158, "num_samples_added_to_queue": 173700}, "done": false, "training_iteration": 79, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-46", "timestamp": 1728601966, "time_this_iter_s": 10.459661722183228, "time_total_s": 818.071576833725, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee15a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 818.071576833725, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.57333333333333, "ram_util_percent": 53.87333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 265005.5625, "policy_loss": 254960.71875, "entropy": 14.59496784210205, "entropy_coeff": 0.01, "var_gnorm": 16.46724510192871, "vf_loss": 1008862.625, "vf_explained_var": 0.03266555070877075}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 585.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1172, "num_samples_added_to_queue": 175800, "learner_queue": {"size_count": 585, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.654, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1365.525, "learner_dequeue_time_ms": 11299.901}}, "env_runners": {"episode_reward_max": 764.2322222222222, "episode_reward_min": 659.8944444444446, "episode_reward_mean": 707.535433333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 659.8944444444446}, "policy_reward_max": {"default_policy": 764.2322222222222}, "policy_reward_mean": {"default_policy": 707.535433333333}, "custom_metrics": {"num_consolidated_mean": 2.4048000000000003, "num_consolidated_min": 2.25, "num_consolidated_max": 2.57, "num_overloaded_mean": 0.008900000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 4.6133, "num_moves_min": 4.21, "num_moves_max": 5.17, "mean_accuracy_mean": 39.41178666666664, "mean_accuracy_min": 39.22533333333331, "mean_accuracy_max": 39.58633333333332, "num_model_switches_mean": 2.5339, "num_model_switches_min": 2.09, "num_model_switches_max": 2.87, "num_slav_mean": 0.006757666666666665, "num_slav_min": 0.0019166666666666666, "num_slav_max": 0.013216666666666668, "mean_cluster_cpu_util_mean": 0.4473376622286974, "mean_cluster_cpu_util_min": 0.43746856104015613, "mean_cluster_cpu_util_max": 0.4579947259799452, "mean_cluster_mem_util_mean": 0.3026356072630529, "mean_cluster_mem_util_min": 0.29687453769482475, "mean_cluster_mem_util_max": 0.3103348418797899, "reward_consolidation_mean_mean": 3.3171666666666666, "reward_consolidation_mean_min": 2.927777777777777, "reward_consolidation_mean_max": 3.805555555555555, "reward_illegal_mean_mean": -0.014833333333333332, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9058409999999997, "reward_accuracy_mean_min": 3.807466666666666, "reward_accuracy_mean_max": 3.9586333333333323, "reward_sla_mean_mean": -0.13282000000000002, "reward_sla_mean_min": -0.24800000000000005, "reward_sla_mean_max": -0.03833333333333334, "reward_consolidation_sum_mean": 331.7166666666666, "reward_consolidation_sum_min": 292.7777777777777, "reward_consolidation_sum_max": 380.5555555555555, "reward_illegal_sum_mean": -1.4833333333333332, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.58409999999986, "reward_accuracy_sum_min": 380.7466666666666, "reward_accuracy_sum_max": 395.86333333333323, "reward_sla_sum_mean": -13.281999999999998, "reward_sla_sum_min": -24.800000000000004, "reward_sla_sum_max": -3.8333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2371.0, "global_timestep_min": 400, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [734.3511111111109, 699.5822222222221, 708.791111111111, 705.3177777777777, 712.7977777777778, 667.8744444444446, 659.8944444444446, 679.646666666667, 715.7188888888887, 707.9677777777778, 676.6333333333336, 694.7255555555556, 686.1500000000002, 699.1555555555557, 691.0677777777779, 737.2755555555559, 724.3866666666668, 693.8311111111108, 687.9833333333336, 697.9844444444449, 709.3644444444444, 687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27432974320266656, "mean_inference_ms": 2.3965126223418354, "mean_action_processing_ms": 0.10115358371660144, "mean_env_wait_ms": 1.7512571653168112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064165592193603516, "StateBufferConnector_ms": 0.0038220882415771484, "ViewRequirementAgentConnector_ms": 0.09775209426879883}, "num_episodes": 21, "episode_return_max": 764.2322222222222, "episode_return_min": 659.8944444444446, "episode_return_mean": 707.535433333333, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175500, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 209.3142187446197, "num_env_steps_trained_throughput_per_sec": 209.3142187446197, "timesteps_total": 175800, "num_env_steps_sampled_lifetime": 175800, "num_agent_steps_sampled_lifetime": 175800, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 175800, "timers": {"training_iteration_time_ms": 10345.098, "restore_workers_time_ms": 0.012, "training_step_time_ms": 725.274, "sample_time_ms": 708.106, "synch_weights_time_ms": 15.675}, "counters": {"num_env_steps_sampled": 175800, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1172, "num_samples_added_to_queue": 175800}, "done": false, "training_iteration": 80, "trial_id": "3f041_00000", "date": "2024-10-11_00-12-56", "timestamp": 1728601976, "time_this_iter_s": 10.045475721359253, "time_total_s": 828.1170525550842, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698775e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 828.1170525550842, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 19.035714285714285, "ram_util_percent": 54.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 263658.84375, "policy_loss": 252524.171875, "entropy": 14.606159210205078, "entropy_coeff": 0.01, "var_gnorm": 16.46696662902832, "vf_loss": 1117847.75, "vf_explained_var": 0.036100924015045166}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 592.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1186, "num_samples_added_to_queue": 177900, "learner_queue": {"size_count": 592, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.577, "learner_load_time_ms": 0.331, "learner_load_wait_time_ms": 1390.22, "learner_dequeue_time_ms": 11345.841}}, "env_runners": {"episode_reward_max": 766.6055555555557, "episode_reward_min": 665.3777777777776, "episode_reward_mean": 713.5336111111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 665.3777777777776}, "policy_reward_max": {"default_policy": 766.6055555555557}, "policy_reward_mean": {"default_policy": 713.5336111111111}, "custom_metrics": {"num_consolidated_mean": 2.42, "num_consolidated_min": 2.25, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.008, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.551, "num_moves_min": 4.11, "num_moves_max": 5.13, "mean_accuracy_mean": 39.42571999999998, "mean_accuracy_min": 39.256999999999984, "mean_accuracy_max": 39.62433333333332, "num_model_switches_mean": 2.5047999999999995, "num_model_switches_min": 2.09, "num_model_switches_max": 2.87, "num_slav_mean": 0.006339333333333332, "num_slav_min": 0.0019166666666666666, "num_slav_max": 0.012399999999999998, "mean_cluster_cpu_util_mean": 0.44826749094252605, "mean_cluster_cpu_util_min": 0.43746856104015613, "mean_cluster_cpu_util_max": 0.45854036668879156, "mean_cluster_mem_util_mean": 0.3034205208028358, "mean_cluster_mem_util_min": 0.2975695113593961, "mean_cluster_mem_util_max": 0.3103348418797899, "reward_consolidation_mean_mean": 3.362777777777777, "reward_consolidation_mean_min": 2.927777777777777, "reward_consolidation_mean_max": 3.8222222222222224, "reward_illegal_mean_mean": -0.013333333333333332, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9108383333333334, "reward_accuracy_mean_min": 3.7448999999999995, "reward_accuracy_mean_max": 3.9586333333333323, "reward_sla_mean_mean": -0.12494666666666668, "reward_sla_mean_min": -0.24800000000000005, "reward_sla_mean_max": -0.03833333333333334, "reward_consolidation_sum_mean": 336.27777777777766, "reward_consolidation_sum_min": 292.7777777777777, "reward_consolidation_sum_max": 382.22222222222223, "reward_illegal_sum_mean": -1.333333333333333, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.0838333333333, "reward_accuracy_sum_min": 374.48999999999995, "reward_accuracy_sum_max": 395.86333333333323, "reward_sla_sum_mean": -12.494666666666669, "reward_sla_sum_min": -24.800000000000004, "reward_sla_sum_max": -3.8333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3067.0, "global_timestep_min": 1100, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [687.9733333333335, 691.1911111111114, 693.3400000000001, 693.5033333333337, 723.808888888889, 685.0366666666672, 699.8655555555558, 681.8455555555556, 723.3766666666668, 688.1988888888891, 665.3777777777776, 705.761111111111, 695.1855555555555, 697.2766666666668, 710.247777777778, 694.7588888888888, 717.6700000000003, 733.8411111111113, 718.0522222222222, 711.797777777778, 684.5444444444447, 722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742699095239449, "mean_inference_ms": 2.394403466767585, "mean_action_processing_ms": 0.10113377785799285, "mean_env_wait_ms": 1.750924166035859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006337165832519531, "StateBufferConnector_ms": 0.0037877559661865234, "ViewRequirementAgentConnector_ms": 0.09729170799255371}, "num_episodes": 21, "episode_return_max": 766.6055555555557, "episode_return_min": 665.3777777777776, "episode_return_mean": 713.5336111111111, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 207.21522234781023, "num_env_steps_trained_throughput_per_sec": 207.21522234781023, "timesteps_total": 177900, "num_env_steps_sampled_lifetime": 177900, "num_agent_steps_sampled_lifetime": 177900, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 177900, "timers": {"training_iteration_time_ms": 10310.95, "restore_workers_time_ms": 0.014, "training_step_time_ms": 723.044, "sample_time_ms": 705.406, "synch_weights_time_ms": 16.034}, "counters": {"num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1186, "num_samples_added_to_queue": 177900}, "done": false, "training_iteration": 81, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-06", "timestamp": 1728601986, "time_this_iter_s": 10.146610736846924, "time_total_s": 838.2636632919312, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefad10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 838.2636632919312, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.913333333333334, "ram_util_percent": 54.126666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 250043.40625, "policy_loss": 240305.09375, "entropy": 14.197978973388672, "entropy_coeff": 0.01, "var_gnorm": 16.475387573242188, "vf_loss": 978090.5, "vf_explained_var": 0.04352980852127075}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 600.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 180150, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180150, "num_agent_steps_trained": 180000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1201, "num_samples_added_to_queue": 180000, "learner_queue": {"size_count": 600, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.39, "learner_load_time_ms": 0.331, "learner_load_wait_time_ms": 1348.554, "learner_dequeue_time_ms": 11345.841}}, "env_runners": {"episode_reward_max": 766.6055555555557, "episode_reward_min": 669.1977777777778, "episode_reward_mean": 720.1574444444445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 669.1977777777778}, "policy_reward_max": {"default_policy": 766.6055555555557}, "policy_reward_mean": {"default_policy": 720.1574444444445}, "custom_metrics": {"num_consolidated_mean": 2.4371999999999994, "num_consolidated_min": 2.28, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.0066, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.5035, "num_moves_min": 3.89, "num_moves_max": 5.13, "mean_accuracy_mean": 39.44408666666664, "mean_accuracy_min": 39.28866666666665, "mean_accuracy_max": 39.649666666666654, "num_model_switches_mean": 2.4743, "num_model_switches_min": 2.04, "num_model_switches_max": 2.87, "num_slav_mean": 0.006102666666666666, "num_slav_min": 0.0019166666666666666, "num_slav_max": 0.011099999999999999, "mean_cluster_cpu_util_mean": 0.4491229635102745, "mean_cluster_cpu_util_min": 0.438702853152534, "mean_cluster_cpu_util_max": 0.46042065231603074, "mean_cluster_mem_util_mean": 0.3039815032040243, "mean_cluster_mem_util_min": 0.29758446514681824, "mean_cluster_mem_util_max": 0.3112122400542496, "reward_consolidation_mean_mean": 3.4156111111111107, "reward_consolidation_mean_min": 2.9999999999999996, "reward_consolidation_mean_max": 3.8222222222222224, "reward_illegal_mean_mean": -0.011000000000000001, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9181566666666656, "reward_accuracy_mean_min": 3.7448999999999995, "reward_accuracy_mean_max": 3.960533333333333, "reward_sla_mean_mean": -0.12119333333333333, "reward_sla_mean_min": -0.22200000000000003, "reward_sla_mean_max": -0.03833333333333334, "reward_consolidation_sum_mean": 341.561111111111, "reward_consolidation_sum_min": 299.99999999999994, "reward_consolidation_sum_max": 382.22222222222223, "reward_illegal_sum_mean": -1.0999999999999999, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.81566666666663, "reward_accuracy_sum_min": 374.48999999999995, "reward_accuracy_sum_max": 396.0533333333333, "reward_sla_sum_mean": -12.119333333333334, "reward_sla_sum_min": -22.200000000000003, "reward_sla_sum_max": -3.8333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3769.0, "global_timestep_min": 1900, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [722.5266666666664, 673.6722222222222, 717.7477777777777, 681.5177777777778, 716.1944444444446, 692.2133333333336, 691.0522222222221, 708.7144444444446, 704.7955555555558, 744.4755555555555, 671.5400000000002, 717.7011111111112, 692.8388888888887, 707.5266666666669, 687.8566666666669, 739.3522222222225, 669.1977777777778, 723.5711111111113, 691.1544444444447, 720.1011111111114, 728.3555555555556, 682.3544444444444, 738.6555555555555, 726.6122222222224, 719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27426644397844085, "mean_inference_ms": 2.3942486995751078, "mean_action_processing_ms": 0.1011398856434101, "mean_env_wait_ms": 1.7511168486383304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063054561614990234, "StateBufferConnector_ms": 0.003766298294067383, "ViewRequirementAgentConnector_ms": 0.09603118896484375}, "num_episodes": 21, "episode_return_max": 766.6055555555557, "episode_return_min": 669.1977777777778, "episode_return_mean": 720.1574444444445, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180150, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180150, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 212.07571105833154, "num_env_steps_trained_throughput_per_sec": 226.21409179555366, "timesteps_total": 180150, "num_env_steps_sampled_lifetime": 180150, "num_agent_steps_sampled_lifetime": 180150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 180150, "timers": {"training_iteration_time_ms": 10328.028, "restore_workers_time_ms": 0.012, "training_step_time_ms": 697.676, "sample_time_ms": 680.591, "synch_weights_time_ms": 15.475}, "counters": {"num_env_steps_sampled": 180150, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180150, "num_agent_steps_trained": 180000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1201, "num_samples_added_to_queue": 180000}, "done": false, "training_iteration": 82, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-17", "timestamp": 1728601997, "time_this_iter_s": 10.621455907821655, "time_total_s": 848.8851191997528, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698751e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.8851191997528, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.813333333333333, "ram_util_percent": 54.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 247127.328125, "policy_loss": 237450.328125, "entropy": 13.607433319091797, "entropy_coeff": 0.01, "var_gnorm": 16.488128662109375, "vf_loss": 971782.8125, "vf_explained_var": 0.04929172992706299}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1216, "num_samples_added_to_queue": 182400, "learner_queue": {"size_count": 607, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.377, "learner_load_time_ms": 0.346, "learner_load_wait_time_ms": 1329.887, "learner_dequeue_time_ms": 11366.225}}, "env_runners": {"episode_reward_max": 767.7133333333333, "episode_reward_min": 671.0622222222222, "episode_reward_mean": 730.093577777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 671.0622222222222}, "policy_reward_max": {"default_policy": 767.7133333333333}, "policy_reward_mean": {"default_policy": 730.093577777778}, "custom_metrics": {"num_consolidated_mean": 2.4667000000000003, "num_consolidated_min": 2.3, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.0054, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.4025, "num_moves_min": 3.89, "num_moves_max": 4.93, "mean_accuracy_mean": 39.460553333333316, "mean_accuracy_min": 39.28866666666665, "mean_accuracy_max": 39.649666666666654, "num_model_switches_mean": 2.4315, "num_model_switches_min": 1.99, "num_model_switches_max": 2.87, "num_slav_mean": 0.005792499999999999, "num_slav_min": 0.0018666666666666666, "num_slav_max": 0.011099999999999999, "mean_cluster_cpu_util_mean": 0.45035469428343033, "mean_cluster_cpu_util_min": 0.438702853152534, "mean_cluster_cpu_util_max": 0.46042065231603074, "mean_cluster_mem_util_mean": 0.3048792737682625, "mean_cluster_mem_util_min": 0.2976153760871437, "mean_cluster_mem_util_max": 0.3112122400542496, "reward_consolidation_mean_mean": 3.5007777777777767, "reward_consolidation_mean_min": 3.0055555555555555, "reward_consolidation_mean_max": 3.8666666666666667, "reward_illegal_mean_mean": -0.009000000000000001, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.924621333333333, "reward_accuracy_mean_min": 3.7448999999999995, "reward_accuracy_mean_max": 3.960533333333333, "reward_sla_mean_mean": -0.11546333333333335, "reward_sla_mean_min": -0.22200000000000003, "reward_sla_mean_max": -0.037333333333333336, "reward_consolidation_sum_mean": 350.07777777777767, "reward_consolidation_sum_min": 300.55555555555554, "reward_consolidation_sum_max": 386.6666666666667, "reward_illegal_sum_mean": -0.9, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.46213333333327, "reward_accuracy_sum_min": 374.48999999999995, "reward_accuracy_sum_max": 396.0533333333333, "reward_sla_sum_mean": -11.546333333333335, "reward_sla_sum_min": -22.200000000000003, "reward_sla_sum_max": -3.7333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4567.0, "global_timestep_min": 2600, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [719.2955555555556, 707.3855555555558, 714.238888888889, 712.6177777777781, 698.4100000000002, 733.528888888889, 702.455555555556, 693.8100000000005, 764.2322222222222, 725.8244444444446, 707.2955555555558, 727.8222222222225, 732.431111111111, 695.0655555555556, 724.4466666666667, 703.2100000000003, 715.728888888889, 719.8866666666669, 721.8155555555555, 725.7322222222223, 743.1166666666663, 722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742835526872702, "mean_inference_ms": 2.394355717499891, "mean_action_processing_ms": 0.10114809791955384, "mean_env_wait_ms": 1.7513342461528962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006707429885864258, "StateBufferConnector_ms": 0.003716707229614258, "ViewRequirementAgentConnector_ms": 0.09484362602233887}, "num_episodes": 24, "episode_return_max": 767.7133333333333, "episode_return_min": 671.0622222222222, "episode_return_mean": 730.093577777778, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 213.921364656142, "num_env_steps_trained_throughput_per_sec": 199.65994034573254, "timesteps_total": 182400, "num_env_steps_sampled_lifetime": 182400, "num_agent_steps_sampled_lifetime": 182400, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 182400, "timers": {"training_iteration_time_ms": 10345.09, "restore_workers_time_ms": 0.014, "training_step_time_ms": 700.262, "sample_time_ms": 683.06, "synch_weights_time_ms": 15.585}, "counters": {"num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1216, "num_samples_added_to_queue": 182400}, "done": false, "training_iteration": 83, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-27", "timestamp": 1728602007, "time_this_iter_s": 10.5282461643219, "time_total_s": 859.4133653640747, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b07e710>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 859.4133653640747, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.98, "ram_util_percent": 54.30666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 248862.546875, "policy_loss": 238213.3125, "entropy": 13.631718635559082, "entropy_coeff": 0.01, "var_gnorm": 16.488697052001953, "vf_loss": 1069012.5, "vf_explained_var": 0.055802106857299805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 615.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 184650, "num_env_steps_trained": 184500, "num_agent_steps_sampled": 184650, "num_agent_steps_trained": 184500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1231, "num_samples_added_to_queue": 184500, "learner_queue": {"size_count": 615, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.524, "learner_load_time_ms": 0.304, "learner_load_wait_time_ms": 1346.197, "learner_dequeue_time_ms": 11385.908}}, "env_runners": {"episode_reward_max": 789.4533333333336, "episode_reward_min": 671.0622222222222, "episode_reward_mean": 736.6403777777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 671.0622222222222}, "policy_reward_max": {"default_policy": 789.4533333333336}, "policy_reward_mean": {"default_policy": 736.6403777777778}, "custom_metrics": {"num_consolidated_mean": 2.4898, "num_consolidated_min": 2.3, "num_consolidated_max": 2.64, "num_overloaded_mean": 0.0053, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.3046999999999995, "num_moves_min": 3.73, "num_moves_max": 4.93, "mean_accuracy_mean": 39.47188999999998, "mean_accuracy_min": 39.307666666666655, "mean_accuracy_max": 39.649666666666654, "num_model_switches_mean": 2.3857, "num_model_switches_min": 1.99, "num_model_switches_max": 2.87, "num_slav_mean": 0.005759666666666667, "num_slav_min": 0.0018666666666666666, "num_slav_max": 0.011099999999999999, "mean_cluster_cpu_util_mean": 0.4514355747603008, "mean_cluster_cpu_util_min": 0.438702853152534, "mean_cluster_cpu_util_max": 0.46509182362711926, "mean_cluster_mem_util_mean": 0.30549966167764575, "mean_cluster_mem_util_min": 0.2976153760871437, "mean_cluster_mem_util_max": 0.31336858854301214, "reward_consolidation_mean_mean": 3.5637777777777773, "reward_consolidation_mean_min": 3.0055555555555555, "reward_consolidation_mean_max": 3.9999999999999996, "reward_illegal_mean_mean": -0.008833333333333334, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9261026666666656, "reward_accuracy_mean_min": 3.7448999999999995, "reward_accuracy_mean_max": 3.960533333333333, "reward_sla_mean_mean": -0.11464333333333335, "reward_sla_mean_min": -0.22200000000000003, "reward_sla_mean_max": -0.037333333333333336, "reward_consolidation_sum_mean": 356.3777777777778, "reward_consolidation_sum_min": 300.55555555555554, "reward_consolidation_sum_max": 399.99999999999994, "reward_illegal_sum_mean": -0.8833333333333334, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.6102666666666, "reward_accuracy_sum_min": 374.48999999999995, "reward_accuracy_sum_max": 396.0533333333333, "reward_sla_sum_mean": -11.464333333333334, "reward_sla_sum_min": -22.200000000000003, "reward_sla_sum_max": -3.7333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5269.0, "global_timestep_min": 3400, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [722.4844444444444, 739.8644444444444, 715.3700000000002, 721.3588888888887, 716.5277777777777, 713.9522222222225, 699.8044444444448, 710.7944444444443, 743.3077777777779, 709.9077777777778, 713.5877777777778, 744.2900000000004, 671.0622222222222, 678.4677777777778, 712.9511111111115, 733.7111111111111, 724.3766666666668, 731.9877777777781, 730.7355555555558, 730.8322222222225, 737.0866666666668, 744.8766666666664, 724.1333333333333, 729.6344444444445, 723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2742695865388823, "mean_inference_ms": 2.3943686629784438, "mean_action_processing_ms": 0.10115351387897871, "mean_env_wait_ms": 1.7515577004277054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006780147552490234, "StateBufferConnector_ms": 0.0036873817443847656, "ViewRequirementAgentConnector_ms": 0.09387588500976562}, "num_episodes": 21, "episode_return_max": 789.4533333333336, "episode_return_min": 671.0622222222222, "episode_return_mean": 736.6403777777778, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184650, "num_agent_steps_trained": 184500, "num_env_steps_sampled": 184650, "num_env_steps_trained": 184500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 212.87479173099177, "num_env_steps_trained_throughput_per_sec": 227.0664445130579, "timesteps_total": 184650, "num_env_steps_sampled_lifetime": 184650, "num_agent_steps_sampled_lifetime": 184650, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 184650, "timers": {"training_iteration_time_ms": 10398.24, "restore_workers_time_ms": 0.012, "training_step_time_ms": 698.065, "sample_time_ms": 681.594, "synch_weights_time_ms": 14.99}, "counters": {"num_env_steps_sampled": 184650, "num_env_steps_trained": 184500, "num_agent_steps_sampled": 184650, "num_agent_steps_trained": 184500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1231, "num_samples_added_to_queue": 184500}, "done": false, "training_iteration": 84, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-38", "timestamp": 1728602018, "time_this_iter_s": 10.57898211479187, "time_total_s": 869.9923474788666, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae53d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 869.9923474788666, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 19.02, "ram_util_percent": 54.426666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 250560.9375, "policy_loss": 239840.59375, "entropy": 13.639190673828125, "entropy_coeff": 0.01, "var_gnorm": 16.489744186401367, "vf_loss": 1076127.25, "vf_explained_var": 0.059024274349212646}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 622.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 186900, "num_env_steps_trained": 186600, "num_agent_steps_sampled": 186900, "num_agent_steps_trained": 186600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1246, "num_samples_added_to_queue": 186900, "learner_queue": {"size_count": 622, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.507, "learner_load_time_ms": 0.379, "learner_load_wait_time_ms": 1349.922, "learner_dequeue_time_ms": 11387.262}}, "env_runners": {"episode_reward_max": 789.4533333333336, "episode_reward_min": 693.6644444444448, "episode_reward_mean": 744.8978333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 693.6644444444448}, "policy_reward_max": {"default_policy": 789.4533333333336}, "policy_reward_mean": {"default_policy": 744.8978333333337}, "custom_metrics": {"num_consolidated_mean": 2.5153, "num_consolidated_min": 2.36, "num_consolidated_max": 2.66, "num_overloaded_mean": 0.0047, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 4.2095, "num_moves_min": 3.73, "num_moves_max": 4.72, "mean_accuracy_mean": 39.47860333333331, "mean_accuracy_min": 39.307666666666655, "mean_accuracy_max": 39.649666666666654, "num_model_switches_mean": 2.3322000000000003, "num_model_switches_min": 1.96, "num_model_switches_max": 2.87, "num_slav_mean": 0.005451666666666667, "num_slav_min": 0.0012333333333333332, "num_slav_max": 0.011099999999999999, "mean_cluster_cpu_util_mean": 0.4532430017233648, "mean_cluster_cpu_util_min": 0.44217334767158506, "mean_cluster_cpu_util_max": 0.46509182362711926, "mean_cluster_mem_util_mean": 0.3063808496046098, "mean_cluster_mem_util_min": 0.29891406559459227, "mean_cluster_mem_util_max": 0.31336858854301214, "reward_consolidation_mean_mean": 3.6364999999999994, "reward_consolidation_mean_min": 3.1722222222222225, "reward_consolidation_mean_max": 4.055555555555555, "reward_illegal_mean_mean": -0.007833333333333333, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9291449999999997, "reward_accuracy_mean_min": 3.8289999999999993, "reward_accuracy_mean_max": 3.960533333333333, "reward_sla_mean_mean": -0.10883333333333332, "reward_sla_mean_min": -0.22200000000000003, "reward_sla_mean_max": -0.024666666666666674, "reward_consolidation_sum_mean": 363.6499999999999, "reward_consolidation_sum_min": 317.22222222222223, "reward_consolidation_sum_max": 405.55555555555554, "reward_illegal_sum_mean": -0.7833333333333333, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.9144999999999, "reward_accuracy_sum_min": 382.8999999999999, "reward_accuracy_sum_max": 396.0533333333333, "reward_sla_sum_mean": -10.883333333333336, "reward_sla_sum_min": -22.200000000000003, "reward_sla_sum_max": -2.4666666666666672, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6071.0, "global_timestep_min": 4100, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [723.4955555555554, 766.6055555555557, 708.1722222222226, 736.541111111111, 727.7700000000001, 708.3722222222223, 715.9266666666672, 759.4322222222221, 713.5533333333335, 751.6555555555557, 749.8655555555557, 739.7422222222223, 749.7888888888891, 755.3300000000003, 748.3488888888891, 731.1677777777778, 730.9811111111112, 718.7022222222224, 717.3155555555555, 695.798888888889, 717.2477777777777, 727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2743254311728279, "mean_inference_ms": 2.3964042771289416, "mean_action_processing_ms": 0.10118627524470898, "mean_env_wait_ms": 1.752256436342697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006810426712036133, "StateBufferConnector_ms": 0.003717184066772461, "ViewRequirementAgentConnector_ms": 0.09459280967712402}, "num_episodes": 24, "episode_return_max": 789.4533333333336, "episode_return_min": 693.6644444444448, "episode_return_mean": 744.8978333333337, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186900, "num_agent_steps_trained": 186600, "num_env_steps_sampled": 186900, "num_env_steps_trained": 186600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 212.83509767039308, "num_env_steps_trained_throughput_per_sec": 198.64609115903355, "timesteps_total": 186900, "num_env_steps_sampled_lifetime": 186900, "num_agent_steps_sampled_lifetime": 186900, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 186900, "timers": {"training_iteration_time_ms": 10444.144, "restore_workers_time_ms": 0.014, "training_step_time_ms": 695.904, "sample_time_ms": 679.193, "synch_weights_time_ms": 15.081}, "counters": {"num_env_steps_sampled": 186900, "num_env_steps_trained": 186600, "num_agent_steps_sampled": 186900, "num_agent_steps_trained": 186600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1246, "num_samples_added_to_queue": 186900}, "done": false, "training_iteration": 85, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-49", "timestamp": 1728602029, "time_this_iter_s": 10.584235191345215, "time_total_s": 880.5765826702118, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefbf70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.5765826702118, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.519999999999996, "ram_util_percent": 54.513333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 228831.484375, "policy_loss": 217276.34375, "entropy": 12.798185348510742, "entropy_coeff": 0.01, "var_gnorm": 16.49924659729004, "vf_loss": 1159352.75, "vf_explained_var": 0.0665358304977417}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 630.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1261, "num_samples_added_to_queue": 189000, "learner_queue": {"size_count": 630, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.17, "learner_load_time_ms": 0.426, "learner_load_wait_time_ms": 1341.376, "learner_dequeue_time_ms": 11370.676}}, "env_runners": {"episode_reward_max": 799.5288888888889, "episode_reward_min": 693.6644444444448, "episode_reward_mean": 754.7112333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 693.6644444444448}, "policy_reward_max": {"default_policy": 799.5288888888889}, "policy_reward_mean": {"default_policy": 754.7112333333336}, "custom_metrics": {"num_consolidated_mean": 2.5473, "num_consolidated_min": 2.37, "num_consolidated_max": 2.7, "num_overloaded_mean": 0.0041, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 4.0942, "num_moves_min": 3.49, "num_moves_max": 4.72, "mean_accuracy_mean": 39.47005333333332, "mean_accuracy_min": 39.313999999999986, "mean_accuracy_max": 39.624333333333325, "num_model_switches_mean": 2.2624, "num_model_switches_min": 1.85, "num_model_switches_max": 2.67, "num_slav_mean": 0.005155999999999999, "num_slav_min": 0.0012333333333333332, "num_slav_max": 0.0093, "mean_cluster_cpu_util_mean": 0.454749839148238, "mean_cluster_cpu_util_min": 0.44217334767158506, "mean_cluster_cpu_util_max": 0.4682565056795719, "mean_cluster_mem_util_mean": 0.3071702677853842, "mean_cluster_mem_util_min": 0.29891406559459227, "mean_cluster_mem_util_max": 0.3143150564023077, "reward_consolidation_mean_mean": 3.726166666666666, "reward_consolidation_mean_min": 3.1999999999999993, "reward_consolidation_mean_max": 4.144444444444444, "reward_illegal_mean_mean": -0.006833333333333334, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.930699, "reward_accuracy_mean_min": 3.861233333333333, "reward_accuracy_mean_max": 3.9573666666666663, "reward_sla_mean_mean": -0.10292000000000001, "reward_sla_mean_min": -0.18600000000000003, "reward_sla_mean_max": -0.024666666666666674, "reward_consolidation_sum_mean": 372.6166666666666, "reward_consolidation_sum_min": 319.99999999999994, "reward_consolidation_sum_max": 414.4444444444444, "reward_illegal_sum_mean": -0.6833333333333331, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 393.06989999999996, "reward_accuracy_sum_min": 386.1233333333333, "reward_accuracy_sum_max": 395.7366666666666, "reward_sla_sum_mean": -10.292000000000003, "reward_sla_sum_min": -18.6, "reward_sla_sum_max": -2.4666666666666672, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5367.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [727.1688888888888, 749.3777777777779, 700.4, 736.1377777777781, 746.4322222222224, 708.2455555555557, 729.7455555555555, 761.2422222222225, 721.4422222222222, 730.5555555555559, 736.9288888888889, 754.3077777777776, 738.3511111111113, 754.5366666666666, 749.7611111111111, 747.4711111111112, 767.7133333333333, 730.1622222222223, 753.3322222222224, 738.8822222222224, 764.4477777777772, 766.7611111111113, 765.7622222222224, 766.19, 724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2743336985478043, "mean_inference_ms": 2.396358421307335, "mean_action_processing_ms": 0.10119041032477075, "mean_env_wait_ms": 1.7524016537635436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068738460540771484, "StateBufferConnector_ms": 0.0037338733673095703, "ViewRequirementAgentConnector_ms": 0.09456205368041992}, "num_episodes": 21, "episode_return_max": 799.5288888888889, "episode_return_min": 693.6644444444448, "episode_return_mean": 754.7112333333336, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 207.9840287600799, "num_env_steps_trained_throughput_per_sec": 221.84963067741856, "timesteps_total": 189150, "num_env_steps_sampled_lifetime": 189150, "num_agent_steps_sampled_lifetime": 189150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 189150, "timers": {"training_iteration_time_ms": 10477.051, "restore_workers_time_ms": 0.012, "training_step_time_ms": 714.729, "sample_time_ms": 698.504, "synch_weights_time_ms": 14.698}, "counters": {"num_env_steps_sampled": 189150, "num_env_steps_trained": 189000, "num_agent_steps_sampled": 189150, "num_agent_steps_trained": 189000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1261, "num_samples_added_to_queue": 189000}, "done": false, "training_iteration": 86, "trial_id": "3f041_00000", "date": "2024-10-11_00-13-59", "timestamp": 1728602039, "time_this_iter_s": 10.83080792427063, "time_total_s": 891.4073905944824, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae51c00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 891.4073905944824, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 18.9, "ram_util_percent": 54.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 222299.203125, "policy_loss": 210998.5625, "entropy": 12.3926362991333, "entropy_coeff": 0.01, "var_gnorm": 16.513662338256836, "vf_loss": 1133781.625, "vf_explained_var": 0.07419759035110474}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 637.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 191400, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 191400, "num_agent_steps_trained": 191100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1276, "num_samples_added_to_queue": 191400, "learner_queue": {"size_count": 637, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.118, "learner_load_time_ms": 0.444, "learner_load_wait_time_ms": 1379.089, "learner_dequeue_time_ms": 11369.999}}, "env_runners": {"episode_reward_max": 823.6655555555554, "episode_reward_min": 693.6644444444448, "episode_reward_mean": 766.5568222222221, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 693.6644444444448}, "policy_reward_max": {"default_policy": 823.6655555555554}, "policy_reward_mean": {"default_policy": 766.5568222222221}, "custom_metrics": {"num_consolidated_mean": 2.5901000000000005, "num_consolidated_min": 2.37, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0044, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.943, "num_moves_min": 3.29, "num_moves_max": 4.55, "mean_accuracy_mean": 39.45592999999998, "mean_accuracy_min": 39.26966666666665, "mean_accuracy_max": 39.624333333333325, "num_model_switches_mean": 2.167, "num_model_switches_min": 1.66, "num_model_switches_max": 2.56, "num_slav_mean": 0.004929, "num_slav_min": 0.0012333333333333332, "num_slav_max": 0.0093, "mean_cluster_cpu_util_mean": 0.457066940522899, "mean_cluster_cpu_util_min": 0.4473941924960014, "mean_cluster_cpu_util_max": 0.4695213316652807, "mean_cluster_mem_util_mean": 0.30871312395411754, "mean_cluster_mem_util_min": 0.3019048921467321, "mean_cluster_mem_util_max": 0.3167940648411263, "reward_consolidation_mean_mean": 3.8427222222222213, "reward_consolidation_mean_min": 3.227777777777777, "reward_consolidation_mean_max": 4.422222222222222, "reward_illegal_mean_mean": -0.007333333333333334, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9280726666666665, "reward_accuracy_mean_min": 3.863133333333333, "reward_accuracy_mean_max": 3.9554666666666662, "reward_sla_mean_mean": -0.09789333333333333, "reward_sla_mean_min": -0.18600000000000003, "reward_sla_mean_max": -0.024666666666666674, "reward_consolidation_sum_mean": 384.2722222222221, "reward_consolidation_sum_min": 322.7777777777777, "reward_consolidation_sum_max": 442.2222222222222, "reward_illegal_sum_mean": -0.7333333333333333, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.8072666666665, "reward_accuracy_sum_min": 386.3133333333333, "reward_accuracy_sum_max": 395.5466666666666, "reward_sla_sum_mean": -9.789333333333333, "reward_sla_sum_min": -18.6, "reward_sla_sum_max": -2.4666666666666672, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4290.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [724.958888888889, 764.5966666666666, 741.3155555555559, 737.6755555555555, 741.3444444444447, 732.418888888889, 748.615555555556, 767.5000000000002, 724.9555555555559, 725.3522222222225, 759.2088888888889, 757.1277777777779, 729.727777777778, 750.7522222222221, 789.4533333333336, 728.6677777777782, 737.1711111111115, 742.252222222222, 725.6411111111111, 764.0544444444445, 756.8522222222224, 730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2743868010094599, "mean_inference_ms": 2.3963575446525294, "mean_action_processing_ms": 0.10119946063250897, "mean_env_wait_ms": 1.7526468084089932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006658315658569336, "StateBufferConnector_ms": 0.0037927627563476562, "ViewRequirementAgentConnector_ms": 0.09611940383911133}, "num_episodes": 24, "episode_return_max": 823.6655555555554, "episode_return_min": 693.6644444444448, "episode_return_mean": 766.5568222222221, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191400, "num_agent_steps_trained": 191100, "num_env_steps_sampled": 191400, "num_env_steps_trained": 191100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 210.75378058044842, "num_env_steps_trained_throughput_per_sec": 196.70352854175184, "timesteps_total": 191400, "num_env_steps_sampled_lifetime": 191400, "num_agent_steps_sampled_lifetime": 191400, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 191400, "timers": {"training_iteration_time_ms": 10501.214, "restore_workers_time_ms": 0.014, "training_step_time_ms": 717.538, "sample_time_ms": 700.279, "synch_weights_time_ms": 15.674}, "counters": {"num_env_steps_sampled": 191400, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 191400, "num_agent_steps_trained": 191100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1276, "num_samples_added_to_queue": 191400}, "done": false, "training_iteration": 87, "trial_id": "3f041_00000", "date": "2024-10-11_00-14-10", "timestamp": 1728602050, "time_this_iter_s": 10.693854808807373, "time_total_s": 902.1012454032898, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa9930>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 902.1012454032898, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.233333333333334, "ram_util_percent": 54.819999999999986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 223323.25, "policy_loss": 211771.328125, "entropy": 11.986640930175781, "entropy_coeff": 0.01, "var_gnorm": 16.524459838867188, "vf_loss": 1158787.5, "vf_explained_var": 0.08256745338439941}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 644.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 193500, "num_env_steps_trained": 193200, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1290, "num_samples_added_to_queue": 193500, "learner_queue": {"size_count": 644, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.788, "learner_load_time_ms": 0.457, "learner_load_wait_time_ms": 1378.125, "learner_dequeue_time_ms": 11395.577}}, "env_runners": {"episode_reward_max": 829.5888888888887, "episode_reward_min": 693.6644444444448, "episode_reward_mean": 778.4413222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 693.6644444444448}, "policy_reward_max": {"default_policy": 829.5888888888887}, "policy_reward_mean": {"default_policy": 778.4413222222222}, "custom_metrics": {"num_consolidated_mean": 2.6301, "num_consolidated_min": 2.37, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.004200000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.8180999999999994, "num_moves_min": 3.23, "num_moves_max": 4.55, "mean_accuracy_mean": 39.441743333333314, "mean_accuracy_min": 39.26966666666665, "mean_accuracy_max": 39.58633333333332, "num_model_switches_mean": 2.0986000000000002, "num_model_switches_min": 1.66, "num_model_switches_max": 2.56, "num_slav_mean": 0.004520499999999999, "num_slav_min": 0.0010999999999999998, "num_slav_max": 0.009283333333333333, "mean_cluster_cpu_util_mean": 0.45894420747843845, "mean_cluster_cpu_util_min": 0.4477378621655916, "mean_cluster_cpu_util_max": 0.4695213316652807, "mean_cluster_mem_util_mean": 0.30983614512651053, "mean_cluster_mem_util_min": 0.3019048921467321, "mean_cluster_mem_util_max": 0.3167940648411263, "reward_consolidation_mean_mean": 3.9537222222222215, "reward_consolidation_mean_min": 3.227777777777777, "reward_consolidation_mean_max": 4.472222222222221, "reward_illegal_mean_mean": -0.007000000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9274443333333333, "reward_accuracy_mean_min": 3.863133333333333, "reward_accuracy_mean_max": 3.9554666666666662, "reward_sla_mean_mean": -0.08975333333333334, "reward_sla_mean_min": -0.1856666666666667, "reward_sla_mean_max": -0.022000000000000002, "reward_consolidation_sum_mean": 395.3722222222222, "reward_consolidation_sum_min": 322.7777777777777, "reward_consolidation_sum_max": 447.2222222222222, "reward_illegal_sum_mean": -0.7, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.74443333333323, "reward_accuracy_sum_min": 386.3133333333333, "reward_accuracy_sum_max": 395.5466666666666, "reward_sla_sum_mean": -8.975333333333333, "reward_sla_sum_min": -18.56666666666667, "reward_sla_sum_max": -2.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3357.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [730.5633333333334, 756.1255555555556, 761.2344444444442, 724.3422222222225, 761.4244444444447, 732.3677777777777, 760.3555555555556, 762.8988888888888, 764.9055555555553, 747.9033333333333, 729.4188888888892, 785.6177777777777, 758.7777777777776, 749.6822222222223, 770.5555555555559, 693.6644444444448, 752.2122222222225, 744.8933333333339, 763.0944444444442, 739.0733333333336, 743.0522222222223, 762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27440978056684395, "mean_inference_ms": 2.3965101478506963, "mean_action_processing_ms": 0.10121182269046586, "mean_env_wait_ms": 1.752925550496874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00642704963684082, "StateBufferConnector_ms": 0.0038192272186279297, "ViewRequirementAgentConnector_ms": 0.09747958183288574}, "num_episodes": 21, "episode_return_max": 829.5888888888887, "episode_return_min": 693.6644444444448, "episode_return_mean": 778.4413222222222, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193200, "num_env_steps_sampled": 193500, "num_env_steps_trained": 193200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 208.78783403715164, "num_env_steps_trained_throughput_per_sec": 208.78783403715164, "timesteps_total": 193500, "num_env_steps_sampled_lifetime": 193500, "num_agent_steps_sampled_lifetime": 193500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 193500, "timers": {"training_iteration_time_ms": 10443.069, "restore_workers_time_ms": 0.015, "training_step_time_ms": 714.472, "sample_time_ms": 697.125, "synch_weights_time_ms": 15.745}, "counters": {"num_env_steps_sampled": 193500, "num_env_steps_trained": 193200, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1290, "num_samples_added_to_queue": 193500}, "done": false, "training_iteration": 88, "trial_id": "3f041_00000", "date": "2024-10-11_00-14-20", "timestamp": 1728602060, "time_this_iter_s": 10.084562063217163, "time_total_s": 912.185807466507, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfab6a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 912.185807466507, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.771428571428572, "ram_util_percent": 54.942857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 231655.0, "policy_loss": 219815.25, "entropy": 12.361348152160645, "entropy_coeff": 0.01, "var_gnorm": 16.530622482299805, "vf_loss": 1187682.75, "vf_explained_var": 0.08481031656265259}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 651.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 195600, "num_env_steps_trained": 195300, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1304, "num_samples_added_to_queue": 195600, "learner_queue": {"size_count": 651, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.545, "learner_load_time_ms": 0.487, "learner_load_wait_time_ms": 1364.523, "learner_dequeue_time_ms": 11432.708}}, "env_runners": {"episode_reward_max": 829.5888888888887, "episode_reward_min": 740.9988888888888, "episode_reward_mean": 788.3838333333332, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 740.9988888888888}, "policy_reward_max": {"default_policy": 829.5888888888887}, "policy_reward_mean": {"default_policy": 788.3838333333332}, "custom_metrics": {"num_consolidated_mean": 2.6615, "num_consolidated_min": 2.49, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0036000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.7073, "num_moves_min": 3.21, "num_moves_max": 4.45, "mean_accuracy_mean": 39.41957666666665, "mean_accuracy_min": 39.25699999999998, "mean_accuracy_max": 39.58633333333332, "num_model_switches_mean": 2.052, "num_model_switches_min": 1.66, "num_model_switches_max": 2.56, "num_slav_mean": 0.004062833333333334, "num_slav_min": 0.0010999999999999998, "num_slav_max": 0.008483333333333332, "mean_cluster_cpu_util_mean": 0.46014014272359627, "mean_cluster_cpu_util_min": 0.4477378621655916, "mean_cluster_cpu_util_max": 0.4695213316652807, "mean_cluster_mem_util_mean": 0.3106627403018169, "mean_cluster_mem_util_min": 0.3029880430336692, "mean_cluster_mem_util_max": 0.3167940648411263, "reward_consolidation_mean_mean": 4.042833333333333, "reward_consolidation_mean_min": 3.561111111111111, "reward_consolidation_mean_max": 4.472222222222221, "reward_illegal_mean_mean": -0.006000000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.927605, "reward_accuracy_mean_min": 3.861866666666666, "reward_accuracy_mean_max": 3.9529333333333327, "reward_sla_mean_mean": -0.0806, "reward_sla_mean_min": -0.159, "reward_sla_mean_max": -0.022000000000000002, "reward_consolidation_sum_mean": 404.2833333333333, "reward_consolidation_sum_min": 356.1111111111111, "reward_consolidation_sum_max": 447.2222222222222, "reward_illegal_sum_mean": -0.5999999999999999, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.76050000000004, "reward_accuracy_sum_min": 386.1866666666666, "reward_accuracy_sum_max": 395.2933333333333, "reward_sla_sum_mean": -8.06, "reward_sla_sum_min": -15.9, "reward_sla_sum_max": -2.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2415.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [762.7455555555557, 741.0944444444447, 774.6555555555558, 758.5055555555555, 748.7144444444444, 755.0355555555554, 747.6866666666664, 764.1833333333335, 759.5088888888889, 785.4622222222222, 774.0066666666667, 784.2111111111112, 740.9988888888888, 778.07, 788.3933333333334, 797.5844444444442, 787.6922222222217, 763.238888888889, 779.1488888888888, 771.3011111111109, 790.6511111111108, 782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27439910247911853, "mean_inference_ms": 2.394861330948749, "mean_action_processing_ms": 0.10119792453514222, "mean_env_wait_ms": 1.7526850091485238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064122676849365234, "StateBufferConnector_ms": 0.00385284423828125, "ViewRequirementAgentConnector_ms": 0.09824562072753906}, "num_episodes": 21, "episode_return_max": 829.5888888888887, "episode_return_min": 740.9988888888888, "episode_return_mean": 788.3838333333332, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195300, "num_env_steps_sampled": 195600, "num_env_steps_trained": 195300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 209.20254915329983, "num_env_steps_trained_throughput_per_sec": 209.20254915329983, "timesteps_total": 195600, "num_env_steps_sampled_lifetime": 195600, "num_agent_steps_sampled_lifetime": 195600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 195600, "timers": {"training_iteration_time_ms": 10402.598, "restore_workers_time_ms": 0.013, "training_step_time_ms": 718.619, "sample_time_ms": 700.556, "synch_weights_time_ms": 16.339}, "counters": {"num_env_steps_sampled": 195600, "num_env_steps_trained": 195300, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1304, "num_samples_added_to_queue": 195600}, "done": false, "training_iteration": 89, "trial_id": "3f041_00000", "date": "2024-10-11_00-14-30", "timestamp": 1728602070, "time_this_iter_s": 10.047235012054443, "time_total_s": 922.2330424785614, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee2ad0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 922.2330424785614, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 19.18, "ram_util_percent": 55.11333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 213521.5625, "policy_loss": 202739.25, "entropy": 12.250682830810547, "entropy_coeff": 0.01, "var_gnorm": 16.538843154907227, "vf_loss": 1081906.5, "vf_explained_var": 0.0936245322227478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 659.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 197850, "num_env_steps_trained": 197700, "num_agent_steps_sampled": 197850, "num_agent_steps_trained": 197700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1319, "num_samples_added_to_queue": 197700, "learner_queue": {"size_count": 659, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.009, "learner_load_time_ms": 0.471, "learner_load_wait_time_ms": 1342.795, "learner_dequeue_time_ms": 11450.121}}, "env_runners": {"episode_reward_max": 829.5888888888887, "episode_reward_min": 742.45, "episode_reward_mean": 794.6753333333331, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 742.45}, "policy_reward_max": {"default_policy": 829.5888888888887}, "policy_reward_mean": {"default_policy": 794.6753333333331}, "custom_metrics": {"num_consolidated_mean": 2.6828, "num_consolidated_min": 2.49, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0036, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.6349999999999993, "num_moves_min": 3.21, "num_moves_max": 4.18, "mean_accuracy_mean": 39.40184333333332, "mean_accuracy_min": 39.20633333333331, "mean_accuracy_max": 39.58633333333332, "num_model_switches_mean": 2.0422999999999996, "num_model_switches_min": 1.66, "num_model_switches_max": 2.46, "num_slav_mean": 0.0038434999999999997, "num_slav_min": 0.0009833333333333332, "num_slav_max": 0.008483333333333332, "mean_cluster_cpu_util_mean": 0.4606871831936422, "mean_cluster_cpu_util_min": 0.4477378621655916, "mean_cluster_cpu_util_max": 0.4695213316652807, "mean_cluster_mem_util_mean": 0.31122345521721345, "mean_cluster_mem_util_min": 0.3029880430336692, "mean_cluster_mem_util_max": 0.3167940648411263, "reward_consolidation_mean_mean": 4.102833333333333, "reward_consolidation_mean_min": 3.583333333333333, "reward_consolidation_mean_max": 4.472222222222221, "reward_illegal_mean_mean": -0.006000000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9258000000000006, "reward_accuracy_mean_min": 3.861866666666666, "reward_accuracy_mean_max": 3.951033333333333, "reward_sla_mean_mean": -0.07588, "reward_sla_mean_min": -0.159, "reward_sla_mean_max": -0.01966666666666667, "reward_consolidation_sum_mean": 410.2833333333333, "reward_consolidation_sum_min": 358.3333333333333, "reward_consolidation_sum_max": 447.2222222222222, "reward_illegal_sum_mean": -0.6, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.58, "reward_accuracy_sum_min": 386.1866666666666, "reward_accuracy_sum_max": 395.1033333333333, "reward_sla_sum_mean": -7.587999999999999, "reward_sla_sum_min": -15.9, "reward_sla_sum_max": -1.9666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1947.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [782.1933333333332, 778.0922222222222, 788.1666666666667, 773.9644444444444, 786.5233333333337, 787.4133333333332, 763.1222222222221, 763.18, 742.45, 760.88, 795.8100000000001, 769.7488888888889, 799.5288888888889, 813.9066666666666, 823.6655555555554, 753.0933333333331, 788.341111111111, 817.6255555555553, 766.3255555555554, 801.8799999999997, 779.3399999999995, 792.9366666666664, 798.718888888889, 789.1488888888889, 801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27442732352035376, "mean_inference_ms": 2.394970727738592, "mean_action_processing_ms": 0.10121114881569575, "mean_env_wait_ms": 1.7529638187570282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006392955780029297, "StateBufferConnector_ms": 0.003844738006591797, "ViewRequirementAgentConnector_ms": 0.09824442863464355}, "num_episodes": 21, "episode_return_max": 829.5888888888887, "episode_return_min": 742.45, "episode_return_mean": 794.6753333333331, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197850, "num_agent_steps_trained": 197700, "num_env_steps_sampled": 197850, "num_env_steps_trained": 197700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 212.97809060796442, "num_env_steps_trained_throughput_per_sec": 227.1766299818287, "timesteps_total": 197850, "num_env_steps_sampled_lifetime": 197850, "num_agent_steps_sampled_lifetime": 197850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 197850, "timers": {"training_iteration_time_ms": 10455.768, "restore_workers_time_ms": 0.016, "training_step_time_ms": 707.146, "sample_time_ms": 684.61, "synch_weights_time_ms": 20.5}, "counters": {"num_env_steps_sampled": 197850, "num_env_steps_trained": 197700, "num_agent_steps_sampled": 197850, "num_agent_steps_trained": 197700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1319, "num_samples_added_to_queue": 197700}, "done": false, "training_iteration": 90, "trial_id": "3f041_00000", "date": "2024-10-11_00-14-41", "timestamp": 1728602081, "time_this_iter_s": 10.574395656585693, "time_total_s": 932.8074381351471, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b170d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 932.8074381351471, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 18.793333333333333, "ram_util_percent": 55.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 212822.421875, "policy_loss": 201006.34375, "entropy": 12.008682250976562, "entropy_coeff": 0.01, "var_gnorm": 16.548036575317383, "vf_loss": 1185211.375, "vf_explained_var": 0.09698319435119629}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 666.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1334, "num_samples_added_to_queue": 200100, "learner_queue": {"size_count": 666, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.447, "learner_load_time_ms": 0.465, "learner_load_wait_time_ms": 1310.824, "learner_dequeue_time_ms": 11411.582}}, "env_runners": {"episode_reward_max": 837.6933333333334, "episode_reward_min": 753.6744444444442, "episode_reward_mean": 799.6881777777776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 753.6744444444442}, "policy_reward_max": {"default_policy": 837.6933333333334}, "policy_reward_mean": {"default_policy": 799.6881777777776}, "custom_metrics": {"num_consolidated_mean": 2.6987, "num_consolidated_min": 2.61, "num_consolidated_max": 2.82, "num_overloaded_mean": 0.003300000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.5804, "num_moves_min": 3.13, "num_moves_max": 4.05, "mean_accuracy_mean": 39.382906666666656, "mean_accuracy_min": 39.20633333333331, "mean_accuracy_max": 39.58633333333332, "num_model_switches_mean": 2.0439999999999996, "num_model_switches_min": 1.7, "num_model_switches_max": 2.46, "num_slav_mean": 0.0036413333333333337, "num_slav_min": 0.0009833333333333332, "num_slav_max": 0.008483333333333332, "mean_cluster_cpu_util_mean": 0.46122145564700984, "mean_cluster_cpu_util_min": 0.4533133426595677, "mean_cluster_cpu_util_max": 0.4695213316652807, "mean_cluster_mem_util_mean": 0.3116954314381871, "mean_cluster_mem_util_min": 0.3071471217600964, "mean_cluster_mem_util_max": 0.3167940648411263, "reward_consolidation_mean_mean": 4.148777777777778, "reward_consolidation_mean_min": 3.844444444444443, "reward_consolidation_mean_max": 4.499999999999999, "reward_illegal_mean_mean": -0.005500000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9251139999999993, "reward_accuracy_mean_min": 3.861866666666666, "reward_accuracy_mean_max": 3.951033333333333, "reward_sla_mean_mean": -0.07151000000000002, "reward_sla_mean_min": -0.15333333333333335, "reward_sla_mean_max": -0.01966666666666667, "reward_consolidation_sum_mean": 414.8777777777777, "reward_consolidation_sum_min": 384.44444444444434, "reward_consolidation_sum_max": 449.99999999999994, "reward_illegal_sum_mean": -0.5499999999999998, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.5114, "reward_accuracy_sum_min": 386.1866666666666, "reward_accuracy_sum_max": 395.1033333333333, "reward_sla_sum_mean": -7.151, "reward_sla_sum_min": -15.333333333333336, "reward_sla_sum_max": -1.9666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2667.0, "global_timestep_min": 700, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [801.391111111111, 810.311111111111, 785.9888888888889, 805.0144444444446, 793.5088888888887, 789.8144444444442, 789.6177777777776, 753.6744444444442, 796.6255555555553, 792.5177777777781, 792.3822222222221, 793.4699999999998, 800.6155555555553, 798.8444444444441, 795.8966666666666, 793.3355555555557, 786.7366666666667, 795.6633333333331, 813.4444444444445, 797.7622222222219, 797.0866666666667, 790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744443396662528, "mean_inference_ms": 2.3947934504907185, "mean_action_processing_ms": 0.10121556528015362, "mean_env_wait_ms": 1.753034813131095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062673091888427734, "StateBufferConnector_ms": 0.003798246383666992, "ViewRequirementAgentConnector_ms": 0.09618568420410156}, "num_episodes": 24, "episode_return_max": 837.6933333333334, "episode_return_min": 753.6744444444442, "episode_return_mean": 799.6881777777776, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 220.50693174337158, "num_env_steps_trained_throughput_per_sec": 205.8064696271468, "timesteps_total": 200100, "num_env_steps_sampled_lifetime": 200100, "num_agent_steps_sampled_lifetime": 200100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 200100, "timers": {"training_iteration_time_ms": 10462.705, "restore_workers_time_ms": 0.014, "training_step_time_ms": 673.231, "sample_time_ms": 656.478, "synch_weights_time_ms": 15.143}, "counters": {"num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1334, "num_samples_added_to_queue": 200100}, "done": false, "training_iteration": 91, "trial_id": "3f041_00000", "date": "2024-10-11_00-14-51", "timestamp": 1728602091, "time_this_iter_s": 10.217384338378906, "time_total_s": 943.024822473526, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfabfd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 943.024822473526, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 55.32142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 199966.765625, "policy_loss": 188219.0, "entropy": 11.553414344787598, "entropy_coeff": 0.01, "var_gnorm": 16.56310272216797, "vf_loss": 1178242.5, "vf_explained_var": 0.10616809129714966}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 674.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200, "learner_queue": {"size_count": 674, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.64, "learner_load_time_ms": 0.512, "learner_load_wait_time_ms": 1304.522, "learner_dequeue_time_ms": 11347.985}}, "env_runners": {"episode_reward_max": 843.2888888888889, "episode_reward_min": 767.8466666666668, "episode_reward_mean": 804.8448555555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 767.8466666666668}, "policy_reward_max": {"default_policy": 843.2888888888889}, "policy_reward_mean": {"default_policy": 804.8448555555552}, "custom_metrics": {"num_consolidated_mean": 2.7171, "num_consolidated_min": 2.61, "num_consolidated_max": 2.84, "num_overloaded_mean": 0.0036, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.5279, "num_moves_min": 3.07, "num_moves_max": 4.05, "mean_accuracy_mean": 39.35041666666665, "mean_accuracy_min": 39.13666666666665, "mean_accuracy_max": 39.55466666666665, "num_model_switches_mean": 2.0471, "num_model_switches_min": 1.7, "num_model_switches_max": 2.46, "num_slav_mean": 0.003296666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.007666666666666666, "mean_cluster_cpu_util_mean": 0.4617098398412754, "mean_cluster_cpu_util_min": 0.4533133426595677, "mean_cluster_cpu_util_max": 0.46921230848889756, "mean_cluster_mem_util_mean": 0.31195703185366974, "mean_cluster_mem_util_min": 0.3071471217600964, "mean_cluster_mem_util_max": 0.31536957235425817, "reward_consolidation_mean_mean": 4.198388888888888, "reward_consolidation_mean_min": 3.866666666666666, "reward_consolidation_mean_max": 4.5555555555555545, "reward_illegal_mean_mean": -0.006000000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9206763333333328, "reward_accuracy_mean_min": 3.849199999999999, "reward_accuracy_mean_max": 3.951033333333333, "reward_sla_mean_mean": -0.06461666666666666, "reward_sla_mean_min": -0.15333333333333332, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 419.83888888888885, "reward_consolidation_sum_min": 386.6666666666666, "reward_consolidation_sum_max": 455.5555555555555, "reward_illegal_sum_mean": -0.5999999999999999, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 392.0676333333333, "reward_accuracy_sum_min": 384.9199999999999, "reward_accuracy_sum_max": 395.1033333333333, "reward_sla_sum_mean": -6.461666666666666, "reward_sla_sum_min": -15.333333333333332, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3369.0, "global_timestep_min": 1500, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [790.582222222222, 819.4955555555556, 788.2711111111112, 827.5088888888888, 804.2700000000001, 792.0488888888888, 805.2233333333332, 806.5611111111114, 829.5888888888887, 791.4255555555557, 816.001111111111, 791.9555555555554, 796.3899999999999, 780.2777777777779, 799.0155555555556, 779.1466666666669, 812.3233333333334, 791.1277777777774, 812.9233333333332, 815.821111111111, 806.7055555555555, 778.4211111111113, 813.9588888888889, 784.982222222222, 790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274419051154591, "mean_inference_ms": 2.394228701701416, "mean_action_processing_ms": 0.10120861449317076, "mean_env_wait_ms": 1.752917031730417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006173372268676758, "StateBufferConnector_ms": 0.0037240982055664062, "ViewRequirementAgentConnector_ms": 0.09405279159545898}, "num_episodes": 21, "episode_return_max": 843.2888888888889, "episode_return_min": 767.8466666666668, "episode_return_mean": 804.8448555555552, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 219.50718121291484, "num_env_steps_trained_throughput_per_sec": 234.14099329377584, "timesteps_total": 202350, "num_env_steps_sampled_lifetime": 202350, "num_agent_steps_sampled_lifetime": 202350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 202350, "timers": {"training_iteration_time_ms": 10426.787, "restore_workers_time_ms": 0.015, "training_step_time_ms": 675.183, "sample_time_ms": 657.853, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200}, "done": false, "training_iteration": 92, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-02", "timestamp": 1728602102, "time_this_iter_s": 10.260953426361084, "time_total_s": 953.2857758998871, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfaa2f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 953.2857758998871, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.72666666666667, "ram_util_percent": 55.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 197721.875, "policy_loss": 185906.296875, "entropy": 11.173295974731445, "entropy_coeff": 0.01, "var_gnorm": 16.577425003051758, "vf_loss": 1184908.75, "vf_explained_var": 0.11343151330947876}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 681.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204300, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1364, "num_samples_added_to_queue": 204600, "learner_queue": {"size_count": 681, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.886, "learner_load_time_ms": 0.49, "learner_load_wait_time_ms": 1306.722, "learner_dequeue_time_ms": 11287.881}}, "env_runners": {"episode_reward_max": 854.8433333333335, "episode_reward_min": 767.8466666666668, "episode_reward_mean": 811.147788888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 767.8466666666668}, "policy_reward_max": {"default_policy": 854.8433333333335}, "policy_reward_mean": {"default_policy": 811.147788888889}, "custom_metrics": {"num_consolidated_mean": 2.7395, "num_consolidated_min": 2.61, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0037, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.4353000000000002, "num_moves_min": 2.94, "num_moves_max": 4.05, "mean_accuracy_mean": 39.30253666666665, "mean_accuracy_min": 39.04799999999999, "mean_accuracy_max": 39.55466666666665, "num_model_switches_mean": 2.0369, "num_model_switches_min": 1.7, "num_model_switches_max": 2.46, "num_slav_mean": 0.0029785000000000002, "num_slav_min": 0.0002, "num_slav_max": 0.0067666666666666665, "mean_cluster_cpu_util_mean": 0.4627095019100501, "mean_cluster_cpu_util_min": 0.4533133426595677, "mean_cluster_cpu_util_max": 0.47122343045799053, "mean_cluster_mem_util_mean": 0.3124806612076265, "mean_cluster_mem_util_min": 0.30750297834323603, "mean_cluster_mem_util_max": 0.31705688075863253, "reward_consolidation_mean_mean": 4.260388888888889, "reward_consolidation_mean_min": 3.866666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.006166666666666667, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9155089999999997, "reward_accuracy_mean_min": 3.8371666666666657, "reward_accuracy_mean_max": 3.951033333333333, "reward_sla_mean_mean": -0.05825333333333333, "reward_sla_mean_min": -0.13533333333333333, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 426.03888888888883, "reward_consolidation_sum_min": 386.6666666666666, "reward_consolidation_sum_max": 466.66666666666663, "reward_illegal_sum_mean": -0.6166666666666666, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.55089999999996, "reward_accuracy_sum_min": 383.7166666666666, "reward_accuracy_sum_max": 395.1033333333333, "reward_sla_sum_mean": -5.825333333333334, "reward_sla_sum_min": -13.533333333333333, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4171.0, "global_timestep_min": 2200, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [790.5644444444443, 810.7599999999995, 775.2644444444445, 808.72, 782.3011111111109, 816.9199999999998, 767.8466666666668, 800.9799999999999, 803.3588888888889, 794.9955555555554, 788.5033333333331, 773.1322222222221, 806.7266666666666, 807.1411111111108, 811.2744444444445, 806.1077777777775, 813.9555555555557, 791.7433333333332, 817.9288888888887, 792.0755555555559, 788.5099999999999, 798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744692447944997, "mean_inference_ms": 2.3954387571090523, "mean_action_processing_ms": 0.10122091447371695, "mean_env_wait_ms": 1.7531576042586963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006188392639160156, "StateBufferConnector_ms": 0.003697633743286133, "ViewRequirementAgentConnector_ms": 0.09326291084289551}, "num_episodes": 24, "episode_return_max": 854.8433333333335, "episode_return_min": 767.8466666666668, "episode_return_mean": 811.147788888889, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204300, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.94413817790013, "num_env_steps_trained_throughput_per_sec": 204.34786229937347, "timesteps_total": 204600, "num_env_steps_sampled_lifetime": 204600, "num_agent_steps_sampled_lifetime": 204600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 204600, "timers": {"training_iteration_time_ms": 10402.658, "restore_workers_time_ms": 0.015, "training_step_time_ms": 684.108, "sample_time_ms": 666.728, "synch_weights_time_ms": 15.731}, "counters": {"num_env_steps_sampled": 204600, "num_env_steps_trained": 204300, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1364, "num_samples_added_to_queue": 204600}, "done": false, "training_iteration": 93, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-12", "timestamp": 1728602112, "time_this_iter_s": 10.288092374801636, "time_total_s": 963.5738682746887, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfaa1d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 963.5738682746887, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.573333333333334, "ram_util_percent": 55.53333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 180968.140625, "policy_loss": 169139.9375, "entropy": 10.736322402954102, "entropy_coeff": 0.01, "var_gnorm": 16.590585708618164, "vf_loss": 1186040.25, "vf_explained_var": 0.12367063760757446}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 688.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 206700, "num_env_steps_trained": 206400, "num_agent_steps_sampled": 206700, "num_agent_steps_trained": 206400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1378, "num_samples_added_to_queue": 206700, "learner_queue": {"size_count": 688, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.446, "learner_load_time_ms": 0.499, "learner_load_wait_time_ms": 1387.563, "learner_dequeue_time_ms": 11345.305}}, "env_runners": {"episode_reward_max": 861.48, "episode_reward_min": 778.8922222222222, "episode_reward_mean": 819.8221333333332, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 778.8922222222222}, "policy_reward_max": {"default_policy": 861.48}, "policy_reward_mean": {"default_policy": 819.8221333333332}, "custom_metrics": {"num_consolidated_mean": 2.7684, "num_consolidated_min": 2.63, "num_consolidated_max": 2.91, "num_overloaded_mean": 0.0031, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.3026999999999997, "num_moves_min": 2.65, "num_moves_max": 3.97, "mean_accuracy_mean": 39.25832999999999, "mean_accuracy_min": 39.04799999999999, "mean_accuracy_max": 39.55466666666665, "num_model_switches_mean": 1.9855999999999998, "num_model_switches_min": 1.53, "num_model_switches_max": 2.46, "num_slav_mean": 0.0027463333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0067666666666666665, "mean_cluster_cpu_util_mean": 0.46416734078866456, "mean_cluster_cpu_util_min": 0.4534601798372339, "mean_cluster_cpu_util_max": 0.47258016118416984, "mean_cluster_mem_util_mean": 0.31323293885444475, "mean_cluster_mem_util_min": 0.3077137421424265, "mean_cluster_mem_util_max": 0.3179924976319642, "reward_consolidation_mean_mean": 4.343666666666667, "reward_consolidation_mean_min": 3.9499999999999993, "reward_consolidation_mean_max": 4.749999999999999, "reward_illegal_mean_mean": -0.005166666666666666, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9134846666666654, "reward_accuracy_mean_min": 3.8371666666666657, "reward_accuracy_mean_max": 3.949766666666666, "reward_sla_mean_mean": -0.05376333333333333, "reward_sla_mean_min": -0.13533333333333333, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 434.3666666666666, "reward_consolidation_sum_min": 394.99999999999994, "reward_consolidation_sum_max": 474.99999999999994, "reward_illegal_sum_mean": -0.5166666666666666, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.3484666666666, "reward_accuracy_sum_min": 383.7166666666666, "reward_accuracy_sum_max": 394.97666666666663, "reward_sla_sum_mean": -5.376333333333333, "reward_sla_sum_min": -13.533333333333333, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4871.0, "global_timestep_min": 2900, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [798.8311111111113, 810.3200000000002, 801.6722222222226, 782.2699999999999, 778.8922222222222, 780.8211111111108, 812.8100000000001, 800.671111111111, 821.6355555555554, 797.0166666666664, 804.2788888888889, 797.827777777778, 837.6933333333334, 798.0955555555556, 787.5433333333336, 810.0522222222218, 834.8855555555552, 785.8511111111111, 801.3888888888887, 824.9522222222223, 791.7699999999995, 811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744932992396268, "mean_inference_ms": 2.394828887369352, "mean_action_processing_ms": 0.10121352583559955, "mean_env_wait_ms": 1.7530094645401624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006457805633544922, "StateBufferConnector_ms": 0.003854036331176758, "ViewRequirementAgentConnector_ms": 0.09768319129943848}, "num_episodes": 21, "episode_return_max": 861.48, "episode_return_min": 778.8922222222222, "episode_return_mean": 819.8221333333332, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206700, "num_agent_steps_trained": 206400, "num_env_steps_sampled": 206700, "num_env_steps_trained": 206400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 202.1681939311521, "num_env_steps_trained_throughput_per_sec": 202.1681939311521, "timesteps_total": 206700, "num_env_steps_sampled_lifetime": 206700, "num_agent_steps_sampled_lifetime": 206700, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 206700, "timers": {"training_iteration_time_ms": 10384.438, "restore_workers_time_ms": 0.015, "training_step_time_ms": 745.886, "sample_time_ms": 725.917, "synch_weights_time_ms": 18.053}, "counters": {"num_env_steps_sampled": 206700, "num_env_steps_trained": 206400, "num_agent_steps_sampled": 206700, "num_agent_steps_trained": 206400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1378, "num_samples_added_to_queue": 206700}, "done": false, "training_iteration": 94, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-22", "timestamp": 1728602122, "time_this_iter_s": 10.422460079193115, "time_total_s": 973.9963283538818, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefb4f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 973.9963283538818, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 55.933333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 169763.65625, "policy_loss": 157768.34375, "entropy": 10.348169326782227, "entropy_coeff": 0.01, "var_gnorm": 16.606565475463867, "vf_loss": 1202636.75, "vf_explained_var": 0.1251409649848938}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 695.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 208800, "num_env_steps_trained": 208500, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1392, "num_samples_added_to_queue": 208800, "learner_queue": {"size_count": 695, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.853, "learner_load_time_ms": 0.499, "learner_load_wait_time_ms": 1386.886, "learner_dequeue_time_ms": 11345.305}}, "env_runners": {"episode_reward_max": 864.4466666666663, "episode_reward_min": 779.5522222222224, "episode_reward_mean": 828.4149555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 779.5522222222224}, "policy_reward_max": {"default_policy": 864.4466666666663}, "policy_reward_mean": {"default_policy": 828.4149555555555}, "custom_metrics": {"num_consolidated_mean": 2.7969, "num_consolidated_min": 2.63, "num_consolidated_max": 2.91, "num_overloaded_mean": 0.0028000000000000004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 3.1392000000000007, "num_moves_min": 2.48, "num_moves_max": 3.8, "mean_accuracy_mean": 39.21304666666665, "mean_accuracy_min": 39.003666666666646, "mean_accuracy_max": 39.44699999999998, "num_model_switches_mean": 1.9126000000000003, "num_model_switches_min": 1.53, "num_model_switches_max": 2.38, "num_slav_mean": 0.002254, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0067666666666666665, "mean_cluster_cpu_util_mean": 0.4659236083388527, "mean_cluster_cpu_util_min": 0.45745523478961675, "mean_cluster_cpu_util_max": 0.4748140534693782, "mean_cluster_mem_util_mean": 0.3141230858628262, "mean_cluster_mem_util_min": 0.30926210927408937, "mean_cluster_mem_util_max": 0.3191106680013778, "reward_consolidation_mean_mean": 4.423222222222223, "reward_consolidation_mean_min": 3.972222222222222, "reward_consolidation_mean_max": 4.749999999999999, "reward_illegal_mean_mean": -0.004666666666666667, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.910163999999999, "reward_accuracy_mean_min": 3.8371666666666657, "reward_accuracy_mean_max": 3.9427999999999996, "reward_sla_mean_mean": -0.044570000000000005, "reward_sla_mean_min": -0.13533333333333333, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 442.32222222222214, "reward_consolidation_sum_min": 397.2222222222222, "reward_consolidation_sum_max": 474.99999999999994, "reward_illegal_sum_mean": -0.46666666666666656, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.01639999999986, "reward_accuracy_sum_min": 383.7166666666666, "reward_accuracy_sum_max": 394.28, "reward_sla_sum_mean": -4.457000000000001, "reward_sla_sum_min": -13.533333333333333, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5567.0, "global_timestep_min": 3600, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [811.4233333333334, 779.5522222222224, 823.2677777777776, 809.9911111111111, 824.0366666666664, 796.1355555555556, 809.0533333333332, 797.1455555555553, 799.2933333333335, 786.2122222222225, 786.3011111111108, 806.9455555555554, 813.6433333333333, 827.9355555555552, 820.7555555555557, 820.1888888888886, 829.8811111111108, 822.981111111111, 824.7844444444444, 806.5533333333335, 796.1466666666665, 803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27447907773893776, "mean_inference_ms": 2.3925690187875084, "mean_action_processing_ms": 0.10118733668407845, "mean_env_wait_ms": 1.752477728349706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006560802459716797, "StateBufferConnector_ms": 0.003912925720214844, "ViewRequirementAgentConnector_ms": 0.09953093528747559}, "num_episodes": 21, "episode_return_max": 864.4466666666663, "episode_return_min": 779.5522222222224, "episode_return_mean": 828.4149555555555, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208500, "num_env_steps_sampled": 208800, "num_env_steps_trained": 208500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 206.52759410470398, "num_env_steps_trained_throughput_per_sec": 206.52759410470398, "timesteps_total": 208800, "num_env_steps_sampled_lifetime": 208800, "num_agent_steps_sampled_lifetime": 208800, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 208800, "timers": {"training_iteration_time_ms": 10344.094, "restore_workers_time_ms": 0.013, "training_step_time_ms": 733.195, "sample_time_ms": 715.605, "synch_weights_time_ms": 15.673}, "counters": {"num_env_steps_sampled": 208800, "num_env_steps_trained": 208500, "num_agent_steps_sampled": 208800, "num_agent_steps_trained": 208500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1392, "num_samples_added_to_queue": 208800}, "done": false, "training_iteration": 95, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-33", "timestamp": 1728602133, "time_this_iter_s": 10.184234857559204, "time_total_s": 984.180563211441, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa8a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 984.180563211441, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.457142857142856, "ram_util_percent": 56.03571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 144675.5, "policy_loss": 133798.890625, "entropy": 9.703036308288574, "entropy_coeff": 0.01, "var_gnorm": 16.626232147216797, "vf_loss": 1090571.375, "vf_explained_var": 0.1475256085395813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 703.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 211050, "num_env_steps_trained": 210900, "num_agent_steps_sampled": 211050, "num_agent_steps_trained": 210900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1407, "num_samples_added_to_queue": 210900, "learner_queue": {"size_count": 703, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.135, "learner_load_time_ms": 0.422, "learner_load_wait_time_ms": 1343.232, "learner_dequeue_time_ms": 11380.077}}, "env_runners": {"episode_reward_max": 865.4944444444445, "episode_reward_min": 794.9166666666665, "episode_reward_mean": 836.4125222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 794.9166666666665}, "policy_reward_max": {"default_policy": 865.4944444444445}, "policy_reward_mean": {"default_policy": 836.4125222222222}, "custom_metrics": {"num_consolidated_mean": 2.8225999999999996, "num_consolidated_min": 2.72, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.0025, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.9629000000000008, "num_moves_min": 2.36, "num_moves_max": 3.62, "mean_accuracy_mean": 39.18511666666665, "mean_accuracy_min": 39.003666666666646, "mean_accuracy_max": 39.37099999999998, "num_model_switches_mean": 1.8273, "num_model_switches_min": 1.43, "num_model_switches_max": 2.24, "num_slav_mean": 0.0018089999999999994, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.006, "mean_cluster_cpu_util_mean": 0.46725240260158124, "mean_cluster_cpu_util_min": 0.45782233520596316, "mean_cluster_cpu_util_max": 0.4748140534693782, "mean_cluster_mem_util_mean": 0.31482185713747524, "mean_cluster_mem_util_min": 0.3109735210539912, "mean_cluster_mem_util_max": 0.3191106680013778, "reward_consolidation_mean_mean": 4.495555555555556, "reward_consolidation_mean_min": 4.172222222222222, "reward_consolidation_mean_max": 4.777777777777777, "reward_illegal_mean_mean": -0.004166666666666667, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.908559666666666, "reward_accuracy_mean_min": 3.8371666666666657, "reward_accuracy_mean_max": 3.9370999999999996, "reward_sla_mean_mean": -0.03582333333333334, "reward_sla_mean_min": -0.12, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 449.5555555555555, "reward_consolidation_sum_min": 417.2222222222222, "reward_consolidation_sum_max": 477.7777777777777, "reward_illegal_sum_mean": -0.4166666666666666, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.8559666666666, "reward_accuracy_sum_min": 383.7166666666666, "reward_accuracy_sum_max": 393.71, "reward_sla_sum_mean": -3.5823333333333336, "reward_sla_sum_min": -12.0, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6035.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [803.2988888888889, 805.4766666666666, 827.082222222222, 830.432222222222, 814.8722222222225, 828.9999999999995, 804.3155555555555, 823.3444444444444, 829.8633333333333, 806.2166666666666, 822.22, 810.7322222222225, 843.2888888888889, 854.8433333333335, 813.318888888889, 821.0811111111115, 828.1733333333332, 815.9388888888885, 794.9166666666665, 834.0999999999998, 831.1166666666667, 829.0433333333332, 816.121111111111, 814.3300000000002, 816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27452748335457144, "mean_inference_ms": 2.3923405708195618, "mean_action_processing_ms": 0.10119237789945908, "mean_env_wait_ms": 1.7525418984100423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006760120391845703, "StateBufferConnector_ms": 0.003927707672119141, "ViewRequirementAgentConnector_ms": 0.09995412826538086}, "num_episodes": 21, "episode_return_max": 865.4944444444445, "episode_return_min": 794.9166666666665, "episode_return_mean": 836.4125222222222, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211050, "num_agent_steps_trained": 210900, "num_env_steps_sampled": 211050, "num_env_steps_trained": 210900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 213.62612950887615, "num_env_steps_trained_throughput_per_sec": 227.86787147613455, "timesteps_total": 211050, "num_env_steps_sampled_lifetime": 211050, "num_agent_steps_sampled_lifetime": 211050, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 211050, "timers": {"training_iteration_time_ms": 10315.523, "restore_workers_time_ms": 0.016, "training_step_time_ms": 709.81, "sample_time_ms": 691.528, "synch_weights_time_ms": 16.614}, "counters": {"num_env_steps_sampled": 211050, "num_env_steps_trained": 210900, "num_agent_steps_sampled": 211050, "num_agent_steps_trained": 210900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1407, "num_samples_added_to_queue": 210900}, "done": false, "training_iteration": 96, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-43", "timestamp": 1728602143, "time_this_iter_s": 10.542654275894165, "time_total_s": 994.7232174873352, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa9f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 994.7232174873352, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.24, "ram_util_percent": 55.86666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 122926.6328125, "policy_loss": 111675.6796875, "entropy": 8.905966758728027, "entropy_coeff": 0.01, "var_gnorm": 16.645458221435547, "vf_loss": 1127767.25, "vf_explained_var": 0.1591930389404297}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 710.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 213300, "num_env_steps_trained": 213000, "num_agent_steps_sampled": 213300, "num_agent_steps_trained": 213000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1422, "num_samples_added_to_queue": 213300, "learner_queue": {"size_count": 710, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.42, "learner_load_time_ms": 0.407, "learner_load_wait_time_ms": 1353.844, "learner_dequeue_time_ms": 11383.705}}, "env_runners": {"episode_reward_max": 877.9655555555552, "episode_reward_min": 811.9777777777779, "episode_reward_mean": 846.7633666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 811.9777777777779}, "policy_reward_max": {"default_policy": 877.9655555555552}, "policy_reward_mean": {"default_policy": 846.7633666666666}, "custom_metrics": {"num_consolidated_mean": 2.8547000000000002, "num_consolidated_min": 2.74, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0014000000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 2.7295000000000003, "num_moves_min": 1.97, "num_moves_max": 3.3, "mean_accuracy_mean": 39.16769999999998, "mean_accuracy_min": 39.003666666666646, "mean_accuracy_max": 39.35199999999998, "num_model_switches_mean": 1.6696, "num_model_switches_min": 1.02, "num_model_switches_max": 2.15, "num_slav_mean": 0.0015458333333333335, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.006, "mean_cluster_cpu_util_mean": 0.4691709408516453, "mean_cluster_cpu_util_min": 0.4623806843201851, "mean_cluster_cpu_util_max": 0.4748140534693782, "mean_cluster_mem_util_mean": 0.3158411286058727, "mean_cluster_mem_util_min": 0.3117403475630759, "mean_cluster_mem_util_max": 0.3193157802678034, "reward_consolidation_mean_mean": 4.589666666666666, "reward_consolidation_mean_min": 4.277777777777777, "reward_consolidation_mean_max": 4.888888888888888, "reward_illegal_mean_mean": -0.0023333333333333335, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9111869999999986, "reward_accuracy_mean_min": 3.871299999999999, "reward_accuracy_mean_max": 3.9352, "reward_sla_mean_mean": -0.03088666666666667, "reward_sla_mean_min": -0.12, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 458.96666666666664, "reward_consolidation_sum_min": 427.7777777777777, "reward_consolidation_sum_max": 488.8888888888888, "reward_illegal_sum_mean": -0.2333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.1186999999999, "reward_accuracy_sum_min": 387.1299999999999, "reward_accuracy_sum_max": 393.52, "reward_sla_sum_mean": -3.088666666666668, "reward_sla_sum_min": -12.0, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4961.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [816.2377777777778, 822.5411111111111, 842.0344444444444, 847.991111111111, 840.7544444444443, 826.9977777777775, 831.3266666666667, 827.2588888888889, 830.2833333333331, 827.7066666666666, 826.1555555555556, 829.5566666666665, 842.4911111111111, 835.9255555555554, 826.6599999999997, 851.9344444444444, 834.4055555555556, 836.2699999999998, 830.5499999999998, 845.4900000000002, 845.7533333333332, 811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27458873167548087, "mean_inference_ms": 2.3926999390657357, "mean_action_processing_ms": 0.10120857212917128, "mean_env_wait_ms": 1.7528548676950124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007359504699707031, "StateBufferConnector_ms": 0.003937244415283203, "ViewRequirementAgentConnector_ms": 0.09996676445007324}, "num_episodes": 24, "episode_return_max": 877.9655555555552, "episode_return_min": 811.9777777777779, "episode_return_mean": 846.7633666666666, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213300, "num_agent_steps_trained": 213000, "num_env_steps_sampled": 213300, "num_env_steps_trained": 213000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 210.67848758967838, "num_env_steps_trained_throughput_per_sec": 196.63325508369982, "timesteps_total": 213300, "num_env_steps_sampled_lifetime": 213300, "num_agent_steps_sampled_lifetime": 213300, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 213300, "timers": {"training_iteration_time_ms": 10315.904, "restore_workers_time_ms": 0.013, "training_step_time_ms": 717.938, "sample_time_ms": 700.781, "synch_weights_time_ms": 15.592}, "counters": {"num_env_steps_sampled": 213300, "num_env_steps_trained": 213000, "num_agent_steps_sampled": 213300, "num_agent_steps_trained": 213000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1422, "num_samples_added_to_queue": 213300}, "done": false, "training_iteration": 97, "trial_id": "3f041_00000", "date": "2024-10-11_00-15-54", "timestamp": 1728602154, "time_this_iter_s": 10.68896484375, "time_total_s": 1005.4121823310852, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfaa7a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1005.4121823310852, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 18.98125, "ram_util_percent": 56.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 123369.4453125, "policy_loss": 112296.359375, "entropy": 8.509218215942383, "entropy_coeff": 0.01, "var_gnorm": 16.671815872192383, "vf_loss": 1109861.625, "vf_explained_var": 0.1662348508834839}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 215550, "num_env_steps_trained": 215400, "num_agent_steps_sampled": 215550, "num_agent_steps_trained": 215400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1437, "num_samples_added_to_queue": 215400, "learner_queue": {"size_count": 718, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.592, "learner_load_time_ms": 0.419, "learner_load_wait_time_ms": 1369.808, "learner_dequeue_time_ms": 11378.063}}, "env_runners": {"episode_reward_max": 879.165555555555, "episode_reward_min": 811.9777777777779, "episode_reward_mean": 853.4135999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 811.9777777777779}, "policy_reward_max": {"default_policy": 879.165555555555}, "policy_reward_mean": {"default_policy": 853.4135999999999}, "custom_metrics": {"num_consolidated_mean": 2.8769000000000005, "num_consolidated_min": 2.76, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0013, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 2.5225, "num_moves_min": 1.77, "num_moves_max": 3.17, "mean_accuracy_mean": 39.15623666666665, "mean_accuracy_min": 39.003666666666646, "mean_accuracy_max": 39.29499999999998, "num_model_switches_mean": 1.5206000000000004, "num_model_switches_min": 0.98, "num_model_switches_max": 2.15, "num_slav_mean": 0.0012993333333333331, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.004299999999999999, "mean_cluster_cpu_util_mean": 0.47021811535231317, "mean_cluster_cpu_util_min": 0.4632699284105534, "mean_cluster_cpu_util_max": 0.4748140534693782, "mean_cluster_mem_util_mean": 0.31650488203952465, "mean_cluster_mem_util_min": 0.3117403475630759, "mean_cluster_mem_util_max": 0.3195527426160337, "reward_consolidation_mean_mean": 4.651833333333332, "reward_consolidation_mean_min": 4.31111111111111, "reward_consolidation_mean_max": 4.888888888888888, "reward_illegal_mean_mean": -0.0021666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9104326666666656, "reward_accuracy_mean_min": 3.871299999999999, "reward_accuracy_mean_max": 3.929499999999999, "reward_sla_mean_mean": -0.025963333333333338, "reward_sla_mean_min": -0.086, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 465.1833333333333, "reward_consolidation_sum_min": 431.11111111111103, "reward_consolidation_sum_max": 488.8888888888888, "reward_illegal_sum_mean": -0.21666666666666665, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.0432666666665, "reward_accuracy_sum_min": 387.1299999999999, "reward_accuracy_sum_max": 392.94999999999993, "reward_sla_sum_mean": -2.5963333333333334, "reward_sla_sum_min": -8.6, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4025.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [811.9777777777779, 835.9833333333333, 834.3288888888892, 853.2933333333333, 836.7666666666664, 849.9911111111111, 835.3055555555554, 823.0266666666665, 849.5011111111111, 837.4000000000001, 848.62, 861.48, 831.581111111111, 825.9122222222223, 847.2233333333332, 826.9344444444447, 825.6188888888888, 840.9500000000002, 838.1477777777776, 864.4466666666663, 854.0899999999999, 842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2746385719614283, "mean_inference_ms": 2.3928385053990358, "mean_action_processing_ms": 0.10122175289697026, "mean_env_wait_ms": 1.7531103579431084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007342338562011719, "StateBufferConnector_ms": 0.003943681716918945, "ViewRequirementAgentConnector_ms": 0.09998202323913574}, "num_episodes": 21, "episode_return_max": 879.165555555555, "episode_return_min": 811.9777777777779, "episode_return_mean": 853.4135999999999, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215550, "num_agent_steps_trained": 215400, "num_env_steps_sampled": 215550, "num_env_steps_trained": 215400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 212.5120809422625, "num_env_steps_trained_throughput_per_sec": 226.67955300507998, "timesteps_total": 215550, "num_env_steps_sampled_lifetime": 215550, "num_agent_steps_sampled_lifetime": 215550, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 215550, "timers": {"training_iteration_time_ms": 10368.862, "restore_workers_time_ms": 0.015, "training_step_time_ms": 704.562, "sample_time_ms": 686.098, "synch_weights_time_ms": 16.875}, "counters": {"num_env_steps_sampled": 215550, "num_env_steps_trained": 215400, "num_agent_steps_sampled": 215550, "num_agent_steps_trained": 215400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1437, "num_samples_added_to_queue": 215400}, "done": false, "training_iteration": 98, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-05", "timestamp": 1728602165, "time_this_iter_s": 10.606733083724976, "time_total_s": 1016.0189154148102, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b173040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1016.0189154148102, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.680000000000003, "ram_util_percent": 56.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 119991.3359375, "policy_loss": 108684.609375, "entropy": 8.368188858032227, "entropy_coeff": 0.01, "var_gnorm": 16.690692901611328, "vf_loss": 1133183.125, "vf_explained_var": 0.17668288946151733}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 217650, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 217650, "num_agent_steps_trained": 217500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1451, "num_samples_added_to_queue": 217500, "learner_queue": {"size_count": 725, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.326, "learner_load_time_ms": 0.428, "learner_load_wait_time_ms": 1376.117, "learner_dequeue_time_ms": 11371.697}}, "env_runners": {"episode_reward_max": 881.0966666666664, "episode_reward_min": 830.4011111111109, "episode_reward_mean": 859.3940444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 830.4011111111109}, "policy_reward_max": {"default_policy": 881.0966666666664}, "policy_reward_mean": {"default_policy": 859.3940444444443}, "custom_metrics": {"num_consolidated_mean": 2.8971, "num_consolidated_min": 2.8, "num_consolidated_max": 2.97, "num_overloaded_mean": 0.0011, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 2.326, "num_moves_min": 1.77, "num_moves_max": 3.07, "mean_accuracy_mean": 39.14033999999998, "mean_accuracy_min": 38.997333333333316, "mean_accuracy_max": 39.29499999999998, "num_model_switches_mean": 1.3575, "num_model_switches_min": 0.81, "num_model_switches_max": 2.0, "num_slav_mean": 0.0011415000000000002, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.004299999999999999, "mean_cluster_cpu_util_mean": 0.4710947158367723, "mean_cluster_cpu_util_min": 0.465322167567139, "mean_cluster_cpu_util_max": 0.4765155151202407, "mean_cluster_mem_util_mean": 0.317139612723887, "mean_cluster_mem_util_min": 0.3133731540084388, "mean_cluster_mem_util_max": 0.3200880667140274, "reward_consolidation_mean_mean": 4.708944444444444, "reward_consolidation_mean_min": 4.444444444444444, "reward_consolidation_mean_max": 4.916666666666666, "reward_illegal_mean_mean": -0.0018333333333333335, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9096459999999995, "reward_accuracy_mean_min": 3.8624333333333323, "reward_accuracy_mean_max": 3.929499999999999, "reward_sla_mean_mean": -0.022816666666666666, "reward_sla_mean_min": -0.086, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 470.89444444444433, "reward_consolidation_sum_min": 444.4444444444444, "reward_consolidation_sum_max": 491.6666666666666, "reward_illegal_sum_mean": -0.18333333333333332, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.9646, "reward_accuracy_sum_min": 386.2433333333332, "reward_accuracy_sum_max": 392.94999999999993, "reward_sla_sum_mean": -2.2816666666666667, "reward_sla_sum_min": -8.6, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3087.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [842.8222222222221, 847.8199999999999, 841.1122222222222, 840.1777777777775, 834.0355555555556, 845.3188888888884, 846.17, 834.4744444444442, 845.3522222222223, 844.7344444444442, 862.28, 858.2499999999998, 852.6900000000002, 830.4011111111109, 841.6900000000002, 865.4944444444445, 835.8644444444448, 846.7333333333331, 848.61, 849.6377777777776, 844.4355555555557, 844.672222222222, 851.7255555555557, 851.7766666666664, 848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274670613194099, "mean_inference_ms": 2.3930156897495376, "mean_action_processing_ms": 0.10122672305606734, "mean_env_wait_ms": 1.7532549789541934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007185697555541992, "StateBufferConnector_ms": 0.0038666725158691406, "ViewRequirementAgentConnector_ms": 0.09707856178283691}, "num_episodes": 21, "episode_return_max": 881.0966666666664, "episode_return_min": 830.4011111111109, "episode_return_mean": 859.3940444444443, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217650, "num_agent_steps_trained": 217500, "num_env_steps_sampled": 217650, "num_env_steps_trained": 217500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 205.35918932901603, "num_env_steps_trained_throughput_per_sec": 205.35918932901603, "timesteps_total": 217650, "num_env_steps_sampled_lifetime": 217650, "num_agent_steps_sampled_lifetime": 217650, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 217650, "timers": {"training_iteration_time_ms": 10387.649, "restore_workers_time_ms": 0.015, "training_step_time_ms": 732.249, "sample_time_ms": 714.675, "synch_weights_time_ms": 15.958}, "counters": {"num_env_steps_sampled": 217650, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 217650, "num_agent_steps_trained": 217500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1451, "num_samples_added_to_queue": 217500}, "done": false, "training_iteration": 99, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-15", "timestamp": 1728602175, "time_this_iter_s": 10.2366304397583, "time_total_s": 1026.2555458545685, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae53be0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1026.2555458545685, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.842857142857145, "ram_util_percent": 56.33571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 122468.21875, "policy_loss": 110849.0703125, "entropy": 8.231914520263672, "entropy_coeff": 0.01, "var_gnorm": 16.70706558227539, "vf_loss": 1164384.625, "vf_explained_var": 0.18473786115646362}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 732.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 219900, "num_env_steps_trained": 219600, "num_agent_steps_sampled": 219900, "num_agent_steps_trained": 219600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1466, "num_samples_added_to_queue": 219900, "learner_queue": {"size_count": 732, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.098, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1322.956, "learner_dequeue_time_ms": 11353.586}}, "env_runners": {"episode_reward_max": 881.0966666666664, "episode_reward_min": 832.0144444444443, "episode_reward_mean": 865.3210888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 832.0144444444443}, "policy_reward_max": {"default_policy": 881.0966666666664}, "policy_reward_mean": {"default_policy": 865.3210888888888}, "custom_metrics": {"num_consolidated_mean": 2.9171000000000005, "num_consolidated_min": 2.83, "num_consolidated_max": 2.97, "num_overloaded_mean": 0.0007000000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 2.1270000000000007, "num_moves_min": 1.74, "num_moves_max": 2.91, "mean_accuracy_mean": 39.115766666666644, "mean_accuracy_min": 38.97833333333331, "mean_accuracy_max": 39.29499999999998, "num_model_switches_mean": 1.2029, "num_model_switches_min": 0.81, "num_model_switches_max": 1.7, "num_slav_mean": 0.0010319999999999997, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0029499999999999995, "mean_cluster_cpu_util_mean": 0.47175341611491617, "mean_cluster_cpu_util_min": 0.4655212585034014, "mean_cluster_cpu_util_max": 0.4765155151202407, "mean_cluster_mem_util_mean": 0.31770295592224224, "mean_cluster_mem_util_min": 0.3133731540084388, "mean_cluster_mem_util_max": 0.3200880667140274, "reward_consolidation_mean_mean": 4.766222222222221, "reward_consolidation_mean_min": 4.477777777777777, "reward_consolidation_mean_max": 4.916666666666666, "reward_illegal_mean_mean": -0.0011666666666666668, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9087819999999995, "reward_accuracy_mean_min": 3.8624333333333323, "reward_accuracy_mean_max": 3.929499999999999, "reward_sla_mean_mean": -0.020626666666666668, "reward_sla_mean_min": -0.05900000000000001, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 476.62222222222226, "reward_consolidation_sum_min": 447.7777777777777, "reward_consolidation_sum_max": 491.66666666666663, "reward_illegal_sum_mean": -0.11666666666666664, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.87819999999994, "reward_accuracy_sum_min": 386.2433333333332, "reward_accuracy_sum_max": 392.94999999999993, "reward_sla_sum_mean": -2.062666666666667, "reward_sla_sum_min": -5.900000000000001, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2095.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [848.6077777777775, 853.9222222222222, 850.0677777777779, 845.7933333333332, 832.0144444444443, 846.5288888888886, 852.9488888888889, 855.1399999999999, 846.038888888889, 849.881111111111, 867.9844444444444, 858.1566666666663, 862.3599999999997, 864.7166666666666, 862.965555555555, 877.9655555555552, 876.5244444444442, 858.9388888888888, 861.4822222222223, 853.9122222222223, 863.8066666666666, 858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27473759271527265, "mean_inference_ms": 2.3952123849772557, "mean_action_processing_ms": 0.10125533565005672, "mean_env_wait_ms": 1.7538689462277113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00708770751953125, "StateBufferConnector_ms": 0.0038788318634033203, "ViewRequirementAgentConnector_ms": 0.09733724594116211}, "num_episodes": 24, "episode_return_max": 881.0966666666664, "episode_return_min": 832.0144444444443, "episode_return_mean": 865.3210888888888, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219900, "num_agent_steps_trained": 219600, "num_env_steps_sampled": 219900, "num_env_steps_trained": 219600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.2781304085095, "num_env_steps_trained_throughput_per_sec": 200.9262550479422, "timesteps_total": 219900, "num_env_steps_sampled_lifetime": 219900, "num_agent_steps_sampled_lifetime": 219900, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 219900, "timers": {"training_iteration_time_ms": 10376.361, "restore_workers_time_ms": 0.012, "training_step_time_ms": 691.291, "sample_time_ms": 674.602, "synch_weights_time_ms": 14.878}, "counters": {"num_env_steps_sampled": 219900, "num_env_steps_trained": 219600, "num_agent_steps_sampled": 219900, "num_agent_steps_trained": 219600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1466, "num_samples_added_to_queue": 219900}, "done": false, "training_iteration": 100, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-25", "timestamp": 1728602185, "time_this_iter_s": 10.463200807571411, "time_total_s": 1036.71874666214, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefbdc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1036.71874666214, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.973333333333336, "ram_util_percent": 56.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 109053.1484375, "policy_loss": 98647.46875, "entropy": 8.299521446228027, "entropy_coeff": 0.01, "var_gnorm": 16.72515869140625, "vf_loss": 1043058.0, "vf_explained_var": 0.20126700401306152}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 740.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 222150, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222150, "num_agent_steps_trained": 222000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1481, "num_samples_added_to_queue": 222000, "learner_queue": {"size_count": 740, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.215, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1351.777, "learner_dequeue_time_ms": 11363.12}}, "env_runners": {"episode_reward_max": 881.4666666666667, "episode_reward_min": 844.1055555555554, "episode_reward_mean": 868.9107222222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 844.1055555555554}, "policy_reward_max": {"default_policy": 881.4666666666667}, "policy_reward_mean": {"default_policy": 868.9107222222219}, "custom_metrics": {"num_consolidated_mean": 2.93, "num_consolidated_min": 2.84, "num_consolidated_max": 2.97, "num_overloaded_mean": 0.0005, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 2.0228, "num_moves_min": 1.53, "num_moves_max": 2.58, "mean_accuracy_mean": 39.08669666666665, "mean_accuracy_min": 38.92766666666664, "mean_accuracy_max": 39.26966666666665, "num_model_switches_mean": 1.1336, "num_model_switches_min": 0.79, "num_model_switches_max": 1.5, "num_slav_mean": 0.0009896666666666667, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.003533333333333333, "mean_cluster_cpu_util_mean": 0.4721619591295523, "mean_cluster_cpu_util_min": 0.4655212585034014, "mean_cluster_cpu_util_max": 0.47665919479838587, "mean_cluster_mem_util_mean": 0.3180797840997158, "mean_cluster_mem_util_min": 0.3133731540084388, "mean_cluster_mem_util_max": 0.32096621781624035, "reward_consolidation_mean_mean": 4.803055555555555, "reward_consolidation_mean_min": 4.5555555555555545, "reward_consolidation_mean_max": 4.916666666666666, "reward_illegal_mean_mean": -0.0008333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9066716666666665, "reward_accuracy_mean_min": 3.8624333333333323, "reward_accuracy_mean_max": 3.9269666666666665, "reward_sla_mean_mean": -0.01978666666666667, "reward_sla_mean_min": -0.07066666666666667, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 480.30555555555554, "reward_consolidation_sum_min": 455.5555555555555, "reward_consolidation_sum_max": 491.66666666666663, "reward_illegal_sum_mean": -0.08333333333333331, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.6671666666665, "reward_accuracy_sum_min": 386.2433333333332, "reward_accuracy_sum_max": 392.69666666666666, "reward_sla_sum_mean": -1.9786666666666664, "reward_sla_sum_min": -7.066666666666666, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2167.0, "global_timestep_min": 200, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [858.824444444444, 867.8377777777774, 861.1699999999994, 869.8322222222218, 856.894444444444, 850.4077777777778, 866.9744444444441, 855.442222222222, 871.8700000000001, 866.7177777777774, 871.6755555555553, 867.804444444444, 863.9466666666663, 874.6111111111107, 860.1444444444442, 879.0522222222219, 868.1377777777775, 852.4755555555555, 873.4999999999999, 860.6188888888886, 868.2844444444441, 865.6066666666666, 862.2166666666661, 867.1922222222222, 863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27469230624177926, "mean_inference_ms": 2.39334884283954, "mean_action_processing_ms": 0.1012330379973326, "mean_env_wait_ms": 1.7534430023568377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067713260650634766, "StateBufferConnector_ms": 0.003863811492919922, "ViewRequirementAgentConnector_ms": 0.09711241722106934}, "num_episodes": 21, "episode_return_max": 881.4666666666667, "episode_return_min": 844.1055555555554, "episode_return_mean": 868.9107222222219, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222150, "num_agent_steps_trained": 222000, "num_env_steps_sampled": 222150, "num_env_steps_trained": 222000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 210.28808549477915, "num_env_steps_trained_throughput_per_sec": 224.3072911944311, "timesteps_total": 222150, "num_env_steps_sampled_lifetime": 222150, "num_agent_steps_sampled_lifetime": 222150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 222150, "timers": {"training_iteration_time_ms": 10425.946, "restore_workers_time_ms": 0.014, "training_step_time_ms": 717.718, "sample_time_ms": 701.536, "synch_weights_time_ms": 14.481}, "counters": {"num_env_steps_sampled": 222150, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222150, "num_agent_steps_trained": 222000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1481, "num_samples_added_to_queue": 222000}, "done": false, "training_iteration": 101, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-36", "timestamp": 1728602196, "time_this_iter_s": 10.709705352783203, "time_total_s": 1047.428452014923, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfaae60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1047.428452014923, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 19.262500000000003, "ram_util_percent": 56.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 95092.6796875, "policy_loss": 85966.171875, "entropy": 8.257715225219727, "entropy_coeff": 0.01, "var_gnorm": 16.741804122924805, "vf_loss": 915128.0, "vf_explained_var": 0.22203242778778076}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 747.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 224400, "num_env_steps_trained": 224100, "num_agent_steps_sampled": 224400, "num_agent_steps_trained": 224100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1496, "num_samples_added_to_queue": 224400, "learner_queue": {"size_count": 747, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.267, "learner_load_time_ms": 0.376, "learner_load_wait_time_ms": 1341.245, "learner_dequeue_time_ms": 11378.17}}, "env_runners": {"episode_reward_max": 886.2422222222219, "episode_reward_min": 844.1055555555554, "episode_reward_mean": 870.6969555555553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 844.1055555555554}, "policy_reward_max": {"default_policy": 886.2422222222219}, "policy_reward_mean": {"default_policy": 870.6969555555553}, "custom_metrics": {"num_consolidated_mean": 2.9366000000000008, "num_consolidated_min": 2.84, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.9795999999999998, "num_moves_min": 1.53, "num_moves_max": 2.32, "mean_accuracy_mean": 39.03203999999998, "mean_accuracy_min": 38.78833333333331, "mean_accuracy_max": 39.20633333333332, "num_model_switches_mean": 1.0911000000000002, "num_model_switches_min": 0.79, "num_model_switches_max": 1.38, "num_slav_mean": 0.0008996666666666667, "num_slav_min": 5e-05, "num_slav_max": 0.003533333333333333, "mean_cluster_cpu_util_mean": 0.47223164911481147, "mean_cluster_cpu_util_min": 0.4655212585034014, "mean_cluster_cpu_util_max": 0.47665919479838587, "mean_cluster_mem_util_mean": 0.3181084129962112, "mean_cluster_mem_util_min": 0.3133731540084388, "mean_cluster_mem_util_max": 0.32096621781624035, "reward_consolidation_mean_mean": 4.822888888888889, "reward_consolidation_mean_min": 4.5555555555555545, "reward_consolidation_mean_max": 4.972222222222221, "reward_illegal_mean_mean": -0.0003333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.902407333333332, "reward_accuracy_mean_min": 3.8624333333333323, "reward_accuracy_mean_max": 3.920633333333333, "reward_sla_mean_mean": -0.017993333333333333, "reward_sla_mean_min": -0.07066666666666667, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 482.28888888888883, "reward_consolidation_sum_min": 455.5555555555555, "reward_consolidation_sum_max": 497.2222222222222, "reward_illegal_sum_mean": -0.03333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 390.2407333333333, "reward_accuracy_sum_min": 386.2433333333332, "reward_accuracy_sum_max": 392.0633333333333, "reward_sla_sum_mean": -1.7993333333333335, "reward_sla_sum_min": -7.066666666666666, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2971.0, "global_timestep_min": 1000, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [863.5855555555552, 869.4855555555553, 844.1055555555554, 857.2677777777776, 879.165555555555, 858.1077777777774, 868.5444444444439, 872.02, 870.8855555555552, 868.3399999999999, 858.361111111111, 868.8822222222218, 873.8833333333332, 856.0911111111112, 874.8944444444437, 867.4011111111112, 865.2877777777774, 865.13, 875.914444444444, 873.4477777777774, 881.0966666666664, 857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27476679018859973, "mean_inference_ms": 2.3954601933863087, "mean_action_processing_ms": 0.10126311420868038, "mean_env_wait_ms": 1.7540670991311922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006406307220458984, "StateBufferConnector_ms": 0.003880023956298828, "ViewRequirementAgentConnector_ms": 0.09713149070739746}, "num_episodes": 24, "episode_return_max": 886.2422222222219, "episode_return_min": 844.1055555555554, "episode_return_mean": 870.6969555555553, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224400, "num_agent_steps_trained": 224100, "num_env_steps_sampled": 224400, "num_env_steps_trained": 224100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 214.69554015509783, "num_env_steps_trained_throughput_per_sec": 200.38250414475797, "timesteps_total": 224400, "num_env_steps_sampled_lifetime": 224400, "num_agent_steps_sampled_lifetime": 224400, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 224400, "timers": {"training_iteration_time_ms": 10448.918, "restore_workers_time_ms": 0.013, "training_step_time_ms": 708.329, "sample_time_ms": 690.841, "synch_weights_time_ms": 15.829}, "counters": {"num_env_steps_sampled": 224400, "num_env_steps_trained": 224100, "num_agent_steps_sampled": 224400, "num_agent_steps_trained": 224100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1496, "num_samples_added_to_queue": 224400}, "done": false, "training_iteration": 102, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-47", "timestamp": 1728602207, "time_this_iter_s": 10.490768194198608, "time_total_s": 1057.9192202091217, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfab4f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1057.9192202091217, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 18.573333333333334, "ram_util_percent": 56.613333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 90751.25, "policy_loss": 81291.9296875, "entropy": 7.896214962005615, "entropy_coeff": 0.01, "var_gnorm": 16.763607025146484, "vf_loss": 948300.6875, "vf_explained_var": 0.23299115896224976}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 754.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 226500, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226500, "num_agent_steps_trained": 226200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1510, "num_samples_added_to_queue": 226500, "learner_queue": {"size_count": 754, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.781, "learner_load_time_ms": 0.343, "learner_load_wait_time_ms": 1369.983, "learner_dequeue_time_ms": 11425.137}}, "env_runners": {"episode_reward_max": 886.2422222222219, "episode_reward_min": 852.5299999999999, "episode_reward_mean": 872.0580555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 852.5299999999999}, "policy_reward_max": {"default_policy": 886.2422222222219}, "policy_reward_mean": {"default_policy": 872.0580555555555}, "custom_metrics": {"num_consolidated_mean": 2.9429, "num_consolidated_min": 2.88, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.9626000000000001, "num_moves_min": 1.53, "num_moves_max": 2.33, "mean_accuracy_mean": 38.968833333333315, "mean_accuracy_min": 38.680666666666646, "mean_accuracy_max": 39.14933333333331, "num_model_switches_mean": 1.0674, "num_model_switches_min": 0.67, "num_model_switches_max": 1.38, "num_slav_mean": 0.0008313333333333333, "num_slav_min": 5e-05, "num_slav_max": 0.003533333333333333, "mean_cluster_cpu_util_mean": 0.4725448619911415, "mean_cluster_cpu_util_min": 0.4674155520316235, "mean_cluster_cpu_util_max": 0.4767823691897988, "mean_cluster_mem_util_mean": 0.318118075093645, "mean_cluster_mem_util_min": 0.31409599156118145, "mean_cluster_mem_util_max": 0.32096621781624035, "reward_consolidation_mean_mean": 4.8408888888888875, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.972222222222221, "reward_illegal_mean_mean": -0.00016666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.896485, "reward_accuracy_mean_min": 3.8680666666666657, "reward_accuracy_mean_max": 3.914933333333333, "reward_sla_mean_mean": -0.016626666666666668, "reward_sla_mean_min": -0.07066666666666667, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 484.0888888888889, "reward_consolidation_sum_min": 466.66666666666663, "reward_consolidation_sum_max": 497.2222222222222, "reward_illegal_sum_mean": -0.016666666666666666, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.6484999999999, "reward_accuracy_sum_min": 386.80666666666656, "reward_accuracy_sum_max": 391.4933333333333, "reward_sla_sum_mean": -1.6626666666666672, "reward_sla_sum_min": -7.066666666666666, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3671.0, "global_timestep_min": 1700, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [857.0866666666664, 873.0211111111109, 867.5177777777772, 875.7711111111108, 855.2777777777773, 871.2366666666665, 868.8588888888885, 861.7622222222221, 876.4944444444445, 863.2066666666664, 865.3377777777775, 870.4833333333331, 865.4399999999996, 854.9766666666665, 875.9311111111111, 866.5944444444441, 875.1811111111109, 871.0788888888885, 874.3911111111106, 874.5377777777778, 863.4333333333329, 879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27479761854902535, "mean_inference_ms": 2.3954655186612994, "mean_action_processing_ms": 0.10126644753655359, "mean_env_wait_ms": 1.7541522997599985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00642704963684082, "StateBufferConnector_ms": 0.003907918930053711, "ViewRequirementAgentConnector_ms": 0.09783291816711426}, "num_episodes": 21, "episode_return_max": 886.2422222222219, "episode_return_min": 852.5299999999999, "episode_return_mean": 872.0580555555555, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226500, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226500, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 208.17561247512918, "num_env_steps_trained_throughput_per_sec": 208.17561247512918, "timesteps_total": 226500, "num_env_steps_sampled_lifetime": 226500, "num_agent_steps_sampled_lifetime": 226500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 226500, "timers": {"training_iteration_time_ms": 10430.022, "restore_workers_time_ms": 0.013, "training_step_time_ms": 733.15, "sample_time_ms": 715.902, "synch_weights_time_ms": 15.58}, "counters": {"num_env_steps_sampled": 226500, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226500, "num_agent_steps_trained": 226200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1510, "num_samples_added_to_queue": 226500}, "done": false, "training_iteration": 103, "trial_id": "3f041_00000", "date": "2024-10-11_00-16-57", "timestamp": 1728602217, "time_this_iter_s": 10.10018014907837, "time_total_s": 1068.0194003582, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1068.0194003582, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 19.071428571428573, "ram_util_percent": 56.83571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 73346.5703125, "policy_loss": 64642.1875, "entropy": 7.271591663360596, "entropy_coeff": 0.01, "var_gnorm": 16.79510498046875, "vf_loss": 872619.625, "vf_explained_var": 0.2542411684989929}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 762.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 228750, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228750, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1525, "num_samples_added_to_queue": 228600, "learner_queue": {"size_count": 762, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.948, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 1346.824, "learner_dequeue_time_ms": 11484.578}}, "env_runners": {"episode_reward_max": 886.2422222222219, "episode_reward_min": 852.5299999999999, "episode_reward_mean": 874.073533333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 852.5299999999999}, "policy_reward_max": {"default_policy": 886.2422222222219}, "policy_reward_mean": {"default_policy": 874.073533333333}, "custom_metrics": {"num_consolidated_mean": 2.9523000000000006, "num_consolidated_min": 2.88, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.9012, "num_moves_min": 1.45, "num_moves_max": 2.33, "mean_accuracy_mean": 38.88611999999998, "mean_accuracy_min": 38.58566666666665, "mean_accuracy_max": 39.14299999999999, "num_model_switches_mean": 0.9972999999999997, "num_model_switches_min": 0.47, "num_model_switches_max": 1.38, "num_slav_mean": 0.0007688333333333333, "num_slav_min": 5e-05, "num_slav_max": 0.003533333333333333, "mean_cluster_cpu_util_mean": 0.47309583953146267, "mean_cluster_cpu_util_min": 0.4674155520316235, "mean_cluster_cpu_util_max": 0.4772172274315131, "mean_cluster_mem_util_mean": 0.31808357593322134, "mean_cluster_mem_util_min": 0.31409599156118145, "mean_cluster_mem_util_max": 0.32096621781624035, "reward_consolidation_mean_mean": 4.8675, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.972222222222221, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8886119999999984, "reward_accuracy_mean_min": 3.858566666666665, "reward_accuracy_mean_max": 3.914299999999999, "reward_sla_mean_mean": -0.015376666666666667, "reward_sla_mean_min": -0.07066666666666667, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 486.74999999999994, "reward_consolidation_sum_min": 466.66666666666663, "reward_consolidation_sum_max": 497.2222222222222, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 388.8611999999998, "reward_accuracy_sum_min": 385.8566666666665, "reward_accuracy_sum_max": 391.4299999999999, "reward_sla_sum_mean": -1.5376666666666667, "reward_sla_sum_min": -7.066666666666666, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4367.0, "global_timestep_min": 2400, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [879.6766666666663, 874.4633333333329, 878.7133333333329, 866.5088888888886, 874.4877777777779, 864.7766666666662, 869.5122222222218, 879.7922222222217, 874.9277777777775, 868.4988888888881, 870.5799999999995, 871.3666666666666, 868.2933333333331, 878.4766666666662, 873.1533333333331, 881.4666666666667, 867.4011111111106, 873.06, 874.6755555555554, 876.762222222222, 876.4611111111108, 873.153333333333, 878.6388888888885, 871.4566666666664, 864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27476372756443523, "mean_inference_ms": 2.393519230248516, "mean_action_processing_ms": 0.10124641567344549, "mean_env_wait_ms": 1.7537636021874932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006440162658691406, "StateBufferConnector_ms": 0.003917694091796875, "ViewRequirementAgentConnector_ms": 0.09802484512329102}, "num_episodes": 21, "episode_return_max": 886.2422222222219, "episode_return_min": 852.5299999999999, "episode_return_mean": 874.073533333333, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228750, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228750, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 210.38170326137893, "num_env_steps_trained_throughput_per_sec": 224.40715014547087, "timesteps_total": 228750, "num_env_steps_sampled_lifetime": 228750, "num_agent_steps_sampled_lifetime": 228750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 228750, "timers": {"training_iteration_time_ms": 10460.768, "restore_workers_time_ms": 0.017, "training_step_time_ms": 716.23, "sample_time_ms": 699.388, "synch_weights_time_ms": 15.196}, "counters": {"num_env_steps_sampled": 228750, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228750, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1525, "num_samples_added_to_queue": 228600}, "done": false, "training_iteration": 104, "trial_id": "3f041_00000", "date": "2024-10-11_00-17-08", "timestamp": 1728602228, "time_this_iter_s": 10.712258100509644, "time_total_s": 1078.7316584587097, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef9210>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1078.7316584587097, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.886666666666667, "ram_util_percent": 57.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 64143.15625, "policy_loss": 55366.7578125, "entropy": 6.817473888397217, "entropy_coeff": 0.01, "var_gnorm": 16.8245792388916, "vf_loss": 879685.375, "vf_explained_var": 0.2741810083389282}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 769.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 231000, "num_env_steps_trained": 230700, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 230700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1540, "num_samples_added_to_queue": 231000, "learner_queue": {"size_count": 769, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.495, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 1337.507, "learner_dequeue_time_ms": 11418.873}}, "env_runners": {"episode_reward_max": 886.2422222222219, "episode_reward_min": 852.5299999999999, "episode_reward_mean": 875.0033222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 852.5299999999999}, "policy_reward_max": {"default_policy": 886.2422222222219}, "policy_reward_mean": {"default_policy": 875.0033222222222}, "custom_metrics": {"num_consolidated_mean": 2.9585000000000004, "num_consolidated_min": 2.88, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.7583000000000002, "num_moves_min": 0.84, "num_moves_max": 2.33, "mean_accuracy_mean": 38.78054333333331, "mean_accuracy_min": 38.528666666666645, "mean_accuracy_max": 39.085999999999984, "num_model_switches_mean": 0.8691000000000001, "num_model_switches_min": 0.31, "num_model_switches_max": 1.38, "num_slav_mean": 0.0006371666666666667, "num_slav_min": 5e-05, "num_slav_max": 0.003533333333333333, "mean_cluster_cpu_util_mean": 0.47358982357642154, "mean_cluster_cpu_util_min": 0.4674155520316235, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.3178319640596745, "mean_cluster_mem_util_min": 0.31409599156118145, "mean_cluster_mem_util_max": 0.3201075491905623, "reward_consolidation_mean_mean": 4.884722222222221, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8780543333333326, "reward_accuracy_mean_min": 3.852866666666665, "reward_accuracy_mean_max": 3.908599999999999, "reward_sla_mean_mean": -0.012743333333333336, "reward_sla_mean_min": -0.07066666666666667, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 488.4722222222221, "reward_consolidation_sum_min": 466.66666666666663, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 387.80543333333327, "reward_accuracy_sum_min": 385.2866666666665, "reward_accuracy_sum_max": 390.8599999999999, "reward_sla_sum_mean": -1.2743333333333335, "reward_sla_sum_min": -7.066666666666666, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5171.0, "global_timestep_min": 3200, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [864.9166666666665, 881.0399999999997, 868.9355555555549, 876.915555555555, 871.0466666666665, 880.9999999999995, 863.6377777777774, 875.5411111111108, 872.6188888888885, 868.3622222222216, 868.1622222222222, 866.3044444444442, 886.2422222222219, 872.0366666666666, 866.6077777777774, 865.5877777777777, 879.0100000000002, 876.902222222222, 872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27484651511272146, "mean_inference_ms": 2.3953278040168886, "mean_action_processing_ms": 0.10127286186221884, "mean_env_wait_ms": 1.7542801373510968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00636744499206543, "StateBufferConnector_ms": 0.0038726329803466797, "ViewRequirementAgentConnector_ms": 0.09761452674865723}, "num_episodes": 24, "episode_return_max": 886.2422222222219, "episode_return_min": 852.5299999999999, "episode_return_mean": 875.0033222222222, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 230700, "num_env_steps_sampled": 231000, "num_env_steps_trained": 230700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 217.32563463973653, "num_env_steps_trained_throughput_per_sec": 202.83725899708742, "timesteps_total": 231000, "num_env_steps_sampled_lifetime": 231000, "num_agent_steps_sampled_lifetime": 231000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 231000, "timers": {"training_iteration_time_ms": 10479.267, "restore_workers_time_ms": 0.015, "training_step_time_ms": 671.347, "sample_time_ms": 653.397, "synch_weights_time_ms": 16.147}, "counters": {"num_env_steps_sampled": 231000, "num_env_steps_trained": 230700, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 230700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1540, "num_samples_added_to_queue": 231000}, "done": false, "training_iteration": 105, "trial_id": "3f041_00000", "date": "2024-10-11_00-17-18", "timestamp": 1728602238, "time_this_iter_s": 10.371840715408325, "time_total_s": 1089.103499174118, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefab00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1089.103499174118, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.153333333333332, "ram_util_percent": 57.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 63576.703125, "policy_loss": 53756.140625, "entropy": 6.533400535583496, "entropy_coeff": 0.01, "var_gnorm": 16.853593826293945, "vf_loss": 984016.3125, "vf_explained_var": 0.2746812701225281}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 776.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 232950, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232950, "num_agent_steps_trained": 232800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1553, "num_samples_added_to_queue": 232800, "learner_queue": {"size_count": 776, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.799, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 1437.073, "learner_dequeue_time_ms": 11418.873}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 852.5299999999999, "episode_reward_mean": 876.082766666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 852.5299999999999}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 876.082766666667}, "custom_metrics": {"num_consolidated_mean": 2.9643000000000006, "num_consolidated_min": 2.88, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.5920999999999998, "num_moves_min": 0.84, "num_moves_max": 2.33, "mean_accuracy_mean": 38.70960999999998, "mean_accuracy_min": 38.528666666666645, "mean_accuracy_max": 39.05433333333332, "num_model_switches_mean": 0.7483999999999998, "num_model_switches_min": 0.31, "num_model_switches_max": 1.38, "num_slav_mean": 0.0005483333333333334, "num_slav_min": 5e-05, "num_slav_max": 0.0020999999999999994, "mean_cluster_cpu_util_mean": 0.47402812626443586, "mean_cluster_cpu_util_min": 0.4674155520316235, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.3177615079705933, "mean_cluster_mem_util_min": 0.31409599156118145, "mean_cluster_mem_util_max": 0.31934083839231897, "reward_consolidation_mean_mean": 4.900833333333333, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8709609999999985, "reward_accuracy_mean_min": 3.852866666666665, "reward_accuracy_mean_max": 3.9054333333333324, "reward_sla_mean_mean": -0.010966666666666666, "reward_sla_mean_min": -0.042, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 490.0833333333332, "reward_consolidation_sum_min": 466.66666666666663, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 387.09609999999986, "reward_accuracy_sum_min": 385.2866666666665, "reward_accuracy_sum_max": 390.54333333333324, "reward_sla_sum_mean": -1.0966666666666667, "reward_sla_sum_min": -4.2, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5762.0, "global_timestep_min": 3900, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [872.5600000000001, 878.0155555555552, 870.6033333333331, 869.082222222222, 875.2611111111111, 870.4366666666666, 876.6722222222219, 866.9922222222223, 867.0988888888885, 869.482222222222, 873.0811111111109, 874.7411111111103, 866.0444444444443, 870.1133333333333, 879.5666666666663, 879.2566666666665, 877.3088888888889, 874.2077777777779, 852.5299999999999, 875.3422222222222, 875.4488888888891, 883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27481767264646656, "mean_inference_ms": 2.3919635079096224, "mean_action_processing_ms": 0.1012475078121973, "mean_env_wait_ms": 1.7536493941459617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064601898193359375, "StateBufferConnector_ms": 0.003923892974853516, "ViewRequirementAgentConnector_ms": 0.09978294372558594}, "num_episodes": 18, "episode_return_max": 885.7566666666667, "episode_return_min": 852.5299999999999, "episode_return_mean": 876.082766666667, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232950, "num_agent_steps_trained": 232800, "num_env_steps_sampled": 232950, "num_env_steps_trained": 232800, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 182.61831746687056, "num_env_steps_trained_throughput_per_sec": 196.66588034893752, "timesteps_total": 232950, "num_env_steps_sampled_lifetime": 232950, "num_agent_steps_sampled_lifetime": 232950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 232950, "timers": {"training_iteration_time_ms": 10493.826, "restore_workers_time_ms": 0.016, "training_step_time_ms": 847.477, "sample_time_ms": 827.919, "synch_weights_time_ms": 17.656}, "counters": {"num_env_steps_sampled": 232950, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232950, "num_agent_steps_trained": 232800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1553, "num_samples_added_to_queue": 232800}, "done": false, "training_iteration": 106, "trial_id": "3f041_00000", "date": "2024-10-11_00-17-29", "timestamp": 1728602249, "time_this_iter_s": 10.689800500869751, "time_total_s": 1099.7932996749878, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef98a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1099.7932996749878, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.85333333333333, "ram_util_percent": 57.566666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 56230.25, "policy_loss": 46665.203125, "entropy": 6.362967014312744, "entropy_coeff": 0.01, "var_gnorm": 16.883556365966797, "vf_loss": 958413.5, "vf_explained_var": 0.3071616291999817}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 783.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 235050, "num_env_steps_trained": 234900, "num_agent_steps_sampled": 235050, "num_agent_steps_trained": 234900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1567, "num_samples_added_to_queue": 234900, "learner_queue": {"size_count": 783, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.922, "learner_load_time_ms": 0.381, "learner_load_wait_time_ms": 1530.76, "learner_dequeue_time_ms": 11552.072}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 856.8477777777779, "episode_reward_mean": 877.797688888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 856.8477777777779}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 877.797688888889}, "custom_metrics": {"num_consolidated_mean": 2.9726000000000004, "num_consolidated_min": 2.89, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.3824, "num_moves_min": 0.81, "num_moves_max": 2.33, "mean_accuracy_mean": 38.635446666666645, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.86433333333331, "num_model_switches_mean": 0.6289000000000001, "num_model_switches_min": 0.31, "num_model_switches_max": 1.23, "num_slav_mean": 0.00047283333333333346, "num_slav_min": 0.0001, "num_slav_max": 0.0020999999999999994, "mean_cluster_cpu_util_mean": 0.4744076181825131, "mean_cluster_cpu_util_min": 0.46948445915878617, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.31772961942435207, "mean_cluster_mem_util_min": 0.31511057920003444, "mean_cluster_mem_util_max": 0.31934083839231897, "reward_consolidation_mean_mean": 4.923888888888888, "reward_consolidation_mean_min": 4.694444444444444, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.863544666666664, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.8864333333333327, "reward_sla_mean_mean": -0.009456666666666667, "reward_sla_mean_min": -0.042, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 492.38888888888886, "reward_consolidation_sum_min": 469.44444444444434, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 386.35446666666655, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 388.64333333333326, "reward_sla_sum_mean": -0.9456666666666667, "reward_sla_sum_min": -4.2, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5773.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.3755555555557, 878.3366666666668, 878.6977777777778, 871.0933333333328, 874.6688888888884, 881.7344444444445, 869.4599999999997, 881.4044444444445, 875.9222222222221, 856.8477777777779, 877.4733333333336, 876.0788888888889, 868.2322222222222, 876.2822222222221, 875.8222222222223, 867.7400000000002, 883.6688888888889, 874.9755555555556, 880.6444444444447, 880.9711111111116, 873.4988888888889, 871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2750387655962207, "mean_inference_ms": 2.39683822452106, "mean_action_processing_ms": 0.10133771766559983, "mean_env_wait_ms": 1.7552690384970262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00643467903137207, "StateBufferConnector_ms": 0.003934144973754883, "ViewRequirementAgentConnector_ms": 0.09931254386901855}, "num_episodes": 21, "episode_return_max": 885.7566666666667, "episode_return_min": 856.8477777777779, "episode_return_mean": 877.797688888889, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235050, "num_agent_steps_trained": 234900, "num_env_steps_sampled": 235050, "num_env_steps_trained": 234900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 203.14405569942173, "num_env_steps_trained_throughput_per_sec": 203.14405569942173, "timesteps_total": 235050, "num_env_steps_sampled_lifetime": 235050, "num_agent_steps_sampled_lifetime": 235050, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 235050, "timers": {"training_iteration_time_ms": 10459.598, "restore_workers_time_ms": 0.013, "training_step_time_ms": 728.727, "sample_time_ms": 710.681, "synch_weights_time_ms": 16.469}, "counters": {"num_env_steps_sampled": 235050, "num_env_steps_trained": 234900, "num_agent_steps_sampled": 235050, "num_agent_steps_trained": 234900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1567, "num_samples_added_to_queue": 234900}, "done": false, "training_iteration": 107, "trial_id": "3f041_00000", "date": "2024-10-11_00-17-39", "timestamp": 1728602259, "time_this_iter_s": 10.347330808639526, "time_total_s": 1110.1406304836273, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875de0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1110.1406304836273, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 20.386666666666667, "ram_util_percent": 57.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 49801.15234375, "policy_loss": 42901.1640625, "entropy": 6.27998161315918, "entropy_coeff": 0.01, "var_gnorm": 16.917882919311523, "vf_loss": 691882.75, "vf_explained_var": 0.3522319793701172}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 790.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1581, "num_samples_added_to_queue": 237000, "learner_queue": {"size_count": 790, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.439, "learner_load_time_ms": 0.369, "learner_load_wait_time_ms": 1385.923, "learner_dequeue_time_ms": 11582.732}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 863.9611111111113, "episode_reward_mean": 878.8302000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.9611111111113}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 878.8302000000002}, "custom_metrics": {"num_consolidated_mean": 2.9778000000000007, "num_consolidated_min": 2.92, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.1956, "num_moves_min": 0.78, "num_moves_max": 1.8, "mean_accuracy_mean": 38.58528666666665, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.76299999999998, "num_model_switches_mean": 0.5437, "num_model_switches_min": 0.31, "num_model_switches_max": 0.9, "num_slav_mean": 0.000428, "num_slav_min": 0.0001, "num_slav_max": 0.001966666666666667, "mean_cluster_cpu_util_mean": 0.47447574509872564, "mean_cluster_cpu_util_min": 0.46976678559937485, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.3176910658044863, "mean_cluster_mem_util_min": 0.3152434071729958, "mean_cluster_mem_util_max": 0.3192117320029277, "reward_consolidation_mean_mean": 4.938333333333333, "reward_consolidation_mean_min": 4.777777777777777, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8585286666666656, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.8762999999999987, "reward_sla_mean_mean": -0.008560000000000002, "reward_sla_mean_min": -0.03933333333333334, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 493.8333333333332, "reward_consolidation_sum_min": 477.7777777777777, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.8528666666665, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 387.6299999999999, "reward_sla_sum_mean": -0.8560000000000002, "reward_sla_sum_min": -3.9333333333333336, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4835.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [871.7211111111113, 879.9111111111115, 879.2977777777779, 876.5600000000001, 877.9400000000004, 879.1977777777785, 864.4544444444444, 882.578888888889, 873.3588888888893, 880.8555555555557, 877.3633333333333, 877.5899999999999, 883.1988888888891, 874.9588888888892, 880.4344444444447, 875.9866666666667, 880.5377777777783, 877.2333333333336, 865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27515593457307835, "mean_inference_ms": 2.3978127514394494, "mean_action_processing_ms": 0.10137636232194619, "mean_env_wait_ms": 1.7558266660338029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006463050842285156, "StateBufferConnector_ms": 0.003926753997802734, "ViewRequirementAgentConnector_ms": 0.09973430633544922}, "num_episodes": 21, "episode_return_max": 885.7566666666667, "episode_return_min": 863.9611111111113, "episode_return_mean": 878.8302000000002, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 207.7152483504656, "num_env_steps_trained_throughput_per_sec": 207.7152483504656, "timesteps_total": 237150, "num_env_steps_sampled_lifetime": 237150, "num_agent_steps_sampled_lifetime": 237150, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 237150, "timers": {"training_iteration_time_ms": 10411.834, "restore_workers_time_ms": 0.013, "training_step_time_ms": 723.336, "sample_time_ms": 705.933, "synch_weights_time_ms": 15.675}, "counters": {"num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1581, "num_samples_added_to_queue": 237000}, "done": false, "training_iteration": 108, "trial_id": "3f041_00000", "date": "2024-10-11_00-17-49", "timestamp": 1728602269, "time_this_iter_s": 10.121597290039062, "time_total_s": 1120.2622277736664, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876080>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1120.2622277736664, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 18.9, "ram_util_percent": 57.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 39627.609375, "policy_loss": 31767.20703125, "entropy": 6.013411521911621, "entropy_coeff": 0.01, "var_gnorm": 16.95087242126465, "vf_loss": 787844.375, "vf_explained_var": 0.3526585102081299}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 796.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 238950, "num_env_steps_trained": 238800, "num_agent_steps_sampled": 238950, "num_agent_steps_trained": 238800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1593, "num_samples_added_to_queue": 238800, "learner_queue": {"size_count": 796, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.606, "learner_load_time_ms": 0.321, "learner_load_wait_time_ms": 1544.955, "learner_dequeue_time_ms": 11616.872}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 863.9611111111113, "episode_reward_mean": 879.6525555555559, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.9611111111113}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 879.6525555555559}, "custom_metrics": {"num_consolidated_mean": 2.9813000000000005, "num_consolidated_min": 2.92, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.0473999999999999, "num_moves_min": 0.67, "num_moves_max": 1.61, "mean_accuracy_mean": 38.55843333333332, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.674333333333315, "num_model_switches_mean": 0.48840000000000006, "num_model_switches_min": 0.28, "num_model_switches_max": 0.69, "num_slav_mean": 0.0003686666666666666, "num_slav_min": 0.0001, "num_slav_max": 0.0011166666666666664, "mean_cluster_cpu_util_mean": 0.4745484886010244, "mean_cluster_cpu_util_min": 0.46976678559937485, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.31772117774799796, "mean_cluster_mem_util_min": 0.3152434071729958, "mean_cluster_mem_util_max": 0.3192117320029277, "reward_consolidation_mean_mean": 4.9480555555555545, "reward_consolidation_mean_min": 4.777777777777777, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.855843333333332, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.8674333333333317, "reward_sla_mean_mean": -0.007373333333333335, "reward_sla_mean_min": -0.022333333333333337, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 494.8055555555555, "reward_consolidation_sum_min": 477.7777777777777, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.5843333333332, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 386.74333333333317, "reward_sla_sum_mean": -0.7373333333333335, "reward_sla_sum_min": -2.233333333333334, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4038.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.5822222222223, 885.2066666666668, 877.0300000000001, 871.3311111111113, 882.3422222222227, 885.6300000000003, 875.5133333333337, 863.9611111111113, 868.7433333333335, 882.8822222222226, 871.6044444444444, 875.7766666666666, 876.9866666666671, 874.1488888888894, 884.3933333333339, 883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2754800831863896, "mean_inference_ms": 2.4034757070148105, "mean_action_processing_ms": 0.10149179447402983, "mean_env_wait_ms": 1.757848491128292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067424774169921875, "StateBufferConnector_ms": 0.00409245491027832, "ViewRequirementAgentConnector_ms": 0.10410046577453613}, "num_episodes": 18, "episode_return_max": 885.7566666666667, "episode_return_min": 863.9611111111113, "episode_return_mean": 879.6525555555559, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238950, "num_agent_steps_trained": 238800, "num_env_steps_sampled": 238950, "num_env_steps_trained": 238800, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 167.85826009687904, "num_env_steps_trained_throughput_per_sec": 167.85826009687904, "timesteps_total": 238950, "num_env_steps_sampled_lifetime": 238950, "num_agent_steps_sampled_lifetime": 238950, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 238950, "timers": {"training_iteration_time_ms": 10461.568, "restore_workers_time_ms": 0.016, "training_step_time_ms": 925.5, "sample_time_ms": 903.885, "synch_weights_time_ms": 19.152}, "counters": {"num_env_steps_sampled": 238950, "num_env_steps_trained": 238800, "num_agent_steps_sampled": 238950, "num_agent_steps_trained": 238800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1593, "num_samples_added_to_queue": 238800}, "done": false, "training_iteration": 109, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-00", "timestamp": 1728602280, "time_this_iter_s": 10.745561599731445, "time_total_s": 1131.0077893733978, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefab60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1131.0077893733978, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 27.913333333333338, "ram_util_percent": 58.066666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 37560.7890625, "policy_loss": 29887.951171875, "entropy": 5.822685241699219, "entropy_coeff": 0.01, "var_gnorm": 16.98017692565918, "vf_loss": 769030.8125, "vf_explained_var": 0.3617621660232544}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 801.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 240450, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 240300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1603, "num_samples_added_to_queue": 240300, "learner_queue": {"size_count": 801, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.62, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 1830.459, "learner_dequeue_time_ms": 12100.834}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 865.3988888888894, "episode_reward_mean": 880.7202777777779, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.3988888888894}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 880.7202777777779}, "custom_metrics": {"num_consolidated_mean": 2.9854000000000007, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.9577000000000001, "num_moves_min": 0.61, "num_moves_max": 1.61, "mean_accuracy_mean": 38.54734999999998, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.674333333333315, "num_model_switches_mean": 0.4523, "num_model_switches_min": 0.2, "num_model_switches_max": 0.68, "num_slav_mean": 0.00034883333333333327, "num_slav_min": 0.0001, "num_slav_max": 0.0011166666666666664, "mean_cluster_cpu_util_mean": 0.4747759692497728, "mean_cluster_cpu_util_min": 0.47044603787460937, "mean_cluster_cpu_util_max": 0.47753588665195806, "mean_cluster_mem_util_mean": 0.31783191735554983, "mean_cluster_mem_util_min": 0.3152434071729958, "mean_cluster_mem_util_max": 0.3188776371308017, "reward_consolidation_mean_mean": 4.959444444444443, "reward_consolidation_mean_min": 4.8055555555555545, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.854734999999999, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.8674333333333317, "reward_sla_mean_mean": -0.0069766666666666675, "reward_sla_mean_min": -0.022333333333333337, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 495.94444444444423, "reward_consolidation_sum_min": 480.5555555555555, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.4734999999998, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 386.74333333333317, "reward_sla_sum_mean": -0.6976666666666668, "reward_sla_sum_min": -2.233333333333334, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3353.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.4655555555557, 874.0055555555559, 876.7500000000005, 879.704444444445, 879.5477777777778, 881.8755555555558, 885.0300000000003, 879.6544444444447, 874.0788888888892, 873.9655555555559, 876.6766666666672, 880.017777777778, 879.0577777777778, 883.2522222222227, 876.9966666666671, 879.3944444444447, 876.8000000000006, 878.3377777777785, 885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27569919645881097, "mean_inference_ms": 2.404254596682947, "mean_action_processing_ms": 0.1015496134963496, "mean_env_wait_ms": 1.758672719686914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007340908050537109, "StateBufferConnector_ms": 0.004332542419433594, "ViewRequirementAgentConnector_ms": 0.11080241203308105}, "num_episodes": 15, "episode_return_max": 885.7566666666667, "episode_return_min": 865.3988888888894, "episode_return_mean": 880.7202777777779, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 240300, "num_env_steps_sampled": 240450, "num_env_steps_trained": 240300, "num_env_steps_sampled_this_iter": 1500, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 147.31162425038605, "num_env_steps_trained_throughput_per_sec": 147.31162425038605, "timesteps_total": 240450, "num_env_steps_sampled_lifetime": 240450, "num_agent_steps_sampled_lifetime": 240450, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 240450, "timers": {"training_iteration_time_ms": 10434.659, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1018.216, "sample_time_ms": 997.769, "synch_weights_time_ms": 17.83}, "counters": {"num_env_steps_sampled": 240450, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 240300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1603, "num_samples_added_to_queue": 240300}, "done": false, "training_iteration": 110, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-10", "timestamp": 1728602290, "time_this_iter_s": 10.20207667350769, "time_total_s": 1141.2098660469055, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669875840>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1141.2098660469055, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 31.846666666666668, "ram_util_percent": 58.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 36422.6796875, "policy_loss": 28367.791015625, "entropy": 5.665173530578613, "entropy_coeff": 0.01, "var_gnorm": 17.011333465576172, "vf_loss": 807188.625, "vf_explained_var": 0.36310285329818726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 242100, "num_env_steps_trained": 241800, "num_agent_steps_sampled": 242100, "num_agent_steps_trained": 241800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1614, "num_samples_added_to_queue": 242100, "learner_queue": {"size_count": 806, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.672, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 1903.639, "learner_dequeue_time_ms": 12100.834}}, "env_runners": {"episode_reward_max": 885.7566666666667, "episode_reward_min": 865.3988888888894, "episode_reward_mean": 881.5795333333339, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.3988888888894}, "policy_reward_max": {"default_policy": 885.7566666666667}, "policy_reward_mean": {"default_policy": 881.5795333333339}, "custom_metrics": {"num_consolidated_mean": 2.988600000000001, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.8654, "num_moves_min": 0.55, "num_moves_max": 1.29, "mean_accuracy_mean": 38.54285333333331, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.64899999999998, "num_model_switches_mean": 0.4083999999999999, "num_model_switches_min": 0.14, "num_model_switches_max": 0.68, "num_slav_mean": 0.00034116666666666665, "num_slav_min": 0.0001, "num_slav_max": 0.0011166666666666664, "mean_cluster_cpu_util_mean": 0.4751058606167662, "mean_cluster_cpu_util_min": 0.47044603787460937, "mean_cluster_cpu_util_max": 0.47817358429858436, "mean_cluster_mem_util_mean": 0.3179273819211228, "mean_cluster_mem_util_min": 0.3152434071729958, "mean_cluster_mem_util_max": 0.3188776371308017, "reward_consolidation_mean_mean": 4.968333333333333, "reward_consolidation_mean_min": 4.8055555555555545, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.854285333333331, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.864899999999999, "reward_sla_mean_mean": -0.006823333333333335, "reward_sla_mean_min": -0.022333333333333337, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 496.8333333333332, "reward_consolidation_sum_min": 480.5555555555555, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.4285333333331, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 386.4899999999999, "reward_sla_sum_mean": -0.6823333333333335, "reward_sla_sum_min": -2.233333333333334, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2555.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.7566666666667, 873.8055555555558, 882.7855555555558, 877.0433333333339, 878.9911111111119, 879.4377777777781, 876.7600000000004, 884.6466666666665, 879.9211111111111, 882.1288888888888, 882.1355555555558, 881.9322222222225, 882.2322222222227, 878.9044444444446, 885.316666666667, 873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2761176582337854, "mean_inference_ms": 2.4083136748139413, "mean_action_processing_ms": 0.10168897829229265, "mean_env_wait_ms": 1.7609520014369633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008311986923217773, "StateBufferConnector_ms": 0.004564523696899414, "ViewRequirementAgentConnector_ms": 0.11750507354736328}, "num_episodes": 18, "episode_return_max": 885.7566666666667, "episode_return_min": 865.3988888888894, "episode_return_mean": 881.5795333333339, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242100, "num_agent_steps_trained": 241800, "num_env_steps_sampled": 242100, "num_env_steps_trained": 241800, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 153.6990706767266, "num_env_steps_trained_throughput_per_sec": 139.72642788793326, "timesteps_total": 242100, "num_env_steps_sampled_lifetime": 242100, "num_agent_steps_sampled_lifetime": 242100, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 242100, "timers": {"training_iteration_time_ms": 10438.224, "restore_workers_time_ms": 0.016, "training_step_time_ms": 971.65, "sample_time_ms": 949.58, "synch_weights_time_ms": 19.585}, "counters": {"num_env_steps_sampled": 242100, "num_env_steps_trained": 241800, "num_agent_steps_sampled": 242100, "num_agent_steps_trained": 241800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1614, "num_samples_added_to_queue": 242100}, "done": false, "training_iteration": 111, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-21", "timestamp": 1728602301, "time_this_iter_s": 10.746041536331177, "time_total_s": 1151.9559075832367, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1151.9559075832367, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 31.74666666666667, "ram_util_percent": 58.61333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 26500.75, "policy_loss": 19825.279296875, "entropy": 5.420983791351318, "entropy_coeff": 0.01, "var_gnorm": 17.05438232421875, "vf_loss": 669173.5, "vf_explained_var": 0.40173619985580444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 812.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 243750, "num_env_steps_trained": 243600, "num_agent_steps_sampled": 243750, "num_agent_steps_trained": 243600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1625, "num_samples_added_to_queue": 243600, "learner_queue": {"size_count": 812, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 101.843, "learner_load_time_ms": 0.381, "learner_load_wait_time_ms": 1813.72, "learner_dequeue_time_ms": 12517.766}}, "env_runners": {"episode_reward_max": 885.413333333334, "episode_reward_min": 865.3988888888894, "episode_reward_mean": 882.1636333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.3988888888894}, "policy_reward_max": {"default_policy": 885.413333333334}, "policy_reward_mean": {"default_policy": 882.1636333333337}, "custom_metrics": {"num_consolidated_mean": 2.9907000000000004, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.7916000000000003, "num_moves_min": 0.48, "num_moves_max": 1.12, "mean_accuracy_mean": 38.542029999999976, "mean_accuracy_min": 38.44633333333331, "mean_accuracy_max": 38.604666666666645, "num_model_switches_mean": 0.36019999999999996, "num_model_switches_min": 0.1, "num_model_switches_max": 0.68, "num_slav_mean": 0.00033666666666666665, "num_slav_min": 0.0001, "num_slav_max": 0.0011166666666666664, "mean_cluster_cpu_util_mean": 0.4754818970549902, "mean_cluster_cpu_util_min": 0.47044603787460937, "mean_cluster_cpu_util_max": 0.47887514938407805, "mean_cluster_mem_util_mean": 0.31802603039158706, "mean_cluster_mem_util_min": 0.3152434071729958, "mean_cluster_mem_util_max": 0.31876160337552745, "reward_consolidation_mean_mean": 4.974166666666666, "reward_consolidation_mean_min": 4.8055555555555545, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8542029999999983, "reward_accuracy_mean_min": 3.8446333333333316, "reward_accuracy_mean_max": 3.860466666666665, "reward_sla_mean_mean": -0.006733333333333334, "reward_sla_mean_min": -0.022333333333333337, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 497.41666666666663, "reward_consolidation_sum_min": 480.5555555555555, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.42029999999994, "reward_accuracy_sum_min": 384.46333333333314, "reward_accuracy_sum_max": 386.0466666666665, "reward_sla_sum_mean": -0.6733333333333335, "reward_sla_sum_min": -2.233333333333334, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2115.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.9222222222228, 882.398888888889, 876.376666666667, 881.9922222222226, 879.8711111111115, 880.9522222222222, 865.3988888888894, 876.4033333333339, 882.2022222222226, 879.5177777777778, 881.6755555555554, 882.0688888888892, 885.3400000000001, 884.3933333333337, 879.2311111111114, 882.3288888888889, 881.9088888888891, 879.1611111111114, 879.0311111111114, 880.0222222222226, 877.3744444444446, 881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2764149590474294, "mean_inference_ms": 2.408351488686618, "mean_action_processing_ms": 0.10177307889428153, "mean_env_wait_ms": 1.762131373877756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008742809295654297, "StateBufferConnector_ms": 0.004676342010498047, "ViewRequirementAgentConnector_ms": 0.12003707885742188}, "num_episodes": 15, "episode_return_max": 885.413333333334, "episode_return_min": 865.3988888888894, "episode_return_mean": 882.1636333333337, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243750, "num_agent_steps_trained": 243600, "num_env_steps_sampled": 243750, "num_env_steps_trained": 243600, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.19139533562662, "num_env_steps_trained_throughput_per_sec": 178.0269767297745, "timesteps_total": 243750, "num_env_steps_sampled_lifetime": 243750, "num_agent_steps_sampled_lifetime": 243750, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 243750, "timers": {"training_iteration_time_ms": 10401.311, "restore_workers_time_ms": 0.014, "training_step_time_ms": 921.6, "sample_time_ms": 900.188, "synch_weights_time_ms": 19.536}, "counters": {"num_env_steps_sampled": 243750, "num_env_steps_trained": 243600, "num_agent_steps_sampled": 243750, "num_agent_steps_trained": 243600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1625, "num_samples_added_to_queue": 243600}, "done": false, "training_iteration": 112, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-31", "timestamp": 1728602311, "time_this_iter_s": 10.123022079467773, "time_total_s": 1162.0789296627045, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefbc70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1162.0789296627045, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 29.779999999999998, "ram_util_percent": 59.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 17229.564453125, "policy_loss": 10355.3720703125, "entropy": 4.996822834014893, "entropy_coeff": 0.01, "var_gnorm": 17.109085083007812, "vf_loss": 688918.25, "vf_explained_var": 0.4100084900856018}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 819.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1639, "num_samples_added_to_queue": 245700, "learner_queue": {"size_count": 819, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.57, "learner_load_time_ms": 0.397, "learner_load_wait_time_ms": 1557.4, "learner_dequeue_time_ms": 12717.175}}, "env_runners": {"episode_reward_max": 885.583333333334, "episode_reward_min": 876.2200000000003, "episode_reward_mean": 883.1594222222226, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 876.2200000000003}, "policy_reward_max": {"default_policy": 885.583333333334}, "policy_reward_mean": {"default_policy": 883.1594222222226}, "custom_metrics": {"num_consolidated_mean": 2.9939000000000004, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.6604000000000001, "num_moves_min": 0.12, "num_moves_max": 1.12, "mean_accuracy_mean": 38.55171999999998, "mean_accuracy_min": 38.47799999999998, "mean_accuracy_max": 38.623666666666644, "num_model_switches_mean": 0.27590000000000003, "num_model_switches_min": 0.04, "num_model_switches_max": 0.57, "num_slav_mean": 0.00033166666666666663, "num_slav_min": 0.0001, "num_slav_max": 0.0006333333333333333, "mean_cluster_cpu_util_mean": 0.4760351121397218, "mean_cluster_cpu_util_min": 0.47205816786173926, "mean_cluster_cpu_util_max": 0.47932078507078507, "mean_cluster_mem_util_mean": 0.31819702041892706, "mean_cluster_mem_util_min": 0.31689517405063294, "mean_cluster_mem_util_max": 0.31876160337552745, "reward_consolidation_mean_mean": 4.983055555555556, "reward_consolidation_mean_min": 4.916666666666666, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8551719999999987, "reward_accuracy_mean_min": 3.8477999999999977, "reward_accuracy_mean_max": 3.862366666666665, "reward_sla_mean_mean": -0.006633333333333333, "reward_sla_mean_min": -0.012666666666666666, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 498.3055555555555, "reward_consolidation_sum_min": 491.6666666666666, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.5171999999998, "reward_accuracy_sum_min": 384.77999999999975, "reward_accuracy_sum_max": 386.2366666666665, "reward_sla_sum_mean": -0.6633333333333334, "reward_sla_sum_min": -1.2666666666666666, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2269.0, "global_timestep_min": 400, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [881.8088888888892, 878.7444444444445, 884.366666666667, 882.0488888888896, 879.1677777777779, 876.2200000000003, 884.3733333333336, 876.4266666666671, 882.0322222222226, 878.8744444444446, 881.7122222222224, 879.4077777777779, 881.5455555555558, 881.4022222222226, 881.665555555556, 884.3100000000004, 884.7133333333337, 879.1311111111116, 884.4566666666669, 881.945555555556, 879.4177777777782, 878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27700978837126555, "mean_inference_ms": 2.41399984344228, "mean_action_processing_ms": 0.10196714164856466, "mean_env_wait_ms": 1.7652494020097118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008903980255126953, "StateBufferConnector_ms": 0.004720926284790039, "ViewRequirementAgentConnector_ms": 0.12094497680664062}, "num_episodes": 21, "episode_return_max": 885.583333333334, "episode_return_min": 876.2200000000003, "episode_return_mean": 883.1594222222226, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 195.02815440998958, "num_env_steps_trained_throughput_per_sec": 195.02815440998958, "timesteps_total": 245850, "num_env_steps_sampled_lifetime": 245850, "num_agent_steps_sampled_lifetime": 245850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 245850, "timers": {"training_iteration_time_ms": 10469.315, "restore_workers_time_ms": 0.015, "training_step_time_ms": 784.823, "sample_time_ms": 765.701, "synch_weights_time_ms": 17.263}, "counters": {"num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1639, "num_samples_added_to_queue": 245700}, "done": false, "training_iteration": 113, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-42", "timestamp": 1728602322, "time_this_iter_s": 10.778793573379517, "time_total_s": 1172.857723236084, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698742b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1172.857723236084, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 21.74666666666667, "ram_util_percent": 58.89333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 13053.193359375, "policy_loss": 6306.46875, "entropy": 4.765256404876709, "entropy_coeff": 0.01, "var_gnorm": 17.166730880737305, "vf_loss": 676102.0, "vf_explained_var": 0.43648552894592285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 825.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1652, "num_samples_added_to_queue": 247800, "learner_queue": {"size_count": 825, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.661, "learner_load_time_ms": 0.437, "learner_load_wait_time_ms": 1538.746, "learner_dequeue_time_ms": 12893.89}}, "env_runners": {"episode_reward_max": 885.583333333334, "episode_reward_min": 878.5577777777784, "episode_reward_mean": 883.8961333333339, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.5577777777784}, "policy_reward_max": {"default_policy": 885.583333333334}, "policy_reward_mean": {"default_policy": 883.8961333333339}, "custom_metrics": {"num_consolidated_mean": 2.9961, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5049, "num_moves_min": 0.06, "num_moves_max": 1.0, "mean_accuracy_mean": 38.56451333333331, "mean_accuracy_min": 38.47799999999998, "mean_accuracy_max": 38.623666666666644, "num_model_switches_mean": 0.1924, "num_model_switches_min": 0.0, "num_model_switches_max": 0.49, "num_slav_mean": 0.0003328333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.0006333333333333333, "mean_cluster_cpu_util_mean": 0.47658303394864804, "mean_cluster_cpu_util_min": 0.47303599869001656, "mean_cluster_cpu_util_max": 0.47932078507078507, "mean_cluster_mem_util_mean": 0.3183699502712477, "mean_cluster_mem_util_min": 0.3174340717299578, "mean_cluster_mem_util_max": 0.3188523206751055, "reward_consolidation_mean_mean": 4.989166666666666, "reward_consolidation_mean_min": 4.944444444444444, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8564513333333315, "reward_accuracy_mean_min": 3.8477999999999977, "reward_accuracy_mean_max": 3.862366666666665, "reward_sla_mean_mean": -0.006656666666666668, "reward_sla_mean_min": -0.012666666666666666, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 498.9166666666666, "reward_consolidation_sum_min": 494.44444444444434, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.64513333333315, "reward_accuracy_sum_min": 384.77999999999975, "reward_accuracy_sum_max": 386.2366666666665, "reward_sla_sum_mean": -0.6656666666666666, "reward_sla_sum_min": -1.2666666666666666, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2974.0, "global_timestep_min": 1100, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [878.9877777777783, 885.0066666666669, 884.7200000000007, 884.5766666666669, 881.5188888888893, 879.1377777777781, 878.5577777777784, 881.8088888888892, 881.6455555555561, 882.4122222222228, 884.2266666666671, 879.1711111111115, 884.4233333333337, 881.6722222222224, 884.9500000000007, 881.798888888889, 884.4666666666673, 879.5111111111117, 885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27765577560852034, "mean_inference_ms": 2.4218716364014856, "mean_action_processing_ms": 0.10218925139229797, "mean_env_wait_ms": 1.768930260204088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008989810943603516, "StateBufferConnector_ms": 0.004750967025756836, "ViewRequirementAgentConnector_ms": 0.1227269172668457}, "num_episodes": 21, "episode_return_max": 885.583333333334, "episode_return_min": 878.5577777777784, "episode_return_mean": 883.8961333333339, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247500, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 181.955297364548, "num_env_steps_trained_throughput_per_sec": 167.95873602881352, "timesteps_total": 247800, "num_env_steps_sampled_lifetime": 247800, "num_agent_steps_sampled_lifetime": 247800, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 247800, "timers": {"training_iteration_time_ms": 10471.522, "restore_workers_time_ms": 0.015, "training_step_time_ms": 833.407, "sample_time_ms": 812.886, "synch_weights_time_ms": 18.167}, "counters": {"num_env_steps_sampled": 247800, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1652, "num_samples_added_to_queue": 247800}, "done": false, "training_iteration": 114, "trial_id": "3f041_00000", "date": "2024-10-11_00-18-53", "timestamp": 1728602333, "time_this_iter_s": 10.730824708938599, "time_total_s": 1183.5885479450226, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae53040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1183.5885479450226, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 23.94, "ram_util_percent": 59.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 8543.46875, "policy_loss": 2078.2607421875, "entropy": 4.581552505493164, "entropy_coeff": 0.01, "var_gnorm": 17.253355026245117, "vf_loss": 647895.25, "vf_explained_var": 0.46094363927841187}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 832.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 249750, "num_env_steps_trained": 249600, "num_agent_steps_sampled": 249750, "num_agent_steps_trained": 249600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1665, "num_samples_added_to_queue": 249600, "learner_queue": {"size_count": 832, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.933, "learner_load_time_ms": 0.437, "learner_load_wait_time_ms": 1566.182, "learner_dequeue_time_ms": 12893.89}}, "env_runners": {"episode_reward_max": 885.583333333334, "episode_reward_min": 879.3777777777782, "episode_reward_mean": 884.3383111111117, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 879.3777777777782}, "policy_reward_max": {"default_policy": 885.583333333334}, "policy_reward_mean": {"default_policy": 884.3383111111117}, "custom_metrics": {"num_consolidated_mean": 2.9974000000000003, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3815999999999999, "num_moves_min": 0.04, "num_moves_max": 0.86, "mean_accuracy_mean": 38.571353333333306, "mean_accuracy_min": 38.50333333333331, "mean_accuracy_max": 38.623666666666644, "num_model_switches_mean": 0.1392, "num_model_switches_min": 0.0, "num_model_switches_max": 0.47, "num_slav_mean": 0.00032649999999999997, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0006333333333333333, "mean_cluster_cpu_util_mean": 0.47695188106154623, "mean_cluster_cpu_util_min": 0.47303599869001656, "mean_cluster_cpu_util_max": 0.47932078507078507, "mean_cluster_mem_util_mean": 0.3184557990506329, "mean_cluster_mem_util_min": 0.31751635021097047, "mean_cluster_mem_util_max": 0.3188523206751055, "reward_consolidation_mean_mean": 4.9927777777777775, "reward_consolidation_mean_min": 4.944444444444444, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.857135333333332, "reward_accuracy_mean_min": 3.850333333333332, "reward_accuracy_mean_max": 3.862366666666665, "reward_sla_mean_mean": -0.006530000000000001, "reward_sla_mean_min": -0.012666666666666666, "reward_sla_mean_max": -0.0013333333333333333, "reward_consolidation_sum_mean": 499.27777777777766, "reward_consolidation_sum_min": 494.44444444444434, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.71353333333326, "reward_accuracy_sum_min": 385.0333333333332, "reward_accuracy_sum_max": 386.2366666666665, "reward_sla_sum_mean": -0.653, "reward_sla_sum_min": -1.2666666666666666, "reward_sla_sum_max": -0.13333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3577.0, "global_timestep_min": 1700, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.3166666666672, 884.6500000000001, 884.5466666666671, 884.7800000000007, 881.7788888888892, 884.7300000000002, 881.8822222222228, 885.0000000000008, 884.8066666666674, 882.2855555555559, 882.4455555555561, 884.8633333333338, 885.0300000000005, 882.5555555555561, 884.7000000000006, 885.213333333334, 882.415555555556, 885.003333333334, 884.8366666666674, 881.7688888888893, 884.6500000000005, 884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2781538243025259, "mean_inference_ms": 2.428193071114627, "mean_action_processing_ms": 0.10236015280030397, "mean_env_wait_ms": 1.7717583137928636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008635759353637695, "StateBufferConnector_ms": 0.004563093185424805, "ViewRequirementAgentConnector_ms": 0.11795687675476074}, "num_episodes": 18, "episode_return_max": 885.583333333334, "episode_return_min": 879.3777777777782, "episode_return_mean": 884.3383111111117, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249750, "num_agent_steps_trained": 249600, "num_env_steps_sampled": 249750, "num_env_steps_trained": 249600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 185.63499075013135, "num_env_steps_trained_throughput_per_sec": 199.91460542321838, "timesteps_total": 249750, "num_env_steps_sampled_lifetime": 249750, "num_agent_steps_sampled_lifetime": 249750, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 249750, "timers": {"training_iteration_time_ms": 10486.658, "restore_workers_time_ms": 0.014, "training_step_time_ms": 830.076, "sample_time_ms": 810.169, "synch_weights_time_ms": 17.961}, "counters": {"num_env_steps_sampled": 249750, "num_env_steps_trained": 249600, "num_agent_steps_sampled": 249750, "num_agent_steps_trained": 249600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1665, "num_samples_added_to_queue": 249600}, "done": false, "training_iteration": 115, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-03", "timestamp": 1728602343, "time_this_iter_s": 10.517880201339722, "time_total_s": 1194.1064281463623, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1194.1064281463623, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 21.433333333333334, "ram_util_percent": 59.806666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 7587.669921875, "policy_loss": 2119.83154296875, "entropy": 4.497180938720703, "entropy_coeff": 0.01, "var_gnorm": 17.35357093811035, "vf_loss": 548133.0, "vf_explained_var": 0.5031790733337402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 839.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 251850, "num_env_steps_trained": 251700, "num_agent_steps_sampled": 251850, "num_agent_steps_trained": 251700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1679, "num_samples_added_to_queue": 251700, "learner_queue": {"size_count": 839, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.343, "learner_load_time_ms": 0.463, "learner_load_wait_time_ms": 1500.474, "learner_dequeue_time_ms": 13037.803}}, "env_runners": {"episode_reward_max": 885.583333333334, "episode_reward_min": 879.3777777777782, "episode_reward_mean": 884.5351777777786, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 879.3777777777782}, "policy_reward_max": {"default_policy": 885.583333333334}, "policy_reward_mean": {"default_policy": 884.5351777777786}, "custom_metrics": {"num_consolidated_mean": 2.998, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2525, "num_moves_min": 0.0, "num_moves_max": 0.76, "mean_accuracy_mean": 38.57477333333331, "mean_accuracy_min": 38.51599999999998, "mean_accuracy_max": 38.623666666666644, "num_model_switches_mean": 0.08130000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.32, "num_slav_mean": 0.00032849999999999996, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0006333333333333333, "mean_cluster_cpu_util_mean": 0.47723627625712445, "mean_cluster_cpu_util_min": 0.47421557271557274, "mean_cluster_cpu_util_max": 0.47932078507078507, "mean_cluster_mem_util_mean": 0.31851748945147684, "mean_cluster_mem_util_min": 0.31751635021097047, "mean_cluster_mem_util_max": 0.3188523206751055, "reward_consolidation_mean_mean": 4.994444444444444, "reward_consolidation_mean_min": 4.944444444444444, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8574773333333314, "reward_accuracy_mean_min": 3.851599999999998, "reward_accuracy_mean_max": 3.862366666666665, "reward_sla_mean_mean": -0.00657, "reward_sla_mean_min": -0.012666666666666666, "reward_sla_mean_max": -0.0013333333333333333, "reward_consolidation_sum_mean": 499.4444444444444, "reward_consolidation_sum_min": 494.44444444444434, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.7477333333331, "reward_accuracy_sum_min": 385.1599999999998, "reward_accuracy_sum_max": 386.2366666666665, "reward_sla_sum_mean": -0.657, "reward_sla_sum_min": -1.2666666666666666, "reward_sla_sum_max": -0.13333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4278.0, "global_timestep_min": 2400, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.8733333333339, 882.4822222222228, 882.2288888888893, 879.3777777777782, 885.1900000000004, 885.0633333333338, 885.353333333334, 884.8666666666674, 884.7666666666674, 881.9955555555559, 882.6722222222224, 885.413333333334, 885.1966666666673, 885.1233333333341, 884.2600000000004, 884.8200000000006, 885.1266666666675, 885.263333333334, 885.0966666666673, 885.1233333333341, 884.9366666666674, 885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27858505468384126, "mean_inference_ms": 2.433641053355401, "mean_action_processing_ms": 0.10250632463829266, "mean_env_wait_ms": 1.7741017245342028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007691383361816406, "StateBufferConnector_ms": 0.004329681396484375, "ViewRequirementAgentConnector_ms": 0.11098766326904297}, "num_episodes": 21, "episode_return_max": 885.583333333334, "episode_return_min": 879.3777777777782, "episode_return_mean": 884.5351777777786, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251850, "num_agent_steps_trained": 251700, "num_env_steps_sampled": 251850, "num_env_steps_trained": 251700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 197.9296754075338, "num_env_steps_trained_throughput_per_sec": 197.9296754075338, "timesteps_total": 251850, "num_env_steps_sampled_lifetime": 251850, "num_agent_steps_sampled_lifetime": 251850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 251850, "timers": {"training_iteration_time_ms": 10479.841, "restore_workers_time_ms": 0.015, "training_step_time_ms": 750.375, "sample_time_ms": 733.421, "synch_weights_time_ms": 15.143}, "counters": {"num_env_steps_sampled": 251850, "num_env_steps_trained": 251700, "num_agent_steps_sampled": 251850, "num_agent_steps_trained": 251700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1679, "num_samples_added_to_queue": 251700}, "done": false, "training_iteration": 116, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-14", "timestamp": 1728602354, "time_this_iter_s": 10.620195150375366, "time_total_s": 1204.7266232967377, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa96c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1204.7266232967377, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 20.46875, "ram_util_percent": 59.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4513.3623046875, "policy_loss": 67.80912780761719, "entropy": 4.427855491638184, "entropy_coeff": 0.01, "var_gnorm": 17.481624603271484, "vf_loss": 445883.6875, "vf_explained_var": 0.5441590547561646}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 846.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 253950, "num_env_steps_trained": 253800, "num_agent_steps_sampled": 253950, "num_agent_steps_trained": 253800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1693, "num_samples_added_to_queue": 253800, "learner_queue": {"size_count": 846, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.564, "learner_load_time_ms": 0.447, "learner_load_wait_time_ms": 1448.699, "learner_dequeue_time_ms": 13117.323}}, "env_runners": {"episode_reward_max": 885.583333333334, "episode_reward_min": 879.564444444445, "episode_reward_mean": 884.6987444444453, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 879.564444444445}, "policy_reward_max": {"default_policy": 885.583333333334}, "policy_reward_mean": {"default_policy": 884.6987444444453}, "custom_metrics": {"num_consolidated_mean": 2.9986, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1396, "num_moves_min": 0.0, "num_moves_max": 0.57, "mean_accuracy_mean": 38.57432999999998, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.623666666666644, "num_model_switches_mean": 0.045200000000000004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.21, "num_slav_mean": 0.0003278333333333334, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0006333333333333333, "mean_cluster_cpu_util_mean": 0.4773602110624656, "mean_cluster_cpu_util_min": 0.4747865818624748, "mean_cluster_cpu_util_max": 0.47932078507078507, "mean_cluster_mem_util_mean": 0.31854859440928274, "mean_cluster_mem_util_min": 0.3176561181434599, "mean_cluster_mem_util_max": 0.3188523206751055, "reward_consolidation_mean_mean": 4.9961111111111105, "reward_consolidation_mean_min": 4.944444444444444, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.857432999999998, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.862366666666665, "reward_sla_mean_mean": -0.006556666666666667, "reward_sla_mean_min": -0.012666666666666666, "reward_sla_mean_max": -0.0013333333333333333, "reward_consolidation_sum_mean": 499.6111111111111, "reward_consolidation_sum_min": 494.44444444444434, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.74329999999964, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 386.2366666666665, "reward_sla_sum_mean": -0.6556666666666666, "reward_sla_sum_min": -1.2666666666666666, "reward_sla_sum_max": -0.13333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4982.0, "global_timestep_min": 3300, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.1866666666673, 882.7422222222228, 884.9300000000004, 884.9533333333337, 885.583333333334, 885.1266666666671, 885.5800000000008, 885.3800000000007, 885.0033333333339, 885.003333333334, 884.7800000000005, 885.233333333334, 882.385555555556, 885.3233333333341, 882.1855555555562, 884.8000000000006, 879.564444444445, 882.5255555555559, 884.8033333333341, 885.253333333334, 885.1300000000008, 882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2788549016084307, "mean_inference_ms": 2.4359038125618264, "mean_action_processing_ms": 0.10258789031883637, "mean_env_wait_ms": 1.775372717001613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007056713104248047, "StateBufferConnector_ms": 0.004166603088378906, "ViewRequirementAgentConnector_ms": 0.10626602172851562}, "num_episodes": 21, "episode_return_max": 885.583333333334, "episode_return_min": 879.564444444445, "episode_return_mean": 884.6987444444453, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253950, "num_agent_steps_trained": 253800, "num_env_steps_sampled": 253950, "num_env_steps_trained": 253800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 200.49451912334473, "num_env_steps_trained_throughput_per_sec": 200.49451912334473, "timesteps_total": 253950, "num_env_steps_sampled_lifetime": 253950, "num_agent_steps_sampled_lifetime": 253950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 253950, "timers": {"training_iteration_time_ms": 10493.501, "restore_workers_time_ms": 0.017, "training_step_time_ms": 740.732, "sample_time_ms": 721.728, "synch_weights_time_ms": 17.236}, "counters": {"num_env_steps_sampled": 253950, "num_env_steps_trained": 253800, "num_agent_steps_sampled": 253950, "num_agent_steps_trained": 253800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1693, "num_samples_added_to_queue": 253800}, "done": false, "training_iteration": 117, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-25", "timestamp": 1728602365, "time_this_iter_s": 10.491715908050537, "time_total_s": 1215.2183392047882, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36f790>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1215.2183392047882, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 18.92, "ram_util_percent": 59.693333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3298.50146484375, "policy_loss": -84.40068817138672, "entropy": 4.383917331695557, "entropy_coeff": 0.01, "var_gnorm": 17.626693725585938, "vf_loss": 339605.40625, "vf_explained_var": 0.5854067206382751}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 853.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 256050, "num_env_steps_trained": 255900, "num_agent_steps_sampled": 256050, "num_agent_steps_trained": 255900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1707, "num_samples_added_to_queue": 255900, "learner_queue": {"size_count": 853, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.628, "learner_load_time_ms": 0.471, "learner_load_wait_time_ms": 1402.876, "learner_dequeue_time_ms": 13176.751}}, "env_runners": {"episode_reward_max": 885.5333333333342, "episode_reward_min": 881.8922222222229, "episode_reward_mean": 884.8289777777785, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.8922222222229}, "policy_reward_max": {"default_policy": 885.5333333333342}, "policy_reward_mean": {"default_policy": 884.8289777777785}, "custom_metrics": {"num_consolidated_mean": 2.9992, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0729, "num_moves_min": 0.0, "num_moves_max": 0.29, "mean_accuracy_mean": 38.57071999999998, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.604666666666645, "num_model_switches_mean": 0.02, "num_model_switches_min": 0.0, "num_model_switches_max": 0.16, "num_slav_mean": 0.000328, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0006000000000000001, "mean_cluster_cpu_util_mean": 0.47748633894098175, "mean_cluster_cpu_util_min": 0.47487229959551386, "mean_cluster_cpu_util_max": 0.47929163219341786, "mean_cluster_mem_util_mean": 0.3185699182489451, "mean_cluster_mem_util_min": 0.31810073839662445, "mean_cluster_mem_util_max": 0.3188523206751055, "reward_consolidation_mean_mean": 4.997777777777777, "reward_consolidation_mean_min": 4.972222222222221, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8570719999999983, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.860466666666665, "reward_sla_mean_mean": -0.00656, "reward_sla_mean_min": -0.012000000000000002, "reward_sla_mean_max": -0.0013333333333333333, "reward_consolidation_sum_mean": 499.7777777777777, "reward_consolidation_sum_min": 497.2222222222222, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.70719999999966, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 386.0466666666665, "reward_sla_sum_mean": -0.6559999999999998, "reward_sla_sum_min": -1.2000000000000002, "reward_sla_sum_max": -0.13333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5682.0, "global_timestep_min": 4000, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [882.4755555555562, 885.2500000000007, 885.2633333333341, 884.9333333333341, 885.1933333333341, 885.3300000000008, 884.993333333334, 882.3522222222231, 885.5266666666674, 885.1933333333341, 882.3488888888895, 884.5300000000008, 885.1933333333341, 885.1266666666672, 885.1966666666673, 884.8666666666674, 885.3900000000009, 882.6022222222226, 885.2933333333341, 885.1933333333343, 884.793333333334, 885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790547700856332, "mean_inference_ms": 2.437709635365577, "mean_action_processing_ms": 0.10265017522483597, "mean_env_wait_ms": 1.7763181868485938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069942474365234375, "StateBufferConnector_ms": 0.004141569137573242, "ViewRequirementAgentConnector_ms": 0.10567903518676758}, "num_episodes": 21, "episode_return_max": 885.5333333333342, "episode_return_min": 881.8922222222229, "episode_return_mean": 884.8289777777785, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256050, "num_agent_steps_trained": 255900, "num_env_steps_sampled": 256050, "num_env_steps_trained": 255900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 204.2067094270128, "num_env_steps_trained_throughput_per_sec": 204.2067094270128, "timesteps_total": 256050, "num_env_steps_sampled_lifetime": 256050, "num_agent_steps_sampled_lifetime": 256050, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 256050, "timers": {"training_iteration_time_ms": 10510.871, "restore_workers_time_ms": 0.015, "training_step_time_ms": 734.307, "sample_time_ms": 716.9, "synch_weights_time_ms": 15.719}, "counters": {"num_env_steps_sampled": 256050, "num_env_steps_trained": 255900, "num_agent_steps_sampled": 256050, "num_agent_steps_trained": 255900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1707, "num_samples_added_to_queue": 255900}, "done": false, "training_iteration": 118, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-35", "timestamp": 1728602375, "time_this_iter_s": 10.294666290283203, "time_total_s": 1225.5130054950714, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1225.5130054950714, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.82857142857143, "ram_util_percent": 59.89285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2521.49267578125, "policy_loss": -36.91568374633789, "entropy": 4.366939067840576, "entropy_coeff": 0.01, "var_gnorm": 17.763919830322266, "vf_loss": 257150.921875, "vf_explained_var": 0.614066481590271}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 859.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 258000, "num_env_steps_trained": 257700, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 257700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1720, "num_samples_added_to_queue": 258000, "learner_queue": {"size_count": 859, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.29, "learner_load_time_ms": 0.452, "learner_load_wait_time_ms": 1456.271, "learner_dequeue_time_ms": 13074.979}}, "env_runners": {"episode_reward_max": 885.5333333333342, "episode_reward_min": 881.8922222222229, "episode_reward_mean": 884.896522222223, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.8922222222229}, "policy_reward_max": {"default_policy": 885.5333333333342}, "policy_reward_mean": {"default_policy": 884.896522222223}, "custom_metrics": {"num_consolidated_mean": 2.9996000000000005, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.042199999999999994, "num_moves_min": 0.0, "num_moves_max": 0.2, "mean_accuracy_mean": 38.56799666666666, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.58566666666665, "num_model_switches_mean": 0.0104, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.0003361666666666667, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0006, "mean_cluster_cpu_util_mean": 0.4775690183742416, "mean_cluster_cpu_util_min": 0.47559041184041184, "mean_cluster_cpu_util_max": 0.47929163219341786, "mean_cluster_mem_util_mean": 0.3185727478902953, "mean_cluster_mem_util_min": 0.3181722046413502, "mean_cluster_mem_util_max": 0.3188132911392405, "reward_consolidation_mean_mean": 4.998888888888888, "reward_consolidation_mean_min": 4.972222222222221, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8567996666666646, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.858566666666665, "reward_sla_mean_mean": -0.006723333333333335, "reward_sla_mean_min": -0.012000000000000002, "reward_sla_mean_max": -0.0013333333333333333, "reward_consolidation_sum_mean": 499.88888888888886, "reward_consolidation_sum_min": 497.2222222222222, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.67996666666636, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.8566666666665, "reward_sla_sum_mean": -0.6723333333333332, "reward_sla_sum_min": -1.2000000000000002, "reward_sla_sum_max": -0.13333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5914.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.0000000000007, 885.1966666666676, 885.1966666666675, 885.2600000000009, 884.733333333334, 885.063333333334, 882.2122222222226, 881.8922222222229, 885.4600000000008, 885.1333333333341, 885.5333333333342, 885.3300000000008, 882.4855555555564, 884.5300000000007, 884.9300000000006, 884.8666666666675, 884.9966666666674, 885.2666666666676, 885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27923368564497464, "mean_inference_ms": 2.43907057267226, "mean_action_processing_ms": 0.10270767329936151, "mean_env_wait_ms": 1.7771538303495715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006997585296630859, "StateBufferConnector_ms": 0.004157066345214844, "ViewRequirementAgentConnector_ms": 0.10581517219543457}, "num_episodes": 21, "episode_return_max": 885.5333333333342, "episode_return_min": 881.8922222222229, "episode_return_mean": 884.896522222223, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 257700, "num_env_steps_sampled": 258000, "num_env_steps_trained": 257700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 194.40220325067847, "num_env_steps_trained_throughput_per_sec": 179.4481876160109, "timesteps_total": 258000, "num_env_steps_sampled_lifetime": 258000, "num_agent_steps_sampled_lifetime": 258000, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 258000, "timers": {"training_iteration_time_ms": 10441.613, "restore_workers_time_ms": 0.015, "training_step_time_ms": 793.345, "sample_time_ms": 773.243, "synch_weights_time_ms": 18.212}, "counters": {"num_env_steps_sampled": 258000, "num_env_steps_trained": 257700, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 257700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1720, "num_samples_added_to_queue": 258000}, "done": false, "training_iteration": 119, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-45", "timestamp": 1728602385, "time_this_iter_s": 10.044398784637451, "time_total_s": 1235.5574042797089, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aef8370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1235.5574042797089, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 21.393333333333338, "ram_util_percent": 60.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2178.893310546875, "policy_loss": -102.51364135742188, "entropy": 4.359875202178955, "entropy_coeff": 0.01, "var_gnorm": 17.927486419677734, "vf_loss": 229448.65625, "vf_explained_var": 0.6059430837631226}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 866.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 259950, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259950, "num_agent_steps_trained": 259800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1733, "num_samples_added_to_queue": 259800, "learner_queue": {"size_count": 866, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.247, "learner_load_time_ms": 0.452, "learner_load_wait_time_ms": 1528.205, "learner_dequeue_time_ms": 13192.066}}, "env_runners": {"episode_reward_max": 885.5300000000009, "episode_reward_min": 882.2255555555563, "episode_reward_mean": 884.9716888888896, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 882.2255555555563}, "policy_reward_max": {"default_policy": 885.5300000000009}, "policy_reward_mean": {"default_policy": 884.9716888888896}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0258, "num_moves_min": 0.0, "num_moves_max": 0.18, "mean_accuracy_mean": 38.567046666666656, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.572999999999986, "num_model_switches_mean": 0.0058000000000000005, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.00033549999999999997, "num_slav_min": 0.0001, "num_slav_max": 0.0005333333333333334, "mean_cluster_cpu_util_mean": 0.47751605039988965, "mean_cluster_cpu_util_min": 0.47558310351167493, "mean_cluster_cpu_util_max": 0.47909978856407426, "mean_cluster_mem_util_mean": 0.31857488924050625, "mean_cluster_mem_util_min": 0.31822468354430383, "mean_cluster_mem_util_max": 0.3188132911392405, "reward_consolidation_mean_mean": 4.999722222222221, "reward_consolidation_mean_min": 4.972222222222221, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856704666666665, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8572999999999977, "reward_sla_mean_mean": -0.0067100000000000016, "reward_sla_mean_min": -0.010666666666666668, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.9722222222222, "reward_consolidation_sum_min": 497.2222222222222, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.6704666666664, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.7299999999998, "reward_sla_sum_mean": -0.671, "reward_sla_sum_min": -1.0666666666666669, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5110.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.1300000000007, 885.1966666666675, 885.2633333333341, 884.8666666666674, 885.1333333333341, 882.2255555555563, 884.7333333333341, 885.0000000000009, 885.0666666666676, 884.8666666666675, 884.8000000000008, 884.8700000000008, 885.2666666666676, 885.1366666666673, 884.7966666666674, 885.4666666666676, 884.6666666666672, 885.1333333333341, 885.0633333333341, 885.5300000000009, 884.6000000000008, 885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279371835498961, "mean_inference_ms": 2.4402284485127694, "mean_action_processing_ms": 0.10275900363888046, "mean_env_wait_ms": 1.7778725291685118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007056713104248047, "StateBufferConnector_ms": 0.004197359085083008, "ViewRequirementAgentConnector_ms": 0.10646891593933105}, "num_episodes": 18, "episode_return_max": 885.5300000000009, "episode_return_min": 882.2255555555563, "episode_return_mean": 884.9716888888896, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259950, "num_agent_steps_trained": 259800, "num_env_steps_sampled": 259950, "num_env_steps_trained": 259800, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 184.65300932924202, "num_env_steps_trained_throughput_per_sec": 198.85708696995295, "timesteps_total": 259950, "num_env_steps_sampled_lifetime": 259950, "num_agent_steps_sampled_lifetime": 259950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 259950, "timers": {"training_iteration_time_ms": 10479.399, "restore_workers_time_ms": 0.016, "training_step_time_ms": 823.732, "sample_time_ms": 804.292, "synch_weights_time_ms": 17.623}, "counters": {"num_env_steps_sampled": 259950, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259950, "num_agent_steps_trained": 259800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1733, "num_samples_added_to_queue": 259800}, "done": false, "training_iteration": 120, "trial_id": "3f041_00000", "date": "2024-10-11_00-19-56", "timestamp": 1728602396, "time_this_iter_s": 10.575197458267212, "time_total_s": 1246.132601737976, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefba00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1246.132601737976, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.826666666666668, "ram_util_percent": 60.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2238.602294921875, "policy_loss": -96.9775619506836, "entropy": 4.357110977172852, "entropy_coeff": 0.01, "var_gnorm": 18.049440383911133, "vf_loss": 234865.125, "vf_explained_var": 0.6196144819259644}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 872.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 261900, "num_env_steps_trained": 261600, "num_agent_steps_sampled": 261900, "num_agent_steps_trained": 261600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1746, "num_samples_added_to_queue": 261900, "learner_queue": {"size_count": 872, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.059, "learner_load_time_ms": 0.486, "learner_load_wait_time_ms": 1576.09, "learner_dequeue_time_ms": 13350.561}}, "env_runners": {"episode_reward_max": 885.4666666666676, "episode_reward_min": 884.3333333333339, "episode_reward_mean": 884.9995666666674, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.3333333333339}, "policy_reward_max": {"default_policy": 885.4666666666676}, "policy_reward_mean": {"default_policy": 884.9995666666674}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0129, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 38.56685666666665, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.572999999999986, "num_model_switches_mean": 0.004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.0003345, "num_slav_min": 0.0001, "num_slav_max": 0.0006666666666666666, "mean_cluster_cpu_util_mean": 0.4775002595835631, "mean_cluster_cpu_util_min": 0.4753013881228167, "mean_cluster_cpu_util_max": 0.47951047986762263, "mean_cluster_mem_util_mean": 0.31857521624472573, "mean_cluster_mem_util_min": 0.318373417721519, "mean_cluster_mem_util_max": 0.318834388185654, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856685666666665, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8572999999999977, "reward_sla_mean_mean": -0.006689999999999999, "reward_sla_mean_min": -0.013333333333333334, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.6685666666663, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.7299999999998, "reward_sla_sum_mean": -0.669, "reward_sla_sum_min": -1.3333333333333335, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4172.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.0666666666674, 884.9966666666674, 885.3300000000008, 884.8666666666675, 885.2666666666674, 885.1333333333341, 885.133333333334, 885.0000000000009, 885.2666666666676, 885.4000000000009, 884.7300000000006, 884.9333333333341, 885.0000000000008, 884.8666666666676, 884.6666666666673, 885.0666666666675, 884.8000000000009, 885.0666666666675, 884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27956898981491485, "mean_inference_ms": 2.4419551895987137, "mean_action_processing_ms": 0.10283009832929708, "mean_env_wait_ms": 1.7789541638578907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007261037826538086, "StateBufferConnector_ms": 0.004350423812866211, "ViewRequirementAgentConnector_ms": 0.11036157608032227}, "num_episodes": 21, "episode_return_max": 885.4666666666676, "episode_return_min": 884.3333333333339, "episode_return_mean": 884.9995666666674, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261900, "num_agent_steps_trained": 261600, "num_env_steps_sampled": 261900, "num_env_steps_trained": 261600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 180.24418503790136, "num_env_steps_trained_throughput_per_sec": 166.37924772729357, "timesteps_total": 261900, "num_env_steps_sampled_lifetime": 261900, "num_agent_steps_sampled_lifetime": 261900, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 261900, "timers": {"training_iteration_time_ms": 10487.738, "restore_workers_time_ms": 0.017, "training_step_time_ms": 832.094, "sample_time_ms": 812.602, "synch_weights_time_ms": 17.467}, "counters": {"num_env_steps_sampled": 261900, "num_env_steps_trained": 261600, "num_agent_steps_sampled": 261900, "num_agent_steps_trained": 261600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1746, "num_samples_added_to_queue": 261900}, "done": false, "training_iteration": 121, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-07", "timestamp": 1728602407, "time_this_iter_s": 10.83203911781311, "time_total_s": 1256.9646408557892, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1256.9646408557892, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.286666666666665, "ram_util_percent": 60.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2328.675537109375, "policy_loss": 213.89669799804688, "entropy": 4.37421178817749, "entropy_coeff": 0.01, "var_gnorm": 18.057462692260742, "vf_loss": 212790.140625, "vf_explained_var": 0.6385083198547363}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 879.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 263850, "num_env_steps_trained": 263700, "num_agent_steps_sampled": 263850, "num_agent_steps_trained": 263700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1759, "num_samples_added_to_queue": 263700, "learner_queue": {"size_count": 879, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.55, "learner_load_time_ms": 0.486, "learner_load_wait_time_ms": 1577.395, "learner_dequeue_time_ms": 13350.561}}, "env_runners": {"episode_reward_max": 885.4666666666676, "episode_reward_min": 884.3333333333339, "episode_reward_mean": 884.9803666666676, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.3333333333339}, "policy_reward_max": {"default_policy": 885.4666666666676}, "policy_reward_mean": {"default_policy": 884.9803666666676}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.008400000000000001, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 38.566603333333326, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.57299999999998, "num_model_switches_mean": 0.0036, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.00034283333333333334, "num_slav_min": 0.0001, "num_slav_max": 0.0006666666666666666, "mean_cluster_cpu_util_mean": 0.47743357786357793, "mean_cluster_cpu_util_min": 0.4753013881228167, "mean_cluster_cpu_util_max": 0.47951047986762263, "mean_cluster_mem_util_mean": 0.3185701687763713, "mean_cluster_mem_util_min": 0.318373417721519, "mean_cluster_mem_util_max": 0.318834388185654, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856660333333332, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8572999999999977, "reward_sla_mean_mean": -0.006856666666666666, "reward_sla_mean_min": -0.013333333333333334, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.666033333333, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.7299999999998, "reward_sla_sum_mean": -0.6856666666666666, "reward_sla_sum_min": -1.3333333333333335, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3369.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.8666666666672, 884.9333333333338, 885.0666666666674, 884.8666666666674, 884.9333333333342, 885.0000000000009, 885.0000000000008, 884.9333333333341, 884.8000000000008, 884.933333333334, 885.0666666666675, 884.8000000000008, 885.2666666666674, 885.0000000000008, 885.1333333333342, 885.0000000000009, 885.0000000000009, 884.963333333334, 885.0000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27981663505767784, "mean_inference_ms": 2.445802878262474, "mean_action_processing_ms": 0.10293129904369792, "mean_env_wait_ms": 1.780644613222545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007467746734619141, "StateBufferConnector_ms": 0.004476785659790039, "ViewRequirementAgentConnector_ms": 0.11366462707519531}, "num_episodes": 18, "episode_return_max": 885.4666666666676, "episode_return_min": 884.3333333333339, "episode_return_mean": 884.9803666666676, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263850, "num_agent_steps_trained": 263700, "num_env_steps_sampled": 263850, "num_env_steps_trained": 263700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 182.3794562804468, "num_env_steps_trained_throughput_per_sec": 196.40864522509654, "timesteps_total": 263850, "num_env_steps_sampled_lifetime": 263850, "num_agent_steps_sampled_lifetime": 263850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 263850, "timers": {"training_iteration_time_ms": 10545.855, "restore_workers_time_ms": 0.015, "training_step_time_ms": 827.658, "sample_time_ms": 809.265, "synch_weights_time_ms": 16.597}, "counters": {"num_env_steps_sampled": 263850, "num_env_steps_trained": 263700, "num_agent_steps_sampled": 263850, "num_agent_steps_trained": 263700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1759, "num_samples_added_to_queue": 263700}, "done": false, "training_iteration": 122, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-17", "timestamp": 1728602417, "time_this_iter_s": 10.704516649246216, "time_total_s": 1267.6691575050354, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36d660>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1267.6691575050354, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 22.518749999999997, "ram_util_percent": 60.224999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2279.877685546875, "policy_loss": 254.5100860595703, "entropy": 4.465705394744873, "entropy_coeff": 0.01, "var_gnorm": 18.03494644165039, "vf_loss": 203876.484375, "vf_explained_var": 0.6435397863388062}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 885.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 265800, "num_env_steps_trained": 265500, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1772, "num_samples_added_to_queue": 265800, "learner_queue": {"size_count": 885, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.527, "learner_load_time_ms": 0.464, "learner_load_wait_time_ms": 1517.634, "learner_dequeue_time_ms": 13032.063}}, "env_runners": {"episode_reward_max": 885.4666666666676, "episode_reward_min": 884.3333333333339, "episode_reward_mean": 884.9827666666674, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.3333333333339}, "policy_reward_max": {"default_policy": 885.4666666666676}, "policy_reward_mean": {"default_policy": 884.9827666666674}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.014000000000000002, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 38.56647666666665, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0036000000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.000341, "num_slav_min": 0.0001, "num_slav_max": 0.0006666666666666666, "mean_cluster_cpu_util_mean": 0.4774167564120242, "mean_cluster_cpu_util_min": 0.4753013881228167, "mean_cluster_cpu_util_max": 0.47951047986762263, "mean_cluster_mem_util_mean": 0.31856927215189873, "mean_cluster_mem_util_min": 0.3183227848101266, "mean_cluster_mem_util_max": 0.318834388185654, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8566476666666656, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006820000000000001, "reward_sla_mean_min": -0.013333333333333334, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.6647666666663, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.682, "reward_sla_sum_min": -1.3333333333333335, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2431.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.0666666666674, 885.0000000000009, 885.0666666666674, 885.1333333333341, 885.1333333333341, 885.0000000000008, 885.0000000000008, 884.6666666666673, 884.9333333333342, 885.0000000000009, 885.0666666666674, 885.2666666666676, 884.733333333334, 884.6000000000006, 884.7333333333339, 884.8000000000008, 884.8000000000008, 884.9333333333341, 884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28007919158686656, "mean_inference_ms": 2.448214452723875, "mean_action_processing_ms": 0.10302889668940607, "mean_env_wait_ms": 1.7821331193652543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007546424865722656, "StateBufferConnector_ms": 0.004528522491455078, "ViewRequirementAgentConnector_ms": 0.11423158645629883}, "num_episodes": 21, "episode_return_max": 885.4666666666676, "episode_return_min": 884.3333333333339, "episode_return_mean": 884.9827666666674, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265500, "num_env_steps_sampled": 265800, "num_env_steps_trained": 265500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 192.26324354153112, "num_env_steps_trained_throughput_per_sec": 177.47376326910566, "timesteps_total": 265800, "num_env_steps_sampled_lifetime": 265800, "num_agent_steps_sampled_lifetime": 265800, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 265800, "timers": {"training_iteration_time_ms": 10483.322, "restore_workers_time_ms": 0.016, "training_step_time_ms": 792.33, "sample_time_ms": 772.91, "synch_weights_time_ms": 17.487}, "counters": {"num_env_steps_sampled": 265800, "num_env_steps_trained": 265500, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1772, "num_samples_added_to_queue": 265800}, "done": false, "training_iteration": 123, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-27", "timestamp": 1728602427, "time_this_iter_s": 10.151696681976318, "time_total_s": 1277.8208541870117, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36fe20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1277.8208541870117, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 21.37142857142857, "ram_util_percent": 60.48571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2373.3251953125, "policy_loss": 374.86883544921875, "entropy": 4.785451889038086, "entropy_coeff": 0.01, "var_gnorm": 18.019989013671875, "vf_loss": 201281.265625, "vf_explained_var": 0.6393761038780212}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 892.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 267750, "num_env_steps_trained": 267600, "num_agent_steps_sampled": 267750, "num_agent_steps_trained": 267600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1785, "num_samples_added_to_queue": 267600, "learner_queue": {"size_count": 892, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.274, "learner_load_time_ms": 0.452, "learner_load_wait_time_ms": 1503.674, "learner_dequeue_time_ms": 12732.999}}, "env_runners": {"episode_reward_max": 885.4666666666676, "episode_reward_min": 884.3333333333339, "episode_reward_mean": 884.9808333333342, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.3333333333339}, "policy_reward_max": {"default_policy": 885.4666666666676}, "policy_reward_mean": {"default_policy": 884.9808333333342}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0466, "num_moves_min": 0.0, "num_moves_max": 0.34, "mean_accuracy_mean": 38.566349999999986, "mean_accuracy_min": 38.55399999999998, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.00034133333333333335, "num_slav_min": 0.0001, "num_slav_max": 0.0006666666666666666, "mean_cluster_cpu_util_mean": 0.47742423182110677, "mean_cluster_cpu_util_min": 0.4753013881228167, "mean_cluster_cpu_util_max": 0.47951047986762263, "mean_cluster_mem_util_mean": 0.318568496835443, "mean_cluster_mem_util_min": 0.3183227848101266, "mean_cluster_mem_util_max": 0.318834388185654, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856634999999999, "reward_accuracy_mean_min": 3.8553999999999977, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006826666666666668, "reward_sla_mean_min": -0.013333333333333334, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.6634999999997, "reward_accuracy_sum_min": 385.5399999999998, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6826666666666668, "reward_sla_sum_min": -1.3333333333333335, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.8666666666672, 885.200000000001, 884.8000000000006, 885.0666666666675, 885.1333333333341, 885.133333333334, 884.8000000000005, 885.2666666666673, 885.4666666666676, 885.2000000000008, 885.2666666666674, 884.8000000000009, 884.6000000000008, 884.9333333333341, 884.8666666666674, 884.8000000000006, 884.9366666666675, 885.400000000001, 885.4000000000009, 885.2666666666674, 884.6000000000007, 884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28022719280582076, "mean_inference_ms": 2.448435995158151, "mean_action_processing_ms": 0.10308635747692527, "mean_env_wait_ms": 1.7828502468570793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007582426071166992, "StateBufferConnector_ms": 0.004522800445556641, "ViewRequirementAgentConnector_ms": 0.11424469947814941}, "num_episodes": 18, "episode_return_max": 885.4666666666676, "episode_return_min": 884.3333333333339, "episode_return_mean": 884.9808333333342, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267750, "num_agent_steps_trained": 267600, "num_env_steps_sampled": 267750, "num_env_steps_trained": 267600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 189.57024124943052, "num_env_steps_trained_throughput_per_sec": 204.15256749938672, "timesteps_total": 267750, "num_env_steps_sampled_lifetime": 267750, "num_agent_steps_sampled_lifetime": 267750, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 267750, "timers": {"training_iteration_time_ms": 10440.273, "restore_workers_time_ms": 0.017, "training_step_time_ms": 798.338, "sample_time_ms": 779.474, "synch_weights_time_ms": 17.08}, "counters": {"num_env_steps_sampled": 267750, "num_env_steps_trained": 267600, "num_agent_steps_sampled": 267750, "num_agent_steps_trained": 267600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1785, "num_samples_added_to_queue": 267600}, "done": false, "training_iteration": 124, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-38", "timestamp": 1728602438, "time_this_iter_s": 10.299179077148438, "time_total_s": 1288.1200332641602, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698776d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1288.1200332641602, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 20.766666666666666, "ram_util_percent": 60.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2514.072998046875, "policy_loss": 496.7387390136719, "entropy": 4.940919399261475, "entropy_coeff": 0.01, "var_gnorm": 18.01238441467285, "vf_loss": 203215.71875, "vf_explained_var": 0.6384158134460449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 898.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 269700, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269700, "num_agent_steps_trained": 269400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1798, "num_samples_added_to_queue": 269700, "learner_queue": {"size_count": 898, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.775, "learner_load_time_ms": 0.447, "learner_load_wait_time_ms": 1577.846, "learner_dequeue_time_ms": 12718.05}}, "env_runners": {"episode_reward_max": 885.4000000000009, "episode_reward_min": 884.3333333333339, "episode_reward_mean": 884.9863000000008, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.3333333333339}, "policy_reward_max": {"default_policy": 885.4000000000009}, "policy_reward_mean": {"default_policy": 884.9863000000008}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1317, "num_moves_min": 0.0, "num_moves_max": 0.54, "mean_accuracy_mean": 38.56609666666665, "mean_accuracy_min": 38.55399999999998, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0003373333333333333, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0006666666666666666, "mean_cluster_cpu_util_mean": 0.47742638915701413, "mean_cluster_cpu_util_min": 0.4753013881228167, "mean_cluster_cpu_util_max": 0.47951047986762263, "mean_cluster_mem_util_mean": 0.31856654535864976, "mean_cluster_mem_util_min": 0.3183227848101266, "mean_cluster_mem_util_max": 0.318834388185654, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856609666666665, "reward_accuracy_mean_min": 3.8553999999999977, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006746666666666667, "reward_sla_mean_min": -0.013333333333333334, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.66096666666635, "reward_accuracy_sum_min": 385.5399999999998, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6746666666666669, "reward_sla_sum_min": -1.3333333333333335, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2483.0, "global_timestep_min": 800, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.733333333334, 884.9333333333341, 885.133333333334, 884.9333333333341, 885.0000000000009, 885.2666666666676, 885.1333333333341, 885.2666666666676, 884.8000000000006, 885.1333333333341, 885.3333333333343, 885.0000000000008, 884.9333333333341, 884.3333333333339, 884.8666666666675, 885.4000000000009, 885.1333333333342, 885.0666666666676, 885.0666666666676, 885.1333333333341, 885.0666666666675, 884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28056877379743633, "mean_inference_ms": 2.453055015690334, "mean_action_processing_ms": 0.10321865212939059, "mean_env_wait_ms": 1.7851277774980168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007529020309448242, "StateBufferConnector_ms": 0.004473447799682617, "ViewRequirementAgentConnector_ms": 0.1124725341796875}, "num_episodes": 21, "episode_return_max": 885.4000000000009, "episode_return_min": 884.3333333333339, "episode_return_mean": 884.9863000000008, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269700, "num_agent_steps_trained": 269400, "num_env_steps_sampled": 269700, "num_env_steps_trained": 269400, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 181.3565465659935, "num_env_steps_trained_throughput_per_sec": 167.406042983994, "timesteps_total": 269700, "num_env_steps_sampled_lifetime": 269700, "num_agent_steps_sampled_lifetime": 269700, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 269700, "timers": {"training_iteration_time_ms": 10465.055, "restore_workers_time_ms": 0.015, "training_step_time_ms": 835.116, "sample_time_ms": 817.219, "synch_weights_time_ms": 16.012}, "counters": {"num_env_steps_sampled": 269700, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269700, "num_agent_steps_trained": 269400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1798, "num_samples_added_to_queue": 269700}, "done": false, "training_iteration": 125, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-49", "timestamp": 1728602449, "time_this_iter_s": 10.763949871063232, "time_total_s": 1298.8839831352234, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874cd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1298.8839831352234, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 24.066666666666666, "ram_util_percent": 61.37333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2599.10888671875, "policy_loss": 611.1304931640625, "entropy": 4.985326290130615, "entropy_coeff": 0.01, "var_gnorm": 18.010086059570312, "vf_loss": 200293.453125, "vf_explained_var": 0.6400141716003418}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 271800, "num_env_steps_trained": 271500, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1812, "num_samples_added_to_queue": 271800, "learner_queue": {"size_count": 905, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.942, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1462.245, "learner_dequeue_time_ms": 12634.553}}, "env_runners": {"episode_reward_max": 885.4000000000009, "episode_reward_min": 884.1066666666671, "episode_reward_mean": 884.964600000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.1066666666671}, "policy_reward_max": {"default_policy": 885.4000000000009}, "policy_reward_mean": {"default_policy": 884.964600000001}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.23720000000000002, "num_moves_min": 0.0, "num_moves_max": 0.61, "mean_accuracy_mean": 38.56489333333332, "mean_accuracy_min": 38.54766666666664, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0054, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.00034216666666666667, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0007166666666666666, "mean_cluster_cpu_util_mean": 0.4773593043298399, "mean_cluster_cpu_util_min": 0.4753864681007538, "mean_cluster_cpu_util_max": 0.4792230878838022, "mean_cluster_mem_util_mean": 0.31855303270042196, "mean_cluster_mem_util_min": 0.3183227848101266, "mean_cluster_mem_util_max": 0.31874367088607597, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856489333333331, "reward_accuracy_mean_min": 3.8547666666666647, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006843333333333333, "reward_sla_mean_min": -0.014333333333333333, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.64893333333316, "reward_accuracy_sum_min": 385.47666666666646, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6843333333333333, "reward_sla_sum_min": -1.4333333333333333, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3183.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.6666666666673, 884.6000000000007, 885.133333333334, 884.8000000000009, 885.0666666666675, 884.8000000000008, 884.8033333333341, 885.0666666666675, 885.2666666666677, 885.0000000000008, 885.0000000000008, 885.2666666666674, 884.8666666666675, 884.7333333333341, 884.6666666666674, 885.1333333333342, 884.9333333333341, 884.9333333333342, 884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28078445294178456, "mean_inference_ms": 2.455137528285494, "mean_action_processing_ms": 0.1033053445245212, "mean_env_wait_ms": 1.78651206012476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007628917694091797, "StateBufferConnector_ms": 0.004291534423828125, "ViewRequirementAgentConnector_ms": 0.10797548294067383}, "num_episodes": 21, "episode_return_max": 885.4000000000009, "episode_return_min": 884.1066666666671, "episode_return_mean": 884.964600000001, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271500, "num_env_steps_sampled": 271800, "num_env_steps_trained": 271500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 198.25084902784243, "num_env_steps_trained_throughput_per_sec": 198.25084902784243, "timesteps_total": 271800, "num_env_steps_sampled_lifetime": 271800, "num_agent_steps_sampled_lifetime": 271800, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 271800, "timers": {"training_iteration_time_ms": 10463.335, "restore_workers_time_ms": 0.015, "training_step_time_ms": 752.784, "sample_time_ms": 733.773, "synch_weights_time_ms": 17.203}, "counters": {"num_env_steps_sampled": 271800, "num_env_steps_trained": 271500, "num_agent_steps_sampled": 271800, "num_agent_steps_trained": 271500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1812, "num_samples_added_to_queue": 271800}, "done": false, "training_iteration": 126, "trial_id": "3f041_00000", "date": "2024-10-11_00-20-59", "timestamp": 1728602459, "time_this_iter_s": 10.60722303390503, "time_total_s": 1309.4912061691284, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfabf70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1309.4912061691284, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 20.6125, "ram_util_percent": 61.262499999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1016.8778686523438, "policy_loss": -680.7689819335938, "entropy": 5.1720380783081055, "entropy_coeff": 0.01, "var_gnorm": 18.008338928222656, "vf_loss": 171316.296875, "vf_explained_var": 0.659477949142456}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 912.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 273750, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273750, "num_agent_steps_trained": 273600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1825, "num_samples_added_to_queue": 273600, "learner_queue": {"size_count": 912, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.349, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1468.821, "learner_dequeue_time_ms": 12634.553}}, "env_runners": {"episode_reward_max": 885.4000000000009, "episode_reward_min": 883.916666666667, "episode_reward_mean": 884.8778666666675, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 883.916666666667}, "policy_reward_max": {"default_policy": 885.4000000000009}, "policy_reward_mean": {"default_policy": 884.8778666666675}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3249, "num_moves_min": 0.0, "num_moves_max": 0.61, "mean_accuracy_mean": 38.55425333333332, "mean_accuracy_min": 38.47166666666664, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.03590000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.28, "num_slav_mean": 0.00033233333333333335, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0007166666666666666, "mean_cluster_cpu_util_mean": 0.47718065763467554, "mean_cluster_cpu_util_min": 0.4748282542746829, "mean_cluster_cpu_util_max": 0.4792230878838022, "mean_cluster_mem_util_mean": 0.31849668248945145, "mean_cluster_mem_util_min": 0.31795569620253167, "mean_cluster_mem_util_max": 0.31874367088607597, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8554253333333315, "reward_accuracy_mean_min": 3.847166666666664, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006646666666666666, "reward_sla_mean_min": -0.014333333333333333, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.5425333333331, "reward_accuracy_sum_min": 384.7166666666664, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6646666666666667, "reward_sla_sum_min": -1.4333333333333333, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3783.0, "global_timestep_min": 2100, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.6000000000007, 884.8000000000009, 885.0000000000008, 885.0000000000009, 885.2000000000008, 885.1333333333342, 884.9333333333341, 884.8000000000005, 885.0000000000008, 885.1333333333342, 884.9333333333342, 885.0666666666676, 885.2666666666674, 884.933333333334, 885.0000000000008, 885.0000000000008, 884.7333333333339, 884.6666666666675, 885.0666666666675, 885.0666666666675, 885.0000000000009, 884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2809513459036564, "mean_inference_ms": 2.4566674850793335, "mean_action_processing_ms": 0.10337099375269736, "mean_env_wait_ms": 1.7875496611832669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007839679718017578, "StateBufferConnector_ms": 0.004269599914550781, "ViewRequirementAgentConnector_ms": 0.10829949378967285}, "num_episodes": 18, "episode_return_max": 885.4000000000009, "episode_return_min": 883.916666666667, "episode_return_mean": 884.8778666666675, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273750, "num_agent_steps_trained": 273600, "num_env_steps_sampled": 273750, "num_env_steps_trained": 273600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 193.16051204195279, "num_env_steps_trained_throughput_per_sec": 208.01901296825685, "timesteps_total": 273750, "num_env_steps_sampled_lifetime": 273750, "num_agent_steps_sampled_lifetime": 273750, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 273750, "timers": {"training_iteration_time_ms": 10425.448, "restore_workers_time_ms": 0.017, "training_step_time_ms": 780.851, "sample_time_ms": 761.472, "synch_weights_time_ms": 17.338}, "counters": {"num_env_steps_sampled": 273750, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273750, "num_agent_steps_trained": 273600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1825, "num_samples_added_to_queue": 273600}, "done": false, "training_iteration": 127, "trial_id": "3f041_00000", "date": "2024-10-11_00-21-09", "timestamp": 1728602469, "time_this_iter_s": 10.105117321014404, "time_total_s": 1319.5963234901428, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698775b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1319.5963234901428, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 20.0, "ram_util_percent": 61.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1401.0914306640625, "policy_loss": -539.5958251953125, "entropy": 5.051835536956787, "entropy_coeff": 0.01, "var_gnorm": 18.00706672668457, "vf_loss": 195584.28125, "vf_explained_var": 0.6425814628601074}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 919.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 275850, "num_env_steps_trained": 275700, "num_agent_steps_sampled": 275850, "num_agent_steps_trained": 275700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1839, "num_samples_added_to_queue": 275700, "learner_queue": {"size_count": 919, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.553, "learner_load_time_ms": 0.365, "learner_load_wait_time_ms": 1478.804, "learner_dequeue_time_ms": 12589.887}}, "env_runners": {"episode_reward_max": 885.4000000000009, "episode_reward_min": 883.3033333333336, "episode_reward_mean": 884.6395666666672, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 883.3033333333336}, "policy_reward_max": {"default_policy": 885.4000000000009}, "policy_reward_mean": {"default_policy": 884.6395666666672}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.41009999999999996, "num_moves_min": 0.06, "num_moves_max": 0.61, "mean_accuracy_mean": 38.528856666666655, "mean_accuracy_min": 38.40199999999998, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.1014, "num_model_switches_min": 0.0, "num_model_switches_max": 0.4, "num_slav_mean": 0.0003245, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0007166666666666666, "mean_cluster_cpu_util_mean": 0.47668679732027947, "mean_cluster_cpu_util_min": 0.47342431972789123, "mean_cluster_cpu_util_max": 0.47895424250781393, "mean_cluster_mem_util_mean": 0.31837249999999995, "mean_cluster_mem_util_min": 0.31764556962025314, "mean_cluster_mem_util_max": 0.31874367088607597, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.852885666666665, "reward_accuracy_mean_min": 3.8401999999999976, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.00649, "reward_sla_mean_min": -0.014333333333333333, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.2885666666665, "reward_accuracy_sum_min": 384.01999999999975, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.649, "reward_sla_sum_min": -1.4333333333333333, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4483.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.803333333334, 885.0000000000009, 884.8000000000008, 884.9333333333342, 884.6666666666675, 884.6000000000007, 885.0666666666675, 884.7333333333339, 884.8000000000009, 884.933333333334, 885.0666666666674, 884.9400000000009, 884.8000000000008, 885.2666666666676, 885.0000000000007, 884.9333333333341, 885.0000000000008, 885.2000000000007, 885.0000000000009, 885.0000000000008, 885.1366666666676, 885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.281106061160192, "mean_inference_ms": 2.458283849173593, "mean_action_processing_ms": 0.1034399368847107, "mean_env_wait_ms": 1.7886878286304286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007748126983642578, "StateBufferConnector_ms": 0.004214048385620117, "ViewRequirementAgentConnector_ms": 0.10838890075683594}, "num_episodes": 21, "episode_return_max": 885.4000000000009, "episode_return_min": 883.3033333333336, "episode_return_mean": 884.6395666666672, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275850, "num_agent_steps_trained": 275700, "num_env_steps_sampled": 275850, "num_env_steps_trained": 275700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 199.3780644793274, "num_env_steps_trained_throughput_per_sec": 199.3780644793274, "timesteps_total": 275850, "num_env_steps_sampled_lifetime": 275850, "num_agent_steps_sampled_lifetime": 275850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 275850, "timers": {"training_iteration_time_ms": 10450.354, "restore_workers_time_ms": 0.013, "training_step_time_ms": 762.682, "sample_time_ms": 745.306, "synch_weights_time_ms": 15.629}, "counters": {"num_env_steps_sampled": 275850, "num_env_steps_trained": 275700, "num_agent_steps_sampled": 275850, "num_agent_steps_trained": 275700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1839, "num_samples_added_to_queue": 275700}, "done": false, "training_iteration": 128, "trial_id": "3f041_00000", "date": "2024-10-11_00-21-20", "timestamp": 1728602480, "time_this_iter_s": 10.543292999267578, "time_total_s": 1330.1396164894104, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36ca30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1330.1396164894104, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.02, "ram_util_percent": 60.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1640.90771484375, "policy_loss": -180.03627014160156, "entropy": 4.7590789794921875, "entropy_coeff": 0.01, "var_gnorm": 18.00780487060547, "vf_loss": 183522.125, "vf_explained_var": 0.649513840675354}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 926.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1853, "num_samples_added_to_queue": 277800, "learner_queue": {"size_count": 926, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.585, "learner_load_time_ms": 0.351, "learner_load_wait_time_ms": 1421.172, "learner_dequeue_time_ms": 12587.59}}, "env_runners": {"episode_reward_max": 885.4000000000009, "episode_reward_min": 883.2200000000003, "episode_reward_mean": 884.4461666666674, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 883.2200000000003}, "policy_reward_max": {"default_policy": 885.4000000000009}, "policy_reward_mean": {"default_policy": 884.4461666666674}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4354, "num_moves_min": 0.2, "num_moves_max": 0.61, "mean_accuracy_mean": 38.50744999999998, "mean_accuracy_min": 38.40199999999997, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.1536, "num_model_switches_min": 0.0, "num_model_switches_max": 0.4, "num_slav_mean": 0.0003141666666666667, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0007166666666666666, "mean_cluster_cpu_util_mean": 0.4763322320279464, "mean_cluster_cpu_util_min": 0.47342431972789123, "mean_cluster_cpu_util_max": 0.47874450726236434, "mean_cluster_mem_util_mean": 0.3182719620253165, "mean_cluster_mem_util_min": 0.31764556962025314, "mean_cluster_mem_util_max": 0.31870358649789027, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.850744999999997, "reward_accuracy_mean_min": 3.8401999999999976, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006283333333333334, "reward_sla_mean_min": -0.014333333333333333, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.07449999999983, "reward_accuracy_sum_min": 384.01999999999975, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6283333333333334, "reward_sla_sum_min": -1.4333333333333333, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5182.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.0000000000007, 884.7366666666674, 884.7366666666672, 885.2666666666674, 885.0000000000007, 885.1333333333341, 885.3333333333343, 885.4000000000009, 884.8700000000007, 885.200000000001, 884.7366666666674, 885.2000000000007, 885.2000000000008, 885.200000000001, 885.1333333333342, 885.1333333333341, 885.2666666666676, 885.0000000000009, 884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28118419716720233, "mean_inference_ms": 2.4575517815863153, "mean_action_processing_ms": 0.10346844133184485, "mean_env_wait_ms": 1.7890801104213299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075855255126953125, "StateBufferConnector_ms": 0.0041348934173583984, "ViewRequirementAgentConnector_ms": 0.10538744926452637}, "num_episodes": 21, "episode_return_max": 885.4000000000009, "episode_return_min": 883.2200000000003, "episode_return_mean": 884.4461666666674, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 204.2679098321592, "num_env_steps_trained_throughput_per_sec": 204.2679098321592, "timesteps_total": 277950, "num_env_steps_sampled_lifetime": 277950, "num_agent_steps_sampled_lifetime": 277950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 277950, "timers": {"training_iteration_time_ms": 10475.34, "restore_workers_time_ms": 0.014, "training_step_time_ms": 729.535, "sample_time_ms": 711.588, "synch_weights_time_ms": 16.326}, "counters": {"num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1853, "num_samples_added_to_queue": 277800}, "done": false, "training_iteration": 129, "trial_id": "3f041_00000", "date": "2024-10-11_00-21-30", "timestamp": 1728602490, "time_this_iter_s": 10.291025400161743, "time_total_s": 1340.4306418895721, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b36dff0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1340.4306418895721, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 18.34, "ram_util_percent": 60.58000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1445.8131103515625, "policy_loss": -334.6982421875, "entropy": 4.8457841873168945, "entropy_coeff": 0.01, "var_gnorm": 18.00984764099121, "vf_loss": 179504.875, "vf_explained_var": 0.6530025005340576}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 279750, "num_env_steps_trained": 279600, "num_agent_steps_sampled": 279750, "num_agent_steps_trained": 279600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1865, "num_samples_added_to_queue": 279600, "learner_queue": {"size_count": 932, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.181, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1521.011, "learner_dequeue_time_ms": 12672.684}}, "env_runners": {"episode_reward_max": 885.3366666666676, "episode_reward_min": 883.2200000000003, "episode_reward_mean": 884.2888666666673, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 883.2200000000003}, "policy_reward_max": {"default_policy": 885.3366666666676}, "policy_reward_mean": {"default_policy": 884.2888666666673}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.40369999999999995, "num_moves_min": 0.08, "num_moves_max": 0.61, "mean_accuracy_mean": 38.491553333333314, "mean_accuracy_min": 38.40199999999997, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.19490000000000005, "num_model_switches_min": 0.0, "num_model_switches_max": 0.4, "num_slav_mean": 0.0003133333333333333, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0007166666666666666, "mean_cluster_cpu_util_mean": 0.47602939269626776, "mean_cluster_cpu_util_min": 0.47342431972789123, "mean_cluster_cpu_util_max": 0.478285162713734, "mean_cluster_mem_util_mean": 0.3181945411392405, "mean_cluster_mem_util_min": 0.31764556962025314, "mean_cluster_mem_util_max": 0.3186782700421941, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.849155333333331, "reward_accuracy_mean_min": 3.8401999999999976, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006266666666666667, "reward_sla_mean_min": -0.014333333333333333, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.9155333333331, "reward_accuracy_sum_min": 384.01999999999975, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6266666666666666, "reward_sla_sum_min": -1.4333333333333333, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5783.0, "global_timestep_min": 4100, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.6666666666675, 884.9366666666674, 884.8666666666674, 885.0033333333341, 884.9366666666674, 884.8000000000008, 884.8400000000007, 884.5400000000008, 884.733333333334, 885.133333333334, 885.0033333333342, 885.133333333334, 885.1366666666677, 884.6666666666673, 884.9400000000009, 885.0666666666675, 885.2033333333342, 885.0666666666674, 884.1066666666671, 885.3366666666676, 885.043333333334, 885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2813476827068426, "mean_inference_ms": 2.4606321260766526, "mean_action_processing_ms": 0.10353785287327659, "mean_env_wait_ms": 1.7903520223903766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075342655181884766, "StateBufferConnector_ms": 0.004120826721191406, "ViewRequirementAgentConnector_ms": 0.10501527786254883}, "num_episodes": 18, "episode_return_max": 885.3366666666676, "episode_return_min": 883.2200000000003, "episode_return_mean": 884.2888666666673, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279750, "num_agent_steps_trained": 279600, "num_env_steps_sampled": 279750, "num_env_steps_trained": 279600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.98703362299435, "num_env_steps_trained_throughput_per_sec": 177.98703362299435, "timesteps_total": 279750, "num_env_steps_sampled_lifetime": 279750, "num_agent_steps_sampled_lifetime": 279750, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 279750, "timers": {"training_iteration_time_ms": 10430.615, "restore_workers_time_ms": 0.016, "training_step_time_ms": 804.425, "sample_time_ms": 785.504, "synch_weights_time_ms": 17.143}, "counters": {"num_env_steps_sampled": 279750, "num_env_steps_trained": 279600, "num_agent_steps_sampled": 279750, "num_agent_steps_trained": 279600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1865, "num_samples_added_to_queue": 279600}, "done": false, "training_iteration": 130, "trial_id": "3f041_00000", "date": "2024-10-11_00-21-41", "timestamp": 1728602501, "time_this_iter_s": 10.122638940811157, "time_total_s": 1350.5532808303833, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874af0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1350.5532808303833, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 24.392857142857146, "ram_util_percent": 62.58571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 949.905517578125, "policy_loss": -814.534423828125, "entropy": 4.9315595626831055, "entropy_coeff": 0.01, "var_gnorm": 18.009647369384766, "vf_loss": 177923.46875, "vf_explained_var": 0.6744343042373657}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 939.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1879, "num_samples_added_to_queue": 281700, "learner_queue": {"size_count": 939, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.583, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1437.472, "learner_dequeue_time_ms": 12687.665}}, "env_runners": {"episode_reward_max": 885.0666666666675, "episode_reward_min": 880.8566666666658, "episode_reward_mean": 883.7622333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 880.8566666666658}, "policy_reward_max": {"default_policy": 885.0666666666675}, "policy_reward_mean": {"default_policy": 883.7622333333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3967, "num_moves_min": 0.08, "num_moves_max": 0.64, "mean_accuracy_mean": 38.43575666666664, "mean_accuracy_min": 38.1423333333333, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.28809999999999997, "num_model_switches_min": 0.0, "num_model_switches_max": 0.63, "num_slav_mean": 0.0002976666666666667, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.4749526491542562, "mean_cluster_cpu_util_min": 0.46915042976650123, "mean_cluster_cpu_util_max": 0.478158186247472, "mean_cluster_mem_util_mean": 0.3179148628691983, "mean_cluster_mem_util_min": 0.3165395569620253, "mean_cluster_mem_util_max": 0.318539029535865, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8435756666666645, "reward_accuracy_mean_min": 3.8142333333333314, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.005953333333333334, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.3575666666665, "reward_accuracy_sum_min": 381.4233333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.5953333333333334, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5781.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.003333333334, 885.0666666666675, 884.7866666666673, 884.6866666666673, 884.7200000000006, 884.5066666666671, 884.1700000000005, 884.6533333333339, 884.7833333333341, 884.1466666666672, 883.916666666667, 883.9466666666672, 884.246666666667, 884.743333333334, 884.5966666666673, 884.5300000000007, 884.3433333333337, 884.2366666666674, 883.9833333333338, 883.4066666666671, 883.8700000000003, 883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28147110654201196, "mean_inference_ms": 2.4618138102950438, "mean_action_processing_ms": 0.10358385847000168, "mean_env_wait_ms": 1.7911247432914925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007149934768676758, "StateBufferConnector_ms": 0.004094600677490234, "ViewRequirementAgentConnector_ms": 0.10405874252319336}, "num_episodes": 21, "episode_return_max": 885.0666666666675, "episode_return_min": 880.8566666666658, "episode_return_mean": 883.7622333333336, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 203.99372485799304, "num_env_steps_trained_throughput_per_sec": 203.99372485799304, "timesteps_total": 281850, "num_env_steps_sampled_lifetime": 281850, "num_agent_steps_sampled_lifetime": 281850, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 281850, "timers": {"training_iteration_time_ms": 10378.192, "restore_workers_time_ms": 0.016, "training_step_time_ms": 724.52, "sample_time_ms": 706.398, "synch_weights_time_ms": 16.393}, "counters": {"num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1879, "num_samples_added_to_queue": 281700}, "done": false, "training_iteration": 131, "trial_id": "3f041_00000", "date": "2024-10-11_00-21-51", "timestamp": 1728602511, "time_this_iter_s": 10.318037986755371, "time_total_s": 1360.8713188171387, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae538e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1360.8713188171387, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.84, "ram_util_percent": 62.20666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 769.242919921875, "policy_loss": -1078.320556640625, "entropy": 4.642005443572998, "entropy_coeff": 0.01, "var_gnorm": 17.995662689208984, "vf_loss": 186148.953125, "vf_explained_var": 0.6665381789207458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 945.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 283800, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1892, "num_samples_added_to_queue": 283800, "learner_queue": {"size_count": 945, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.634, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 1492.31, "learner_dequeue_time_ms": 12652.052}}, "env_runners": {"episode_reward_max": 885.0166666666674, "episode_reward_min": 879.4766666666656, "episode_reward_mean": 882.8653666666668, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 879.4766666666656}, "policy_reward_max": {"default_policy": 885.0166666666674}, "policy_reward_mean": {"default_policy": 882.8653666666668}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.35339999999999994, "num_moves_min": 0.08, "num_moves_max": 0.64, "mean_accuracy_mean": 38.34113666666664, "mean_accuracy_min": 37.977666666666636, "mean_accuracy_max": 38.53499999999998, "num_model_switches_mean": 0.3115, "num_model_switches_min": 0.08, "num_model_switches_max": 0.63, "num_slav_mean": 0.000273, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.47302293126034184, "mean_cluster_cpu_util_min": 0.46370307041735614, "mean_cluster_cpu_util_max": 0.478158186247472, "mean_cluster_mem_util_mean": 0.31744013713080166, "mean_cluster_mem_util_min": 0.31553164556962027, "mean_cluster_mem_util_max": 0.31844672995780593, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.834113666666665, "reward_accuracy_mean_min": 3.7977666666666643, "reward_accuracy_mean_max": 3.853499999999998, "reward_sla_mean_mean": -0.0054600000000000004, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0016666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 383.4113666666664, "reward_accuracy_sum_min": 379.7766666666664, "reward_accuracy_sum_max": 385.3499999999998, "reward_sla_sum_mean": -0.546, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.16666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4842.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.986666666667, 883.886666666667, 883.5433333333339, 883.7400000000001, 883.8866666666671, 884.2433333333339, 884.0633333333337, 883.8000000000008, 884.4000000000005, 884.0200000000004, 883.4866666666668, 883.7400000000004, 883.9366666666671, 883.9933333333339, 883.7566666666671, 883.8000000000002, 883.8733333333338, 883.3033333333336, 883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2815456804535879, "mean_inference_ms": 2.461158671974997, "mean_action_processing_ms": 0.10360889153394849, "mean_env_wait_ms": 1.7914704805130162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006824016571044922, "StateBufferConnector_ms": 0.004034996032714844, "ViewRequirementAgentConnector_ms": 0.10259652137756348}, "num_episodes": 21, "episode_return_max": 885.0166666666674, "episode_return_min": 879.4766666666656, "episode_return_mean": 882.8653666666668, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283500, "num_env_steps_sampled": 283800, "num_env_steps_trained": 283500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 187.05013812137955, "num_env_steps_trained_throughput_per_sec": 172.6616659581965, "timesteps_total": 283800, "num_env_steps_sampled_lifetime": 283800, "num_agent_steps_sampled_lifetime": 283800, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 283800, "timers": {"training_iteration_time_ms": 10351.494, "restore_workers_time_ms": 0.013, "training_step_time_ms": 805.835, "sample_time_ms": 787.706, "synch_weights_time_ms": 16.348}, "counters": {"num_env_steps_sampled": 283800, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 283800, "num_agent_steps_trained": 283500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1892, "num_samples_added_to_queue": 283800}, "done": false, "training_iteration": 132, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-01", "timestamp": 1728602521, "time_this_iter_s": 10.435791015625, "time_total_s": 1371.3071098327637, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee38b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1371.3071098327637, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 20.71333333333333, "ram_util_percent": 62.686666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1849.4998779296875, "policy_loss": -121.30835723876953, "entropy": 4.522895336151123, "entropy_coeff": 0.01, "var_gnorm": 17.978607177734375, "vf_loss": 198437.703125, "vf_explained_var": 0.6346613168716431}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 951.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1904, "num_samples_added_to_queue": 285600, "learner_queue": {"size_count": 951, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.002, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 1587.262, "learner_dequeue_time_ms": 12652.052}}, "env_runners": {"episode_reward_max": 885.0166666666674, "episode_reward_min": 878.9999999999986, "episode_reward_mean": 882.0626666666662, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.9999999999986}, "policy_reward_max": {"default_policy": 885.0166666666674}, "policy_reward_mean": {"default_policy": 882.0626666666662}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.29710000000000003, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 38.2563333333333, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.53499999999998, "num_model_switches_mean": 0.2792, "num_model_switches_min": 0.0, "num_model_switches_max": 0.63, "num_slav_mean": 0.0002503333333333333, "num_slav_min": 5e-05, "num_slav_max": 0.00046666666666666666, "mean_cluster_cpu_util_mean": 0.4713754574600111, "mean_cluster_cpu_util_min": 0.4634951162897592, "mean_cluster_cpu_util_max": 0.478158186247472, "mean_cluster_mem_util_mean": 0.31700562236286917, "mean_cluster_mem_util_min": 0.3153212025316456, "mean_cluster_mem_util_max": 0.31844672995780593, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8256333333333314, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.853499999999998, "reward_sla_mean_mean": -0.005006666666666667, "reward_sla_mean_min": -0.009333333333333334, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 382.56333333333316, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 385.3499999999998, "reward_sla_sum_mean": -0.5006666666666668, "reward_sla_sum_min": -0.9333333333333333, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4039.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.7666666666668, 883.6700000000004, 883.6100000000004, 884.0133333333339, 883.8300000000004, 883.9733333333339, 884.1566666666669, 883.7866666666672, 884.5066666666673, 883.2200000000003, 884.2800000000007, 884.0533333333339, 884.2466666666672, 884.2733333333338, 884.1200000000006, 883.6766666666672, 884.3400000000005, 883.9800000000002, 883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2817482320581476, "mean_inference_ms": 2.4646210671744226, "mean_action_processing_ms": 0.10368580510627132, "mean_env_wait_ms": 1.7928924000979551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068683624267578125, "StateBufferConnector_ms": 0.00409388542175293, "ViewRequirementAgentConnector_ms": 0.10438728332519531}, "num_episodes": 18, "episode_return_max": 885.0166666666674, "episode_return_min": 878.9999999999986, "episode_return_mean": 882.0626666666662, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.06280679650317, "num_env_steps_trained_throughput_per_sec": 177.06280679650317, "timesteps_total": 285600, "num_env_steps_sampled_lifetime": 285600, "num_agent_steps_sampled_lifetime": 285600, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 285600, "timers": {"training_iteration_time_ms": 10353.848, "restore_workers_time_ms": 0.016, "training_step_time_ms": 845.82, "sample_time_ms": 827.087, "synch_weights_time_ms": 17.028}, "counters": {"num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1904, "num_samples_added_to_queue": 285600}, "done": false, "training_iteration": 133, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-12", "timestamp": 1728602532, "time_this_iter_s": 10.17598819732666, "time_total_s": 1381.4830980300903, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876350>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1381.4830980300903, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.14666666666667, "ram_util_percent": 62.68666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1754.304931640625, "policy_loss": -191.24485778808594, "entropy": 4.41148567199707, "entropy_coeff": 0.01, "var_gnorm": 17.97040557861328, "vf_loss": 195878.421875, "vf_explained_var": 0.6502606868743896}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 958.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 287550, "num_env_steps_trained": 287400, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1917, "num_samples_added_to_queue": 287400, "learner_queue": {"size_count": 958, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.316, "learner_load_time_ms": 0.344, "learner_load_wait_time_ms": 1540.446, "learner_dequeue_time_ms": 12685.945}}, "env_runners": {"episode_reward_max": 885.0166666666674, "episode_reward_min": 878.7999999999987, "episode_reward_mean": 881.1825333333328, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.7999999999987}, "policy_reward_max": {"default_policy": 885.0166666666674}, "policy_reward_mean": {"default_policy": 881.1825333333328}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2433, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 38.163486666666635, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.53499999999998, "num_model_switches_mean": 0.23879999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.63, "num_slav_mean": 0.00022616666666666667, "num_slav_min": 5e-05, "num_slav_max": 0.00046666666666666666, "mean_cluster_cpu_util_mean": 0.4694957924250782, "mean_cluster_cpu_util_min": 0.46342944475087333, "mean_cluster_cpu_util_max": 0.478158186247472, "mean_cluster_mem_util_mean": 0.3165351213080168, "mean_cluster_mem_util_min": 0.3152505274261603, "mean_cluster_mem_util_max": 0.31844672995780593, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.816348666666664, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.853499999999998, "reward_sla_mean_mean": -0.004523333333333333, "reward_sla_mean_min": -0.009333333333333334, "reward_sla_mean_max": -0.001, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 381.6348666666665, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 385.3499999999998, "reward_sla_sum_mean": -0.45233333333333325, "reward_sla_sum_min": -0.9333333333333333, "reward_sla_sum_max": -0.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3230.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.7600000000004, 883.6000000000004, 884.6066666666675, 884.6366666666673, 885.0166666666674, 884.2133333333337, 884.573333333334, 883.7933333333337, 884.1166666666671, 883.6766666666671, 883.8533333333338, 884.6900000000007, 884.2200000000005, 884.403333333334, 884.1866666666671, 884.036666666667, 884.4033333333339, 884.336666666667, 884.6300000000007, 883.8266666666668, 883.7833333333336, 884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.281865407112156, "mean_inference_ms": 2.464712423856683, "mean_action_processing_ms": 0.1037275550320952, "mean_env_wait_ms": 1.7934537827659085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989717483520508, "StateBufferConnector_ms": 0.004187345504760742, "ViewRequirementAgentConnector_ms": 0.10767531394958496}, "num_episodes": 18, "episode_return_max": 885.0166666666674, "episode_return_min": 878.7999999999987, "episode_return_mean": 881.1825333333328, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287400, "num_env_steps_sampled": 287550, "num_env_steps_trained": 287400, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 182.36889123656826, "num_env_steps_trained_throughput_per_sec": 196.39726748553505, "timesteps_total": 287550, "num_env_steps_sampled_lifetime": 287550, "num_agent_steps_sampled_lifetime": 287550, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 287550, "timers": {"training_iteration_time_ms": 10394.467, "restore_workers_time_ms": 0.014, "training_step_time_ms": 819.594, "sample_time_ms": 800.338, "synch_weights_time_ms": 17.222}, "counters": {"num_env_steps_sampled": 287550, "num_env_steps_trained": 287400, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1917, "num_samples_added_to_queue": 287400}, "done": false, "training_iteration": 134, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-22", "timestamp": 1728602542, "time_this_iter_s": 10.703603982925415, "time_total_s": 1392.1867020130157, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669876cb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1392.1867020130157, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 22.90666666666667, "ram_util_percent": 62.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1298.00048828125, "policy_loss": -786.1556396484375, "entropy": 4.3792724609375, "entropy_coeff": 0.01, "var_gnorm": 17.985095977783203, "vf_loss": 209729.40625, "vf_explained_var": 0.6324129104614258}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 964.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 289500, "num_env_steps_trained": 289200, "num_agent_steps_sampled": 289500, "num_agent_steps_trained": 289200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1930, "num_samples_added_to_queue": 289500, "learner_queue": {"size_count": 964, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.256, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 1519.883, "learner_dequeue_time_ms": 12680.967}}, "env_runners": {"episode_reward_max": 884.056666666667, "episode_reward_min": 878.7999999999987, "episode_reward_mean": 880.1025333333323, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.7999999999987}, "policy_reward_max": {"default_policy": 884.056666666667}, "policy_reward_mean": {"default_policy": 880.1025333333323}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.19219999999999998, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 38.05011999999997, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.458999999999975, "num_model_switches_mean": 0.1923, "num_model_switches_min": 0.0, "num_model_switches_max": 0.63, "num_slav_mean": 0.00019933333333333334, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.00045000000000000004, "mean_cluster_cpu_util_mean": 0.46719416551755844, "mean_cluster_cpu_util_min": 0.46342944475087333, "mean_cluster_cpu_util_max": 0.4754061063614635, "mean_cluster_mem_util_mean": 0.3159651424050633, "mean_cluster_mem_util_min": 0.31523523206751053, "mean_cluster_mem_util_max": 0.31802320675105483, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8050119999999983, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.845899999999998, "reward_sla_mean_mean": -0.003986666666666667, "reward_sla_mean_min": -0.009, "reward_sla_mean_max": -0.0006666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 380.50119999999987, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 384.5899999999998, "reward_sla_sum_mean": -0.39866666666666667, "reward_sla_sum_min": -0.8999999999999999, "reward_sla_sum_max": -0.06666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2297.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.056666666667, 883.7600000000004, 883.4500000000002, 882.6333333333331, 882.6399999999998, 881.8966666666661, 881.2099999999994, 881.4299999999997, 883.6133333333336, 883.1666666666666, 882.2966666666665, 882.2966666666664, 881.8, 881.4599999999996, 881.6299999999995, 883.9366666666668, 883.2033333333335, 882.8766666666669, 882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821348291036474, "mean_inference_ms": 2.468612288911925, "mean_action_processing_ms": 0.10383244376496714, "mean_env_wait_ms": 1.7952629288240862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007378816604614258, "StateBufferConnector_ms": 0.0044403076171875, "ViewRequirementAgentConnector_ms": 0.11359977722167969}, "num_episodes": 21, "episode_return_max": 884.056666666667, "episode_return_min": 878.7999999999987, "episode_return_mean": 880.1025333333323, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289500, "num_agent_steps_trained": 289200, "num_env_steps_sampled": 289500, "num_env_steps_trained": 289200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 189.0992418498407, "num_env_steps_trained_throughput_per_sec": 174.55314632292988, "timesteps_total": 289500, "num_env_steps_sampled_lifetime": 289500, "num_agent_steps_sampled_lifetime": 289500, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 289500, "timers": {"training_iteration_time_ms": 10350.441, "restore_workers_time_ms": 0.016, "training_step_time_ms": 792.484, "sample_time_ms": 773.205, "synch_weights_time_ms": 17.532}, "counters": {"num_env_steps_sampled": 289500, "num_env_steps_trained": 289200, "num_agent_steps_sampled": 289500, "num_agent_steps_trained": 289200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1930, "num_samples_added_to_queue": 289500}, "done": false, "training_iteration": 135, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-33", "timestamp": 1728602553, "time_this_iter_s": 10.326911449432373, "time_total_s": 1402.5136134624481, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aefa1d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1402.5136134624481, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.180000000000003, "ram_util_percent": 62.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2431.587890625, "policy_loss": 350.72210693359375, "entropy": 4.38299560546875, "entropy_coeff": 0.01, "var_gnorm": 18.030881881713867, "vf_loss": 209401.46875, "vf_explained_var": 0.6327277421951294}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 971.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 291450, "num_env_steps_trained": 291300, "num_agent_steps_sampled": 291450, "num_agent_steps_trained": 291300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1943, "num_samples_added_to_queue": 291300, "learner_queue": {"size_count": 971, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.635, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1544.91, "learner_dequeue_time_ms": 12730.405}}, "env_runners": {"episode_reward_max": 882.3766666666663, "episode_reward_min": 878.7999999999987, "episode_reward_mean": 879.4572999999987, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.7999999999987}, "policy_reward_max": {"default_policy": 882.3766666666663}, "policy_reward_mean": {"default_policy": 879.4572999999987}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11330000000000001, "num_moves_min": 0.0, "num_moves_max": 0.61, "mean_accuracy_mean": 37.98152999999997, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.294333333333306, "num_model_switches_mean": 0.1152, "num_model_switches_min": 0.0, "num_model_switches_max": 0.58, "num_slav_mean": 0.00017900000000000001, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.00035000000000000005, "mean_cluster_cpu_util_mean": 0.4658033248299319, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.4727487359808789, "mean_cluster_mem_util_mean": 0.31561404008438826, "mean_cluster_mem_util_min": 0.31521255274261606, "mean_cluster_mem_util_max": 0.3172589662447257, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.7981529999999974, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.829433333333331, "reward_sla_mean_mean": -0.00358, "reward_sla_mean_min": -0.007000000000000001, "reward_sla_mean_max": -0.0006666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 379.81529999999987, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 382.9433333333331, "reward_sla_sum_mean": -0.358, "reward_sla_sum_min": -0.7000000000000001, "reward_sla_sum_max": -0.06666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1956.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [882.2899999999995, 882.3766666666663, 881.673333333333, 880.8566666666658, 880.3899999999991, 880.5499999999992, 880.4533333333324, 880.0133333333323, 879.8433333333325, 879.4766666666656, 879.4933333333322, 880.6666666666661, 880.6199999999991, 880.3533333333324, 880.1066666666657, 879.7899999999987, 879.5999999999989, 879.7899999999988, 880.7633333333324, 881.0199999999995, 880.3566666666658, 880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822768780592923, "mean_inference_ms": 2.4687371122108934, "mean_action_processing_ms": 0.10388539716036375, "mean_env_wait_ms": 1.7959305231328693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076100826263427734, "StateBufferConnector_ms": 0.00457763671875, "ViewRequirementAgentConnector_ms": 0.11772584915161133}, "num_episodes": 18, "episode_return_max": 882.3766666666663, "episode_return_min": 878.7999999999987, "episode_return_mean": 879.4572999999987, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291450, "num_agent_steps_trained": 291300, "num_env_steps_sampled": 291450, "num_env_steps_trained": 291300, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 182.75755606483838, "num_env_steps_trained_throughput_per_sec": 196.8158296082875, "timesteps_total": 291450, "num_env_steps_sampled_lifetime": 291450, "num_agent_steps_sampled_lifetime": 291450, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 291450, "timers": {"training_iteration_time_ms": 10358.164, "restore_workers_time_ms": 0.016, "training_step_time_ms": 805.414, "sample_time_ms": 785.635, "synch_weights_time_ms": 17.868}, "counters": {"num_env_steps_sampled": 291450, "num_env_steps_trained": 291300, "num_agent_steps_sampled": 291450, "num_agent_steps_trained": 291300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1943, "num_samples_added_to_queue": 291300}, "done": false, "training_iteration": 136, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-43", "timestamp": 1728602563, "time_this_iter_s": 10.68019151687622, "time_total_s": 1413.1938049793243, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698748e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1413.1938049793243, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.58, "ram_util_percent": 62.36666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2005.7210693359375, "policy_loss": -10.445106506347656, "entropy": 4.498105525970459, "entropy_coeff": 0.01, "var_gnorm": 18.06106185913086, "vf_loss": 202966.0625, "vf_explained_var": 0.6380182504653931}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 977.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 293400, "num_env_steps_trained": 293100, "num_agent_steps_sampled": 293400, "num_agent_steps_trained": 293100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1956, "num_samples_added_to_queue": 293400, "learner_queue": {"size_count": 977, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.312, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1562.33, "learner_dequeue_time_ms": 12713.123}}, "env_runners": {"episode_reward_max": 880.2066666666658, "episode_reward_min": 878.7999999999987, "episode_reward_mean": 879.1644999999986, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.7999999999987}, "policy_reward_max": {"default_policy": 880.2066666666658}, "policy_reward_mean": {"default_policy": 879.1644999999986}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.04680000000000001, "num_moves_min": 0.0, "num_moves_max": 0.28, "mean_accuracy_mean": 37.950116666666624, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.0473333333333, "num_model_switches_mean": 0.0496, "num_model_switches_min": 0.0, "num_model_switches_max": 0.28, "num_slav_mean": 0.00016833333333333332, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.00034999999999999994, "mean_cluster_cpu_util_mean": 0.4651343171998528, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.46881524636881794, "mean_cluster_mem_util_mean": 0.31544731540084386, "mean_cluster_mem_util_min": 0.31521255274261606, "mean_cluster_mem_util_max": 0.3159045358649789, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.7950116666666633, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.8047333333333313, "reward_sla_mean_mean": -0.0033666666666666667, "reward_sla_mean_min": -0.007000000000000001, "reward_sla_mean_max": -0.0006666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 379.5011666666664, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 380.47333333333313, "reward_sla_sum_mean": -0.33666666666666667, "reward_sla_sum_min": -0.7000000000000001, "reward_sla_sum_max": -0.06666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2578.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [880.2066666666658, 879.9833333333324, 879.5066666666654, 879.6733333333323, 879.5099999999987, 879.4466666666655, 879.6266666666655, 879.6699999999989, 879.3399999999988, 879.3499999999988, 879.2799999999987, 879.739999999999, 879.4433333333322, 879.213333333332, 879.5399999999988, 879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28253103885799796, "mean_inference_ms": 2.4713075783471483, "mean_action_processing_ms": 0.10398364769552874, "mean_env_wait_ms": 1.7974646720924963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007658481597900391, "StateBufferConnector_ms": 0.004613161087036133, "ViewRequirementAgentConnector_ms": 0.11853790283203125}, "num_episodes": 21, "episode_return_max": 880.2066666666658, "episode_return_min": 878.7999999999987, "episode_return_mean": 879.1644999999986, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293400, "num_agent_steps_trained": 293100, "num_env_steps_sampled": 293400, "num_env_steps_trained": 293100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 182.1489222250209, "num_env_steps_trained_throughput_per_sec": 168.13746666925005, "timesteps_total": 293400, "num_env_steps_sampled_lifetime": 293400, "num_agent_steps_sampled_lifetime": 293400, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 293400, "timers": {"training_iteration_time_ms": 10419.194, "restore_workers_time_ms": 0.015, "training_step_time_ms": 825.646, "sample_time_ms": 806.442, "synch_weights_time_ms": 17.369}, "counters": {"num_env_steps_sampled": 293400, "num_env_steps_trained": 293100, "num_agent_steps_sampled": 293400, "num_agent_steps_trained": 293100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1956, "num_samples_added_to_queue": 293400}, "done": false, "training_iteration": 137, "trial_id": "3f041_00000", "date": "2024-10-11_00-22-54", "timestamp": 1728602574, "time_this_iter_s": 10.71851372718811, "time_total_s": 1423.9123187065125, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b171f00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1423.9123187065125, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 21.1, "ram_util_percent": 61.74666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 184.283447265625, "policy_loss": -1636.862060546875, "entropy": 4.954102516174316, "entropy_coeff": 0.01, "var_gnorm": 18.0716495513916, "vf_loss": 183600.78125, "vf_explained_var": 0.6536071300506592}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 982.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 294900, "num_env_steps_trained": 294600, "num_agent_steps_sampled": 294900, "num_agent_steps_trained": 294600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1966, "num_samples_added_to_queue": 294900, "learner_queue": {"size_count": 982, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.596, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1763.738, "learner_dequeue_time_ms": 12713.123}}, "env_runners": {"episode_reward_max": 881.9166666666667, "episode_reward_min": 878.7999999999987, "episode_reward_mean": 879.2839333333322, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.7999999999987}, "policy_reward_max": {"default_policy": 881.9166666666667}, "policy_reward_mean": {"default_policy": 879.2839333333322}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0699, "num_moves_min": 0.0, "num_moves_max": 0.46, "mean_accuracy_mean": 37.963226666666635, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.218333333333305, "num_model_switches_mean": 0.07490000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.46, "num_slav_mean": 0.00017416666666666663, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.00035000000000000005, "mean_cluster_cpu_util_mean": 0.4654128060075382, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.4719548974995403, "mean_cluster_mem_util_mean": 0.31552123945147675, "mean_cluster_mem_util_min": 0.31521255274261606, "mean_cluster_mem_util_max": 0.3169535864978903, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.796322666666663, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.821833333333331, "reward_sla_mean_mean": -0.003483333333333334, "reward_sla_mean_min": -0.007000000000000001, "reward_sla_mean_max": -0.0006666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 379.63226666666645, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 382.1833333333331, "reward_sla_sum_mean": -0.3483333333333334, "reward_sla_sum_min": -0.7000000000000001, "reward_sla_sum_max": -0.06666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3073.0, "global_timestep_min": 1100, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [879.2566666666654, 879.5899999999989, 879.5966666666657, 879.1399999999987, 879.253333333332, 878.9999999999986, 879.193333333332, 878.7999999999987, 879.2599999999985, 879.1266666666654, 878.8999999999986, 878.8299999999988, 879.2566666666653, 879.2899999999988, 879.093333333332, 879.3499999999988, 879.1599999999987, 879.0299999999986, 879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2826892251368796, "mean_inference_ms": 2.4716991859189226, "mean_action_processing_ms": 0.10404408110000209, "mean_env_wait_ms": 1.7982829737043533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007889509201049805, "StateBufferConnector_ms": 0.004736661911010742, "ViewRequirementAgentConnector_ms": 0.12149405479431152}, "num_episodes": 15, "episode_return_max": 881.9166666666667, "episode_return_min": 878.7999999999987, "episode_return_mean": 879.2839333333322, "episodes_this_iter": 15}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294900, "num_agent_steps_trained": 294600, "num_env_steps_sampled": 294900, "num_env_steps_trained": 294600, "num_env_steps_sampled_this_iter": 1500, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 147.88691474075804, "num_env_steps_trained_throughput_per_sec": 147.88691474075804, "timesteps_total": 294900, "num_env_steps_sampled_lifetime": 294900, "num_agent_steps_sampled_lifetime": 294900, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 294900, "timers": {"training_iteration_time_ms": 10380.207, "restore_workers_time_ms": 0.024, "training_step_time_ms": 1014.241, "sample_time_ms": 991.301, "synch_weights_time_ms": 21.178}, "counters": {"num_env_steps_sampled": 294900, "num_env_steps_trained": 294600, "num_agent_steps_sampled": 294900, "num_agent_steps_trained": 294600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1966, "num_samples_added_to_queue": 294900}, "done": false, "training_iteration": 138, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-04", "timestamp": 1728602584, "time_this_iter_s": 10.159239768981934, "time_total_s": 1434.0715584754944, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698767a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1434.0715584754944, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 33.74666666666666, "ram_util_percent": 63.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1831.35107421875, "policy_loss": -213.6035614013672, "entropy": 4.916807651519775, "entropy_coeff": 0.01, "var_gnorm": 18.06979751586914, "vf_loss": 205970.515625, "vf_explained_var": 0.6374611854553223}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 988.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 296700, "num_env_steps_trained": 296400, "num_agent_steps_sampled": 296700, "num_agent_steps_trained": 296400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1978, "num_samples_added_to_queue": 296700, "learner_queue": {"size_count": 988, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.932, "learner_load_time_ms": 0.333, "learner_load_wait_time_ms": 1775.819, "learner_dequeue_time_ms": 13068.209}}, "env_runners": {"episode_reward_max": 883.6800000000003, "episode_reward_min": 878.8666666666654, "episode_reward_mean": 879.9149333333323, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.8666666666654}, "policy_reward_max": {"default_policy": 883.6800000000003}, "policy_reward_mean": {"default_policy": 879.9149333333323}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1408, "num_moves_min": 0.0, "num_moves_max": 0.54, "mean_accuracy_mean": 38.0290933333333, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.414666666666655, "num_model_switches_mean": 0.145, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.00018800000000000004, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0003833333333333333, "mean_cluster_cpu_util_mean": 0.466774391202427, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.47505609946681376, "mean_cluster_mem_util_mean": 0.3158611761603376, "mean_cluster_mem_util_min": 0.31521255274261606, "mean_cluster_mem_util_max": 0.3179087552742616, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.802909333333331, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.841466666666664, "reward_sla_mean_mean": -0.00376, "reward_sla_mean_min": -0.007666666666666667, "reward_sla_mean_max": -0.0006666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 380.2909333333331, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 384.1466666666664, "reward_sla_sum_mean": -0.376, "reward_sla_sum_min": -0.7666666666666667, "reward_sla_sum_max": -0.06666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3673.0, "global_timestep_min": 1700, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [879.1266666666653, 879.0266666666653, 879.0566666666653, 878.963333333332, 879.1299999999987, 878.9933333333321, 879.0966666666654, 879.1633333333322, 879.033333333332, 879.0333333333319, 878.8666666666655, 878.8966666666653, 879.263333333332, 879.3299999999986, 879.1666666666654, 879.0666666666652, 878.993333333332, 879.1633333333319, 878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2829543654509501, "mean_inference_ms": 2.4745094039091544, "mean_action_processing_ms": 0.10415105242316901, "mean_env_wait_ms": 1.7999676500802548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008035659790039062, "StateBufferConnector_ms": 0.0047948360443115234, "ViewRequirementAgentConnector_ms": 0.12299990653991699}, "num_episodes": 18, "episode_return_max": 883.6800000000003, "episode_return_min": 878.8666666666654, "episode_return_mean": 879.9149333333323, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296700, "num_agent_steps_trained": 296400, "num_env_steps_sampled": 296700, "num_env_steps_trained": 296400, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.41331279171996, "num_env_steps_trained_throughput_per_sec": 178.41331279171996, "timesteps_total": 296700, "num_env_steps_sampled_lifetime": 296700, "num_agent_steps_sampled_lifetime": 296700, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 296700, "timers": {"training_iteration_time_ms": 10361.039, "restore_workers_time_ms": 0.021, "training_step_time_ms": 807.676, "sample_time_ms": 789.325, "synch_weights_time_ms": 16.621}, "counters": {"num_env_steps_sampled": 296700, "num_env_steps_trained": 296400, "num_agent_steps_sampled": 296700, "num_agent_steps_trained": 296400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1978, "num_samples_added_to_queue": 296700}, "done": false, "training_iteration": 139, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-15", "timestamp": 1728602595, "time_this_iter_s": 10.099583625793457, "time_total_s": 1444.1711421012878, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b173460>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1444.1711421012878, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 25.371428571428574, "ram_util_percent": 64.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1326.81201171875, "policy_loss": -554.1678466796875, "entropy": 4.784115791320801, "entropy_coeff": 0.01, "var_gnorm": 18.06249237060547, "vf_loss": 189533.21875, "vf_explained_var": 0.6477275490760803}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 995.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1991, "num_samples_added_to_queue": 298500, "learner_queue": {"size_count": 995, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.137, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 1487.324, "learner_dequeue_time_ms": 13060.64}}, "env_runners": {"episode_reward_max": 884.0400000000005, "episode_reward_min": 878.8666666666654, "episode_reward_mean": 880.6303333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.8666666666654}, "policy_reward_max": {"default_policy": 884.0400000000005}, "policy_reward_mean": {"default_policy": 880.6303333333327}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2159, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 38.105599999999974, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.42733333333331, "num_model_switches_mean": 0.2191, "num_model_switches_min": 0.0, "num_model_switches_max": 0.6, "num_slav_mean": 0.00021283333333333335, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0004666666666666666, "mean_cluster_cpu_util_mean": 0.46826708563155, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.4753425147085862, "mean_cluster_mem_util_mean": 0.316244694092827, "mean_cluster_mem_util_min": 0.31521255274261606, "mean_cluster_mem_util_max": 0.317912447257384, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.810559999999997, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.8427333333333307, "reward_sla_mean_mean": -0.004256666666666667, "reward_sla_mean_min": -0.009333333333333334, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 381.0559999999997, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 384.2733333333331, "reward_sla_sum_mean": -0.42566666666666664, "reward_sla_sum_min": -0.9333333333333333, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4271.0, "global_timestep_min": 2300, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [878.8999999999986, 878.9999999999987, 879.0666666666652, 879.063333333332, 879.1266666666653, 879.0333333333319, 879.0966666666653, 879.0333333333319, 879.0666666666654, 878.9999999999987, 879.1633333333319, 879.0299999999987, 879.0999999999988, 879.0666666666652, 879.0633333333319, 879.0299999999988, 879.0999999999987, 878.9999999999987, 878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28314921884744954, "mean_inference_ms": 2.4751724741854924, "mean_action_processing_ms": 0.10422836803555818, "mean_env_wait_ms": 1.8010816386177446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007845878601074219, "StateBufferConnector_ms": 0.004670858383178711, "ViewRequirementAgentConnector_ms": 0.11993813514709473}, "num_episodes": 18, "episode_return_max": 884.0400000000005, "episode_return_min": 878.8666666666654, "episode_return_mean": 880.6303333333327, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 191.45742702565033, "num_env_steps_trained_throughput_per_sec": 206.18492141223882, "timesteps_total": 298650, "num_env_steps_sampled_lifetime": 298650, "num_agent_steps_sampled_lifetime": 298650, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 298650, "timers": {"training_iteration_time_ms": 10368.234, "restore_workers_time_ms": 0.014, "training_step_time_ms": 798.179, "sample_time_ms": 778.71, "synch_weights_time_ms": 17.645}, "counters": {"num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1991, "num_samples_added_to_queue": 298500}, "done": false, "training_iteration": 140, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-25", "timestamp": 1728602605, "time_this_iter_s": 10.206381797790527, "time_total_s": 1454.3775238990784, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aee2110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1454.3775238990784, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 20.980000000000004, "ram_util_percent": 64.05999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2501.37890625, "policy_loss": 404.76776123046875, "entropy": 4.659774303436279, "entropy_coeff": 0.01, "var_gnorm": 18.056428909301758, "vf_loss": 211059.046875, "vf_explained_var": 0.6338483095169067}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 300300, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300300, "num_agent_steps_trained": 300000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2002, "num_samples_added_to_queue": 300300, "learner_queue": {"size_count": 1000, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.007, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1709.522, "learner_dequeue_time_ms": 13316.46}}, "env_runners": {"episode_reward_max": 884.7933333333341, "episode_reward_min": 878.8666666666654, "episode_reward_mean": 881.541433333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.8666666666654}, "policy_reward_max": {"default_policy": 884.7933333333341}, "policy_reward_mean": {"default_policy": 881.541433333333}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.25730000000000003, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 38.20357666666664, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.52866666666665, "num_model_switches_mean": 0.2599000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.6, "num_slav_mean": 0.0002471666666666667, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0004833333333333334, "mean_cluster_cpu_util_mean": 0.4702353415149843, "mean_cluster_cpu_util_min": 0.4629056122448981, "mean_cluster_cpu_util_max": 0.4773883181651039, "mean_cluster_mem_util_mean": 0.3167334493670886, "mean_cluster_mem_util_min": 0.3152304852320675, "mean_cluster_mem_util_max": 0.3183633966244726, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8203576666666645, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.8528666666666647, "reward_sla_mean_mean": -0.004943333333333333, "reward_sla_mean_min": -0.009666666666666667, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 382.0357666666664, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 385.28666666666646, "reward_sla_sum_mean": -0.49433333333333335, "reward_sla_sum_min": -0.9666666666666667, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4874.0, "global_timestep_min": 3000, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [878.9999999999986, 879.1899999999988, 878.8666666666654, 879.1599999999986, 879.0666666666652, 878.9999999999987, 878.9666666666654, 879.0333333333318, 879.0299999999986, 878.9666666666653, 878.8999999999985, 878.9599999999989, 879.1266666666653, 878.9899999999986, 879.0333333333319, 879.1299999999986, 879.2566666666655, 879.1599999999987, 878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28344805470871837, "mean_inference_ms": 2.478295152248571, "mean_action_processing_ms": 0.10434149131569317, "mean_env_wait_ms": 1.8029912971858257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008087635040283203, "StateBufferConnector_ms": 0.004784822463989258, "ViewRequirementAgentConnector_ms": 0.122894287109375}, "num_episodes": 18, "episode_return_max": 884.7933333333341, "episode_return_min": 878.8666666666654, "episode_return_mean": 881.541433333333, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300300, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300300, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 156.274568342017, "num_env_steps_trained_throughput_per_sec": 142.06778940183364, "timesteps_total": 300300, "num_env_steps_sampled_lifetime": 300300, "num_agent_steps_sampled_lifetime": 300300, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 300300, "timers": {"training_iteration_time_ms": 10394.624, "restore_workers_time_ms": 0.015, "training_step_time_ms": 974.772, "sample_time_ms": 953.793, "synch_weights_time_ms": 19.06}, "counters": {"num_env_steps_sampled": 300300, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300300, "num_agent_steps_trained": 300000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2002, "num_samples_added_to_queue": 300300}, "done": false, "training_iteration": 141, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-35", "timestamp": 1728602615, "time_this_iter_s": 10.569792747497559, "time_total_s": 1464.947316646576, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877400>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1464.947316646576, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 29.43333333333333, "ram_util_percent": 63.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1876.585205078125, "policy_loss": -44.053749084472656, "entropy": 4.833168029785156, "entropy_coeff": 0.01, "var_gnorm": 18.04715347290039, "vf_loss": 193513.84375, "vf_explained_var": 0.6448012590408325}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1007.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 302250, "num_env_steps_trained": 302100, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 302100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2015, "num_samples_added_to_queue": 302100, "learner_queue": {"size_count": 1007, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.842, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1695.078, "learner_dequeue_time_ms": 13316.46}}, "env_runners": {"episode_reward_max": 884.7933333333341, "episode_reward_min": 878.8966666666654, "episode_reward_mean": 882.4297666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 878.8966666666654}, "policy_reward_max": {"default_policy": 884.7933333333341}, "policy_reward_mean": {"default_policy": 882.4297666666665}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.30060000000000003, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 38.29794333333331, "mean_accuracy_min": 37.9333333333333, "mean_accuracy_max": 38.52866666666665, "num_model_switches_mean": 0.3024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.6, "num_slav_mean": 0.00027483333333333336, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.4721182301434087, "mean_cluster_cpu_util_min": 0.46407909312373596, "mean_cluster_cpu_util_max": 0.4773883181651039, "mean_cluster_mem_util_mean": 0.31720329113924045, "mean_cluster_mem_util_min": 0.31528691983122364, "mean_cluster_mem_util_max": 0.3183876582278481, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8297943333333313, "reward_accuracy_mean_min": 3.793333333333331, "reward_accuracy_mean_max": 3.8528666666666647, "reward_sla_mean_mean": -0.005496666666666667, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 382.9794333333331, "reward_accuracy_sum_min": 379.3333333333331, "reward_accuracy_sum_max": 385.28666666666646, "reward_sla_sum_mean": -0.5496666666666666, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5469.0, "global_timestep_min": 3600, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [878.8966666666654, 879.093333333332, 878.9333333333319, 879.0966666666653, 879.2866666666655, 879.2533333333321, 879.0999999999985, 879.0966666666653, 879.2266666666653, 879.2566666666653, 879.0599999999987, 879.2266666666653, 879.1199999999988, 879.4133333333322, 880.0166666666659, 880.1299999999992, 881.0199999999995, 881.2299999999993, 879.759999999999, 879.6666666666655, 880.4233333333325, 880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2836914186117466, "mean_inference_ms": 2.4795415489253814, "mean_action_processing_ms": 0.10443020185684695, "mean_env_wait_ms": 1.8043722076112738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008501768112182617, "StateBufferConnector_ms": 0.004754781723022461, "ViewRequirementAgentConnector_ms": 0.12125182151794434}, "num_episodes": 18, "episode_return_max": 884.7933333333341, "episode_return_min": 878.8966666666654, "episode_return_mean": 882.4297666666665, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 302100, "num_env_steps_sampled": 302250, "num_env_steps_trained": 302100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 183.36775493944816, "num_env_steps_trained_throughput_per_sec": 197.47296685786725, "timesteps_total": 302250, "num_env_steps_sampled_lifetime": 302250, "num_agent_steps_sampled_lifetime": 302250, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 302250, "timers": {"training_iteration_time_ms": 10415.56, "restore_workers_time_ms": 0.018, "training_step_time_ms": 826.372, "sample_time_ms": 806.581, "synch_weights_time_ms": 17.913}, "counters": {"num_env_steps_sampled": 302250, "num_env_steps_trained": 302100, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 302100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2015, "num_samples_added_to_queue": 302100}, "done": false, "training_iteration": 142, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-46", "timestamp": 1728602626, "time_this_iter_s": 10.659764766693115, "time_total_s": 1475.607081413269, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b1714b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1475.607081413269, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 22.21333333333333, "ram_util_percent": 62.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1752.7318115234375, "policy_loss": -223.40513610839844, "entropy": 4.953186511993408, "entropy_coeff": 0.01, "var_gnorm": 18.038652420043945, "vf_loss": 199099.65625, "vf_explained_var": 0.6402425765991211}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 304200, "num_env_steps_trained": 303900, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2028, "num_samples_added_to_queue": 304200, "learner_queue": {"size_count": 1013, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.875, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1573.229, "learner_dequeue_time_ms": 13385.981}}, "env_runners": {"episode_reward_max": 884.7933333333341, "episode_reward_min": 879.4166666666654, "episode_reward_mean": 883.1051333333334, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 879.4166666666654}, "policy_reward_max": {"default_policy": 884.7933333333341}, "policy_reward_mean": {"default_policy": 883.1051333333334}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.37200000000000005, "num_moves_min": 0.06, "num_moves_max": 0.62, "mean_accuracy_mean": 38.36881333333331, "mean_accuracy_min": 37.96499999999996, "mean_accuracy_max": 38.52866666666665, "num_model_switches_mean": 0.3714, "num_model_switches_min": 0.08, "num_model_switches_max": 0.6, "num_slav_mean": 0.00029150000000000004, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.47355176238738733, "mean_cluster_cpu_util_min": 0.4655882055524912, "mean_cluster_cpu_util_max": 0.4773883181651039, "mean_cluster_mem_util_mean": 0.3175640611814346, "mean_cluster_mem_util_min": 0.31553006329113925, "mean_cluster_mem_util_max": 0.3183876582278481, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8368813333333316, "reward_accuracy_mean_min": 3.7964999999999973, "reward_accuracy_mean_max": 3.8528666666666647, "reward_sla_mean_mean": -0.005829999999999999, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 383.68813333333316, "reward_accuracy_sum_min": 379.64999999999975, "reward_accuracy_sum_max": 385.28666666666646, "reward_sla_sum_mean": -0.583, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6177.0, "global_timestep_min": 4300, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [880.7099999999994, 881.5366666666662, 879.4166666666654, 879.4999999999989, 880.286666666666, 880.4466666666658, 881.9166666666667, 882.3533333333334, 882.6700000000001, 882.5566666666667, 882.5733333333334, 882.6633333333332, 882.5766666666666, 881.3266666666663, 882.6266666666667, 882.6600000000002, 883.5233333333335, 883.6800000000003, 882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2841030033907374, "mean_inference_ms": 2.486721951789883, "mean_action_processing_ms": 0.1045972026262114, "mean_env_wait_ms": 1.8073324752103763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008568048477172852, "StateBufferConnector_ms": 0.004668712615966797, "ViewRequirementAgentConnector_ms": 0.11962676048278809}, "num_episodes": 21, "episode_return_max": 884.7933333333341, "episode_return_min": 879.4166666666654, "episode_return_mean": 883.1051333333334, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303900, "num_env_steps_sampled": 304200, "num_env_steps_trained": 303900, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 184.22861640626098, "num_env_steps_trained_throughput_per_sec": 170.05718437501014, "timesteps_total": 304200, "num_env_steps_sampled_lifetime": 304200, "num_agent_steps_sampled_lifetime": 304200, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 304200, "timers": {"training_iteration_time_ms": 10457.439, "restore_workers_time_ms": 0.015, "training_step_time_ms": 793.114, "sample_time_ms": 773.439, "synch_weights_time_ms": 17.699}, "counters": {"num_env_steps_sampled": 304200, "num_env_steps_trained": 303900, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2028, "num_samples_added_to_queue": 304200}, "done": false, "training_iteration": 143, "trial_id": "3f041_00000", "date": "2024-10-11_00-23-57", "timestamp": 1728602637, "time_this_iter_s": 10.59659194946289, "time_total_s": 1486.203673362732, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66aeface0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1486.203673362732, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 21.1875, "ram_util_percent": 63.087500000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1176.5211181640625, "policy_loss": -735.26123046875, "entropy": 4.7982096672058105, "entropy_coeff": 0.01, "var_gnorm": 18.031307220458984, "vf_loss": 192617.703125, "vf_explained_var": 0.647330641746521}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1019.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 305700, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 305700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2040, "num_samples_added_to_queue": 306000, "learner_queue": {"size_count": 1019, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.54, "learner_load_time_ms": 0.358, "learner_load_wait_time_ms": 1597.793, "learner_dequeue_time_ms": 13490.965}}, "env_runners": {"episode_reward_max": 884.7933333333341, "episode_reward_min": 881.773333333333, "episode_reward_mean": 883.3575666666671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.773333333333}, "policy_reward_max": {"default_policy": 884.7933333333341}, "policy_reward_mean": {"default_policy": 883.3575666666671}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3758000000000001, "num_moves_min": 0.14, "num_moves_max": 0.67, "mean_accuracy_mean": 38.39522333333331, "mean_accuracy_min": 38.23733333333331, "mean_accuracy_max": 38.52866666666665, "num_model_switches_mean": 0.3735, "num_model_switches_min": 0.12, "num_model_switches_max": 0.66, "num_slav_mean": 0.0002973333333333333, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.4739747043344365, "mean_cluster_cpu_util_min": 0.46980237635594785, "mean_cluster_cpu_util_max": 0.4773883181651039, "mean_cluster_mem_util_mean": 0.31768648734177213, "mean_cluster_mem_util_min": 0.3169013713080168, "mean_cluster_mem_util_max": 0.3183876582278481, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8395223333333313, "reward_accuracy_mean_min": 3.823733333333331, "reward_accuracy_mean_max": 3.8528666666666647, "reward_sla_mean_mean": -0.005946666666666668, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0023333333333333335, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 383.95223333333314, "reward_accuracy_sum_min": 382.3733333333331, "reward_accuracy_sum_max": 385.28666666666646, "reward_sla_sum_mean": -0.5946666666666667, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.23333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5369.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [882.3499999999999, 881.993333333333, 882.556666666667, 882.6300000000001, 882.7933333333336, 883.6533333333335, 883.04, 882.7933333333333, 882.5333333333333, 883.1666666666667, 883.4833333333337, 883.1733333333333, 883.3866666666669, 882.1066666666663, 882.7900000000001, 882.8266666666667, 883.2333333333336, 884.0400000000005, 883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284334907611688, "mean_inference_ms": 2.489148444945053, "mean_action_processing_ms": 0.10468336414036156, "mean_env_wait_ms": 1.80874009177189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00834512710571289, "StateBufferConnector_ms": 0.0045642852783203125, "ViewRequirementAgentConnector_ms": 0.1168050765991211}, "num_episodes": 18, "episode_return_max": 884.7933333333341, "episode_return_min": 881.773333333333, "episode_return_mean": 883.3575666666671, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 305700, "num_env_steps_sampled": 306000, "num_env_steps_trained": 305700, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 176.06314978660083, "num_env_steps_trained_throughput_per_sec": 176.06314978660083, "timesteps_total": 306000, "num_env_steps_sampled_lifetime": 306000, "num_agent_steps_sampled_lifetime": 306000, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 10410.538, "restore_workers_time_ms": 0.014, "training_step_time_ms": 861.08, "sample_time_ms": 842.417, "synch_weights_time_ms": 16.961}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 305700, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 305700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2040, "num_samples_added_to_queue": 306000}, "done": false, "training_iteration": 144, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-07", "timestamp": 1728602647, "time_this_iter_s": 10.241315126419067, "time_total_s": 1496.444988489151, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669874fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1496.444988489151, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 23.50714285714286, "ram_util_percent": 62.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1603.252685546875, "policy_loss": -382.7999267578125, "entropy": 4.570143222808838, "entropy_coeff": 0.01, "var_gnorm": 18.016334533691406, "vf_loss": 199976.3125, "vf_explained_var": 0.6427229642868042}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1026.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 307950, "num_env_steps_trained": 307800, "num_agent_steps_sampled": 307950, "num_agent_steps_trained": 307800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2053, "num_samples_added_to_queue": 307800, "learner_queue": {"size_count": 1026, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.995, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1579.543, "learner_dequeue_time_ms": 13595.495}}, "env_runners": {"episode_reward_max": 884.7933333333341, "episode_reward_min": 881.773333333333, "episode_reward_mean": 883.6225333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.773333333333}, "policy_reward_max": {"default_policy": 884.7933333333341}, "policy_reward_mean": {"default_policy": 883.6225333333335}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3273, "num_moves_min": 0.08, "num_moves_max": 0.67, "mean_accuracy_mean": 38.42315333333331, "mean_accuracy_min": 38.23733333333331, "mean_accuracy_max": 38.54133333333331, "num_model_switches_mean": 0.3256, "num_model_switches_min": 0.08, "num_model_switches_max": 0.66, "num_slav_mean": 0.00030450000000000003, "num_slav_min": 0.0001333333333333333, "num_slav_max": 0.0005166666666666667, "mean_cluster_cpu_util_mean": 0.47446838998437224, "mean_cluster_cpu_util_min": 0.46995379435558, "mean_cluster_cpu_util_max": 0.4773883181651039, "mean_cluster_mem_util_mean": 0.31782678797468356, "mean_cluster_mem_util_min": 0.3169013713080168, "mean_cluster_mem_util_max": 0.31841191983122363, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8423153333333313, "reward_accuracy_mean_min": 3.823733333333331, "reward_accuracy_mean_max": 3.854133333333331, "reward_sla_mean_mean": -0.006090000000000001, "reward_sla_mean_min": -0.010333333333333335, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.2315333333331, "reward_accuracy_sum_min": 382.3733333333331, "reward_accuracy_sum_max": 385.4133333333331, "reward_sla_sum_mean": -0.609, "reward_sla_sum_min": -1.0333333333333334, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4565.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.2533333333337, 882.8566666666667, 882.5933333333335, 882.8400000000001, 883.4866666666669, 882.9600000000003, 883.3866666666669, 883.496666666667, 883.6433333333338, 884.4100000000005, 884.2400000000006, 884.1333333333339, 884.1833333333338, 883.666666666667, 884.1366666666671, 884.3366666666672, 884.3200000000007, 884.7933333333341, 884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2845932608725709, "mean_inference_ms": 2.4916392660066498, "mean_action_processing_ms": 0.10477292456944313, "mean_env_wait_ms": 1.810257880121444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008387327194213867, "StateBufferConnector_ms": 0.004591703414916992, "ViewRequirementAgentConnector_ms": 0.11781477928161621}, "num_episodes": 18, "episode_return_max": 884.7933333333341, "episode_return_min": 881.773333333333, "episode_return_mean": 883.6225333333335, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307950, "num_agent_steps_trained": 307800, "num_env_steps_sampled": 307950, "num_env_steps_trained": 307800, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 184.878344544287, "num_env_steps_trained_throughput_per_sec": 199.0997556630783, "timesteps_total": 307950, "num_env_steps_sampled_lifetime": 307950, "num_agent_steps_sampled_lifetime": 307950, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 307950, "timers": {"training_iteration_time_ms": 10434.082, "restore_workers_time_ms": 0.018, "training_step_time_ms": 797.699, "sample_time_ms": 777.472, "synch_weights_time_ms": 18.452}, "counters": {"num_env_steps_sampled": 307950, "num_env_steps_trained": 307800, "num_agent_steps_sampled": 307950, "num_agent_steps_trained": 307800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2053, "num_samples_added_to_queue": 307800}, "done": false, "training_iteration": 145, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-18", "timestamp": 1728602658, "time_this_iter_s": 10.561779022216797, "time_total_s": 1507.0067675113678, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee669877340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1507.0067675113678, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 21.353333333333335, "ram_util_percent": 62.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1253.7999267578125, "policy_loss": -859.1260986328125, "entropy": 4.399338245391846, "entropy_coeff": 0.01, "var_gnorm": 18.000003814697266, "vf_loss": 212612.40625, "vf_explained_var": 0.6332169771194458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1032.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 309750, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309750, "num_agent_steps_trained": 309600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2065, "num_samples_added_to_queue": 309600, "learner_queue": {"size_count": 1032, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.51, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1558.381, "learner_dequeue_time_ms": 13595.495}}, "env_runners": {"episode_reward_max": 885.1366666666675, "episode_reward_min": 881.773333333333, "episode_reward_mean": 883.8095333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.773333333333}, "policy_reward_max": {"default_policy": 885.1366666666675}, "policy_reward_mean": {"default_policy": 883.8095333333337}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2875, "num_moves_min": 0.0, "num_moves_max": 0.67, "mean_accuracy_mean": 38.440886666666636, "mean_accuracy_min": 38.23733333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.2858, "num_model_switches_min": 0.0, "num_model_switches_max": 0.66, "num_slav_mean": 0.0002996666666666667, "num_slav_min": 0.0001, "num_slav_max": 0.0006833333333333333, "mean_cluster_cpu_util_mean": 0.47481835390237187, "mean_cluster_cpu_util_min": 0.46995379435558, "mean_cluster_cpu_util_max": 0.47820947095054245, "mean_cluster_mem_util_mean": 0.3179244831223629, "mean_cluster_mem_util_min": 0.3169013713080168, "mean_cluster_mem_util_max": 0.31864715189873416, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8440886666666643, "reward_accuracy_mean_min": 3.823733333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.005993333333333335, "reward_sla_mean_min": -0.013666666666666667, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.40886666666637, "reward_accuracy_sum_min": 382.3733333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.5993333333333334, "reward_sla_sum_min": -1.3666666666666667, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3761.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.3633333333339, 883.4433333333336, 883.8866666666675, 884.0133333333341, 883.9166666666672, 884.3800000000005, 884.6866666666671, 884.1466666666671, 884.1200000000006, 884.1700000000005, 883.3033333333335, 883.7366666666669, 884.0700000000004, 884.5300000000008, 884.0733333333338, 883.7833333333335, 884.4700000000008, 883.5800000000003, 883.6966666666668, 884.0566666666671, 884.2400000000006, 883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2848222635783527, "mean_inference_ms": 2.4940369748587035, "mean_action_processing_ms": 0.10485816890602237, "mean_env_wait_ms": 1.8116861571915366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008236408233642578, "StateBufferConnector_ms": 0.004489898681640625, "ViewRequirementAgentConnector_ms": 0.11631035804748535}, "num_episodes": 18, "episode_return_max": 885.1366666666675, "episode_return_min": 881.773333333333, "episode_return_mean": 883.8095333333337, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309750, "num_agent_steps_trained": 309600, "num_env_steps_sampled": 309750, "num_env_steps_trained": 309600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.60024163851236, "num_env_steps_trained_throughput_per_sec": 177.60024163851236, "timesteps_total": 309750, "num_env_steps_sampled_lifetime": 309750, "num_agent_steps_sampled_lifetime": 309750, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 309750, "timers": {"training_iteration_time_ms": 10380.606, "restore_workers_time_ms": 0.015, "training_step_time_ms": 861.281, "sample_time_ms": 841.76, "synch_weights_time_ms": 17.66}, "counters": {"num_env_steps_sampled": 309750, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309750, "num_agent_steps_trained": 309600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2065, "num_samples_added_to_queue": 309600}, "done": false, "training_iteration": 146, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-28", "timestamp": 1728602668, "time_this_iter_s": 10.14664101600647, "time_total_s": 1517.1534085273743, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa9810>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1517.1534085273743, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 21.533333333333335, "ram_util_percent": 62.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2043.4136962890625, "policy_loss": -66.33975219726562, "entropy": 4.358544826507568, "entropy_coeff": 0.01, "var_gnorm": 18.00615882873535, "vf_loss": 212282.921875, "vf_explained_var": 0.6312702298164368}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1038.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 311700, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311700, "num_agent_steps_trained": 311400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2078, "num_samples_added_to_queue": 311700, "learner_queue": {"size_count": 1038, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.589, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 1595.413, "learner_dequeue_time_ms": 13543.429}}, "env_runners": {"episode_reward_max": 885.3333333333343, "episode_reward_min": 881.773333333333, "episode_reward_mean": 884.0163000000007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 881.773333333333}, "policy_reward_max": {"default_policy": 885.3333333333343}, "policy_reward_mean": {"default_policy": 884.0163000000007}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2346, "num_moves_min": 0.0, "num_moves_max": 0.67, "mean_accuracy_mean": 38.46096333333331, "mean_accuracy_min": 38.23733333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.23310000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.66, "num_slav_mean": 0.0002966666666666667, "num_slav_min": 0.0001, "num_slav_max": 0.0006833333333333333, "mean_cluster_cpu_util_mean": 0.47523355028497877, "mean_cluster_cpu_util_min": 0.46995379435558, "mean_cluster_cpu_util_max": 0.47852328093399515, "mean_cluster_mem_util_mean": 0.31803197257383964, "mean_cluster_mem_util_min": 0.3169013713080168, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8460963333333313, "reward_accuracy_mean_min": 3.823733333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.005933333333333334, "reward_sla_mean_min": -0.013666666666666667, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.60963333333297, "reward_accuracy_sum_min": 382.3733333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.5933333333333335, "reward_sla_sum_min": -1.3666666666666667, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2828.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [883.9900000000004, 884.0533333333335, 883.8100000000002, 883.8400000000003, 883.5100000000001, 883.436666666667, 882.8866666666668, 882.5733333333332, 882.2933333333333, 881.773333333333, 882.3833333333332, 883.5800000000003, 883.4866666666669, 883.3700000000003, 883.0733333333335, 882.5033333333332, 882.7333333333332, 882.063333333333, 882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28513801646196346, "mean_inference_ms": 2.4982353914114435, "mean_action_processing_ms": 0.10496775640060686, "mean_env_wait_ms": 1.813661941105898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007796525955200195, "StateBufferConnector_ms": 0.004420042037963867, "ViewRequirementAgentConnector_ms": 0.11398839950561523}, "num_episodes": 21, "episode_return_max": 885.3333333333343, "episode_return_min": 881.773333333333, "episode_return_mean": 884.0163000000007, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311700, "num_agent_steps_trained": 311400, "num_env_steps_sampled": 311700, "num_env_steps_trained": 311400, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 182.84139248053074, "num_env_steps_trained_throughput_per_sec": 168.77666998202838, "timesteps_total": 311700, "num_env_steps_sampled_lifetime": 311700, "num_agent_steps_sampled_lifetime": 311700, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 311700, "timers": {"training_iteration_time_ms": 10376.552, "restore_workers_time_ms": 0.017, "training_step_time_ms": 825.114, "sample_time_ms": 805.905, "synch_weights_time_ms": 17.464}, "counters": {"num_env_steps_sampled": 311700, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311700, "num_agent_steps_trained": 311400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2078, "num_samples_added_to_queue": 311700}, "done": false, "training_iteration": 147, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-39", "timestamp": 1728602679, "time_this_iter_s": 10.675413131713867, "time_total_s": 1527.8288216590881, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66b08d420>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1527.8288216590881, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.25333333333333, "ram_util_percent": 62.37999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2075.493896484375, "policy_loss": -62.21385955810547, "entropy": 4.352756977081299, "entropy_coeff": 0.01, "var_gnorm": 18.06720542907715, "vf_loss": 215076.625, "vf_explained_var": 0.6312510967254639}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1044.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 313500, "num_env_steps_trained": 313200, "num_agent_steps_sampled": 313500, "num_agent_steps_trained": 313200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2090, "num_samples_added_to_queue": 313500, "learner_queue": {"size_count": 1044, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.932, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 1615.254, "learner_dequeue_time_ms": 13540.803}}, "env_runners": {"episode_reward_max": 885.4000000000008, "episode_reward_min": 882.0033333333328, "episode_reward_mean": 884.3473666666672, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 882.0033333333328}, "policy_reward_max": {"default_policy": 885.4000000000008}, "policy_reward_mean": {"default_policy": 884.3473666666672}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1583, "num_moves_min": 0.0, "num_moves_max": 0.67, "mean_accuracy_mean": 38.498203333333315, "mean_accuracy_min": 38.243666666666634, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.1572, "num_model_switches_min": 0.0, "num_model_switches_max": 0.66, "num_slav_mean": 0.00031733333333333337, "num_slav_min": 0.0001, "num_slav_max": 0.0006999999999999998, "mean_cluster_cpu_util_mean": 0.4760459418091562, "mean_cluster_cpu_util_min": 0.47149956333884907, "mean_cluster_cpu_util_max": 0.4788465250965251, "mean_cluster_mem_util_mean": 0.3182291983122363, "mean_cluster_mem_util_min": 0.3170353375527426, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.849820333333331, "reward_accuracy_mean_min": 3.8243666666666645, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006346666666666667, "reward_sla_mean_min": -0.014000000000000002, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 384.98203333333294, "reward_accuracy_sum_min": 382.43666666666644, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6346666666666667, "reward_sla_sum_min": -1.4000000000000001, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2013.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [882.9633333333331, 883.0066666666668, 883.1433333333335, 882.6933333333333, 882.1566666666664, 882.2099999999998, 882.0033333333328, 882.323333333333, 882.9866666666668, 883.4966666666669, 883.7166666666669, 883.466666666667, 883.766666666667, 882.3433333333332, 882.7666666666665, 883.0566666666667, 883.2466666666669, 883.2000000000003, 884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2853077072178188, "mean_inference_ms": 2.4985384904726478, "mean_action_processing_ms": 0.10501920797071554, "mean_env_wait_ms": 1.814451914151785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007601261138916016, "StateBufferConnector_ms": 0.004559755325317383, "ViewRequirementAgentConnector_ms": 0.11505246162414551}, "num_episodes": 18, "episode_return_max": 885.4000000000008, "episode_return_min": 882.0033333333328, "episode_return_mean": 884.3473666666672, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313500, "num_agent_steps_trained": 313200, "num_env_steps_sampled": 313500, "num_env_steps_trained": 313200, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.03537237045288, "num_env_steps_trained_throughput_per_sec": 170.03537237045288, "timesteps_total": 313500, "num_env_steps_sampled_lifetime": 313500, "num_agent_steps_sampled_lifetime": 313500, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 313500, "timers": {"training_iteration_time_ms": 10420.866, "restore_workers_time_ms": 0.02, "training_step_time_ms": 907.578, "sample_time_ms": 885.668, "synch_weights_time_ms": 19.765}, "counters": {"num_env_steps_sampled": 313500, "num_env_steps_trained": 313200, "num_agent_steps_sampled": 313500, "num_agent_steps_trained": 313200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2090, "num_samples_added_to_queue": 313500}, "done": false, "training_iteration": 148, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-49", "timestamp": 1728602689, "time_this_iter_s": 10.598273515701294, "time_total_s": 1538.4270951747894, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa8d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1538.4270951747894, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 26.246666666666666, "ram_util_percent": 62.49333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2092.587890625, "policy_loss": -56.04079055786133, "entropy": 4.3516926765441895, "entropy_coeff": 0.01, "var_gnorm": 18.06487274169922, "vf_loss": 216168.390625, "vf_explained_var": 0.6309821605682373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1050.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 315300, "num_env_steps_trained": 315000, "num_agent_steps_sampled": 315300, "num_agent_steps_trained": 315000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2102, "num_samples_added_to_queue": 315300, "learner_queue": {"size_count": 1050, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.889, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 1676.787, "learner_dequeue_time_ms": 13675.495}}, "env_runners": {"episode_reward_max": 885.4000000000008, "episode_reward_min": 882.3966666666669, "episode_reward_mean": 884.7285666666671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 882.3966666666669}, "policy_reward_max": {"default_policy": 885.4000000000008}, "policy_reward_mean": {"default_policy": 884.7285666666671}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0771, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 38.53772333333332, "mean_accuracy_min": 38.31966666666664, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0764, "num_model_switches_min": 0.0, "num_model_switches_max": 0.59, "num_slav_mean": 0.0003243333333333334, "num_slav_min": 0.0001, "num_slav_max": 0.0006999999999999998, "mean_cluster_cpu_util_mean": 0.47686473984188277, "mean_cluster_cpu_util_min": 0.47149956333884907, "mean_cluster_cpu_util_max": 0.4788465250965251, "mean_cluster_mem_util_mean": 0.31842577004219413, "mean_cluster_mem_util_min": 0.3172473628691983, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8537723333333314, "reward_accuracy_mean_min": 3.8319666666666645, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.0064866666666666675, "reward_sla_mean_min": -0.014000000000000002, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.377233333333, "reward_accuracy_sum_min": 383.19666666666643, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6486666666666667, "reward_sla_sum_min": -1.4000000000000001, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2073.0, "global_timestep_min": 100, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.4766666666673, 882.3966666666669, 882.7233333333336, 882.8866666666667, 883.5800000000006, 883.7700000000004, 884.063333333334, 884.3100000000005, 884.3700000000007, 884.433333333334, 884.5933333333339, 884.5666666666674, 884.653333333334, 883.9966666666671, 884.4766666666671, 884.3700000000006, 884.4966666666672, 884.6200000000007, 884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855593292421473, "mean_inference_ms": 2.5007540572410933, "mean_action_processing_ms": 0.10509858029920455, "mean_env_wait_ms": 1.815888651714825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075838565826416016, "StateBufferConnector_ms": 0.004603147506713867, "ViewRequirementAgentConnector_ms": 0.1147310733795166}, "num_episodes": 18, "episode_return_max": 885.4000000000008, "episode_return_min": 882.3966666666669, "episode_return_mean": 884.7285666666671, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315300, "num_agent_steps_trained": 315000, "num_env_steps_sampled": 315300, "num_env_steps_trained": 315000, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.26282841746303, "num_env_steps_trained_throughput_per_sec": 178.26282841746303, "timesteps_total": 315300, "num_env_steps_sampled_lifetime": 315300, "num_agent_steps_sampled_lifetime": 315300, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 315300, "timers": {"training_iteration_time_ms": 10421.718, "restore_workers_time_ms": 0.013, "training_step_time_ms": 837.705, "sample_time_ms": 818.551, "synch_weights_time_ms": 17.393}, "counters": {"num_env_steps_sampled": 315300, "num_env_steps_trained": 315000, "num_agent_steps_sampled": 315300, "num_agent_steps_trained": 315000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2102, "num_samples_added_to_queue": 315300}, "done": false, "training_iteration": 149, "trial_id": "3f041_00000", "date": "2024-10-11_00-24-59", "timestamp": 1728602699, "time_this_iter_s": 10.11213207244873, "time_total_s": 1548.5392272472382, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa95a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1548.5392272472382, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 22.466666666666672, "ram_util_percent": 63.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2074.073486328125, "policy_loss": -45.35509490966797, "entropy": 4.350809097290039, "entropy_coeff": 0.01, "var_gnorm": 18.044597625732422, "vf_loss": 213248.09375, "vf_explained_var": 0.6318583488464355}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1056.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 317100, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 317100, "num_agent_steps_trained": 316800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2114, "num_samples_added_to_queue": 317100, "learner_queue": {"size_count": 1056, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.662, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 1600.643, "learner_dequeue_time_ms": 13701.897}}, "env_runners": {"episode_reward_max": 885.400000000001, "episode_reward_min": 883.8166666666672, "episode_reward_mean": 884.9027333333339, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 883.8166666666672}, "policy_reward_max": {"default_policy": 885.400000000001}, "policy_reward_mean": {"default_policy": 884.9027333333339}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.027999999999999997, "num_moves_min": 0.0, "num_moves_max": 0.23, "mean_accuracy_mean": 38.557039999999986, "mean_accuracy_min": 38.47166666666664, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0276, "num_model_switches_min": 0.0, "num_model_switches_max": 0.23, "num_slav_mean": 0.0003338333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.0006999999999999998, "mean_cluster_cpu_util_mean": 0.4772398738279096, "mean_cluster_cpu_util_min": 0.47349464515535944, "mean_cluster_cpu_util_max": 0.4788465250965251, "mean_cluster_mem_util_mean": 0.31851969409282693, "mean_cluster_mem_util_min": 0.31789556962025317, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8557039999999985, "reward_accuracy_mean_min": 3.847166666666664, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.0066766666666666676, "reward_sla_mean_min": -0.014000000000000002, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.57039999999967, "reward_accuracy_sum_min": 384.7166666666664, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6676666666666666, "reward_sla_sum_min": -1.4000000000000001, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2673.0, "global_timestep_min": 700, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.3966666666673, 883.8166666666672, 884.5600000000005, 883.9800000000002, 884.7566666666675, 884.5466666666673, 884.1033333333338, 884.4900000000005, 885.0866666666674, 884.3533333333339, 884.7466666666672, 884.9766666666675, 885.0100000000007, 884.2733333333338, 884.7166666666674, 884.9166666666673, 884.9500000000008, 884.9066666666673, 885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28579654621455336, "mean_inference_ms": 2.5030516454801983, "mean_action_processing_ms": 0.10517688878903407, "mean_env_wait_ms": 1.817270815652038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076444149017333984, "StateBufferConnector_ms": 0.0046346187591552734, "ViewRequirementAgentConnector_ms": 0.11491513252258301}, "num_episodes": 18, "episode_return_max": 885.400000000001, "episode_return_min": 883.8166666666672, "episode_return_mean": 884.9027333333339, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317100, "num_agent_steps_trained": 316800, "num_env_steps_sampled": 317100, "num_env_steps_trained": 316800, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.44919994526745, "num_env_steps_trained_throughput_per_sec": 178.44919994526745, "timesteps_total": 317100, "num_env_steps_sampled_lifetime": 317100, "num_agent_steps_sampled_lifetime": 317100, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 317100, "timers": {"training_iteration_time_ms": 10411.905, "restore_workers_time_ms": 0.015, "training_step_time_ms": 857.995, "sample_time_ms": 838.59, "synch_weights_time_ms": 17.408}, "counters": {"num_env_steps_sampled": 317100, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 317100, "num_agent_steps_trained": 316800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2114, "num_samples_added_to_queue": 317100}, "done": false, "training_iteration": 150, "trial_id": "3f041_00000", "date": "2024-10-11_00-25-10", "timestamp": 1728602710, "time_this_iter_s": 10.103855609893799, "time_total_s": 1558.643082857132, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae50b20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1558.643082857132, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 23.521428571428572, "ram_util_percent": 63.457142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.783626556396484, "cur_lr": 0.0001, "total_loss": 2098.688232421875, "policy_loss": -34.59529495239258, "entropy": 4.348748683929443, "entropy_coeff": 0.01, "var_gnorm": 18.058055877685547, "vf_loss": 214633.0, "vf_explained_var": 0.6312211751937866}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1062.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 318900, "num_env_steps_trained": 318600, "num_agent_steps_sampled": 318900, "num_agent_steps_trained": 318600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2126, "num_samples_added_to_queue": 318900, "learner_queue": {"size_count": 1062, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.473, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 1621.497, "learner_dequeue_time_ms": 13701.897}}, "env_runners": {"episode_reward_max": 885.400000000001, "episode_reward_min": 884.0466666666672, "episode_reward_mean": 884.9768666666674, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.0466666666672}, "policy_reward_max": {"default_policy": 885.400000000001}, "policy_reward_mean": {"default_policy": 884.9768666666674}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0052, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 38.56501999999998, "mean_accuracy_min": 38.522333333333314, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0052, "num_model_switches_min": 0.0, "num_model_switches_max": 0.14, "num_slav_mean": 0.0003366666666666667, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0006999999999999998, "mean_cluster_cpu_util_mean": 0.47743648487773493, "mean_cluster_cpu_util_min": 0.4753858016179444, "mean_cluster_cpu_util_max": 0.47902610774039345, "mean_cluster_mem_util_mean": 0.3185550421940928, "mean_cluster_mem_util_min": 0.3182811181434599, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856501999999998, "reward_accuracy_mean_min": 3.852233333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006733333333333333, "reward_sla_mean_min": -0.014000000000000002, "reward_sla_mean_max": -0.0026666666666666666, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.65019999999976, "reward_accuracy_sum_min": 385.22333333333313, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6733333333333333, "reward_sla_sum_min": -1.4000000000000001, "reward_sla_sum_max": -0.26666666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3273.0, "global_timestep_min": 1300, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.1366666666675, 884.5233333333338, 884.7533333333341, 884.813333333334, 884.0466666666672, 884.8000000000006, 884.9366666666674, 885.3333333333343, 885.1366666666676, 885.1333333333341, 884.8000000000006, 885.1333333333342, 885.2000000000007, 885.0000000000009, 885.2666666666674, 884.8666666666672, 884.8700000000007, 885.2000000000007, 884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860307662768367, "mean_inference_ms": 2.5053808465908016, "mean_action_processing_ms": 0.10525548658985744, "mean_env_wait_ms": 1.818661729728102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007701873779296875, "StateBufferConnector_ms": 0.004648447036743164, "ViewRequirementAgentConnector_ms": 0.1150369644165039}, "num_episodes": 18, "episode_return_max": 885.400000000001, "episode_return_min": 884.0466666666672, "episode_return_mean": 884.9768666666674, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318900, "num_agent_steps_trained": 318600, "num_env_steps_sampled": 318900, "num_env_steps_trained": 318600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 179.05681380712292, "num_env_steps_trained_throughput_per_sec": 179.05681380712292, "timesteps_total": 318900, "num_env_steps_sampled_lifetime": 318900, "num_agent_steps_sampled_lifetime": 318900, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 318900, "timers": {"training_iteration_time_ms": 10361.339, "restore_workers_time_ms": 0.014, "training_step_time_ms": 833.372, "sample_time_ms": 813.064, "synch_weights_time_ms": 18.218}, "counters": {"num_env_steps_sampled": 318900, "num_env_steps_trained": 318600, "num_agent_steps_sampled": 318900, "num_agent_steps_trained": 318600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2126, "num_samples_added_to_queue": 318900}, "done": false, "training_iteration": 151, "trial_id": "3f041_00000", "date": "2024-10-11_00-25-20", "timestamp": 1728602720, "time_this_iter_s": 10.069268465042114, "time_total_s": 1568.712351322174, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae53970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1568.712351322174, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 21.62666666666666, "ram_util_percent": 63.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.883875846862793, "cur_lr": 0.0001, "total_loss": 2106.87939453125, "policy_loss": -23.8209228515625, "entropy": 4.346362113952637, "entropy_coeff": 0.01, "var_gnorm": 18.058595657348633, "vf_loss": 214373.953125, "vf_explained_var": 0.6309784650802612}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1068.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 320700, "num_env_steps_trained": 320400, "num_agent_steps_sampled": 320700, "num_agent_steps_trained": 320400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2138, "num_samples_added_to_queue": 320700, "learner_queue": {"size_count": 1068, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.849, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 1651.721, "learner_dequeue_time_ms": 13485.905}}, "env_runners": {"episode_reward_max": 885.4033333333342, "episode_reward_min": 884.2666666666672, "episode_reward_mean": 884.9894000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.2666666666672}, "policy_reward_max": {"default_policy": 885.4033333333342}, "policy_reward_mean": {"default_policy": 884.9894000000006}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0004, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 38.56653999999999, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.00033800000000000003, "num_slav_min": 0.0001, "num_slav_max": 0.0006999999999999998, "mean_cluster_cpu_util_mean": 0.47738139582184225, "mean_cluster_cpu_util_min": 0.4753858016179444, "mean_cluster_cpu_util_max": 0.47902610774039345, "mean_cluster_mem_util_mean": 0.31855524261603374, "mean_cluster_mem_util_min": 0.31831856540084386, "mean_cluster_mem_util_max": 0.31877848101265827, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8566539999999985, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006760000000000001, "reward_sla_mean_min": -0.014000000000000002, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.66539999999964, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6759999999999999, "reward_sla_sum_min": -1.4000000000000001, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3871.0, "global_timestep_min": 1900, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.8000000000008, 884.533333333334, 885.0000000000008, 885.0000000000008, 885.2666666666674, 885.0000000000009, 884.5333333333339, 885.1366666666673, 885.0666666666674, 885.0666666666674, 885.2000000000007, 884.8666666666674, 884.2666666666672, 884.5333333333341, 884.8000000000009, 885.2000000000008, 885.0000000000007, 885.0000000000009, 885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28619786987390206, "mean_inference_ms": 2.5058125354978555, "mean_action_processing_ms": 0.10531258076319064, "mean_env_wait_ms": 1.8195808718117257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077304840087890625, "StateBufferConnector_ms": 0.004682064056396484, "ViewRequirementAgentConnector_ms": 0.11645913124084473}, "num_episodes": 18, "episode_return_max": 885.4033333333342, "episode_return_min": 884.2666666666672, "episode_return_mean": 884.9894000000006, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320700, "num_agent_steps_trained": 320400, "num_env_steps_sampled": 320700, "num_env_steps_trained": 320400, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.39262719405505, "num_env_steps_trained_throughput_per_sec": 172.39262719405505, "timesteps_total": 320700, "num_env_steps_sampled_lifetime": 320700, "num_agent_steps_sampled_lifetime": 320700, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 320700, "timers": {"training_iteration_time_ms": 10342.032, "restore_workers_time_ms": 0.019, "training_step_time_ms": 870.511, "sample_time_ms": 848.145, "synch_weights_time_ms": 20.092}, "counters": {"num_env_steps_sampled": 320700, "num_env_steps_trained": 320400, "num_agent_steps_sampled": 320700, "num_agent_steps_trained": 320400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2138, "num_samples_added_to_queue": 320700}, "done": false, "training_iteration": 152, "trial_id": "3f041_00000", "date": "2024-10-11_00-25-30", "timestamp": 1728602730, "time_this_iter_s": 10.455404996871948, "time_total_s": 1579.167756319046, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfaa740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1579.167756319046, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 23.459999999999997, "ram_util_percent": 63.80666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.929525375366211, "cur_lr": 0.0001, "total_loss": 2115.19873046875, "policy_loss": -14.714723587036133, "entropy": 4.343278884887695, "entropy_coeff": 0.01, "var_gnorm": 18.05948257446289, "vf_loss": 214294.34375, "vf_explained_var": 0.6305376291275024}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1075.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 322650, "num_env_steps_trained": 322500, "num_agent_steps_sampled": 322650, "num_agent_steps_trained": 322500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2151, "num_samples_added_to_queue": 322500, "learner_queue": {"size_count": 1075, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.801, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 1603.224, "learner_dequeue_time_ms": 13605.636}}, "env_runners": {"episode_reward_max": 885.4033333333342, "episode_reward_min": 884.4666666666673, "episode_reward_mean": 884.9873666666675, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.4666666666673}, "policy_reward_max": {"default_policy": 885.4033333333342}, "policy_reward_mean": {"default_policy": 884.9873666666675}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 38.566603333333326, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.00033933333333333336, "num_slav_min": 0.0001, "num_slav_max": 0.0006000000000000001, "mean_cluster_cpu_util_mean": 0.4773376523717595, "mean_cluster_cpu_util_min": 0.4753858016179444, "mean_cluster_cpu_util_max": 0.4790513191763191, "mean_cluster_mem_util_mean": 0.3185479905063291, "mean_cluster_mem_util_min": 0.31831856540084386, "mean_cluster_mem_util_max": 0.3187415611814346, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856660333333332, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006786666666666667, "reward_sla_mean_min": -0.012, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.666033333333, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6786666666666668, "reward_sla_sum_min": -1.2, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4474.0, "global_timestep_min": 2600, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.4000000000008, 885.2666666666676, 884.7333333333341, 884.8666666666675, 884.8666666666674, 884.7333333333339, 885.2000000000007, 884.8000000000008, 884.9333333333341, 884.8000000000008, 885.0666666666676, 885.0000000000009, 884.733333333334, 884.933333333334, 885.0000000000009, 884.6000000000006, 885.2666666666676, 885.0000000000008, 884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28642678972987506, "mean_inference_ms": 2.5080385094722386, "mean_action_processing_ms": 0.10539195916061062, "mean_env_wait_ms": 1.8209678474668385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007663726806640625, "StateBufferConnector_ms": 0.0046122074127197266, "ViewRequirementAgentConnector_ms": 0.11537313461303711}, "num_episodes": 18, "episode_return_max": 885.4033333333342, "episode_return_min": 884.4666666666673, "episode_return_mean": 884.9873666666675, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322650, "num_agent_steps_trained": 322500, "num_env_steps_sampled": 322650, "num_env_steps_trained": 322500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 186.21984247493717, "num_env_steps_trained_throughput_per_sec": 200.54444574224004, "timesteps_total": 322650, "num_env_steps_sampled_lifetime": 322650, "num_agent_steps_sampled_lifetime": 322650, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 322650, "timers": {"training_iteration_time_ms": 10330.714, "restore_workers_time_ms": 0.013, "training_step_time_ms": 807.624, "sample_time_ms": 788.326, "synch_weights_time_ms": 17.247}, "counters": {"num_env_steps_sampled": 322650, "num_env_steps_trained": 322500, "num_agent_steps_sampled": 322650, "num_agent_steps_trained": 322500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2151, "num_samples_added_to_queue": 322500}, "done": false, "training_iteration": 153, "trial_id": "3f041_00000", "date": "2024-10-11_00-25-41", "timestamp": 1728602741, "time_this_iter_s": 10.481862306594849, "time_total_s": 1589.6496186256409, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae515d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1589.6496186256409, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 63.93999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2119.52783203125, "policy_loss": -9.69694709777832, "entropy": 4.340452671051025, "entropy_coeff": 0.01, "var_gnorm": 18.062484741210938, "vf_loss": 214224.625, "vf_explained_var": 0.6305968165397644}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1081.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 324450, "num_env_steps_trained": 324300, "num_agent_steps_sampled": 324450, "num_agent_steps_trained": 324300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2163, "num_samples_added_to_queue": 324300, "learner_queue": {"size_count": 1081, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.471, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1594.697, "learner_dequeue_time_ms": 13470.099}}, "env_runners": {"episode_reward_max": 885.4033333333342, "episode_reward_min": 884.4666666666673, "episode_reward_mean": 884.9900333333342, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.4666666666673}, "policy_reward_max": {"default_policy": 885.4033333333342}, "policy_reward_mean": {"default_policy": 884.9900333333342}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 38.566603333333326, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.000338, "num_slav_min": 0.0001, "num_slav_max": 0.0006000000000000001, "mean_cluster_cpu_util_mean": 0.4773022384629527, "mean_cluster_cpu_util_min": 0.4753858016179444, "mean_cluster_cpu_util_max": 0.4790513191763191, "mean_cluster_mem_util_mean": 0.3185523575949367, "mean_cluster_mem_util_min": 0.31831856540084386, "mean_cluster_mem_util_max": 0.3187415611814346, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856660333333332, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.00676, "reward_sla_mean_min": -0.012, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.666033333333, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6759999999999999, "reward_sla_sum_min": -1.2, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5074.0, "global_timestep_min": 3200, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.9333333333341, 884.8666666666675, 885.1333333333341, 885.2000000000008, 885.0666666666674, 885.2666666666676, 885.2000000000008, 885.2000000000007, 885.0666666666674, 885.1333333333342, 885.0000000000008, 885.0000000000007, 884.6666666666671, 885.133333333334, 884.9333333333342, 884.5333333333341, 885.0000000000008, 884.8666666666675, 885.2666666666676, 884.933333333334, 885.400000000001, 885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2866556742360891, "mean_inference_ms": 2.5103051982109306, "mean_action_processing_ms": 0.10547380779304025, "mean_env_wait_ms": 1.8223518986586253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007720470428466797, "StateBufferConnector_ms": 0.004597902297973633, "ViewRequirementAgentConnector_ms": 0.11641621589660645}, "num_episodes": 18, "episode_return_max": 885.4033333333342, "episode_return_min": 884.4666666666673, "episode_return_mean": 884.9900333333342, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324450, "num_agent_steps_trained": 324300, "num_env_steps_sampled": 324450, "num_env_steps_trained": 324300, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 174.8347941134419, "num_env_steps_trained_throughput_per_sec": 174.8347941134419, "timesteps_total": 324450, "num_env_steps_sampled_lifetime": 324450, "num_agent_steps_sampled_lifetime": 324450, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 324450, "timers": {"training_iteration_time_ms": 10337.897, "restore_workers_time_ms": 0.015, "training_step_time_ms": 867.807, "sample_time_ms": 848.174, "synch_weights_time_ms": 17.66}, "counters": {"num_env_steps_sampled": 324450, "num_env_steps_trained": 324300, "num_agent_steps_sampled": 324450, "num_agent_steps_trained": 324300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2163, "num_samples_added_to_queue": 324300}, "done": false, "training_iteration": 154, "trial_id": "3f041_00000", "date": "2024-10-11_00-25-51", "timestamp": 1728602751, "time_this_iter_s": 10.307009220123291, "time_total_s": 1599.9566278457642, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee66ae50400>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1599.9566278457642, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 23.220000000000002, "ram_util_percent": 64.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.912222385406494, "cur_lr": 0.0001, "total_loss": 2121.347412109375, "policy_loss": -6.338968753814697, "entropy": 4.337620258331299, "entropy_coeff": 0.01, "var_gnorm": 18.063974380493164, "vf_loss": 214069.921875, "vf_explained_var": 0.6304231882095337}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1088.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 326550, "num_env_steps_trained": 326400, "num_agent_steps_sampled": 326550, "num_agent_steps_trained": 326400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2177, "num_samples_added_to_queue": 326400, "learner_queue": {"size_count": 1088, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.409, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1534.961, "learner_dequeue_time_ms": 13470.099}}, "env_runners": {"episode_reward_max": 885.4033333333342, "episode_reward_min": 884.4666666666673, "episode_reward_mean": 884.9827000000008, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.4666666666673}, "policy_reward_max": {"default_policy": 885.4033333333342}, "policy_reward_mean": {"default_policy": 884.9827000000008}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 38.566603333333326, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.00034166666666666666, "num_slav_min": 0.0001, "num_slav_max": 0.0006000000000000001, "mean_cluster_cpu_util_mean": 0.4773105575473433, "mean_cluster_cpu_util_min": 0.4757041965434823, "mean_cluster_cpu_util_max": 0.4790513191763191, "mean_cluster_mem_util_mean": 0.3185553217299578, "mean_cluster_mem_util_min": 0.31831856540084386, "mean_cluster_mem_util_max": 0.3187415611814346, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856660333333332, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006833333333333333, "reward_sla_mean_min": -0.012, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.666033333333, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6833333333333331, "reward_sla_sum_min": -1.2, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5773.0, "global_timestep_min": 3800, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339, 885.1333333333341, 885.4000000000008, 884.533333333334, 885.0000000000008, 885.2000000000007, 884.5333333333341, 884.7333333333341, 885.0666666666675, 885.2000000000007, 885.0000000000007, 885.2000000000008, 885.0000000000009, 885.1333333333341, 885.1333333333342, 884.8000000000006, 885.0000000000009, 885.0666666666675, 885.0666666666675, 884.9333333333342, 885.0666666666674, 884.8666666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [885.0000000000009, 885.0666666666674, 885.0666666666675, 885.0000000000006, 885.1333333333341, 885.1333333333342, 885.0666666666674, 885.0000000000007, 885.0000000000008, 885.0666666666676, 884.9333333333342, 885.2000000000008, 884.6000000000007, 884.7333333333341, 885.4000000000008, 885.133333333334, 885.2666666666677, 884.933333333334, 885.200000000001, 884.9333333333341, 885.3333333333343, 884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339, 885.1333333333341, 885.4000000000008, 884.533333333334, 885.0000000000008, 885.2000000000007, 884.5333333333341, 884.7333333333341, 885.0666666666675, 885.2000000000007, 885.0000000000007, 885.2000000000008, 885.0000000000009, 885.1333333333341, 885.1333333333342, 884.8000000000006, 885.0000000000009, 885.0666666666675, 885.0666666666675, 884.9333333333342, 885.0666666666674, 884.8666666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869282704630102, "mean_inference_ms": 2.514389895088313, "mean_action_processing_ms": 0.10557801579996368, "mean_env_wait_ms": 1.8242075585087247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007560014724731445, "StateBufferConnector_ms": 0.004432201385498047, "ViewRequirementAgentConnector_ms": 0.11340069770812988}, "num_episodes": 21, "episode_return_max": 885.4033333333342, "episode_return_min": 884.4666666666673, "episode_return_mean": 884.9827000000008, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326550, "num_agent_steps_trained": 326400, "num_env_steps_sampled": 326550, "num_env_steps_trained": 326400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 195.02931604659585, "num_env_steps_trained_throughput_per_sec": 195.02931604659585, "timesteps_total": 326550, "num_env_steps_sampled_lifetime": 326550, "num_agent_steps_sampled_lifetime": 326550, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 326550, "timers": {"training_iteration_time_ms": 10359.91, "restore_workers_time_ms": 0.013, "training_step_time_ms": 779.616, "sample_time_ms": 760.998, "synch_weights_time_ms": 16.834}, "counters": {"num_env_steps_sampled": 326550, "num_env_steps_trained": 326400, "num_agent_steps_sampled": 326550, "num_agent_steps_trained": 326400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2177, "num_samples_added_to_queue": 326400}, "done": false, "training_iteration": 155, "trial_id": "3f041_00000", "date": "2024-10-11_00-26-02", "timestamp": 1728602762, "time_this_iter_s": 10.779810190200806, "time_total_s": 1610.736438035965, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee6698759c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1610.736438035965, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 19.166666666666668, "ram_util_percent": 63.899999999999984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2381.97607421875, "policy_loss": -4.716521263122559, "entropy": 4.3353047370910645, "entropy_coeff": 0.01, "var_gnorm": 18.061891555786133, "vf_loss": 239969.859375, "vf_explained_var": 0.6011074185371399}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 328500, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328500, "num_agent_steps_trained": 328200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2190, "num_samples_added_to_queue": 328500, "learner_queue": {"size_count": 1094, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.494, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1505.375, "learner_dequeue_time_ms": 13395.091}}, "env_runners": {"episode_reward_max": 885.4033333333342, "episode_reward_min": 884.4666666666673, "episode_reward_mean": 884.9753666666674, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 884.4666666666673}, "policy_reward_max": {"default_policy": 885.4033333333342}, "policy_reward_mean": {"default_policy": 884.9753666666674}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0034999999999999996, "num_moves_min": 0.0, "num_moves_max": 0.11, "mean_accuracy_mean": 38.566603333333326, "mean_accuracy_min": 38.56033333333331, "mean_accuracy_max": 38.56666666666665, "num_model_switches_mean": 0.0032, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 0.00034533333333333334, "num_slav_min": 0.0001, "num_slav_max": 0.0006000000000000001, "mean_cluster_cpu_util_mean": 0.477338556260342, "mean_cluster_cpu_util_min": 0.4757041965434823, "mean_cluster_cpu_util_max": 0.4794128746093031, "mean_cluster_mem_util_mean": 0.31856089135021093, "mean_cluster_mem_util_min": 0.3183660337552743, "mean_cluster_mem_util_max": 0.3187320675105485, "reward_consolidation_mean_mean": 4.999999999999999, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 4.999999999999999, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.856660333333332, "reward_accuracy_mean_min": 3.856033333333331, "reward_accuracy_mean_max": 3.8566666666666647, "reward_sla_mean_mean": -0.006906666666666669, "reward_sla_mean_min": -0.012, "reward_sla_mean_max": -0.002, "reward_consolidation_sum_mean": 499.99999999999994, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 499.99999999999994, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 385.666033333333, "reward_accuracy_sum_min": 385.6033333333331, "reward_accuracy_sum_max": 385.66666666666646, "reward_sla_sum_mean": -0.6906666666666667, "reward_sla_sum_min": -1.2, "reward_sla_sum_max": -0.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5776.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339, 885.1333333333341, 885.4000000000008, 884.533333333334, 885.0000000000008, 885.2000000000007, 884.5333333333341, 884.7333333333341, 885.0666666666675, 885.2000000000007, 885.0000000000007, 885.2000000000008, 885.0000000000009, 885.1333333333341, 885.1333333333342, 884.8000000000006, 885.0000000000009, 885.0666666666675, 885.0666666666675, 884.9333333333342, 885.0666666666674, 884.8666666666674, 885.2666666666674, 884.9333333333342, 885.1333333333341, 885.0666666666675, 885.0000000000008, 885.0000000000007, 885.2666666666676, 884.8666666666674, 884.8000000000008, 885.2000000000008, 884.8000000000006, 885.2000000000007, 885.0000000000007, 884.9333333333341, 884.9333333333342, 884.733333333334, 885.2000000000008, 885.0666666666676, 884.8666666666677, 885.0000000000007, 885.2000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.4666666666673, 884.9333333333341, 884.8666666666674, 885.0000000000008, 885.2000000000008, 884.6666666666674, 885.0000000000009, 885.0666666666674, 885.2000000000008, 885.0666666666675, 884.8000000000006, 884.5333333333338, 884.8666666666672, 884.8666666666674, 885.0666666666676, 885.4033333333342, 885.3333333333343, 884.8666666666672, 884.8000000000006, 885.2000000000008, 885.1333333333341, 885.1333333333342, 885.0666666666673, 884.6666666666673, 884.6666666666674, 884.9333333333341, 884.8666666666675, 885.200000000001, 884.8000000000009, 884.8666666666674, 885.2666666666676, 884.8666666666674, 884.8000000000006, 885.0000000000008, 884.733333333334, 884.733333333334, 884.8666666666674, 885.0666666666676, 884.6666666666673, 885.0000000000007, 885.0666666666674, 884.8000000000008, 885.200000000001, 884.8000000000006, 884.8000000000008, 885.2000000000008, 885.0666666666675, 885.0000000000009, 884.8666666666675, 884.6666666666674, 885.2666666666676, 884.9333333333341, 885.2000000000008, 885.0000000000007, 884.8000000000008, 885.0000000000008, 885.0666666666675, 884.7333333333339, 885.1333333333341, 885.4000000000008, 884.533333333334, 885.0000000000008, 885.2000000000007, 884.5333333333341, 884.7333333333341, 885.0666666666675, 885.2000000000007, 885.0000000000007, 885.2000000000008, 885.0000000000009, 885.1333333333341, 885.1333333333342, 884.8000000000006, 885.0000000000009, 885.0666666666675, 885.0666666666675, 884.9333333333342, 885.0666666666674, 884.8666666666674, 885.2666666666674, 884.9333333333342, 885.1333333333341, 885.0666666666675, 885.0000000000008, 885.0000000000007, 885.2666666666676, 884.8666666666674, 884.8000000000008, 885.2000000000008, 884.8000000000006, 885.2000000000007, 885.0000000000007, 884.9333333333341, 884.9333333333342, 884.733333333334, 885.2000000000008, 885.0666666666676, 884.8666666666677, 885.0000000000007, 885.2000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28720319795503985, "mean_inference_ms": 2.5180262390344894, "mean_action_processing_ms": 0.10567338316348478, "mean_env_wait_ms": 1.8259427476556402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007375240325927734, "StateBufferConnector_ms": 0.004369497299194336, "ViewRequirementAgentConnector_ms": 0.11126947402954102}, "num_episodes": 21, "episode_return_max": 885.4033333333342, "episode_return_min": 884.4666666666673, "episode_return_mean": 884.9753666666674, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328500, "num_agent_steps_trained": 328200, "num_env_steps_sampled": 328500, "num_env_steps_trained": 328200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 193.05672616301797, "num_env_steps_trained_throughput_per_sec": 178.20620876586275, "timesteps_total": 328500, "num_env_steps_sampled_lifetime": 328500, "num_agent_steps_sampled_lifetime": 328500, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 328500, "timers": {"training_iteration_time_ms": 10356.464, "restore_workers_time_ms": 0.014, "training_step_time_ms": 775.728, "sample_time_ms": 757.446, "synch_weights_time_ms": 16.519}, "counters": {"num_env_steps_sampled": 328500, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328500, "num_agent_steps_trained": 328200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2190, "num_samples_added_to_queue": 328500}, "done": false, "training_iteration": 156, "trial_id": "3f041_00000", "date": "2024-10-11_00-26-12", "timestamp": 1728602772, "time_this_iter_s": 10.112770795822144, "time_total_s": 1620.849208831787, "pid": 482131, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -3, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7ee65dfa8c10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7ee664769c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 3, "vtrace_clip_pg_rho_threshold": 3, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1620.849208831787, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 20.014285714285712, "ram_util_percent": 64.04285714285714}}
