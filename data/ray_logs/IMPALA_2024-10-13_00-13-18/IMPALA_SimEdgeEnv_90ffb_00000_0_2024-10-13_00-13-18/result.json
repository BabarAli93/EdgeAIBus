{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -333013.5, "policy_loss": -334332.78125, "entropy": 29.818490982055664, "entropy_coeff": 0.01, "var_gnorm": 16.00043487548828, "vf_loss": 148328.984375, "vf_explained_var": 0.0002193450927734375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272727293}}, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2200, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.908, "learner_load_time_ms": 0.204, "learner_load_wait_time_ms": 2245.83, "learner_dequeue_time_ms": 2391.732}}, "env_runners": {"episode_reward_max": -140.42148405373288, "episode_reward_min": -209.61458771208373, "episode_reward_mean": -176.43188326885775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2400, "policy_reward_min": {"default_policy": -209.61458771208373}, "policy_reward_max": {"default_policy": -140.42148405373288}, "policy_reward_mean": {"default_policy": -176.43188326885775}, "custom_metrics": {"num_consolidated_mean": 0.6774999999999999, "num_consolidated_min": 0.55, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.06125, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.9975, "num_moves_min": 9.78, "num_moves_max": 10.25, "mean_accuracy_mean": 41.090763888888894, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.302666666666674, "num_model_switches_mean": 6.03, "num_model_switches_min": 5.68, "num_model_switches_max": 6.35, "num_slav_mean": 0.16186805555555556, "num_slav_min": 0.14223333333333332, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.7049999999999996, "cpu_conserved_cost_min": 2.2, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5711523401235611, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5939567656013183, "mean_cluster_mem_util_mean": 0.3664372669861721, "mean_cluster_mem_util_min": 0.35766869492522735, "mean_cluster_mem_util_max": 0.37661692392146734, "reward_consolidation_mean_mean": 0.34251450064475514, "reward_consolidation_mean_min": 0.19253784763471316, "reward_consolidation_mean_max": 0.47678515946267014, "reward_illegal_mean_mean": -1.7687499999999998, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.9000000000000004, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2380833333333332, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.7486666666666666, "reward_consolidation_sum_mean": 34.25145006447551, "reward_consolidation_sum_min": 19.253784763471316, "reward_consolidation_sum_max": 47.67851594626701, "reward_illegal_sum_mean": -176.87499999999997, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 90.00000000000004, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -123.80833333333334, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -74.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 450.0, "global_timestep_min": 100, "global_timestep_max": 800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24284645944215058, "mean_inference_ms": 1.9421767030470145, "mean_action_processing_ms": 0.08967965899660595, "mean_env_wait_ms": 1.6801553383276968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007388989130655925, "StateBufferConnector_ms": 0.0035335620244344077, "ViewRequirementAgentConnector_ms": 0.08629163106282552}, "num_episodes": 24, "episode_return_max": -140.42148405373288, "episode_return_min": -209.61458771208373, "episode_return_mean": -176.43188326885775, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 244.31869932011378, "num_env_steps_trained_throughput_per_sec": 210.78476019774521, "timesteps_total": 2550, "num_env_steps_sampled_lifetime": 2550, "num_agent_steps_sampled_lifetime": 2550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 2550, "timers": {"training_iteration_time_ms": 10437.195, "restore_workers_time_ms": 0.013, "training_step_time_ms": 616.875, "sample_time_ms": 601.508, "synch_weights_time_ms": 14.01}, "counters": {"num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2200}, "done": false, "training_iteration": 1, "trial_id": "90ffb_00000", "date": "2024-10-13_00-13-29", "timestamp": 1728774809, "time_this_iter_s": 10.441712617874146, "time_total_s": 10.441712617874146, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d576139b6a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.441712617874146, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.62, "ram_util_percent": 45.893333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -292928.71875, "policy_loss": -293935.375, "entropy": 29.818025588989258, "entropy_coeff": 0.01, "var_gnorm": 16.00037384033203, "vf_loss": 117066.65625, "vf_explained_var": 0.0007009506225585938}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 33, "num_samples_added_to_queue": 4950, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.168, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 2222.937, "learner_dequeue_time_ms": 10331.353}}, "env_runners": {"episode_reward_max": -117.94275792744223, "episode_reward_min": -211.5901276310578, "episode_reward_mean": -168.98689808045728, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 4800, "policy_reward_min": {"default_policy": -211.5901276310578}, "policy_reward_max": {"default_policy": -117.94275792744223}, "policy_reward_mean": {"default_policy": -168.98689808045728}, "custom_metrics": {"num_consolidated_mean": 0.6889583333333335, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0489583333333332, "num_overloaded_min": 0.93, "num_overloaded_max": 1.2, "num_moves_mean": 9.980833333333333, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08034027777778, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.302666666666674, "num_model_switches_mean": 6.03625, "num_model_switches_min": 5.67, "num_model_switches_max": 6.37, "num_slav_mean": 0.15946631944444445, "num_slav_min": 0.1376666666666667, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.732083333333333, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5712460380558321, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5957853513937433, "mean_cluster_mem_util_mean": 0.36631916899583317, "mean_cluster_mem_util_min": 0.35766869492522735, "mean_cluster_mem_util_max": 0.37661692392146734, "reward_consolidation_mean_mean": 0.35615185252876014, "reward_consolidation_mean_min": 0.19253784763471316, "reward_consolidation_mean_max": 0.5278336227116269, "reward_illegal_mean_mean": -1.7482638888888886, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.9157986111111113, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2135555555555555, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": 35.61518525287601, "reward_consolidation_sum_min": 19.253784763471316, "reward_consolidation_sum_max": 52.78336227116269, "reward_illegal_sum_mean": -174.82638888888883, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 91.57986111111113, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -121.35555555555554, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 850.0, "global_timestep_min": 100, "global_timestep_max": 1600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24346215742124203, "mean_inference_ms": 1.9550819249269764, "mean_action_processing_ms": 0.08974173048001889, "mean_env_wait_ms": 1.6881807393603656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006790459156036377, "StateBufferConnector_ms": 0.0034824013710021973, "ViewRequirementAgentConnector_ms": 0.08805592854817708}, "num_episodes": 24, "episode_return_max": -117.94275792744223, "episode_return_min": -211.5901276310578, "episode_return_mean": -168.98689808045728, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 235.13812324015706, "num_env_steps_trained_throughput_per_sec": 215.5432796368106, "timesteps_total": 4950, "num_env_steps_sampled_lifetime": 4950, "num_agent_steps_sampled_lifetime": 4950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 4950, "timers": {"training_iteration_time_ms": 10321.985, "restore_workers_time_ms": 0.013, "training_step_time_ms": 646.7, "sample_time_ms": 618.77, "synch_weights_time_ms": 26.602}, "counters": {"num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 33, "num_samples_added_to_queue": 4950}, "done": false, "training_iteration": 2, "trial_id": "90ffb_00000", "date": "2024-10-13_00-13-39", "timestamp": 1728774819, "time_this_iter_s": 10.218985557556152, "time_total_s": 20.660698175430298, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef62f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.660698175430298, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.759999999999998, "ram_util_percent": 45.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -336743.90625, "policy_loss": -338064.125, "entropy": 29.81759262084961, "entropy_coeff": 0.01, "var_gnorm": 16.000226974487305, "vf_loss": 148422.703125, "vf_explained_var": 0.0011482834815979004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 7350, "num_env_steps_trained": 7150, "num_agent_steps_sampled": 7350, "num_agent_steps_trained": 7150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 49, "num_samples_added_to_queue": 7150, "learner_queue": {"size_count": 13, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.352, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 2270.279, "learner_dequeue_time_ms": 10331.353}}, "env_runners": {"episode_reward_max": -117.94275792744223, "episode_reward_min": -211.5901276310578, "episode_reward_mean": -168.76690155384296, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"default_policy": -211.5901276310578}, "policy_reward_max": {"default_policy": -117.94275792744223}, "policy_reward_mean": {"default_policy": -168.76690155384296}, "custom_metrics": {"num_consolidated_mean": 0.6752777777777779, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0459722222222223, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.990972222222222, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.095162037037035, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.38500000000001, "num_model_switches_mean": 6.015694444444445, "num_model_switches_min": 5.61, "num_model_switches_max": 6.37, "num_slav_mean": 0.16050949074074072, "num_slav_min": 0.1376666666666667, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.6816666666666666, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5705692187024265, "mean_cluster_cpu_util_min": 0.5533050352288024, "mean_cluster_cpu_util_max": 0.5957853513937433, "mean_cluster_mem_util_mean": 0.3658563679881821, "mean_cluster_mem_util_min": 0.35766869492522735, "mean_cluster_mem_util_max": 0.37661692392146734, "reward_consolidation_mean_mean": 0.36119672520231094, "reward_consolidation_mean_min": 0.19253784763471316, "reward_consolidation_mean_max": 0.5278336227116269, "reward_illegal_mean_mean": -1.7432870370370368, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.9267361111111112, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2323148148148149, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": 36.11967252023109, "reward_consolidation_sum_min": 19.253784763471316, "reward_consolidation_sum_max": 52.78336227116269, "reward_illegal_sum_mean": -174.32870370370367, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 92.67361111111114, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -123.23148148148147, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1250.0, "global_timestep_min": 100, "global_timestep_max": 2400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24332306021123473, "mean_inference_ms": 1.9670943458258665, "mean_action_processing_ms": 0.08993798249962824, "mean_env_wait_ms": 1.6976305308700637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00647074646419949, "StateBufferConnector_ms": 0.0034468041525946725, "ViewRequirementAgentConnector_ms": 0.08748968442281087}, "num_episodes": 24, "episode_return_max": -117.94275792744223, "episode_return_min": -211.5901276310578, "episode_return_mean": -168.76690155384296, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7350, "num_agent_steps_trained": 7150, "num_env_steps_sampled": 7350, "num_env_steps_trained": 7150, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 233.7140383892341, "num_env_steps_trained_throughput_per_sec": 267.79733565433077, "timesteps_total": 7350, "num_env_steps_sampled_lifetime": 7350, "num_agent_steps_sampled_lifetime": 7350, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 7350, "timers": {"training_iteration_time_ms": 10304.312, "restore_workers_time_ms": 0.012, "training_step_time_ms": 646.546, "sample_time_ms": 631.826, "synch_weights_time_ms": 13.279}, "counters": {"num_env_steps_sampled": 7350, "num_env_steps_trained": 7150, "num_agent_steps_sampled": 7350, "num_agent_steps_trained": 7150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 49, "num_samples_added_to_queue": 7150}, "done": false, "training_iteration": 3, "trial_id": "90ffb_00000", "date": "2024-10-13_00-13-50", "timestamp": 1728774830, "time_this_iter_s": 10.277575254440308, "time_total_s": 30.938273429870605, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.938273429870605, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.799999999999997, "ram_util_percent": 45.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -322020.625, "policy_loss": -323269.5, "entropy": 29.817197799682617, "entropy_coeff": 0.01, "var_gnorm": 16.000268936157227, "vf_loss": 141287.03125, "vf_explained_var": 0.0013568401336669922}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 9750, "num_env_steps_trained": 9350, "num_agent_steps_sampled": 9750, "num_agent_steps_trained": 9350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 65, "num_samples_added_to_queue": 9350, "learner_queue": {"size_count": 17, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.65, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 2314.999, "learner_dequeue_time_ms": 13333.731}}, "env_runners": {"episode_reward_max": -117.94275792744223, "episode_reward_min": -211.5901276310578, "episode_reward_mean": -170.58803950648306, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9600, "policy_reward_min": {"default_policy": -211.5901276310578}, "policy_reward_max": {"default_policy": -117.94275792744223}, "policy_reward_mean": {"default_policy": -170.58803950648306}, "custom_metrics": {"num_consolidated_mean": 0.6804166666666666, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.046354166666667, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.986979166666666, "num_moves_min": 9.7, "num_moves_max": 10.33, "mean_accuracy_mean": 41.092809027777776, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.38500000000001, "num_model_switches_mean": 5.998645833333332, "num_model_switches_min": 5.58, "num_model_switches_max": 6.37, "num_slav_mean": 0.16072934027777777, "num_slav_min": 0.1376666666666667, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.7099999999999995, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5712024213166083, "mean_cluster_cpu_util_min": 0.5533050352288024, "mean_cluster_cpu_util_max": 0.5957853513937433, "mean_cluster_mem_util_mean": 0.3661923264427079, "mean_cluster_mem_util_min": 0.35766869492522735, "mean_cluster_mem_util_max": 0.37661692392146734, "reward_consolidation_mean_mean": 0.3595119660462802, "reward_consolidation_mean_min": 0.19253784763471316, "reward_consolidation_mean_max": 0.53295089707271, "reward_illegal_mean_mean": -1.7439236111111107, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.925434027777778, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2469027777777777, "reward_sla_mean_min": -2.106666666666667, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": 35.951196604628024, "reward_consolidation_sum_min": 19.253784763471316, "reward_consolidation_sum_max": 53.295089707271, "reward_illegal_sum_mean": -174.3923611111111, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 92.54340277777779, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -124.69027777777778, "reward_sla_sum_min": -210.66666666666669, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1650.0, "global_timestep_min": 100, "global_timestep_max": 3200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-164.68308812330554, -151.47543635200591, -194.19575070821534, -184.68571080447157, -209.61458771208373, -148.19082518504965, -169.86370891589752, -143.80968351152933, -179.20001218434916, -185.52535867677975, -194.64621523652855, -158.94282189527527, -192.12411282707347, -203.83726278595148, -157.95526516189943, -178.20632976941116, -207.27647506777532, -187.8917816564622, -179.4609339303663, -185.8097261567516, -167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24351202008185394, "mean_inference_ms": 1.9757698578838812, "mean_action_processing_ms": 0.09012063886921029, "mean_env_wait_ms": 1.704489576677435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006273388862609863, "StateBufferConnector_ms": 0.0034133593241373696, "ViewRequirementAgentConnector_ms": 0.08734315633773804}, "num_episodes": 24, "episode_return_max": -117.94275792744223, "episode_return_min": -211.5901276310578, "episode_return_mean": -170.58803950648306, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9750, "num_agent_steps_trained": 9350, "num_env_steps_sampled": 9750, "num_env_steps_trained": 9350, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 233.91796036537968, "num_env_steps_trained_throughput_per_sec": 214.42479700159805, "timesteps_total": 9750, "num_env_steps_sampled_lifetime": 9750, "num_agent_steps_sampled_lifetime": 9750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 9750, "timers": {"training_iteration_time_ms": 10293.238, "restore_workers_time_ms": 0.013, "training_step_time_ms": 652.334, "sample_time_ms": 638.219, "synch_weights_time_ms": 12.867}, "counters": {"num_env_steps_sampled": 9750, "num_env_steps_trained": 9350, "num_agent_steps_sampled": 9750, "num_agent_steps_trained": 9350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 65, "num_samples_added_to_queue": 9350}, "done": false, "training_iteration": 4, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-00", "timestamp": 1728774840, "time_this_iter_s": 10.270103693008423, "time_total_s": 41.20837712287903, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e356c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.20837712287903, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.92142857142857, "ram_util_percent": 46.021428571428565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -318864.125, "policy_loss": -320072.28125, "entropy": 29.816761016845703, "entropy_coeff": 0.01, "var_gnorm": 16.00052833557129, "vf_loss": 137215.0625, "vf_explained_var": 0.0018346905708312988}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 12100, "learner_queue": {"size_count": 21, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.254, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 2327.274, "learner_dequeue_time_ms": 13333.731}}, "env_runners": {"episode_reward_max": -117.94275792744223, "episode_reward_min": -211.5901276310578, "episode_reward_mean": -167.7702122209022, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.5901276310578}, "policy_reward_max": {"default_policy": -117.94275792744223}, "policy_reward_mean": {"default_policy": -167.7702122209022}, "custom_metrics": {"num_consolidated_mean": 0.6772999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0389, "num_overloaded_min": 0.91, "num_overloaded_max": 1.2, "num_moves_mean": 9.975999999999999, "num_moves_min": 9.59, "num_moves_max": 10.33, "mean_accuracy_mean": 41.102596666666656, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.38500000000001, "num_model_switches_mean": 5.9894, "num_model_switches_min": 5.58, "num_model_switches_max": 6.45, "num_slav_mean": 0.16147066666666668, "num_slav_min": 0.1376666666666667, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.689600000000001, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5703849572276888, "mean_cluster_cpu_util_min": 0.5527930043358893, "mean_cluster_cpu_util_max": 0.5991822411416254, "mean_cluster_mem_util_mean": 0.36579565690210686, "mean_cluster_mem_util_min": 0.35706379219409284, "mean_cluster_mem_util_max": 0.3809842875441316, "reward_consolidation_mean_mean": 0.3668278777909776, "reward_consolidation_mean_min": 0.23272061287276494, "reward_consolidation_mean_max": 0.53295089707271, "reward_illegal_mean_mean": -1.7315, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.516666666666666, "reward_accuracy_mean_mean": 0.9430833333333336, "reward_accuracy_mean_min": 0.5833333333333327, "reward_accuracy_mean_max": 1.325000000000001, "reward_sla_mean_mean": -1.2561133333333334, "reward_sla_mean_min": -2.106666666666667, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": 36.68278777909775, "reward_consolidation_sum_min": 23.272061287276493, "reward_consolidation_sum_max": 53.295089707271, "reward_illegal_sum_mean": -173.14999999999998, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -151.6666666666666, "reward_accuracy_sum_mean": 94.30833333333335, "reward_accuracy_sum_min": 58.33333333333327, "reward_accuracy_sum_max": 132.5000000000001, "reward_sla_sum_mean": -125.61133333333335, "reward_sla_sum_min": -210.66666666666669, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2378.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-167.63209662188908, -171.64485363550517, -177.2716774802767, -140.42148405373288, -165.79003929452614, -152.13546864053131, -117.94275792744223, -128.18330439550397, -144.4621584574613, -185.32793871272352, -151.68231746321837, -203.47336196655402, -177.68754150293952, -162.3700874227055, -182.91966858570152, -138.22456364799424, -144.71726826890853, -140.04043376283167, -158.47369703615703, -172.51564165828987, -191.14358950927533, -169.3587072405494, -211.5901276310578, -163.39496177160422, -159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24301574467374779, "mean_inference_ms": 1.9885326218648276, "mean_action_processing_ms": 0.09042337322725853, "mean_env_wait_ms": 1.715496298379933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00586247444152832, "StateBufferConnector_ms": 0.0033257007598876953, "ViewRequirementAgentConnector_ms": 0.08668041229248047}, "num_episodes": 24, "episode_return_max": -117.94275792744223, "episode_return_min": -211.5901276310578, "episode_return_mean": -167.7702122209022, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 232.7383678670835, "num_env_steps_trained_throughput_per_sec": 213.34350387815988, "timesteps_total": 12150, "num_env_steps_sampled_lifetime": 12150, "num_agent_steps_sampled_lifetime": 12150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 12150, "timers": {"training_iteration_time_ms": 10296.994, "restore_workers_time_ms": 0.016, "training_step_time_ms": 651.587, "sample_time_ms": 637.154, "synch_weights_time_ms": 13.061}, "counters": {"num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 12100}, "done": false, "training_iteration": 5, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-10", "timestamp": 1728774850, "time_this_iter_s": 10.332347869873047, "time_total_s": 51.540724992752075, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef09900>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.540724992752075, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.56, "ram_util_percent": 46.040000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -313450.4375, "policy_loss": -314554.4375, "entropy": 29.81622886657715, "entropy_coeff": 0.01, "var_gnorm": 16.000816345214844, "vf_loss": 126801.4140625, "vf_explained_var": 0.002888619899749756}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.563, "learner_load_time_ms": 0.258, "learner_load_wait_time_ms": 2338.104, "learner_dequeue_time_ms": 14739.206}}, "env_runners": {"episode_reward_max": -134.13367144902386, "episode_reward_min": -206.2880075542963, "episode_reward_mean": -168.0886803435986, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.2880075542963}, "policy_reward_max": {"default_policy": -134.13367144902386}, "policy_reward_mean": {"default_policy": -168.0886803435986}, "custom_metrics": {"num_consolidated_mean": 0.6697, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0359, "num_overloaded_min": 0.88, "num_overloaded_max": 1.16, "num_moves_mean": 9.9828, "num_moves_min": 9.59, "num_moves_max": 10.33, "mean_accuracy_mean": 41.112539999999996, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.38500000000001, "num_model_switches_mean": 5.985, "num_model_switches_min": 5.58, "num_model_switches_max": 6.45, "num_slav_mean": 0.16315683333333336, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6508000000000003, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.6, "mean_cluster_cpu_util_mean": 0.5691151689280284, "mean_cluster_cpu_util_min": 0.5480282268657708, "mean_cluster_cpu_util_max": 0.5991822411416254, "mean_cluster_mem_util_mean": 0.3651750235565746, "mean_cluster_mem_util_min": 0.35706379219409284, "mean_cluster_mem_util_max": 0.3809842875441316, "reward_consolidation_mean_mean": 0.3701098632306802, "reward_consolidation_mean_min": 0.2368689268634439, "reward_consolidation_mean_max": 0.53295089707271, "reward_illegal_mean_mean": -1.7264999999999997, "reward_illegal_mean_min": -1.9333333333333333, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.9555833333333333, "reward_accuracy_mean_min": 0.5916666666666671, "reward_accuracy_mean_max": 1.391666666666668, "reward_sla_mean_mean": -1.2800799999999999, "reward_sla_mean_min": -2.106666666666667, "reward_sla_mean_max": -0.7466666666666667, "reward_consolidation_sum_mean": 37.010986323068025, "reward_consolidation_sum_min": 23.68689268634439, "reward_consolidation_sum_max": 53.295089707271, "reward_illegal_sum_mean": -172.65, "reward_illegal_sum_min": -193.33333333333334, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 95.55833333333335, "reward_accuracy_sum_min": 59.16666666666671, "reward_accuracy_sum_max": 139.1666666666668, "reward_sla_sum_mean": -128.00799999999998, "reward_sla_sum_min": -210.66666666666669, "reward_sla_sum_max": -74.66666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3178.0, "global_timestep_min": 1300, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-159.1838465990435, -159.60844375399802, -151.88006640470323, -144.89991775564283, -171.86560662828586, -161.45163727192406, -170.77404124402202, -196.52535258460495, -157.4299064851199, -179.9376130859911, -166.30875140881523, -172.18593621493187, -160.17808644795758, -200.98705108288405, -165.38223826494868, -187.7365621858722, -149.46277985927077, -169.5714764385147, -150.63742422857842, -178.67024581924522, -163.9430259831246, -141.96122635474745, -134.13367144902386, -168.75572816716902, -180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24389354451520076, "mean_inference_ms": 2.004831369212306, "mean_action_processing_ms": 0.09089110716654805, "mean_env_wait_ms": 1.7284363420009645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005776643753051758, "StateBufferConnector_ms": 0.003355264663696289, "ViewRequirementAgentConnector_ms": 0.0876166820526123}, "num_episodes": 24, "episode_return_max": -134.13367144902386, "episode_return_min": -206.2880075542963, "episode_return_mean": -168.0886803435986, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 226.2013276904549, "num_env_steps_trained_throughput_per_sec": 259.18902131197956, "timesteps_total": 14550, "num_env_steps_sampled_lifetime": 14550, "num_agent_steps_sampled_lifetime": 14550, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 14550, "timers": {"training_iteration_time_ms": 10349.166, "restore_workers_time_ms": 0.014, "training_step_time_ms": 665.825, "sample_time_ms": 651.408, "synch_weights_time_ms": 13.137}, "counters": {"num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300}, "done": false, "training_iteration": 6, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-21", "timestamp": 1728774861, "time_this_iter_s": 10.623537540435791, "time_total_s": 62.164262533187866, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0a530>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.164262533187866, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.68, "ram_util_percent": 45.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -338207.15625, "policy_loss": -339560.71875, "entropy": 29.81559944152832, "entropy_coeff": 0.01, "var_gnorm": 16.001493453979492, "vf_loss": 151756.953125, "vf_explained_var": 0.002759218215942383}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 113, "num_samples_added_to_queue": 16500, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.003, "learner_load_time_ms": 0.258, "learner_load_wait_time_ms": 2288.674, "learner_dequeue_time_ms": 14739.206}}, "env_runners": {"episode_reward_max": -136.2317828748973, "episode_reward_min": -211.3075055591091, "episode_reward_mean": -169.60123521886138, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.3075055591091}, "policy_reward_max": {"default_policy": -136.2317828748973}, "policy_reward_mean": {"default_policy": -169.60123521886138}, "custom_metrics": {"num_consolidated_mean": 0.6742, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0417, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 9.9835, "num_moves_min": 9.59, "num_moves_max": 10.33, "mean_accuracy_mean": 41.112856666666666, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 5.9927, "num_model_switches_min": 5.58, "num_model_switches_max": 6.45, "num_slav_mean": 0.16318216666666666, "num_slav_min": 0.14359999999999998, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.674200000000001, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.6, "mean_cluster_cpu_util_mean": 0.5694089086706293, "mean_cluster_cpu_util_min": 0.5480282268657708, "mean_cluster_cpu_util_max": 0.5991822411416254, "mean_cluster_mem_util_mean": 0.36538836288893184, "mean_cluster_mem_util_min": 0.35706379219409284, "mean_cluster_mem_util_max": 0.3809842875441316, "reward_consolidation_mean_mean": 0.3636609811447195, "reward_consolidation_mean_min": 0.20143592555362638, "reward_consolidation_mean_max": 0.53295089707271, "reward_illegal_mean_mean": -1.7361666666666664, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.9463333333333337, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.391666666666668, "reward_sla_mean_mean": -1.26984, "reward_sla_mean_min": -2.106666666666667, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": 36.36609811447196, "reward_consolidation_sum_min": 20.143592555362638, "reward_consolidation_sum_max": 53.295089707271, "reward_illegal_sum_mean": -173.61666666666665, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 94.63333333333338, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 139.1666666666668, "reward_sla_sum_mean": -126.98400000000001, "reward_sla_sum_min": -210.66666666666669, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3978.0, "global_timestep_min": 2100, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-180.55404368089168, -162.92774376313636, -165.63498126656305, -182.83067409911956, -179.30986627676742, -158.98172652228217, -179.77232629687157, -164.15074781443224, -186.5797739803222, -170.1145633433854, -159.66715708672206, -170.8824057997503, -193.01465777209162, -170.3603764963905, -185.5425477474184, -191.16331292454828, -168.66776935026954, -196.50830972615665, -162.47870480367973, -182.09535776295334, -177.48920466660562, -152.904910292729, -206.2880075542963, -194.3324682445398, -165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24434800530639947, "mean_inference_ms": 2.0140973106839444, "mean_action_processing_ms": 0.09126771665010647, "mean_env_wait_ms": 1.7367205732550932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005789995193481445, "StateBufferConnector_ms": 0.0034074783325195312, "ViewRequirementAgentConnector_ms": 0.08795928955078125}, "num_episodes": 24, "episode_return_max": -136.2317828748973, "episode_return_min": -211.3075055591091, "episode_return_mean": -169.60123521886138, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 233.12373726847028, "num_env_steps_trained_throughput_per_sec": 213.6967591627644, "timesteps_total": 16950, "num_env_steps_sampled_lifetime": 16950, "num_agent_steps_sampled_lifetime": 16950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 16950, "timers": {"training_iteration_time_ms": 10341.424, "restore_workers_time_ms": 0.012, "training_step_time_ms": 636.827, "sample_time_ms": 622.29, "synch_weights_time_ms": 13.22}, "counters": {"num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 113, "num_samples_added_to_queue": 16500}, "done": false, "training_iteration": 7, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-31", "timestamp": 1728774871, "time_this_iter_s": 10.305388689041138, "time_total_s": 72.469651222229, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575e4b91b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.469651222229, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.566666666666666, "ram_util_percent": 45.573333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -327380.84375, "policy_loss": -328624.59375, "entropy": 29.81463050842285, "entropy_coeff": 0.01, "var_gnorm": 16.00276756286621, "vf_loss": 140771.890625, "vf_explained_var": 0.003615140914916992}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 129, "num_samples_added_to_queue": 19250, "learner_queue": {"size_count": 34, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.969, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 2349.983, "learner_dequeue_time_ms": 15596.326}}, "env_runners": {"episode_reward_max": -132.30867221054575, "episode_reward_min": -211.3075055591091, "episode_reward_mean": -167.4549665844222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.3075055591091}, "policy_reward_max": {"default_policy": -132.30867221054575}, "policy_reward_mean": {"default_policy": -167.4549665844222}, "custom_metrics": {"num_consolidated_mean": 0.6727, "num_consolidated_min": 0.53, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0336, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 9.9916, "num_moves_min": 9.59, "num_moves_max": 10.42, "mean_accuracy_mean": 41.11412333333334, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.004099999999998, "num_model_switches_min": 5.57, "num_model_switches_max": 6.45, "num_slav_mean": 0.163529, "num_slav_min": 0.14801666666666669, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6444, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.6, "mean_cluster_cpu_util_mean": 0.5678865564416987, "mean_cluster_cpu_util_min": 0.5434197157243026, "mean_cluster_cpu_util_max": 0.5991822411416254, "mean_cluster_mem_util_mean": 0.36464105048221823, "mean_cluster_mem_util_min": 0.353862694465972, "mean_cluster_mem_util_max": 0.3809842875441316, "reward_consolidation_mean_mean": 0.37233700082244353, "reward_consolidation_mean_min": 0.20143592555362638, "reward_consolidation_mean_max": 0.5812466112278778, "reward_illegal_mean_mean": -1.7226666666666666, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.967166666666667, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.391666666666668, "reward_sla_mean_mean": -1.2913866666666667, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": 37.23370008224436, "reward_consolidation_sum_min": 20.143592555362638, "reward_consolidation_sum_max": 58.12466112278778, "reward_illegal_sum_mean": -172.26666666666668, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 96.7166666666667, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 139.1666666666668, "reward_sla_sum_mean": -129.13866666666667, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4778.0, "global_timestep_min": 2900, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-165.07356910049052, -167.7277864083583, -165.2891437448596, -176.84018702976022, -149.60171799323763, -155.7515611197417, -159.79399311584254, -177.96727283803943, -165.31962898656664, -180.19140394163688, -182.4462548356635, -151.99315848792233, -159.1427640196168, -174.2182064637973, -187.1092722897438, -164.85012945871014, -180.14251728654529, -143.8175667854641, -188.53640683541965, -173.70307350208643, -178.79650309177856, -156.69950348776982, -157.35199671022585, -165.63325413506357, -171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2449951501210321, "mean_inference_ms": 2.0227794470223994, "mean_action_processing_ms": 0.09160778476484317, "mean_env_wait_ms": 1.7447641049434608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005852699279785156, "StateBufferConnector_ms": 0.0034325122833251953, "ViewRequirementAgentConnector_ms": 0.0892188549041748}, "num_episodes": 24, "episode_return_max": -132.30867221054575, "episode_return_min": -211.3075055591091, "episode_return_mean": -167.4549665844222, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 228.69352774206342, "num_env_steps_trained_throughput_per_sec": 209.63573376355814, "timesteps_total": 19350, "num_env_steps_sampled_lifetime": 19350, "num_agent_steps_sampled_lifetime": 19350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 19350, "timers": {"training_iteration_time_ms": 10360.546, "restore_workers_time_ms": 0.017, "training_step_time_ms": 655.823, "sample_time_ms": 639.96, "synch_weights_time_ms": 14.478}, "counters": {"num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 129, "num_samples_added_to_queue": 19250}, "done": false, "training_iteration": 8, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-42", "timestamp": 1728774882, "time_this_iter_s": 10.509394407272339, "time_total_s": 82.97904562950134, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0bd00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.97904562950134, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.74, "ram_util_percent": 45.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -348253.15625, "policy_loss": -349668.40625, "entropy": 29.8132381439209, "entropy_coeff": 0.01, "var_gnorm": 16.004365921020508, "vf_loss": 157922.5625, "vf_explained_var": 0.004526317119598389}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 145, "num_samples_added_to_queue": 21450, "learner_queue": {"size_count": 39, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.603, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 2260.277, "learner_dequeue_time_ms": 15596.326}}, "env_runners": {"episode_reward_max": -132.30867221054575, "episode_reward_min": -211.3075055591091, "episode_reward_mean": -167.4310246428462, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.3075055591091}, "policy_reward_max": {"default_policy": -132.30867221054575}, "policy_reward_mean": {"default_policy": -167.4310246428462}, "custom_metrics": {"num_consolidated_mean": 0.6747, "num_consolidated_min": 0.53, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0292999999999999, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 10.004800000000001, "num_moves_min": 9.68, "num_moves_max": 10.42, "mean_accuracy_mean": 41.11228666666667, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.31533333333333, "num_model_switches_mean": 6.0295000000000005, "num_model_switches_min": 5.57, "num_model_switches_max": 6.43, "num_slav_mean": 0.16289433333333336, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6484000000000005, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.567580282393333, "mean_cluster_cpu_util_min": 0.5434197157243026, "mean_cluster_cpu_util_max": 0.586004885204677, "mean_cluster_mem_util_mean": 0.3645282698986768, "mean_cluster_mem_util_min": 0.353862694465972, "mean_cluster_mem_util_max": 0.3743417029047906, "reward_consolidation_mean_mean": 0.3774430869048707, "reward_consolidation_mean_min": 0.20143592555362638, "reward_consolidation_mean_max": 0.5812466112278778, "reward_illegal_mean_mean": -1.7154999999999998, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.9778333333333338, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.391666666666668, "reward_sla_mean_mean": -1.3140866666666664, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": 37.74430869048707, "reward_consolidation_sum_min": 20.143592555362638, "reward_consolidation_sum_max": 58.12466112278778, "reward_illegal_sum_mean": -171.55, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 97.78333333333336, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 139.1666666666668, "reward_sla_sum_mean": -131.40866666666665, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5578.0, "global_timestep_min": 3700, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-171.34906332815504, -136.2317828748973, -163.3946998080966, -153.9227847330105, -152.5352188613726, -172.1993054920951, -164.74357427883868, -157.0932803314143, -166.87243900210166, -170.44453379633848, -161.94090590636316, -144.87860732888598, -137.18536355051938, -174.5926162843826, -196.38812330561393, -186.7879649090743, -173.19084650766075, -152.67294160650644, -171.3236345913674, -141.54349812665635, -168.8011300983885, -179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2456464183580524, "mean_inference_ms": 2.0283183040561044, "mean_action_processing_ms": 0.09183540789363155, "mean_env_wait_ms": 1.7507510249910758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005858659744262695, "StateBufferConnector_ms": 0.0034627914428710938, "ViewRequirementAgentConnector_ms": 0.0884850025177002}, "num_episodes": 24, "episode_return_max": -132.30867221054575, "episode_return_min": -211.3075055591091, "episode_return_mean": -167.4310246428462, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 233.52619221587526, "num_env_steps_trained_throughput_per_sec": 267.5820952473571, "timesteps_total": 21750, "num_env_steps_sampled_lifetime": 21750, "num_agent_steps_sampled_lifetime": 21750, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 21750, "timers": {"training_iteration_time_ms": 10351.288, "restore_workers_time_ms": 0.013, "training_step_time_ms": 638.121, "sample_time_ms": 622.703, "synch_weights_time_ms": 13.95}, "counters": {"num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 145, "num_samples_added_to_queue": 21450}, "done": false, "training_iteration": 9, "trial_id": "90ffb_00000", "date": "2024-10-13_00-14-52", "timestamp": 1728774892, "time_this_iter_s": 10.288883686065674, "time_total_s": 93.26792931556702, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0a590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.26792931556702, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.040000000000003, "ram_util_percent": 45.91333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -322550.90625, "policy_loss": -323788.625, "entropy": 29.812536239624023, "entropy_coeff": 0.01, "var_gnorm": 16.005096435546875, "vf_loss": 140168.921875, "vf_explained_var": 0.0045760273933410645}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 23700, "num_env_steps_trained": 23100, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 158, "num_samples_added_to_queue": 23650, "learner_queue": {"size_count": 42, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.651, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 2475.131, "learner_dequeue_time_ms": 16381.681}}, "env_runners": {"episode_reward_max": -113.40068232355542, "episode_reward_min": -211.3075055591091, "episode_reward_mean": -168.1432714368393, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.3075055591091}, "policy_reward_max": {"default_policy": -113.40068232355542}, "policy_reward_mean": {"default_policy": -168.1432714368393}, "custom_metrics": {"num_consolidated_mean": 0.6777, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0288000000000002, "num_overloaded_min": 0.85, "num_overloaded_max": 1.18, "num_moves_mean": 10.012500000000001, "num_moves_min": 9.56, "num_moves_max": 10.42, "mean_accuracy_mean": 41.11272999999999, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.017199999999998, "num_model_switches_min": 5.57, "num_model_switches_max": 6.43, "num_slav_mean": 0.162651, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6859999999999995, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5686581847264813, "mean_cluster_cpu_util_min": 0.5434197157243026, "mean_cluster_cpu_util_max": 0.586004885204677, "mean_cluster_mem_util_mean": 0.36510565524986377, "mean_cluster_mem_util_min": 0.353862694465972, "mean_cluster_mem_util_max": 0.3743417029047906, "reward_consolidation_mean_mean": 0.3793039522982729, "reward_consolidation_mean_min": 0.20143592555362638, "reward_consolidation_mean_max": 0.6193265100977794, "reward_illegal_mean_mean": -1.7146666666666663, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 0.9887500000000005, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.5833333333333337, "reward_sla_mean_mean": -1.3348200000000003, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": 37.93039522982729, "reward_consolidation_sum_min": 20.143592555362638, "reward_consolidation_sum_max": 61.93265100977794, "reward_illegal_sum_mean": -171.46666666666664, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 98.87500000000001, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 158.33333333333337, "reward_sla_sum_mean": -133.482, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6033.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.2562185872246, -159.3150507173535, -160.17095555758627, -154.1990739894604, -179.02083523713773, -152.74516433640994, -172.34927655426594, -165.73632763715014, -177.45042797526565, -153.4845685217337, -161.27418745621242, -163.69052057631973, -192.92307411130392, -166.99812056413535, -211.3075055591091, -188.35092144140842, -194.45583478022468, -165.66231076182623, -168.72010417618557, -171.10518748667337, -199.0646806177465, -163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.246784092337574, "mean_inference_ms": 2.037140953268316, "mean_action_processing_ms": 0.09218002148120837, "mean_env_wait_ms": 1.7587945065081998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060269832611083984, "StateBufferConnector_ms": 0.003554821014404297, "ViewRequirementAgentConnector_ms": 0.09153366088867188}, "num_episodes": 21, "episode_return_max": -113.40068232355542, "episode_return_min": -211.3075055591091, "episode_return_mean": -168.1432714368393, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23100, "num_env_steps_sampled": 23700, "num_env_steps_trained": 23100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 194.80701383991092, "num_env_steps_trained_throughput_per_sec": 164.83670401838617, "timesteps_total": 23700, "num_env_steps_sampled_lifetime": 23700, "num_agent_steps_sampled_lifetime": 23700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 23700, "timers": {"training_iteration_time_ms": 10317.151, "restore_workers_time_ms": 0.016, "training_step_time_ms": 789.287, "sample_time_ms": 772.071, "synch_weights_time_ms": 15.74}, "counters": {"num_env_steps_sampled": 23700, "num_env_steps_trained": 23100, "num_agent_steps_sampled": 23700, "num_agent_steps_trained": 23100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 158, "num_samples_added_to_queue": 23650}, "done": false, "training_iteration": 10, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-02", "timestamp": 1728774902, "time_this_iter_s": 10.023471593856812, "time_total_s": 103.29140090942383, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5e40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.29140090942383, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.392857142857142, "ram_util_percent": 48.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -305080.6875, "policy_loss": -306203.75, "entropy": 29.81085968017578, "entropy_coeff": 0.01, "var_gnorm": 16.00664710998535, "vf_loss": 128702.828125, "vf_explained_var": 0.004867911338806152}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25300, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 173, "num_samples_added_to_queue": 25850, "learner_queue": {"size_count": 46, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.765, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 2526.204, "learner_dequeue_time_ms": 16381.681}}, "env_runners": {"episode_reward_max": -110.6321057601511, "episode_reward_min": -201.3609186999299, "episode_reward_mean": -165.30374979438903, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.3609186999299}, "policy_reward_max": {"default_policy": -110.6321057601511}, "policy_reward_mean": {"default_policy": -165.30374979438903}, "custom_metrics": {"num_consolidated_mean": 0.6764000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0164000000000002, "num_overloaded_min": 0.85, "num_overloaded_max": 1.15, "num_moves_mean": 9.982999999999999, "num_moves_min": 9.56, "num_moves_max": 10.42, "mean_accuracy_mean": 41.10918333333334, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.008400000000002, "num_model_switches_min": 5.39, "num_model_switches_max": 6.43, "num_slav_mean": 0.16206833333333337, "num_slav_min": 0.13405, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6684, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5675532081700468, "mean_cluster_cpu_util_min": 0.5434197157243026, "mean_cluster_cpu_util_max": 0.5921442387639834, "mean_cluster_mem_util_mean": 0.3646551212075548, "mean_cluster_mem_util_min": 0.353862694465972, "mean_cluster_mem_util_max": 0.3743422340982807, "reward_consolidation_mean_mean": 0.3915258353894422, "reward_consolidation_mean_min": 0.24687974047336197, "reward_consolidation_mean_max": 0.6193265100977794, "reward_illegal_mean_mean": -1.6939999999999995, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.416666666666666, "reward_accuracy_mean_mean": 1.0237500000000002, "reward_accuracy_mean_min": 0.5749999999999997, "reward_accuracy_mean_max": 1.6000000000000014, "reward_sla_mean_mean": -1.374313333333333, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7833333333333333, "reward_consolidation_sum_mean": 39.15258353894423, "reward_consolidation_sum_min": 24.687974047336198, "reward_consolidation_sum_max": 61.93265100977794, "reward_illegal_sum_mean": -169.39999999999998, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -141.6666666666666, "reward_accuracy_sum_mean": 102.37500000000004, "reward_accuracy_sum_min": 57.49999999999997, "reward_accuracy_sum_max": 160.00000000000014, "reward_sla_sum_mean": -137.43133333333333, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -78.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5094.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-163.5979804441194, -144.4244539888513, -149.04263608395024, -181.44887142465478, -152.6456547564653, -171.02400316793083, -183.49702092661963, -167.55147887538442, -149.79360017058087, -171.47665174083897, -181.47017880532445, -162.51812726552757, -177.51347589021887, -184.79217155563657, -196.49834597459534, -181.0223521886137, -157.75516159493125, -155.53553260836443, -186.94587102866362, -157.40415790916575, -175.1850924487495, -193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2477341577492818, "mean_inference_ms": 2.0472857477504247, "mean_action_processing_ms": 0.09247782102793227, "mean_env_wait_ms": 1.7667469244164713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00585174560546875, "StateBufferConnector_ms": 0.0034410953521728516, "ViewRequirementAgentConnector_ms": 0.08937525749206543}, "num_episodes": 21, "episode_return_max": -110.6321057601511, "episode_return_min": -201.3609186999299, "episode_return_mean": -165.30374979438903, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25300, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 220.35645820734166, "num_env_steps_trained_throughput_per_sec": 215.45964802495627, "timesteps_total": 25950, "num_env_steps_sampled_lifetime": 25950, "num_agent_steps_sampled_lifetime": 25950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 25950, "timers": {"training_iteration_time_ms": 10294.505, "restore_workers_time_ms": 0.015, "training_step_time_ms": 693.528, "sample_time_ms": 677.871, "synch_weights_time_ms": 14.172}, "counters": {"num_env_steps_sampled": 25950, "num_env_steps_trained": 25300, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 173, "num_samples_added_to_queue": 25850}, "done": false, "training_iteration": 11, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-13", "timestamp": 1728774913, "time_this_iter_s": 10.22141146659851, "time_total_s": 113.51281237602234, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0aec0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.51281237602234, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.60666666666667, "ram_util_percent": 48.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -311845.65625, "policy_loss": -312948.9375, "entropy": 29.80891990661621, "entropy_coeff": 0.01, "var_gnorm": 16.008520126342773, "vf_loss": 126722.6875, "vf_explained_var": 0.007365167140960693}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 28050, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 28050, "num_agent_steps_trained": 27500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 187, "num_samples_added_to_queue": 28050, "learner_queue": {"size_count": 50, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.77, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 2482.156, "learner_dequeue_time_ms": 16974.136}}, "env_runners": {"episode_reward_max": -110.6321057601511, "episode_reward_min": -206.09552225166755, "episode_reward_mean": -165.33289704224916, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.09552225166755}, "policy_reward_max": {"default_policy": -110.6321057601511}, "policy_reward_mean": {"default_policy": -165.33289704224916}, "custom_metrics": {"num_consolidated_mean": 0.6750000000000002, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0154, "num_overloaded_min": 0.85, "num_overloaded_max": 1.15, "num_moves_mean": 9.989700000000001, "num_moves_min": 9.56, "num_moves_max": 10.36, "mean_accuracy_mean": 41.106586666666665, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.019400000000001, "num_model_switches_min": 5.39, "num_model_switches_max": 6.41, "num_slav_mean": 0.16238900000000003, "num_slav_min": 0.13405, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6568, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5668123814078266, "mean_cluster_cpu_util_min": 0.5434197157243026, "mean_cluster_cpu_util_max": 0.5921442387639834, "mean_cluster_mem_util_mean": 0.364417356073653, "mean_cluster_mem_util_min": 0.353862694465972, "mean_cluster_mem_util_max": 0.3743422340982807, "reward_consolidation_mean_mean": 0.39498436291084105, "reward_consolidation_mean_min": 0.242155563678455, "reward_consolidation_mean_max": 0.6193265100977794, "reward_illegal_mean_mean": -1.6923333333333332, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.416666666666666, "reward_accuracy_mean_mean": 1.0350000000000004, "reward_accuracy_mean_min": 0.5749999999999997, "reward_accuracy_mean_max": 1.6000000000000014, "reward_sla_mean_mean": -1.3909799999999999, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7533333333333333, "reward_consolidation_sum_mean": 39.4984362910841, "reward_consolidation_sum_min": 24.2155563678455, "reward_consolidation_sum_max": 61.93265100977794, "reward_illegal_sum_mean": -169.23333333333332, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -141.6666666666666, "reward_accuracy_sum_mean": 103.50000000000001, "reward_accuracy_sum_min": 57.49999999999997, "reward_accuracy_sum_max": 160.00000000000014, "reward_sla_sum_mean": -139.098, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -75.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4157.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-193.9207164397331, -167.23971488622854, -162.4658990526668, -150.87710256175933, -169.32535258460507, -169.76046787900938, -132.30867221054575, -149.3092083219105, -189.7453592859971, -135.68481830089254, -178.5365469554356, -157.49788296932584, -154.3125651101159, -165.44198422126786, -187.4373115233481, -165.61969295439988, -188.05277041640014, -179.42785342227901, -175.6504432057022, -187.3470559566237, -186.5315757409606, -167.14972432909926, -145.08207986840893, -149.21659508361515, -160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2489426471681285, "mean_inference_ms": 2.061460583429997, "mean_action_processing_ms": 0.09283614317418226, "mean_env_wait_ms": 1.7762625171264965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005814075469970703, "StateBufferConnector_ms": 0.0034253597259521484, "ViewRequirementAgentConnector_ms": 0.0893402099609375}, "num_episodes": 21, "episode_return_max": -110.6321057601511, "episode_return_min": -206.09552225166755, "episode_return_mean": -165.33289704224916, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28050, "num_agent_steps_trained": 27500, "num_env_steps_sampled": 28050, "num_env_steps_trained": 27500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.22523435356953, "num_env_steps_trained_throughput_per_sec": 219.18834075135857, "timesteps_total": 28050, "num_env_steps_sampled_lifetime": 28050, "num_agent_steps_sampled_lifetime": 28050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 28050, "timers": {"training_iteration_time_ms": 10277.533, "restore_workers_time_ms": 0.014, "training_step_time_ms": 720.349, "sample_time_ms": 704.265, "synch_weights_time_ms": 14.592}, "counters": {"num_env_steps_sampled": 28050, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 28050, "num_agent_steps_trained": 27500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 187, "num_samples_added_to_queue": 28050}, "done": false, "training_iteration": 12, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-23", "timestamp": 1728774923, "time_this_iter_s": 10.048417806625366, "time_total_s": 123.5612301826477, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.5612301826477, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.714285714285715, "ram_util_percent": 50.192857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -330393.28125, "policy_loss": -331673.15625, "entropy": 29.807188034057617, "entropy_coeff": 0.01, "var_gnorm": 16.010419845581055, "vf_loss": 144380.828125, "vf_explained_var": 0.0076045989990234375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 30450, "num_env_steps_trained": 30250, "num_agent_steps_sampled": 30450, "num_agent_steps_trained": 30250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 203, "num_samples_added_to_queue": 30250, "learner_queue": {"size_count": 55, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.256, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 2465.827, "learner_dequeue_time_ms": 16974.136}}, "env_runners": {"episode_reward_max": -110.6321057601511, "episode_reward_min": -206.09552225166755, "episode_reward_mean": -164.54483170367655, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.09552225166755}, "policy_reward_max": {"default_policy": -110.6321057601511}, "policy_reward_mean": {"default_policy": -164.54483170367655}, "custom_metrics": {"num_consolidated_mean": 0.6732999999999998, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0123, "num_overloaded_min": 0.85, "num_overloaded_max": 1.13, "num_moves_mean": 9.998899999999999, "num_moves_min": 9.56, "num_moves_max": 10.36, "mean_accuracy_mean": 41.10614333333333, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.019900000000002, "num_model_switches_min": 5.39, "num_model_switches_max": 6.41, "num_slav_mean": 0.16150933333333334, "num_slav_min": 0.13405, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6645999999999996, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5666369347624132, "mean_cluster_cpu_util_min": 0.5485541969930039, "mean_cluster_cpu_util_max": 0.5921442387639834, "mean_cluster_mem_util_mean": 0.36435613375814463, "mean_cluster_mem_util_min": 0.35493044343264724, "mean_cluster_mem_util_max": 0.3743422340982807, "reward_consolidation_mean_mean": 0.39913501629656717, "reward_consolidation_mean_min": 0.242155563678455, "reward_consolidation_mean_max": 0.6193265100977794, "reward_illegal_mean_mean": -1.6871666666666665, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.416666666666666, "reward_accuracy_mean_mean": 1.0464166666666672, "reward_accuracy_mean_min": 0.6500000000000001, "reward_accuracy_mean_max": 1.6000000000000014, "reward_sla_mean_mean": -1.4038333333333333, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7533333333333333, "reward_consolidation_sum_mean": 39.9135016296567, "reward_consolidation_sum_min": 24.2155563678455, "reward_consolidation_sum_max": 61.93265100977794, "reward_illegal_sum_mean": -168.71666666666664, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -141.6666666666666, "reward_accuracy_sum_mean": 104.6416666666667, "reward_accuracy_sum_min": 65.00000000000001, "reward_accuracy_sum_max": 160.00000000000014, "reward_sla_sum_mean": -140.38333333333333, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -75.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3085.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.12651009777937, -148.77098601845935, -166.7267020012791, -173.6388284748241, -185.15630996984373, -155.34214261780727, -201.3609186999299, -160.16073898077914, -151.76436991684182, -134.25138444667837, -148.52902616588986, -176.7457522312587, -166.07192116726063, -189.93186816534157, -179.38628042279683, -149.2527155868288, -165.15294708946345, -188.57984708641732, -164.19970148344453, -157.45215206067795, -146.9500898595755, -197.80648207377607, -161.82159980505037, -148.7470376800999, -192.15750098997825, -162.6011453288249, -182.41839836729702, -113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2500703035876951, "mean_inference_ms": 2.0756176924119853, "mean_action_processing_ms": 0.0931589320785608, "mean_env_wait_ms": 1.785233647353329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005860567092895508, "StateBufferConnector_ms": 0.003402233123779297, "ViewRequirementAgentConnector_ms": 0.0890512466430664}, "num_episodes": 24, "episode_return_max": -110.6321057601511, "episode_return_min": -206.09552225166755, "episode_return_mean": -164.54483170367655, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30450, "num_agent_steps_trained": 30250, "num_env_steps_sampled": 30450, "num_env_steps_trained": 30250, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 236.91363559253583, "num_env_steps_trained_throughput_per_sec": 271.46354078311396, "timesteps_total": 30450, "num_env_steps_sampled_lifetime": 30450, "num_agent_steps_sampled_lifetime": 30450, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 30450, "timers": {"training_iteration_time_ms": 10263.664, "restore_workers_time_ms": 0.012, "training_step_time_ms": 632.313, "sample_time_ms": 616.681, "synch_weights_time_ms": 14.145}, "counters": {"num_env_steps_sampled": 30450, "num_env_steps_trained": 30250, "num_agent_steps_sampled": 30450, "num_agent_steps_trained": 30250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 203, "num_samples_added_to_queue": 30250}, "done": false, "training_iteration": 13, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-33", "timestamp": 1728774933, "time_this_iter_s": 10.141345977783203, "time_total_s": 133.7025761604309, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef098d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.7025761604309, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.013333333333335, "ram_util_percent": 48.93333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -307010.375, "policy_loss": -308063.75, "entropy": 29.805625915527344, "entropy_coeff": 0.01, "var_gnorm": 16.01226806640625, "vf_loss": 121732.125, "vf_explained_var": 0.009903967380523682}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 32450, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 220, "num_samples_added_to_queue": 33000, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.655, "learner_load_time_ms": 0.311, "learner_load_wait_time_ms": 2206.81, "learner_dequeue_time_ms": 17248.975}}, "env_runners": {"episode_reward_max": -110.6321057601511, "episode_reward_min": -206.09552225166755, "episode_reward_mean": -163.4089386518017, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.09552225166755}, "policy_reward_max": {"default_policy": -110.6321057601511}, "policy_reward_mean": {"default_policy": -163.4089386518017}, "custom_metrics": {"num_consolidated_mean": 0.6638999999999998, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0119, "num_overloaded_min": 0.85, "num_overloaded_max": 1.13, "num_moves_mean": 9.986, "num_moves_min": 9.58, "num_moves_max": 10.36, "mean_accuracy_mean": 41.09417333333333, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.0071, "num_model_switches_min": 5.39, "num_model_switches_max": 6.31, "num_slav_mean": 0.1600371666666667, "num_slav_min": 0.13405, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6173999999999995, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5656387579574558, "mean_cluster_cpu_util_min": 0.5485541969930039, "mean_cluster_cpu_util_max": 0.5921442387639834, "mean_cluster_mem_util_mean": 0.36377601675564747, "mean_cluster_mem_util_min": 0.35493044343264724, "mean_cluster_mem_util_max": 0.3743422340982807, "reward_consolidation_mean_mean": 0.39364061348198226, "reward_consolidation_mean_min": 0.21527079716104663, "reward_consolidation_mean_max": 0.6193265100977794, "reward_illegal_mean_mean": -1.6864999999999997, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.416666666666666, "reward_accuracy_mean_mean": 1.0302500000000006, "reward_accuracy_mean_min": 0.5666666666666663, "reward_accuracy_mean_max": 1.6000000000000014, "reward_sla_mean_mean": -1.37148, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7533333333333333, "reward_consolidation_sum_mean": 39.364061348198234, "reward_consolidation_sum_min": 21.527079716104662, "reward_consolidation_sum_max": 61.93265100977794, "reward_illegal_sum_mean": -168.64999999999998, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -141.6666666666666, "reward_accuracy_sum_mean": 103.02500000000003, "reward_accuracy_sum_min": 56.66666666666663, "reward_accuracy_sum_max": 160.00000000000014, "reward_sla_sum_mean": -137.148, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -75.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2035.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-113.40068232355542, -194.44412562064016, -137.6143623016234, -146.50438027353866, -166.07976788814767, -161.5183039385909, -183.29760577538147, -187.90892808187883, -196.15409851046326, -174.01337536933804, -174.28455024521006, -178.14793018367902, -134.4249322245573, -186.49203448170806, -160.7800785890524, -152.52929117548496, -115.74654421395729, -167.1901733223674, -140.74936489079775, -161.210560784672, -110.6321057601511, -160.16113192604095, -155.54044290109348, -159.7261384751286, -150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508125099798764, "mean_inference_ms": 2.0861809931400876, "mean_action_processing_ms": 0.09329639314871965, "mean_env_wait_ms": 1.7911272144063304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006137847900390625, "StateBufferConnector_ms": 0.0033028125762939453, "ViewRequirementAgentConnector_ms": 0.08615875244140625}, "num_episodes": 27, "episode_return_max": -110.6321057601511, "episode_return_min": -206.09552225166755, "episode_return_mean": -163.4089386518017, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32450, "num_env_steps_sampled": 33000, "num_env_steps_trained": 32450, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 241.375153013651, "num_env_steps_trained_throughput_per_sec": 208.245230050993, "timesteps_total": 33000, "num_env_steps_sampled_lifetime": 33000, "num_agent_steps_sampled_lifetime": 33000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 10294.11, "restore_workers_time_ms": 0.014, "training_step_time_ms": 612.328, "sample_time_ms": 599.063, "synch_weights_time_ms": 11.843}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 32450, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 220, "num_samples_added_to_queue": 33000}, "done": false, "training_iteration": 14, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-43", "timestamp": 1728774943, "time_this_iter_s": 10.575974225997925, "time_total_s": 144.27855038642883, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.27855038642883, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.76, "ram_util_percent": 48.67333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -295496.21875, "policy_loss": -296553.65625, "entropy": 29.80292320251465, "entropy_coeff": 0.01, "var_gnorm": 16.014474868774414, "vf_loss": 122134.6640625, "vf_explained_var": 0.008588612079620361}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35200, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 236, "num_samples_added_to_queue": 35200, "learner_queue": {"size_count": 64, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.605, "learner_load_time_ms": 0.311, "learner_load_wait_time_ms": 2249.123, "learner_dequeue_time_ms": 17248.975}}, "env_runners": {"episode_reward_max": -114.73105790611972, "episode_reward_min": -206.09552225166755, "episode_reward_mean": -163.45592710713083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.09552225166755}, "policy_reward_max": {"default_policy": -114.73105790611972}, "policy_reward_mean": {"default_policy": -163.45592710713083}, "custom_metrics": {"num_consolidated_mean": 0.6643000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0142, "num_overloaded_min": 0.85, "num_overloaded_max": 1.13, "num_moves_mean": 10.0082, "num_moves_min": 9.7, "num_moves_max": 10.36, "mean_accuracy_mean": 41.07764333333334, "mean_accuracy_min": 40.87833333333333, "mean_accuracy_max": 41.251999999999995, "num_model_switches_mean": 6.0245999999999995, "num_model_switches_min": 5.61, "num_model_switches_max": 6.31, "num_slav_mean": 0.15934700000000002, "num_slav_min": 0.13913333333333333, "num_slav_max": 0.1784166666666666, "cpu_conserved_cost_mean": 2.6148, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5649810484013938, "mean_cluster_cpu_util_min": 0.545338572903955, "mean_cluster_cpu_util_max": 0.5842250592773168, "mean_cluster_mem_util_mean": 0.36366160562336747, "mean_cluster_mem_util_min": 0.35493044343264724, "mean_cluster_mem_util_max": 0.37350296076236406, "reward_consolidation_mean_mean": 0.38834739559535775, "reward_consolidation_mean_min": 0.21527079716104663, "reward_consolidation_mean_max": 0.6033232812452405, "reward_illegal_mean_mean": -1.690333333333333, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 1.011166666666667, "reward_accuracy_mean_min": 0.5666666666666663, "reward_accuracy_mean_max": 1.6500000000000012, "reward_sla_mean_mean": -1.3437400000000002, "reward_sla_mean_min": -2.22, "reward_sla_mean_max": -0.7533333333333333, "reward_consolidation_sum_mean": 38.83473955953578, "reward_consolidation_sum_min": 21.527079716104662, "reward_consolidation_sum_max": 60.332328124524054, "reward_illegal_sum_mean": -169.03333333333327, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 101.11666666666672, "reward_accuracy_sum_min": 56.66666666666663, "reward_accuracy_sum_max": 165.0000000000001, "reward_sla_sum_mean": -134.374, "reward_sla_sum_min": -222.0, "reward_sla_sum_max": -75.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2378.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-150.4107344116482, -162.76149441042966, -158.041481616863, -166.42279082518505, -174.66798562246782, -195.64209692649777, -146.06624935270642, -149.66277072100868, -174.61777696548768, -159.01421304334576, -176.53992811233962, -183.5313198696273, -166.02294008346274, -206.09552225166755, -157.12298882085963, -169.92249230862961, -162.27598769380734, -171.2297084894452, -174.9041335404671, -175.1461329921714, -168.4867160132809, -132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2507398583459571, "mean_inference_ms": 2.0858666810503044, "mean_action_processing_ms": 0.09316525559737236, "mean_env_wait_ms": 1.790776707840681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006072998046875, "StateBufferConnector_ms": 0.003259420394897461, "ViewRequirementAgentConnector_ms": 0.08461499214172363}, "num_episodes": 24, "episode_return_max": -114.73105790611972, "episode_return_min": -206.09552225166755, "episode_return_mean": -163.45592710713083, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35200, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 237.58107991344176, "num_env_steps_trained_throughput_per_sec": 272.228320734152, "timesteps_total": 35400, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled_lifetime": 35400, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 35400, "timers": {"training_iteration_time_ms": 10273.091, "restore_workers_time_ms": 0.013, "training_step_time_ms": 626.454, "sample_time_ms": 611.104, "synch_weights_time_ms": 13.936}, "counters": {"num_env_steps_sampled": 35400, "num_env_steps_trained": 35200, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 236, "num_samples_added_to_queue": 35200}, "done": false, "training_iteration": 15, "trial_id": "90ffb_00000", "date": "2024-10-13_00-15-54", "timestamp": 1728774954, "time_this_iter_s": 10.11143708229065, "time_total_s": 154.38998746871948, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d696c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.38998746871948, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.82857142857143, "ram_util_percent": 48.92142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -290682.40625, "policy_loss": -291640.25, "entropy": 29.799928665161133, "entropy_coeff": 0.01, "var_gnorm": 16.016830444335938, "vf_loss": 112173.8671875, "vf_explained_var": 0.012072622776031494}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 37650, "num_env_steps_trained": 37400, "num_agent_steps_sampled": 37650, "num_agent_steps_trained": 37400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 251, "num_samples_added_to_queue": 37400, "learner_queue": {"size_count": 68, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.485, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 2320.314, "learner_dequeue_time_ms": 17418.079}}, "env_runners": {"episode_reward_max": -114.73105790611972, "episode_reward_min": -191.13759785555436, "episode_reward_mean": -160.45307295379084, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.13759785555436}, "policy_reward_max": {"default_policy": -114.73105790611972}, "policy_reward_mean": {"default_policy": -160.45307295379084}, "custom_metrics": {"num_consolidated_mean": 0.6667000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0079000000000002, "num_overloaded_min": 0.85, "num_overloaded_max": 1.13, "num_moves_mean": 9.9981, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.07789666666667, "mean_accuracy_min": 40.87833333333333, "mean_accuracy_max": 41.37866666666666, "num_model_switches_mean": 6.0131000000000006, "num_model_switches_min": 5.5, "num_model_switches_max": 6.43, "num_slav_mean": 0.15819983333333332, "num_slav_min": 0.13466666666666666, "num_slav_max": 0.1784166666666666, "cpu_conserved_cost_mean": 2.6182000000000003, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5647823902806395, "mean_cluster_cpu_util_min": 0.5414729171906124, "mean_cluster_cpu_util_max": 0.5842250592773168, "mean_cluster_mem_util_mean": 0.36341784517171843, "mean_cluster_mem_util_min": 0.35413636083125233, "mean_cluster_mem_util_max": 0.37350296076236406, "reward_consolidation_mean_mean": 0.3940992704620915, "reward_consolidation_mean_min": 0.21527079716104663, "reward_consolidation_mean_max": 0.6033232812452405, "reward_illegal_mean_mean": -1.6798333333333328, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 1.017916666666667, "reward_accuracy_mean_min": 0.5666666666666663, "reward_accuracy_mean_max": 1.6500000000000012, "reward_sla_mean_mean": -1.336713333333333, "reward_sla_mean_min": -2.22, "reward_sla_mean_max": -0.752, "reward_consolidation_sum_mean": 39.40992704620915, "reward_consolidation_sum_min": 21.527079716104662, "reward_consolidation_sum_max": 60.332328124524054, "reward_illegal_sum_mean": -167.9833333333333, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 101.7916666666667, "reward_accuracy_sum_min": 56.66666666666663, "reward_accuracy_sum_max": 165.0000000000001, "reward_sla_sum_mean": -133.67133333333334, "reward_sla_sum_min": -222.0, "reward_sla_sum_max": -75.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3078.0, "global_timestep_min": 1200, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-132.0374242285784, -172.72551098114474, -176.1562277254865, -162.18941789271668, -151.20881233056144, -178.50505955100678, -157.61396326418685, -160.11347893630634, -142.77174754028448, -158.93863352523667, -171.73050351823062, -156.73651344847542, -171.1858752931858, -150.3743062536172, -134.30008833653167, -174.46299613146905, -163.6655700752382, -180.0186359621066, -190.3336684029364, -185.75907886320013, -162.68154984921858, -164.54378141277542, -161.84246854914852, -156.23289774284925, -148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2504254871197285, "mean_inference_ms": 2.082649654931529, "mean_action_processing_ms": 0.09300843811877173, "mean_env_wait_ms": 1.7889437560815802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006044626235961914, "StateBufferConnector_ms": 0.0032532215118408203, "ViewRequirementAgentConnector_ms": 0.08400797843933105}, "num_episodes": 21, "episode_return_max": -114.73105790611972, "episode_return_min": -191.13759785555436, "episode_return_mean": -160.45307295379084, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37650, "num_agent_steps_trained": 37400, "num_env_steps_sampled": 37650, "num_env_steps_trained": 37400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 224.5197050443862, "num_env_steps_trained_throughput_per_sec": 219.53037826562206, "timesteps_total": 37650, "num_env_steps_sampled_lifetime": 37650, "num_agent_steps_sampled_lifetime": 37650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 37650, "timers": {"training_iteration_time_ms": 10214.228, "restore_workers_time_ms": 0.014, "training_step_time_ms": 688.152, "sample_time_ms": 672.698, "synch_weights_time_ms": 13.823}, "counters": {"num_env_steps_sampled": 37650, "num_env_steps_trained": 37400, "num_agent_steps_sampled": 37650, "num_agent_steps_trained": 37400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 251, "num_samples_added_to_queue": 37400}, "done": false, "training_iteration": 16, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-04", "timestamp": 1728774964, "time_this_iter_s": 10.030896663665771, "time_total_s": 164.42088413238525, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef51b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.42088413238525, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.660000000000004, "ram_util_percent": 49.28666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -297592.84375, "policy_loss": -298602.03125, "entropy": 29.795564651489258, "entropy_coeff": 0.01, "var_gnorm": 16.01982879638672, "vf_loss": 117307.09375, "vf_explained_var": 0.01335376501083374}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 40050, "num_env_steps_trained": 39600, "num_agent_steps_sampled": 40050, "num_agent_steps_trained": 39600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 267, "num_samples_added_to_queue": 39600, "learner_queue": {"size_count": 72, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.91, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 2287.255, "learner_dequeue_time_ms": 17418.079}}, "env_runners": {"episode_reward_max": -114.73105790611972, "episode_reward_min": -191.13759785555436, "episode_reward_mean": -159.7051668646623, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.13759785555436}, "policy_reward_max": {"default_policy": -114.73105790611972}, "policy_reward_mean": {"default_policy": -159.7051668646623}, "custom_metrics": {"num_consolidated_mean": 0.6627, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0053999999999998, "num_overloaded_min": 0.85, "num_overloaded_max": 1.13, "num_moves_mean": 9.9971, "num_moves_min": 9.7, "num_moves_max": 10.34, "mean_accuracy_mean": 41.066623333333325, "mean_accuracy_min": 40.872, "mean_accuracy_max": 41.37866666666666, "num_model_switches_mean": 6.014000000000001, "num_model_switches_min": 5.5, "num_model_switches_max": 6.43, "num_slav_mean": 0.15738850000000001, "num_slav_min": 0.13466666666666666, "num_slav_max": 0.1784166666666666, "cpu_conserved_cost_mean": 2.6072, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5641707319427158, "mean_cluster_cpu_util_min": 0.5414729171906124, "mean_cluster_cpu_util_max": 0.5842250592773168, "mean_cluster_mem_util_mean": 0.36316175478092094, "mean_cluster_mem_util_min": 0.35413636083125233, "mean_cluster_mem_util_max": 0.37350296076236406, "reward_consolidation_mean_mean": 0.39508499802004315, "reward_consolidation_mean_min": 0.21527079716104663, "reward_consolidation_mean_max": 0.6033232812452405, "reward_illegal_mean_mean": -1.6756666666666666, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 1.0215833333333335, "reward_accuracy_mean_min": 0.5666666666666663, "reward_accuracy_mean_max": 1.6500000000000012, "reward_sla_mean_mean": -1.3380533333333333, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7386666666666666, "reward_consolidation_sum_mean": 39.50849980200432, "reward_consolidation_sum_min": 21.527079716104662, "reward_consolidation_sum_max": 60.332328124524054, "reward_illegal_sum_mean": -167.56666666666663, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 102.15833333333336, "reward_accuracy_sum_min": 56.66666666666663, "reward_accuracy_sum_max": 165.0000000000001, "reward_sla_sum_mean": -133.80533333333332, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -73.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3878.0, "global_timestep_min": 2000, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-148.99741082579422, -190.80969569587853, -166.8626762923025, -149.44544762252892, -167.39326510097774, -177.92820372231873, -157.33018672515144, -175.7498461725913, -148.5298790703341, -163.17758688964022, -172.90294861250715, -149.09381948886661, -172.69204971214464, -157.26281641231822, -179.77912820981433, -181.9729202838952, -151.6242072557799, -164.10544945018137, -145.3610831886441, -164.33010448079435, -182.22627250296983, -189.07092814280054, -187.6908952450577, -148.34107039507754, -147.9805080873617, -168.84785098540928, -146.778698711505, -168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250091853001712, "mean_inference_ms": 2.0782409051746358, "mean_action_processing_ms": 0.09282573067288855, "mean_env_wait_ms": 1.786384699038584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005982875823974609, "StateBufferConnector_ms": 0.0032701492309570312, "ViewRequirementAgentConnector_ms": 0.08380389213562012}, "num_episodes": 24, "episode_return_max": -114.73105790611972, "episode_return_min": -191.13759785555436, "episode_return_mean": -159.7051668646623, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40050, "num_agent_steps_trained": 39600, "num_env_steps_sampled": 40050, "num_env_steps_trained": 39600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 235.3691969749338, "num_env_steps_trained_throughput_per_sec": 215.75509722702265, "timesteps_total": 40050, "num_env_steps_sampled_lifetime": 40050, "num_agent_steps_sampled_lifetime": 40050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 40050, "timers": {"training_iteration_time_ms": 10204.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 650.603, "sample_time_ms": 637.07, "synch_weights_time_ms": 12.146}, "counters": {"num_env_steps_sampled": 40050, "num_env_steps_trained": 39600, "num_agent_steps_sampled": 40050, "num_agent_steps_trained": 39600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 267, "num_samples_added_to_queue": 39600}, "done": false, "training_iteration": 17, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-14", "timestamp": 1728774974, "time_this_iter_s": 10.207552433013916, "time_total_s": 174.62843656539917, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575418d3f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 174.62843656539917, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.47142857142857, "ram_util_percent": 49.72857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -296760.4375, "policy_loss": -297780.625, "entropy": 29.78942108154297, "entropy_coeff": 0.01, "var_gnorm": 16.023578643798828, "vf_loss": 118403.3203125, "vf_explained_var": 0.014402389526367188}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 42600, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 284, "num_samples_added_to_queue": 42350, "learner_queue": {"size_count": 77, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.825, "learner_load_time_ms": 0.298, "learner_load_wait_time_ms": 2282.447, "learner_dequeue_time_ms": 17582.002}}, "env_runners": {"episode_reward_max": -114.73105790611972, "episode_reward_min": -191.13759785555436, "episode_reward_mean": -156.58699043528586, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.13759785555436}, "policy_reward_max": {"default_policy": -114.73105790611972}, "policy_reward_mean": {"default_policy": -156.58699043528586}, "custom_metrics": {"num_consolidated_mean": 0.6624999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.79, "num_overloaded_mean": 0.9947, "num_overloaded_min": 0.85, "num_overloaded_max": 1.14, "num_moves_mean": 9.998899999999999, "num_moves_min": 9.7, "num_moves_max": 10.34, "mean_accuracy_mean": 41.058706666666666, "mean_accuracy_min": 40.834, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 6.0112, "num_model_switches_min": 5.5, "num_model_switches_max": 6.43, "num_slav_mean": 0.15596816666666666, "num_slav_min": 0.13466666666666666, "num_slav_max": 0.1784166666666666, "cpu_conserved_cost_mean": 2.5982, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.16, "mean_cluster_cpu_util_mean": 0.5633755206846934, "mean_cluster_cpu_util_min": 0.5414729171906124, "mean_cluster_cpu_util_max": 0.5842250592773168, "mean_cluster_mem_util_mean": 0.3628323526902322, "mean_cluster_mem_util_min": 0.35305620102471363, "mean_cluster_mem_util_max": 0.37350296076236406, "reward_consolidation_mean_mean": 0.4083400956471411, "reward_consolidation_mean_min": 0.21645511590362176, "reward_consolidation_mean_max": 0.6033232812452405, "reward_illegal_mean_mean": -1.657833333333333, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 1.0430833333333336, "reward_accuracy_mean_min": 0.6000000000000001, "reward_accuracy_mean_max": 1.6500000000000012, "reward_sla_mean_mean": -1.35946, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7386666666666666, "reward_consolidation_sum_mean": 40.83400956471412, "reward_consolidation_sum_min": 21.645511590362176, "reward_consolidation_sum_max": 60.332328124524054, "reward_illegal_sum_mean": -165.78333333333333, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 104.30833333333334, "reward_accuracy_sum_min": 60.00000000000001, "reward_accuracy_sum_max": 165.0000000000001, "reward_sla_sum_mean": -135.94600000000003, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -73.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4778.0, "global_timestep_min": 2900, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-168.47479667367256, -149.11704895062306, -157.40611958938734, -126.34636754089377, -174.98742270553458, -188.2211550763044, -159.01847147339228, -163.59552834384218, -139.52178257028848, -125.46856437905527, -114.73105790611972, -154.5875993785981, -174.35515245666937, -173.1333759785555, -185.60078284443622, -129.67647202168817, -159.41348502848092, -179.30315574644376, -131.82054585884435, -142.49111151725606, -141.66767187547586, -166.00307654817368, -164.19457796460446, -166.58414206951159, -170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24972054375617656, "mean_inference_ms": 2.074063557033104, "mean_action_processing_ms": 0.09265922087861245, "mean_env_wait_ms": 1.7841048202955516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00555729866027832, "StateBufferConnector_ms": 0.0032994747161865234, "ViewRequirementAgentConnector_ms": 0.0845949649810791}, "num_episodes": 27, "episode_return_max": -114.73105790611972, "episode_return_min": -191.13759785555436, "episode_return_mean": -156.58699043528586, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42350, "num_env_steps_sampled": 42600, "num_env_steps_trained": 42350, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 240.06694910483586, "num_env_steps_trained_throughput_per_sec": 258.89572942678376, "timesteps_total": 42600, "num_env_steps_sampled_lifetime": 42600, "num_agent_steps_sampled_lifetime": 42600, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 42600, "timers": {"training_iteration_time_ms": 10217.172, "restore_workers_time_ms": 0.013, "training_step_time_ms": 637.369, "sample_time_ms": 620.628, "synch_weights_time_ms": 15.113}, "counters": {"num_env_steps_sampled": 42600, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 284, "num_samples_added_to_queue": 42350}, "done": false, "training_iteration": 18, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-25", "timestamp": 1728774985, "time_this_iter_s": 10.633488416671753, "time_total_s": 185.26192498207092, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575418c1c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.26192498207092, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.64, "ram_util_percent": 49.82666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -286190.21875, "policy_loss": -287135.6875, "entropy": 29.783292770385742, "entropy_coeff": 0.01, "var_gnorm": 16.027149200439453, "vf_loss": 110928.6953125, "vf_explained_var": 0.01634049415588379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 301, "num_samples_added_to_queue": 45100, "learner_queue": {"size_count": 81, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.226, "learner_load_time_ms": 0.316, "learner_load_wait_time_ms": 2251.91, "learner_dequeue_time_ms": 19161.816}}, "env_runners": {"episode_reward_max": -111.44609948521138, "episode_reward_min": -191.13759785555436, "episode_reward_mean": -156.47890322580645, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.13759785555436}, "policy_reward_max": {"default_policy": -111.44609948521138}, "policy_reward_mean": {"default_policy": -156.47890322580645}, "custom_metrics": {"num_consolidated_mean": 0.6616, "num_consolidated_min": 0.53, "num_consolidated_max": 0.79, "num_overloaded_mean": 0.9942000000000002, "num_overloaded_min": 0.81, "num_overloaded_max": 1.14, "num_moves_mean": 10.0156, "num_moves_min": 9.6, "num_moves_max": 10.34, "mean_accuracy_mean": 41.05712333333334, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 5.994299999999999, "num_model_switches_min": 5.5, "num_model_switches_max": 6.43, "num_slav_mean": 0.15579216666666665, "num_slav_min": 0.13466666666666666, "num_slav_max": 0.17183333333333337, "cpu_conserved_cost_mean": 2.5918, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.16, "mean_cluster_cpu_util_mean": 0.5628247680704126, "mean_cluster_cpu_util_min": 0.5414729171906124, "mean_cluster_cpu_util_max": 0.5781711824538666, "mean_cluster_mem_util_mean": 0.3624329860142369, "mean_cluster_mem_util_min": 0.35305620102471363, "mean_cluster_mem_util_max": 0.3692474141766411, "reward_consolidation_mean_mean": 0.41400430107526887, "reward_consolidation_mean_min": 0.22207636540863263, "reward_consolidation_mean_max": 0.6388723384812208, "reward_illegal_mean_mean": -1.6569999999999996, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 1.0528333333333333, "reward_accuracy_mean_min": 0.6499999999999991, "reward_accuracy_mean_max": 1.5583333333333345, "reward_sla_mean_mean": -1.3746266666666664, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7386666666666666, "reward_consolidation_sum_mean": 41.40043010752688, "reward_consolidation_sum_min": 22.207636540863263, "reward_consolidation_sum_max": 63.88723384812208, "reward_illegal_sum_mean": -165.69999999999996, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 105.28333333333335, "reward_accuracy_sum_min": 64.99999999999991, "reward_accuracy_sum_max": 155.83333333333346, "reward_sla_sum_mean": -137.46266666666668, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -73.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5578.0, "global_timestep_min": 3700, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-170.62320813914528, -169.0322946175637, -191.13759785555436, -158.08152243443303, -160.2502452100277, -158.2101800237594, -186.30088336531713, -152.64612689999694, -169.57049559840357, -140.56797039203136, -163.60409698741955, -152.34364433884662, -147.5327911297937, -138.50282372292796, -177.90620487983188, -163.86914922781696, -151.46464406469903, -156.1794815559413, -161.51804806725747, -118.45740960735947, -139.39711535532612, -129.81439276249668, -146.99773371104808, -174.50238204026914, -158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2494815487125078, "mean_inference_ms": 2.0706560703743344, "mean_action_processing_ms": 0.0925402102607445, "mean_env_wait_ms": 1.7824547022877482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00558161735534668, "StateBufferConnector_ms": 0.003340482711791992, "ViewRequirementAgentConnector_ms": 0.0853426456451416}, "num_episodes": 24, "episode_return_max": -111.44609948521138, "episode_return_min": -191.13759785555436, "episode_return_mean": -156.47890322580645, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 239.48321214423964, "num_env_steps_trained_throughput_per_sec": 206.61296734012834, "timesteps_total": 45150, "num_env_steps_sampled_lifetime": 45150, "num_agent_steps_sampled_lifetime": 45150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 45150, "timers": {"training_iteration_time_ms": 10254.243, "restore_workers_time_ms": 0.012, "training_step_time_ms": 624.2, "sample_time_ms": 608.556, "synch_weights_time_ms": 14.027}, "counters": {"num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 301, "num_samples_added_to_queue": 45100}, "done": false, "training_iteration": 19, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-35", "timestamp": 1728774995, "time_this_iter_s": 10.65812873840332, "time_total_s": 195.92005372047424, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e37700>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.92005372047424, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 16.63125, "ram_util_percent": 49.074999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -286315.5, "policy_loss": -287298.0, "entropy": 29.77423858642578, "entropy_coeff": 0.01, "var_gnorm": 16.03174591064453, "vf_loss": 114624.125, "vf_explained_var": 0.016198039054870605}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47300, "learner_queue": {"size_count": 85, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.469, "learner_load_time_ms": 0.316, "learner_load_wait_time_ms": 2322.308, "learner_dequeue_time_ms": 19161.816}}, "env_runners": {"episode_reward_max": -111.44609948521138, "episode_reward_min": -189.8364829876022, "episode_reward_mean": -155.03677011179138, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -189.8364829876022}, "policy_reward_max": {"default_policy": -111.44609948521138}, "policy_reward_mean": {"default_policy": -155.03677011179138}, "custom_metrics": {"num_consolidated_mean": 0.6654000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.81, "num_overloaded_mean": 0.9907, "num_overloaded_min": 0.81, "num_overloaded_max": 1.14, "num_moves_mean": 10.016999999999998, "num_moves_min": 9.6, "num_moves_max": 10.34, "mean_accuracy_mean": 41.04661, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 5.9780999999999995, "num_model_switches_min": 5.62, "num_model_switches_max": 6.35, "num_slav_mean": 0.1554665, "num_slav_min": 0.13470000000000001, "num_slav_max": 0.1727, "cpu_conserved_cost_mean": 2.600199999999999, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.16, "mean_cluster_cpu_util_mean": 0.5624995091488966, "mean_cluster_cpu_util_min": 0.5435853475117817, "mean_cluster_cpu_util_max": 0.5781711824538666, "mean_cluster_mem_util_mean": 0.3624983003171733, "mean_cluster_mem_util_min": 0.35305620102471363, "mean_cluster_mem_util_max": 0.3699581160839863, "reward_consolidation_mean_mean": 0.42402229888208587, "reward_consolidation_mean_min": 0.21425964848152546, "reward_consolidation_mean_max": 0.6388723384812208, "reward_illegal_mean_mean": -1.6511666666666667, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 1.06575, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.5583333333333345, "reward_sla_mean_mean": -1.3889733333333332, "reward_sla_mean_min": -2.247333333333333, "reward_sla_mean_max": -0.7386666666666666, "reward_consolidation_sum_mean": 42.402229888208595, "reward_consolidation_sum_min": 21.425964848152546, "reward_consolidation_sum_max": 63.88723384812208, "reward_illegal_sum_mean": -165.11666666666665, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 106.57500000000002, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 155.83333333333346, "reward_sla_sum_mean": -138.8973333333333, "reward_sla_sum_min": -224.73333333333332, "reward_sla_sum_max": -73.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5915.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-158.66422979682585, -157.1869322854794, -162.8505437265832, -160.56157970087418, -165.78247890584532, -153.40385634652282, -152.6779554662036, -176.39003929452625, -158.6060373450301, -166.94795150629005, -126.88940570836779, -171.43543513357076, -151.19674982484992, -170.64554814340974, -152.71343629108412, -152.46843339730114, -165.6513631240672, -146.0556977062964, -163.40471534314156, -163.66484815254802, -185.0923634591366, -160.77471138322812, -151.792415242621, -184.4235036096133, -140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24926993923232654, "mean_inference_ms": 2.067290076370071, "mean_action_processing_ms": 0.09241933795659957, "mean_env_wait_ms": 1.7808098095443978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005679607391357422, "StateBufferConnector_ms": 0.0034008026123046875, "ViewRequirementAgentConnector_ms": 0.0880122184753418}, "num_episodes": 24, "episode_return_max": -111.44609948521138, "episode_return_min": -189.8364829876022, "episode_return_mean": -155.03677011179138, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 221.77720898554074, "num_env_steps_trained_throughput_per_sec": 216.84882656363985, "timesteps_total": 47400, "num_env_steps_sampled_lifetime": 47400, "num_agent_steps_sampled_lifetime": 47400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 10267.783, "restore_workers_time_ms": 0.013, "training_step_time_ms": 635.769, "sample_time_ms": 620.723, "synch_weights_time_ms": 13.674}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47300}, "done": false, "training_iteration": 20, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-45", "timestamp": 1728775005, "time_this_iter_s": 10.156055927276611, "time_total_s": 206.07610964775085, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef4d90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.07610964775085, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.92142857142857, "ram_util_percent": 50.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -271959.3125, "policy_loss": -272793.40625, "entropy": 29.755455017089844, "entropy_coeff": 0.01, "var_gnorm": 16.03790283203125, "vf_loss": 99775.140625, "vf_explained_var": 0.023803353309631348}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 332, "num_samples_added_to_queue": 49500, "learner_queue": {"size_count": 90, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.82, "learner_load_time_ms": 0.337, "learner_load_wait_time_ms": 2274.514, "learner_dequeue_time_ms": 19302.261}}, "env_runners": {"episode_reward_max": -109.79156233817656, "episode_reward_min": -189.8364829876022, "episode_reward_mean": -151.3027513478936, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -189.8364829876022}, "policy_reward_max": {"default_policy": -109.79156233817656}, "policy_reward_mean": {"default_policy": -151.3027513478936}, "custom_metrics": {"num_consolidated_mean": 0.6773, "num_consolidated_min": 0.53, "num_consolidated_max": 0.81, "num_overloaded_mean": 0.9801000000000001, "num_overloaded_min": 0.81, "num_overloaded_max": 1.14, "num_moves_mean": 10.014, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.044963333333335, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 5.967399999999999, "num_model_switches_min": 5.62, "num_model_switches_max": 6.35, "num_slav_mean": 0.15493099999999999, "num_slav_min": 0.13470000000000001, "num_slav_max": 0.1727, "cpu_conserved_cost_mean": 2.6181999999999994, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.18, "mean_cluster_cpu_util_mean": 0.5617137483295359, "mean_cluster_cpu_util_min": 0.5413180492166059, "mean_cluster_cpu_util_max": 0.5780940946491326, "mean_cluster_mem_util_mean": 0.362134346859841, "mean_cluster_mem_util_min": 0.3529638644909441, "mean_cluster_mem_util_max": 0.3699581160839863, "reward_consolidation_mean_mean": 0.4376991531877304, "reward_consolidation_mean_min": 0.21425964848152546, "reward_consolidation_mean_max": 0.6427306649608577, "reward_illegal_mean_mean": -1.6334999999999997, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 1.0910000000000002, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.7583333333333342, "reward_sla_mean_mean": -1.4082266666666667, "reward_sla_mean_min": -2.5359999999999996, "reward_sla_mean_max": -0.8400000000000002, "reward_consolidation_sum_mean": 43.76991531877304, "reward_consolidation_sum_min": 21.425964848152546, "reward_consolidation_sum_max": 64.27306649608578, "reward_illegal_sum_mean": -163.35, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 109.10000000000002, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 175.83333333333343, "reward_sla_sum_mean": -140.8226666666667, "reward_sla_sum_min": -253.59999999999997, "reward_sla_sum_max": -84.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4843.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-140.72159980505054, -144.6382984556337, -130.99222943129536, -142.54523439641787, -156.6472813670839, -158.88855280392326, -166.38706935940786, -136.0449206494259, -160.41234274574313, -157.6094641932438, -187.3804654421396, -159.19967102257147, -160.11255597185416, -164.63359834292854, -139.70254348289632, -150.22996436077875, -182.04365956928314, -118.57041030795955, -153.072481647324, -154.47813518535435, -148.58579914100332, -155.44788449236972, -145.1100795028786, -134.22885863108843, -151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24911580623819646, "mean_inference_ms": 2.0643597714030246, "mean_action_processing_ms": 0.0923202724649946, "mean_env_wait_ms": 1.779692078569731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057108402252197266, "StateBufferConnector_ms": 0.003415346145629883, "ViewRequirementAgentConnector_ms": 0.08799386024475098}, "num_episodes": 24, "episode_return_max": -109.79156233817656, "episode_return_min": -189.8364829876022, "episode_return_mean": -151.3027513478936, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 236.39924773674977, "num_env_steps_trained_throughput_per_sec": 270.87413803169244, "timesteps_total": 49800, "num_env_steps_sampled_lifetime": 49800, "num_agent_steps_sampled_lifetime": 49800, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 49800, "timers": {"training_iteration_time_ms": 10261.942, "restore_workers_time_ms": 0.013, "training_step_time_ms": 635.057, "sample_time_ms": 620.386, "synch_weights_time_ms": 13.132}, "counters": {"num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 332, "num_samples_added_to_queue": 49500}, "done": false, "training_iteration": 21, "trial_id": "90ffb_00000", "date": "2024-10-13_00-16-56", "timestamp": 1728775016, "time_this_iter_s": 10.167629957199097, "time_total_s": 216.24373960494995, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e37d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.24373960494995, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 16.740000000000002, "ram_util_percent": 50.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -250408.21875, "policy_loss": -251090.515625, "entropy": 29.742813110351562, "entropy_coeff": 0.01, "var_gnorm": 16.042694091796875, "vf_loss": 84588.0390625, "vf_explained_var": 0.028267621994018555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 52200, "num_env_steps_trained": 51700, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 348, "num_samples_added_to_queue": 51700, "learner_queue": {"size_count": 94, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.004, "learner_load_time_ms": 0.337, "learner_load_wait_time_ms": 2265.86, "learner_dequeue_time_ms": 19302.261}}, "env_runners": {"episode_reward_max": -104.21578482439313, "episode_reward_min": -189.8364829876022, "episode_reward_mean": -147.8889200706692, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -189.8364829876022}, "policy_reward_max": {"default_policy": -104.21578482439313}, "policy_reward_mean": {"default_policy": -147.8889200706692}, "custom_metrics": {"num_consolidated_mean": 0.6788, "num_consolidated_min": 0.47, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9670000000000001, "num_overloaded_min": 0.77, "num_overloaded_max": 1.11, "num_moves_mean": 10.007399999999999, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.03882000000001, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 5.9824, "num_model_switches_min": 5.68, "num_model_switches_max": 6.5, "num_slav_mean": 0.15503333333333333, "num_slav_min": 0.13591666666666666, "num_slav_max": 0.1727, "cpu_conserved_cost_mean": 2.6154, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5601462236746136, "mean_cluster_cpu_util_min": 0.5413180492166059, "mean_cluster_cpu_util_max": 0.5780940946491326, "mean_cluster_mem_util_mean": 0.3616951690813455, "mean_cluster_mem_util_min": 0.3529638644909441, "mean_cluster_mem_util_max": 0.3699581160839863, "reward_consolidation_mean_mean": 0.45130746595997434, "reward_consolidation_mean_min": 0.21425964848152546, "reward_consolidation_mean_max": 0.6865413201742362, "reward_illegal_mean_mean": -1.6116666666666664, "reward_illegal_mean_min": -1.8500000000000003, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 1.1240833333333335, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.7583333333333342, "reward_sla_mean_mean": -1.442613333333333, "reward_sla_mean_min": -2.5359999999999996, "reward_sla_mean_max": -0.8400000000000002, "reward_consolidation_sum_mean": 45.13074659599744, "reward_consolidation_sum_min": 21.425964848152546, "reward_consolidation_sum_max": 68.65413201742362, "reward_illegal_sum_mean": -161.16666666666663, "reward_illegal_sum_min": -185.00000000000003, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 112.40833333333336, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 175.83333333333343, "reward_sla_sum_mean": -144.26133333333334, "reward_sla_sum_min": -253.59999999999997, "reward_sla_sum_max": -84.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3766.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-151.75757104998632, -154.27168052636392, -175.75182612933673, -155.72472813670848, -118.23592859971373, -151.05364768954283, -155.77391940053008, -152.92721983612049, -130.62898047458043, -186.43624843888023, -189.8364829876022, -162.19522982728677, -148.22437174449428, -142.60611654330003, -157.32793566663625, -166.40280544640413, -166.97324621523643, -153.89904048250017, -164.83955344360177, -183.89535471686614, -140.0778062079258, -167.5258003594382, -187.488610679582, -154.56500350300047, -153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24902473129751967, "mean_inference_ms": 2.061918505323243, "mean_action_processing_ms": 0.09224431058821864, "mean_env_wait_ms": 1.7791184214102629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00570368766784668, "StateBufferConnector_ms": 0.003404855728149414, "ViewRequirementAgentConnector_ms": 0.08815217018127441}, "num_episodes": 24, "episode_return_max": -104.21578482439313, "episode_return_min": -189.8364829876022, "episode_return_mean": -147.8889200706692, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51700, "num_env_steps_sampled": 52200, "num_env_steps_trained": 51700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 239.51369794566506, "num_env_steps_trained_throughput_per_sec": 219.55422311685965, "timesteps_total": 52200, "num_env_steps_sampled_lifetime": 52200, "num_agent_steps_sampled_lifetime": 52200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 52200, "timers": {"training_iteration_time_ms": 10260.269, "restore_workers_time_ms": 0.017, "training_step_time_ms": 618.854, "sample_time_ms": 606.151, "synch_weights_time_ms": 11.437}, "counters": {"num_env_steps_sampled": 52200, "num_env_steps_trained": 51700, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 348, "num_samples_added_to_queue": 51700}, "done": false, "training_iteration": 22, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-06", "timestamp": 1728775026, "time_this_iter_s": 10.030776739120483, "time_total_s": 226.27451634407043, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e36ce0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.27451634407043, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.42142857142857, "ram_util_percent": 50.578571428571436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -271258.09375, "policy_loss": -272064.5, "entropy": 29.728946685791016, "entropy_coeff": 0.01, "var_gnorm": 16.048646926879883, "vf_loss": 96990.171875, "vf_explained_var": 0.031599581241607666}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54450, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 364, "num_samples_added_to_queue": 54450, "learner_queue": {"size_count": 99, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.343, "learner_load_time_ms": 0.323, "learner_load_wait_time_ms": 2213.225, "learner_dequeue_time_ms": 19218.474}}, "env_runners": {"episode_reward_max": -104.21578482439313, "episode_reward_min": -187.8389259496177, "episode_reward_mean": -144.01511413689119, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -187.8389259496177}, "policy_reward_max": {"default_policy": -104.21578482439313}, "policy_reward_mean": {"default_policy": -144.01511413689119}, "custom_metrics": {"num_consolidated_mean": 0.6817, "num_consolidated_min": 0.47, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9516, "num_overloaded_min": 0.77, "num_overloaded_max": 1.11, "num_moves_mean": 10.0062, "num_moves_min": 9.66, "num_moves_max": 10.41, "mean_accuracy_mean": 41.02640666666666, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 5.961300000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.5, "num_slav_mean": 0.15317650000000002, "num_slav_min": 0.13388333333333335, "num_slav_max": 0.1727, "cpu_conserved_cost_mean": 2.6180000000000003, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5592217638053454, "mean_cluster_cpu_util_min": 0.5383863140398647, "mean_cluster_cpu_util_max": 0.5780940946491326, "mean_cluster_mem_util_mean": 0.3614210669005999, "mean_cluster_mem_util_min": 0.3529638644909441, "mean_cluster_mem_util_max": 0.3699581160839863, "reward_consolidation_mean_mean": 0.462395525297755, "reward_consolidation_mean_min": 0.21425964848152546, "reward_consolidation_mean_max": 0.6865413201742362, "reward_illegal_mean_mean": -1.5859999999999996, "reward_illegal_mean_min": -1.8499999999999996, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 1.1528333333333334, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.7583333333333342, "reward_sla_mean_mean": -1.46938, "reward_sla_mean_min": -2.5359999999999996, "reward_sla_mean_max": -0.8400000000000002, "reward_consolidation_sum_mean": 46.239552529775494, "reward_consolidation_sum_min": 21.425964848152546, "reward_consolidation_sum_max": 68.65413201742362, "reward_illegal_sum_mean": -158.6, "reward_illegal_sum_min": -184.99999999999997, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 115.28333333333335, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 175.83333333333343, "reward_sla_sum_mean": -146.938, "reward_sla_sum_min": -253.59999999999997, "reward_sla_sum_max": -84.00000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2694.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-153.01869079167807, -130.29038350239128, -111.44609948521138, -149.24226750738666, -146.46903043041223, -122.05123518840045, -159.6661549240002, -112.25202107892433, -182.94700721922712, -165.92416765664504, -144.01867251515444, -159.55631910810558, -174.71848061165437, -142.3937402905966, -176.8318559809923, -123.59627463523098, -132.3129123640685, -127.16344086021522, -186.74113436291077, -145.3189222943131, -186.60736848518067, -122.94704681836188, -140.88338663986107, -151.92419202534342, -159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24890726497297982, "mean_inference_ms": 2.060063711497458, "mean_action_processing_ms": 0.09217136626102417, "mean_env_wait_ms": 1.7787237120025434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005751848220825195, "StateBufferConnector_ms": 0.003439188003540039, "ViewRequirementAgentConnector_ms": 0.08844113349914551}, "num_episodes": 24, "episode_return_max": -104.21578482439313, "episode_return_min": -187.8389259496177, "episode_return_mean": -144.01511413689119, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54450, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54450, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 236.39080955025173, "num_env_steps_trained_throughput_per_sec": 270.8644692763301, "timesteps_total": 54600, "num_env_steps_sampled_lifetime": 54600, "num_agent_steps_sampled_lifetime": 54600, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 10262.51, "restore_workers_time_ms": 0.013, "training_step_time_ms": 623.555, "sample_time_ms": 608.773, "synch_weights_time_ms": 13.423}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54450, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 364, "num_samples_added_to_queue": 54450}, "done": false, "training_iteration": 23, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-16", "timestamp": 1728775036, "time_this_iter_s": 10.164063215255737, "time_total_s": 236.43857955932617, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754179f00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.43857955932617, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.880000000000003, "ram_util_percent": 49.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -214166.03125, "policy_loss": -214708.890625, "entropy": 29.712194442749023, "entropy_coeff": 0.01, "var_gnorm": 16.05365562438965, "vf_loss": 70627.6796875, "vf_explained_var": 0.02595120668411255}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 56650, "learner_queue": {"size_count": 103, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.446, "learner_load_time_ms": 0.323, "learner_load_wait_time_ms": 2248.65, "learner_dequeue_time_ms": 19218.474}}, "env_runners": {"episode_reward_max": -76.56664229796806, "episode_reward_min": -187.8389259496177, "episode_reward_mean": -140.44157211611687, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -187.8389259496177}, "policy_reward_max": {"default_policy": -76.56664229796806}, "policy_reward_mean": {"default_policy": -140.44157211611687}, "custom_metrics": {"num_consolidated_mean": 0.6775, "num_consolidated_min": 0.47, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9354, "num_overloaded_min": 0.77, "num_overloaded_max": 1.1, "num_moves_mean": 10.004, "num_moves_min": 9.7, "num_moves_max": 10.41, "mean_accuracy_mean": 41.01703333333333, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 5.969900000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.5, "num_slav_mean": 0.1512105, "num_slav_min": 0.13388333333333335, "num_slav_max": 0.16834999999999997, "cpu_conserved_cost_mean": 2.5894, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5571079617713999, "mean_cluster_cpu_util_min": 0.5383863140398647, "mean_cluster_cpu_util_max": 0.5777685358937371, "mean_cluster_mem_util_mean": 0.36039348936536636, "mean_cluster_mem_util_min": 0.3529638644909441, "mean_cluster_mem_util_max": 0.3699581160839863, "reward_consolidation_mean_mean": 0.47589094550549815, "reward_consolidation_mean_min": 0.28024886533248045, "reward_consolidation_mean_max": 0.6865413201742362, "reward_illegal_mean_mean": -1.5589999999999997, "reward_illegal_mean_min": -1.833333333333333, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 1.2001666666666666, "reward_accuracy_mean_min": 0.6833333333333336, "reward_accuracy_mean_max": 1.7583333333333342, "reward_sla_mean_mean": -1.5214733333333335, "reward_sla_mean_min": -2.5359999999999996, "reward_sla_mean_max": -0.9046666666666667, "reward_consolidation_sum_mean": 47.58909455054982, "reward_consolidation_sum_min": 28.024886533248043, "reward_consolidation_sum_max": 68.65413201742362, "reward_illegal_sum_mean": -155.89999999999998, "reward_illegal_sum_min": -183.33333333333331, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 120.01666666666668, "reward_accuracy_sum_min": 68.33333333333336, "reward_accuracy_sum_max": 175.83333333333343, "reward_sla_sum_mean": -152.1473333333333, "reward_sla_sum_min": -253.59999999999997, "reward_sla_sum_max": -90.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-159.16454049773068, -131.343412836212, -175.77511346675172, -163.69070029547052, -149.66739163544426, -150.8318407505558, -134.19823631545265, -134.7469127905205, -161.9837765390356, -134.84955070212314, -144.4291876085168, -127.91964726309067, -165.9941728349934, -150.16026683724752, -109.79156233817656, -156.0748880562915, -113.31770081330535, -136.9582594657164, -147.3731731091413, -141.3033263273325, -159.64121660726792, -153.30223887416614, -142.80513570318934, -144.62196228943932, -144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24858068796288862, "mean_inference_ms": 2.056261822872118, "mean_action_processing_ms": 0.09203952566297613, "mean_env_wait_ms": 1.7770479556483514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00558161735534668, "StateBufferConnector_ms": 0.0033462047576904297, "ViewRequirementAgentConnector_ms": 0.08508539199829102}, "num_episodes": 24, "episode_return_max": -76.56664229796806, "episode_return_min": -187.8389259496177, "episode_return_mean": -140.44157211611687, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 243.10380603182958, "num_env_steps_trained_throughput_per_sec": 209.73661696863726, "timesteps_total": 57150, "num_env_steps_sampled_lifetime": 57150, "num_agent_steps_sampled_lifetime": 57150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 57150, "timers": {"training_iteration_time_ms": 10254.997, "restore_workers_time_ms": 0.013, "training_step_time_ms": 631.679, "sample_time_ms": 617.356, "synch_weights_time_ms": 12.879}, "counters": {"num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 56650}, "done": false, "training_iteration": 24, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-26", "timestamp": 1728775046, "time_this_iter_s": 10.499621391296387, "time_total_s": 246.93820095062256, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754178190>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.93820095062256, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 16.366666666666664, "ram_util_percent": 49.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -229636.90625, "policy_loss": -230245.28125, "entropy": 29.680875778198242, "entropy_coeff": 0.01, "var_gnorm": 16.061702728271484, "vf_loss": 77161.9921875, "vf_explained_var": 0.03160935640335083}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 59550, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59550, "num_agent_steps_trained": 59400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 397, "num_samples_added_to_queue": 59400, "learner_queue": {"size_count": 108, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.631, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 2181.73, "learner_dequeue_time_ms": 19126.213}}, "env_runners": {"episode_reward_max": -67.90481281793518, "episode_reward_min": -191.85718724298636, "episode_reward_mean": -136.66214371439887, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.85718724298636}, "policy_reward_max": {"default_policy": -67.90481281793518}, "policy_reward_mean": {"default_policy": -136.66214371439887}, "custom_metrics": {"num_consolidated_mean": 0.6761, "num_consolidated_min": 0.47, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9197, "num_overloaded_min": 0.69, "num_overloaded_max": 1.08, "num_moves_mean": 9.9928, "num_moves_min": 9.7, "num_moves_max": 10.41, "mean_accuracy_mean": 41.00360666666666, "mean_accuracy_min": 40.76433333333333, "mean_accuracy_max": 41.25833333333333, "num_model_switches_mean": 5.978700000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.5, "num_slav_mean": 0.1497445, "num_slav_min": 0.13258333333333336, "num_slav_max": 0.16741666666666663, "cpu_conserved_cost_mean": 2.5862, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5558012862912215, "mean_cluster_cpu_util_min": 0.5332767358501306, "mean_cluster_cpu_util_max": 0.5757012907314235, "mean_cluster_mem_util_mean": 0.35976235851524163, "mean_cluster_mem_util_min": 0.34878519206205694, "mean_cluster_mem_util_max": 0.36923810976922417, "reward_consolidation_mean_mean": 0.493685229522678, "reward_consolidation_mean_min": 0.29607907642633036, "reward_consolidation_mean_max": 0.8332852051539795, "reward_illegal_mean_mean": -1.532833333333333, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.15, "reward_accuracy_mean_mean": 1.2403333333333335, "reward_accuracy_mean_min": 0.7499999999999987, "reward_accuracy_mean_max": 2.2250000000000023, "reward_sla_mean_mean": -1.5678066666666663, "reward_sla_mean_min": -2.5873333333333335, "reward_sla_mean_max": -0.9119999999999999, "reward_consolidation_sum_mean": 49.36852295226781, "reward_consolidation_sum_min": 29.607907642633037, "reward_consolidation_sum_max": 83.32852051539795, "reward_illegal_sum_mean": -153.2833333333333, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -115.0, "reward_accuracy_sum_mean": 124.03333333333335, "reward_accuracy_sum_min": 74.99999999999987, "reward_accuracy_sum_max": 222.50000000000023, "reward_sla_sum_mean": -156.78066666666666, "reward_sla_sum_min": -258.73333333333335, "reward_sla_sum_max": -91.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2578.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-144.68176916750437, -172.28411465472604, -168.502522160285, -140.43950166011763, -112.27920131590986, -146.69607968564364, -155.21691492278174, -104.21578482439313, -159.01601937311517, -136.79964665387308, -158.2496024856073, -165.38750494989188, -133.3549057235982, -159.0702823722927, -147.54817996283776, -136.8333455176825, -124.5038015169515, -123.62717414481118, -129.20187334369007, -133.84067744981584, -121.34275792744221, -127.12284870084373, -135.40535502147492, -155.10444424137197, -133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24823569484909533, "mean_inference_ms": 2.051938143937288, "mean_action_processing_ms": 0.09189254776853638, "mean_env_wait_ms": 1.7751400342981278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005487203598022461, "StateBufferConnector_ms": 0.0032842159271240234, "ViewRequirementAgentConnector_ms": 0.08419203758239746}, "num_episodes": 24, "episode_return_max": -67.90481281793518, "episode_return_min": -191.85718724298636, "episode_return_mean": -136.66214371439887, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59550, "num_agent_steps_trained": 59400, "num_env_steps_sampled": 59550, "num_env_steps_trained": 59400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 239.01489009735275, "num_env_steps_trained_throughput_per_sec": 273.87122823655005, "timesteps_total": 59550, "num_env_steps_sampled_lifetime": 59550, "num_agent_steps_sampled_lifetime": 59550, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 59550, "timers": {"training_iteration_time_ms": 10248.937, "restore_workers_time_ms": 0.014, "training_step_time_ms": 627.822, "sample_time_ms": 612.946, "synch_weights_time_ms": 13.537}, "counters": {"num_env_steps_sampled": 59550, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59550, "num_agent_steps_trained": 59400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 397, "num_samples_added_to_queue": 59400}, "done": false, "training_iteration": 25, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-37", "timestamp": 1728775057, "time_this_iter_s": 10.051270723342896, "time_total_s": 256.98947167396545, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e349d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.98947167396545, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.385714285714283, "ram_util_percent": 49.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -203277.90625, "policy_loss": -203731.9375, "entropy": 29.64249038696289, "entropy_coeff": 0.01, "var_gnorm": 16.069948196411133, "vf_loss": 61705.96484375, "vf_explained_var": 0.03760796785354614}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 61950, "num_env_steps_trained": 61600, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 413, "num_samples_added_to_queue": 61600, "learner_queue": {"size_count": 112, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.59, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 2307.786, "learner_dequeue_time_ms": 19126.213}}, "env_runners": {"episode_reward_max": -67.90481281793518, "episode_reward_min": -191.85718724298636, "episode_reward_mean": -133.46032928203724, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.85718724298636}, "policy_reward_max": {"default_policy": -67.90481281793518}, "policy_reward_mean": {"default_policy": -133.46032928203724}, "custom_metrics": {"num_consolidated_mean": 0.6786000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9107, "num_overloaded_min": 0.69, "num_overloaded_max": 1.08, "num_moves_mean": 9.9821, "num_moves_min": 9.7, "num_moves_max": 10.41, "mean_accuracy_mean": 40.97472666666667, "mean_accuracy_min": 40.739000000000004, "mean_accuracy_max": 41.239333333333335, "num_model_switches_mean": 5.940600000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.37, "num_slav_mean": 0.14687516666666667, "num_slav_min": 0.13096666666666665, "num_slav_max": 0.16741666666666663, "cpu_conserved_cost_mean": 2.5658000000000003, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.553566989096034, "mean_cluster_cpu_util_min": 0.5332767358501306, "mean_cluster_cpu_util_max": 0.5726373609340808, "mean_cluster_mem_util_mean": 0.3586700795139786, "mean_cluster_mem_util_min": 0.34878519206205694, "mean_cluster_mem_util_max": 0.3676777887209737, "reward_consolidation_mean_mean": 0.5047633738462944, "reward_consolidation_mean_min": 0.29607907642633036, "reward_consolidation_mean_max": 0.8332852051539795, "reward_illegal_mean_mean": -1.517833333333333, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.15, "reward_accuracy_mean_mean": 1.2595, "reward_accuracy_mean_min": 0.7499999999999987, "reward_accuracy_mean_max": 2.2250000000000023, "reward_sla_mean_mean": -1.5810333333333333, "reward_sla_mean_min": -2.5873333333333335, "reward_sla_mean_max": -0.9119999999999999, "reward_consolidation_sum_mean": 50.47633738462944, "reward_consolidation_sum_min": 29.607907642633037, "reward_consolidation_sum_max": 83.32852051539795, "reward_illegal_sum_mean": -151.7833333333333, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -115.0, "reward_accuracy_sum_mean": 125.95, "reward_accuracy_sum_min": 74.99999999999987, "reward_accuracy_sum_max": 222.50000000000023, "reward_sla_sum_mean": -158.1033333333333, "reward_sla_sum_min": -258.73333333333335, "reward_sla_sum_max": -91.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3378.0, "global_timestep_min": 1500, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-133.0540863261142, -147.97387066313328, -124.66153705565218, -135.79407840628718, -148.79978677388885, -147.55704407688327, -147.5754119833072, -151.05520728624086, -130.30459349964985, -166.5273325413507, -141.11307989886998, -138.8757074537755, -119.04588016692556, -114.3890127631059, -129.3936336775412, -139.9941454202078, -142.79259800785883, -143.49579030735032, -160.92736604831103, -128.7019677723964, -187.8389259496177, -151.4577477230497, -161.0963325108897, -157.57479667367247, -111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2479330456780571, "mean_inference_ms": 2.0491365566084707, "mean_action_processing_ms": 0.091789644173814, "mean_env_wait_ms": 1.7740552801326412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005823373794555664, "StateBufferConnector_ms": 0.003313779830932617, "ViewRequirementAgentConnector_ms": 0.08454585075378418}, "num_episodes": 24, "episode_return_max": -67.90481281793518, "episode_return_min": -191.85718724298636, "episode_return_mean": -133.46032928203724, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61600, "num_env_steps_sampled": 61950, "num_env_steps_trained": 61600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 227.59885082848945, "num_env_steps_trained_throughput_per_sec": 208.63227992611533, "timesteps_total": 61950, "num_env_steps_sampled_lifetime": 61950, "num_agent_steps_sampled_lifetime": 61950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 61950, "timers": {"training_iteration_time_ms": 10301.285, "restore_workers_time_ms": 0.012, "training_step_time_ms": 622.209, "sample_time_ms": 608.096, "synch_weights_time_ms": 12.703}, "counters": {"num_env_steps_sampled": 61950, "num_env_steps_trained": 61600, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 413, "num_samples_added_to_queue": 61600}, "done": false, "training_iteration": 26, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-47", "timestamp": 1728775067, "time_this_iter_s": 10.566428661346436, "time_total_s": 267.5559003353119, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5d20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.5559003353119, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.713333333333328, "ram_util_percent": 50.59333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -166150.71875, "policy_loss": -166381.171875, "entropy": 29.601167678833008, "entropy_coeff": 0.01, "var_gnorm": 16.077917098999023, "vf_loss": 39325.90625, "vf_explained_var": 0.060067176818847656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 64350, "num_env_steps_trained": 63800, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 63800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 429, "num_samples_added_to_queue": 64350, "learner_queue": {"size_count": 116, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.12, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 2280.064, "learner_dequeue_time_ms": 19171.817}}, "env_runners": {"episode_reward_max": -54.59416369673153, "episode_reward_min": -191.85718724298636, "episode_reward_mean": -123.68760848639926, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.85718724298636}, "policy_reward_max": {"default_policy": -54.59416369673153}, "policy_reward_mean": {"default_policy": -123.68760848639926}, "custom_metrics": {"num_consolidated_mean": 0.6876000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.8818999999999998, "num_overloaded_min": 0.69, "num_overloaded_max": 1.08, "num_moves_mean": 9.9815, "num_moves_min": 9.7, "num_moves_max": 10.41, "mean_accuracy_mean": 40.962439999999994, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.239333333333335, "num_model_switches_mean": 5.9491999999999985, "num_model_switches_min": 5.38, "num_model_switches_max": 6.37, "num_slav_mean": 0.14467033333333335, "num_slav_min": 0.12416666666666668, "num_slav_max": 0.16706666666666667, "cpu_conserved_cost_mean": 2.5638, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.5503876167221632, "mean_cluster_cpu_util_min": 0.5305713166197021, "mean_cluster_cpu_util_max": 0.5726373609340808, "mean_cluster_mem_util_mean": 0.35712806875017933, "mean_cluster_mem_util_min": 0.34813904855191025, "mean_cluster_mem_util_max": 0.36766828643904825, "reward_consolidation_mean_mean": 0.5427172484693411, "reward_consolidation_mean_min": 0.29607907642633036, "reward_consolidation_mean_max": 0.8332852051539795, "reward_illegal_mean_mean": -1.4698333333333329, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.15, "reward_accuracy_mean_mean": 1.3401666666666665, "reward_accuracy_mean_min": 0.7499999999999987, "reward_accuracy_mean_max": 2.2250000000000023, "reward_sla_mean_mean": -1.6499266666666665, "reward_sla_mean_min": -2.5873333333333335, "reward_sla_mean_max": -0.9119999999999999, "reward_consolidation_sum_mean": 54.271724846934106, "reward_consolidation_sum_min": 29.607907642633037, "reward_consolidation_sum_max": 83.32852051539795, "reward_illegal_sum_mean": -146.98333333333335, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -115.0, "reward_accuracy_sum_mean": 134.01666666666668, "reward_accuracy_sum_min": 74.99999999999987, "reward_accuracy_sum_max": 222.50000000000023, "reward_sla_sum_mean": -164.99266666666665, "reward_sla_sum_min": -258.73333333333335, "reward_sla_sum_max": -91.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4178.0, "global_timestep_min": 2300, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-111.29590301258052, -129.14998324651995, -147.61246458923526, -134.46380334460392, -136.60138596972195, -153.61005818026737, -111.54998629260719, -161.31252551098117, -119.91489841298853, -122.95633738462958, -112.96155837826309, -137.34178927168048, -138.35681866642298, -147.96520759084964, -146.38415120777367, -123.37893630631459, -141.3126625849098, -110.52565414724792, -76.56664229796806, -138.87277102561765, -116.65700447774839, -146.81764598373383, -133.97900027414775, -115.87070577842779, -160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24772398120750758, "mean_inference_ms": 2.0469743531100333, "mean_action_processing_ms": 0.09170978891929953, "mean_env_wait_ms": 1.7734736093203265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005942106246948242, "StateBufferConnector_ms": 0.0032765865325927734, "ViewRequirementAgentConnector_ms": 0.08415102958679199}, "num_episodes": 24, "episode_return_max": -54.59416369673153, "episode_return_min": -191.85718724298636, "episode_return_mean": -123.68760848639926, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 63800, "num_env_steps_sampled": 64350, "num_env_steps_trained": 63800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 231.29677971254057, "num_env_steps_trained_throughput_per_sec": 212.02204806982886, "timesteps_total": 64350, "num_env_steps_sampled_lifetime": 64350, "num_agent_steps_sampled_lifetime": 64350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 64350, "timers": {"training_iteration_time_ms": 10319.237, "restore_workers_time_ms": 0.014, "training_step_time_ms": 649.862, "sample_time_ms": 634.592, "synch_weights_time_ms": 13.901}, "counters": {"num_env_steps_sampled": 64350, "num_env_steps_trained": 63800, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 63800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 429, "num_samples_added_to_queue": 64350}, "done": false, "training_iteration": 27, "trial_id": "90ffb_00000", "date": "2024-10-13_00-17-58", "timestamp": 1728775078, "time_this_iter_s": 10.388174057006836, "time_total_s": 277.9440743923187, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e37b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.9440743923187, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 16.586666666666666, "ram_util_percent": 50.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -130976.9921875, "policy_loss": -131139.515625, "entropy": 29.552276611328125, "entropy_coeff": 0.01, "var_gnorm": 16.086088180541992, "vf_loss": 32505.16015625, "vf_explained_var": 0.040746450424194336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 120.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 444, "num_samples_added_to_queue": 66550, "learner_queue": {"size_count": 120, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.664, "learner_load_time_ms": 0.295, "learner_load_wait_time_ms": 2359.633, "learner_dequeue_time_ms": 19086.639}}, "env_runners": {"episode_reward_max": -43.039157452252496, "episode_reward_min": -191.85718724298636, "episode_reward_mean": -116.22768107465963, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -191.85718724298636}, "policy_reward_max": {"default_policy": -43.039157452252496}, "policy_reward_mean": {"default_policy": -116.22768107465963}, "custom_metrics": {"num_consolidated_mean": 0.6936, "num_consolidated_min": 0.53, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.8598, "num_overloaded_min": 0.69, "num_overloaded_max": 1.02, "num_moves_mean": 9.946100000000001, "num_moves_min": 9.65, "num_moves_max": 10.25, "mean_accuracy_mean": 40.952116666666655, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.239333333333335, "num_model_switches_mean": 5.9590000000000005, "num_model_switches_min": 5.38, "num_model_switches_max": 6.39, "num_slav_mean": 0.14268483333333332, "num_slav_min": 0.12239999999999998, "num_slav_max": 0.16706666666666667, "cpu_conserved_cost_mean": 2.5465999999999998, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.5477972748505088, "mean_cluster_cpu_util_min": 0.527290483674565, "mean_cluster_cpu_util_max": 0.5726373609340808, "mean_cluster_mem_util_mean": 0.35581115705638794, "mean_cluster_mem_util_min": 0.3458982171560608, "mean_cluster_mem_util_max": 0.36766828643904825, "reward_consolidation_mean_mean": 0.5651698559200706, "reward_consolidation_mean_min": 0.29607907642633036, "reward_consolidation_mean_max": 0.8332852051539795, "reward_illegal_mean_mean": -1.4329999999999998, "reward_illegal_mean_min": -1.6999999999999995, "reward_illegal_mean_max": -1.15, "reward_accuracy_mean_mean": 1.3895000000000002, "reward_accuracy_mean_min": 0.7499999999999987, "reward_accuracy_mean_max": 2.2250000000000023, "reward_sla_mean_mean": -1.6839466666666665, "reward_sla_mean_min": -2.5873333333333335, "reward_sla_mean_max": -0.9119999999999999, "reward_consolidation_sum_mean": 56.51698559200706, "reward_consolidation_sum_min": 29.607907642633037, "reward_consolidation_sum_max": 83.32852051539795, "reward_illegal_sum_mean": -143.29999999999995, "reward_illegal_sum_min": -169.99999999999994, "reward_illegal_sum_max": -115.0, "reward_accuracy_sum_mean": 138.95000000000002, "reward_accuracy_sum_min": 74.99999999999987, "reward_accuracy_sum_max": 222.50000000000023, "reward_sla_sum_mean": -168.39466666666667, "reward_sla_sum_min": -258.73333333333335, "reward_sla_sum_max": -91.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4978.0, "global_timestep_min": 3100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.51784702549568, -148.150531542234, -130.99014286149438, -158.37234152730818, -128.09370069146178, -146.00622315635584, -145.35875902403356, -191.85718724298636, -155.40429802918152, -139.0148770903774, -129.04277011179133, -151.24676353224282, -95.75335831124929, -122.96799780681728, -130.87260958299063, -122.8620061530963, -139.96701696670638, -142.31375003807608, -93.4968625300801, -136.2248652106369, -114.05020865698013, -67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24773939054979116, "mean_inference_ms": 2.047275356493169, "mean_action_processing_ms": 0.09171406629090927, "mean_env_wait_ms": 1.7745576858359737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060617923736572266, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.08573484420776367}, "num_episodes": 24, "episode_return_max": -43.039157452252496, "episode_return_min": -191.85718724298636, "episode_return_mean": -116.22768107465963, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66000, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 218.24569680234777, "num_env_steps_trained_throughput_per_sec": 213.39579242896227, "timesteps_total": 66600, "num_env_steps_sampled_lifetime": 66600, "num_agent_steps_sampled_lifetime": 66600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 66600, "timers": {"training_iteration_time_ms": 10287.982, "restore_workers_time_ms": 0.014, "training_step_time_ms": 682.165, "sample_time_ms": 665.591, "synch_weights_time_ms": 15.177}, "counters": {"num_env_steps_sampled": 66600, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 444, "num_samples_added_to_queue": 66550}, "done": false, "training_iteration": 28, "trial_id": "90ffb_00000", "date": "2024-10-13_00-18-08", "timestamp": 1728775088, "time_this_iter_s": 10.319881439208984, "time_total_s": 288.2639558315277, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef4f40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.2639558315277, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 16.933333333333334, "ram_util_percent": 50.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -99321.4375, "policy_loss": -99424.8125, "entropy": 29.47983169555664, "entropy_coeff": 0.01, "var_gnorm": 16.0963191986084, "vf_loss": 26551.365234375, "vf_explained_var": 0.031546175479888916}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 124.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 68850, "num_env_steps_trained": 68200, "num_agent_steps_sampled": 68850, "num_agent_steps_trained": 68200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 459, "num_samples_added_to_queue": 68750, "learner_queue": {"size_count": 124, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.552, "learner_load_time_ms": 0.295, "learner_load_wait_time_ms": 2428.987, "learner_dequeue_time_ms": 19086.639}}, "env_runners": {"episode_reward_max": -43.039157452252496, "episode_reward_min": -164.6442230954339, "episode_reward_mean": -105.70405117426668, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -164.6442230954339}, "policy_reward_max": {"default_policy": -43.039157452252496}, "policy_reward_mean": {"default_policy": -105.70405117426668}, "custom_metrics": {"num_consolidated_mean": 0.6968999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.8326, "num_overloaded_min": 0.68, "num_overloaded_max": 1.0, "num_moves_mean": 9.9466, "num_moves_min": 9.65, "num_moves_max": 10.25, "mean_accuracy_mean": 40.941159999999996, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.9468, "num_model_switches_min": 5.36, "num_model_switches_max": 6.39, "num_slav_mean": 0.13992333333333332, "num_slav_min": 0.12239999999999998, "num_slav_max": 0.1647, "cpu_conserved_cost_mean": 2.5136, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5439578925850482, "mean_cluster_cpu_util_min": 0.527290483674565, "mean_cluster_cpu_util_max": 0.5724645221567132, "mean_cluster_mem_util_mean": 0.3541100895942765, "mean_cluster_mem_util_min": 0.3456731610049083, "mean_cluster_mem_util_max": 0.36766828643904825, "reward_consolidation_mean_mean": 0.6016828215906667, "reward_consolidation_mean_min": 0.36663909957659385, "reward_consolidation_mean_max": 0.8332852051539795, "reward_illegal_mean_mean": -1.3876666666666666, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.1333333333333333, "reward_accuracy_mean_mean": 1.4710833333333333, "reward_accuracy_mean_min": 0.883333333333332, "reward_accuracy_mean_max": 2.2250000000000023, "reward_sla_mean_mean": -1.74214, "reward_sla_mean_min": -2.5873333333333335, "reward_sla_mean_max": -1.0633333333333335, "reward_consolidation_sum_mean": 60.16828215906668, "reward_consolidation_sum_min": 36.663909957659385, "reward_consolidation_sum_max": 83.32852051539795, "reward_illegal_sum_mean": -138.76666666666665, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -113.33333333333333, "reward_accuracy_sum_mean": 147.10833333333335, "reward_accuracy_sum_min": 88.3333333333332, "reward_accuracy_sum_max": 222.50000000000023, "reward_sla_sum_mean": -174.21400000000003, "reward_sla_sum_min": -258.73333333333335, "reward_sla_sum_max": -106.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5667.0, "global_timestep_min": 3600, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-67.90481281793518, -114.21695452191656, -149.16942337567386, -135.97591763379938, -126.88577477230506, -149.75496664534413, -83.56026988333491, -120.48685308720957, -124.79356666362055, -142.2928812939777, -108.14347071187083, -123.88930518748666, -119.1920954034543, -107.44344025099764, -139.74715038533012, -157.40043254439678, -130.117201254988, -147.80745377562536, -118.10192512717425, -116.21678698711501, -145.93262359499215, -105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24783275693560142, "mean_inference_ms": 2.0482272031538487, "mean_action_processing_ms": 0.09175703208796829, "mean_env_wait_ms": 1.7762524060801461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006209135055541992, "StateBufferConnector_ms": 0.0034749507904052734, "ViewRequirementAgentConnector_ms": 0.08803606033325195}, "num_episodes": 21, "episode_return_max": -43.039157452252496, "episode_return_min": -164.6442230954339, "episode_return_mean": -105.70405117426668, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68850, "num_agent_steps_trained": 68200, "num_env_steps_sampled": 68850, "num_env_steps_trained": 68200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 222.7535914156117, "num_env_steps_trained_throughput_per_sec": 217.8035116063759, "timesteps_total": 68850, "num_env_steps_sampled_lifetime": 68850, "num_agent_steps_sampled_lifetime": 68850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 68850, "timers": {"training_iteration_time_ms": 10233.274, "restore_workers_time_ms": 0.015, "training_step_time_ms": 664.001, "sample_time_ms": 647.347, "synch_weights_time_ms": 15.219}, "counters": {"num_env_steps_sampled": 68850, "num_env_steps_trained": 68200, "num_agent_steps_sampled": 68850, "num_agent_steps_trained": 68200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 459, "num_samples_added_to_queue": 68750}, "done": false, "training_iteration": 29, "trial_id": "90ffb_00000", "date": "2024-10-13_00-18-18", "timestamp": 1728775098, "time_this_iter_s": 10.110992431640625, "time_total_s": 298.37494826316833, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d6b8e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.37494826316833, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.678571428571427, "ram_util_percent": 49.828571428571415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -86560.015625, "policy_loss": -86626.390625, "entropy": 29.369211196899414, "entropy_coeff": 0.01, "var_gnorm": 16.108665466308594, "vf_loss": 22790.51171875, "vf_explained_var": 0.03568994998931885}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 128.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 70950, "num_env_steps_trained": 70400, "num_agent_steps_sampled": 70950, "num_agent_steps_trained": 70400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 473, "num_samples_added_to_queue": 70950, "learner_queue": {"size_count": 128, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.423, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2504.21, "learner_dequeue_time_ms": 19137.742}}, "env_runners": {"episode_reward_max": -29.211687836973486, "episode_reward_min": -164.6442230954339, "episode_reward_mean": -94.32318730390816, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -164.6442230954339}, "policy_reward_max": {"default_policy": -29.211687836973486}, "policy_reward_mean": {"default_policy": -94.32318730390816}, "custom_metrics": {"num_consolidated_mean": 0.7069000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.8067, "num_overloaded_min": 0.6, "num_overloaded_max": 0.95, "num_moves_mean": 9.9346, "num_moves_min": 9.65, "num_moves_max": 10.25, "mean_accuracy_mean": 40.92551666666667, "mean_accuracy_min": 40.675666666666665, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.9518, "num_model_switches_min": 5.36, "num_model_switches_max": 6.39, "num_slav_mean": 0.13709983333333337, "num_slav_min": 0.11956666666666668, "num_slav_max": 0.1647, "cpu_conserved_cost_mean": 2.5166, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.14, "mean_cluster_cpu_util_mean": 0.5411016392592729, "mean_cluster_cpu_util_min": 0.5221700470157956, "mean_cluster_cpu_util_max": 0.5633929193673688, "mean_cluster_mem_util_mean": 0.3527363682851833, "mean_cluster_mem_util_min": 0.3447869029679383, "mean_cluster_mem_util_max": 0.36329562182467934, "reward_consolidation_mean_mean": 0.631141460294252, "reward_consolidation_mean_min": 0.41751028054464034, "reward_consolidation_mean_max": 0.9719942733558742, "reward_illegal_mean_mean": -1.3444999999999996, "reward_illegal_mean_min": -1.583333333333333, "reward_illegal_mean_max": -0.9999999999999999, "reward_accuracy_mean_mean": 1.5256666666666667, "reward_accuracy_mean_min": 0.9666666666666663, "reward_accuracy_mean_max": 2.1916666666666664, "reward_sla_mean_mean": -1.75554, "reward_sla_mean_min": -2.5319999999999996, "reward_sla_mean_max": -1.0633333333333335, "reward_consolidation_sum_mean": 63.1141460294252, "reward_consolidation_sum_min": 41.75102805446404, "reward_consolidation_sum_max": 97.19942733558742, "reward_illegal_sum_mean": -134.45, "reward_illegal_sum_min": -158.33333333333331, "reward_illegal_sum_max": -99.99999999999999, "reward_accuracy_sum_mean": 152.5666666666667, "reward_accuracy_sum_min": 96.66666666666663, "reward_accuracy_sum_max": 219.16666666666666, "reward_sla_sum_mean": -175.554, "reward_sla_sum_min": -253.19999999999996, "reward_sla_sum_max": -106.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5898.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-105.55934691888287, -113.38448018520211, -164.6442230954339, -127.45069298486112, -137.12142313198694, -114.31701544366277, -126.41197416917981, -118.17738280179111, -129.32719242133484, -132.58394711992452, -83.11801456029733, -109.73136556093705, -86.9264400377714, -117.08022784733012, -147.42480733497808, -82.85745225258164, -121.84680008529051, -115.07211611684804, -108.99115111639107, -97.51875780559887, -98.33487769959486, -108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24816742416530907, "mean_inference_ms": 2.0511209058488418, "mean_action_processing_ms": 0.09187397709923566, "mean_env_wait_ms": 1.7794452875266003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006231546401977539, "StateBufferConnector_ms": 0.003598928451538086, "ViewRequirementAgentConnector_ms": 0.09081125259399414}, "num_episodes": 21, "episode_return_max": -29.211687836973486, "episode_return_min": -164.6442230954339, "episode_return_mean": -94.32318730390816, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70950, "num_agent_steps_trained": 70400, "num_env_steps_sampled": 70950, "num_env_steps_trained": 70400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 193.75595984508828, "num_env_steps_trained_throughput_per_sec": 202.98243412342583, "timesteps_total": 70950, "num_env_steps_sampled_lifetime": 70950, "num_agent_steps_sampled_lifetime": 70950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 70950, "timers": {"training_iteration_time_ms": 10302.58, "restore_workers_time_ms": 0.014, "training_step_time_ms": 728.233, "sample_time_ms": 711.364, "synch_weights_time_ms": 15.464}, "counters": {"num_env_steps_sampled": 70950, "num_env_steps_trained": 70400, "num_agent_steps_sampled": 70950, "num_agent_steps_trained": 70400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 473, "num_samples_added_to_queue": 70950}, "done": false, "training_iteration": 30, "trial_id": "90ffb_00000", "date": "2024-10-13_00-18-29", "timestamp": 1728775109, "time_this_iter_s": 10.850125074386597, "time_total_s": 309.22507333755493, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e36e90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.22507333755493, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.575, "ram_util_percent": 52.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -44603.11328125, "policy_loss": -44591.984375, "entropy": 29.167396545410156, "entropy_coeff": 0.01, "var_gnorm": 16.123140335083008, "vf_loss": 14929.11328125, "vf_explained_var": 0.02990013360977173}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 132.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 73050, "num_env_steps_trained": 72600, "num_agent_steps_sampled": 73050, "num_agent_steps_trained": 72600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 487, "num_samples_added_to_queue": 72600, "learner_queue": {"size_count": 132, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.809, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2499.175, "learner_dequeue_time_ms": 19137.742}}, "env_runners": {"episode_reward_max": -4.049355752535819, "episode_reward_min": -138.35653538030394, "episode_reward_mean": -79.98325977032503, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -138.35653538030394}, "policy_reward_max": {"default_policy": -4.049355752535819}, "policy_reward_mean": {"default_policy": -79.98325977032503}, "custom_metrics": {"num_consolidated_mean": 0.7170000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.7797999999999999, "num_overloaded_min": 0.6, "num_overloaded_max": 0.95, "num_moves_mean": 9.9135, "num_moves_min": 9.48, "num_moves_max": 10.25, "mean_accuracy_mean": 40.91253333333333, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.9399, "num_model_switches_min": 5.36, "num_model_switches_max": 6.39, "num_slav_mean": 0.13315866666666668, "num_slav_min": 0.11299999999999999, "num_slav_max": 0.14838333333333334, "cpu_conserved_cost_mean": 2.5153999999999996, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.5383543225246302, "mean_cluster_cpu_util_min": 0.5165276666695245, "mean_cluster_cpu_util_max": 0.5633929193673688, "mean_cluster_mem_util_mean": 0.35135911524441, "mean_cluster_mem_util_min": 0.34139626783202737, "mean_cluster_mem_util_max": 0.36329562182467934, "reward_consolidation_mean_mean": 0.6730840689634163, "reward_consolidation_mean_min": 0.41751028054464034, "reward_consolidation_mean_max": 0.9719942733558742, "reward_illegal_mean_mean": -1.2996666666666663, "reward_illegal_mean_min": -1.583333333333333, "reward_illegal_mean_max": -0.9999999999999999, "reward_accuracy_mean_mean": 1.6115833333333334, "reward_accuracy_mean_min": 0.9666666666666663, "reward_accuracy_mean_max": 2.2916666666666665, "reward_sla_mean_mean": -1.7848333333333335, "reward_sla_mean_min": -2.5319999999999996, "reward_sla_mean_max": -1.0633333333333335, "reward_consolidation_sum_mean": 67.30840689634165, "reward_consolidation_sum_min": 41.75102805446404, "reward_consolidation_sum_max": 97.19942733558742, "reward_illegal_sum_mean": -129.96666666666664, "reward_illegal_sum_min": -158.33333333333331, "reward_illegal_sum_max": -99.99999999999999, "reward_accuracy_sum_mean": 161.15833333333333, "reward_accuracy_sum_min": 96.66666666666663, "reward_accuracy_sum_max": 229.16666666666666, "reward_sla_sum_mean": -178.48333333333332, "reward_sla_sum_min": -253.19999999999996, "reward_sla_sum_max": -106.33333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4961.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-108.77919522373506, -102.86692253799998, -95.38489445307508, -104.52838344146959, -98.26984678180872, -90.56321544975482, -111.58633829845574, -133.47998111425855, -71.75407414176493, -112.05893874318446, -105.23797861646713, -114.7219105059551, -54.59416369673153, -91.54626702001286, -127.58230527886944, -68.10324712906257, -122.90034725395219, -106.74468305461652, -92.93128027049259, -108.73151481921471, -119.50024977915868, -121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24866758049068952, "mean_inference_ms": 2.0557209660300146, "mean_action_processing_ms": 0.092049523504081, "mean_env_wait_ms": 1.7838182450901554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006081104278564453, "StateBufferConnector_ms": 0.003678560256958008, "ViewRequirementAgentConnector_ms": 0.09341740608215332}, "num_episodes": 21, "episode_return_max": -4.049355752535819, "episode_return_min": -138.35653538030394, "episode_return_mean": -79.98325977032503, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73050, "num_agent_steps_trained": 72600, "num_env_steps_sampled": 73050, "num_env_steps_trained": 72600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.15799984071265, "num_env_steps_trained_throughput_per_sec": 212.832190309318, "timesteps_total": 73050, "num_env_steps_sampled_lifetime": 73050, "num_agent_steps_sampled_lifetime": 73050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 73050, "timers": {"training_iteration_time_ms": 10321.027, "restore_workers_time_ms": 0.014, "training_step_time_ms": 755.265, "sample_time_ms": 739.884, "synch_weights_time_ms": 13.943}, "counters": {"num_env_steps_sampled": 73050, "num_env_steps_trained": 72600, "num_agent_steps_sampled": 73050, "num_agent_steps_trained": 72600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 487, "num_samples_added_to_queue": 72600}, "done": false, "training_iteration": 31, "trial_id": "90ffb_00000", "date": "2024-10-13_00-18-39", "timestamp": 1728775119, "time_this_iter_s": 10.347805261611938, "time_total_s": 319.57287859916687, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760255600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.57287859916687, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 21.9, "ram_util_percent": 52.29333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6505.5703125, "policy_loss": 6527.56396484375, "entropy": 28.949256896972656, "entropy_coeff": 0.01, "var_gnorm": 16.139095306396484, "vf_loss": 13722.69921875, "vf_explained_var": 0.008300840854644775}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 136.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 75150, "num_env_steps_trained": 74800, "num_agent_steps_sampled": 75150, "num_agent_steps_trained": 74800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 501, "num_samples_added_to_queue": 74800, "learner_queue": {"size_count": 136, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.772, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2675.733, "learner_dequeue_time_ms": 19137.742}}, "env_runners": {"episode_reward_max": 63.67019403576109, "episode_reward_min": -138.35653538030394, "episode_reward_mean": -63.78874205732737, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -138.35653538030394}, "policy_reward_max": {"default_policy": 63.67019403576109}, "policy_reward_mean": {"default_policy": -63.78874205732737}, "custom_metrics": {"num_consolidated_mean": 0.736, "num_consolidated_min": 0.6, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.7476999999999999, "num_overloaded_min": 0.49, "num_overloaded_max": 0.95, "num_moves_mean": 9.893099999999999, "num_moves_min": 9.48, "num_moves_max": 10.2, "mean_accuracy_mean": 40.89840999999999, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.157, "num_model_switches_mean": 5.9227, "num_model_switches_min": 5.36, "num_model_switches_max": 6.31, "num_slav_mean": 0.12867150000000002, "num_slav_min": 0.09996666666666668, "num_slav_max": 0.14838333333333334, "cpu_conserved_cost_mean": 2.5220000000000002, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.24, "mean_cluster_cpu_util_mean": 0.5346226954334317, "mean_cluster_cpu_util_min": 0.5165276666695245, "mean_cluster_cpu_util_max": 0.5581881348555386, "mean_cluster_mem_util_mean": 0.3494151653265737, "mean_cluster_mem_util_min": 0.34062720962857723, "mean_cluster_mem_util_max": 0.3593981213582479, "reward_consolidation_mean_mean": 0.7288325794267263, "reward_consolidation_mean_min": 0.44368759328642354, "reward_consolidation_mean_max": 1.1380352736909438, "reward_illegal_mean_mean": -1.2461666666666666, "reward_illegal_mean_min": -1.5833333333333328, "reward_illegal_mean_max": -0.8166666666666665, "reward_accuracy_mean_mean": 1.7106666666666663, "reward_accuracy_mean_min": 1.124999999999999, "reward_accuracy_mean_max": 2.416666666666666, "reward_sla_mean_mean": -1.83122, "reward_sla_mean_min": -2.5319999999999996, "reward_sla_mean_max": -1.2113333333333332, "reward_consolidation_sum_mean": 72.88325794267263, "reward_consolidation_sum_min": 44.368759328642355, "reward_consolidation_sum_max": 113.80352736909438, "reward_illegal_sum_mean": -124.61666666666666, "reward_illegal_sum_min": -158.3333333333333, "reward_illegal_sum_max": -81.66666666666666, "reward_accuracy_sum_mean": 171.0666666666667, "reward_accuracy_sum_min": 112.49999999999989, "reward_accuracy_sum_max": 241.66666666666663, "reward_sla_sum_mean": -183.12200000000004, "reward_sla_sum_min": -253.19999999999996, "reward_sla_sum_max": -121.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4018.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-121.84748545493314, -80.95646836638345, -113.33651344847543, -80.01081665600525, -120.05613938895497, -43.039157452252496, -60.23841725303834, -94.76982850528508, -98.6057205519511, -98.38184531968697, -106.47245727862575, -109.06630418227792, -101.29944256602413, -110.15453410094743, -124.39790733802428, -68.7922202930337, -99.0038350239119, -87.10655213378413, -89.42327515306597, -99.77857991410045, -46.18984739102615, -62.78939352401825, -75.12445094276403, -113.70143166103131, -104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24924558269758731, "mean_inference_ms": 2.061364019972041, "mean_action_processing_ms": 0.09226272193049376, "mean_env_wait_ms": 1.7889363301348227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006155729293823242, "StateBufferConnector_ms": 0.0037763118743896484, "ViewRequirementAgentConnector_ms": 0.09541606903076172}, "num_episodes": 21, "episode_return_max": 63.67019403576109, "episode_return_min": -138.35653538030394, "episode_return_mean": -63.78874205732737, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75150, "num_agent_steps_trained": 74800, "num_env_steps_sampled": 75150, "num_env_steps_trained": 74800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.54599637211112, "num_env_steps_trained_throughput_per_sec": 214.2862819136402, "timesteps_total": 75150, "num_env_steps_sampled_lifetime": 75150, "num_agent_steps_sampled_lifetime": 75150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 75150, "timers": {"training_iteration_time_ms": 10345.661, "restore_workers_time_ms": 0.017, "training_step_time_ms": 689.756, "sample_time_ms": 672.433, "synch_weights_time_ms": 15.944}, "counters": {"num_env_steps_sampled": 75150, "num_env_steps_trained": 74800, "num_agent_steps_sampled": 75150, "num_agent_steps_trained": 74800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 501, "num_samples_added_to_queue": 74800}, "done": false, "training_iteration": 32, "trial_id": "90ffb_00000", "date": "2024-10-13_00-18-50", "timestamp": 1728775130, "time_this_iter_s": 10.276601791381836, "time_total_s": 329.8494803905487, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.8494803905487, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.828571428571422, "ram_util_percent": 54.128571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 45816.36328125, "policy_loss": 45865.97265625, "entropy": 28.706798553466797, "entropy_coeff": 0.01, "var_gnorm": 16.156179428100586, "vf_loss": 10827.779296875, "vf_explained_var": -0.019887924194335938}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 140.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 77400, "num_env_steps_trained": 77000, "num_agent_steps_sampled": 77400, "num_agent_steps_trained": 77000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 516, "num_samples_added_to_queue": 77000, "learner_queue": {"size_count": 140, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.496, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 2614.733, "learner_dequeue_time_ms": 19455.451}}, "env_runners": {"episode_reward_max": 106.66408967680998, "episode_reward_min": -138.35653538030394, "episode_reward_mean": -36.523480703036945, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -138.35653538030394}, "policy_reward_max": {"default_policy": 106.66408967680998}, "policy_reward_mean": {"default_policy": -36.523480703036945}, "custom_metrics": {"num_consolidated_mean": 0.7694999999999999, "num_consolidated_min": 0.61, "num_consolidated_max": 0.94, "num_overloaded_mean": 0.6928, "num_overloaded_min": 0.42, "num_overloaded_max": 0.95, "num_moves_mean": 9.869400000000002, "num_moves_min": 9.48, "num_moves_max": 10.2, "mean_accuracy_mean": 40.872506666666666, "mean_accuracy_min": 40.605999999999995, "mean_accuracy_max": 41.157, "num_model_switches_mean": 5.8651, "num_model_switches_min": 5.36, "num_model_switches_max": 6.21, "num_slav_mean": 0.12146533333333334, "num_slav_min": 0.09426666666666668, "num_slav_max": 0.14726666666666666, "cpu_conserved_cost_mean": 2.5477999999999996, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5289196446256086, "mean_cluster_cpu_util_min": 0.5013575208333929, "mean_cluster_cpu_util_max": 0.5535685436368217, "mean_cluster_mem_util_mean": 0.346451566464666, "mean_cluster_mem_util_min": 0.33203695929848737, "mean_cluster_mem_util_max": 0.3583918783547174, "reward_consolidation_mean_mean": 0.8177351929696305, "reward_consolidation_mean_min": 0.4727679795302933, "reward_consolidation_mean_max": 1.327307563434768, "reward_illegal_mean_mean": -1.1546666666666667, "reward_illegal_mean_min": -1.5833333333333328, "reward_illegal_mean_max": -0.7, "reward_accuracy_mean_mean": 1.8799166666666665, "reward_accuracy_mean_min": 1.1750000000000005, "reward_accuracy_mean_max": 2.9333333333333353, "reward_sla_mean_mean": -1.9082200000000002, "reward_sla_mean_min": -2.6673333333333336, "reward_sla_mean_max": -1.2113333333333332, "reward_consolidation_sum_mean": 81.77351929696304, "reward_consolidation_sum_min": 47.27679795302933, "reward_consolidation_sum_max": 132.7307563434768, "reward_illegal_sum_mean": -115.46666666666665, "reward_illegal_sum_min": -158.3333333333333, "reward_illegal_sum_max": -70.0, "reward_accuracy_sum_mean": 187.99166666666665, "reward_accuracy_sum_min": 117.50000000000006, "reward_accuracy_sum_max": 293.33333333333354, "reward_sla_sum_mean": -190.82200000000003, "reward_sla_sum_min": -266.73333333333335, "reward_sla_sum_max": -121.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2953.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-104.1295013555089, -71.22806969447744, -69.88589052362232, -74.87656340430696, -71.51779219592423, -74.93912089920511, -95.26266410795334, -138.35653538030394, -78.53742727466573, -107.52589174205741, -79.00988759937856, -105.41895884736068, -86.39545828383434, -92.76367845502459, -29.300572664412577, -41.358935697097, -102.79734990404829, -49.35875597794635, -99.65369033476502, -66.62591915684318, -107.72607450729542, -59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2499859298011055, "mean_inference_ms": 2.0703990062351876, "mean_action_processing_ms": 0.09253159637186326, "mean_env_wait_ms": 1.7956897321381957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006131887435913086, "StateBufferConnector_ms": 0.0037202835083007812, "ViewRequirementAgentConnector_ms": 0.09531807899475098}, "num_episodes": 24, "episode_return_max": 106.66408967680998, "episode_return_min": -138.35653538030394, "episode_return_mean": -36.523480703036945, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77400, "num_agent_steps_trained": 77000, "num_env_steps_sampled": 77400, "num_env_steps_trained": 77000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.53529421600803, "num_env_steps_trained_throughput_per_sec": 208.7900654556523, "timesteps_total": 77400, "num_env_steps_sampled_lifetime": 77400, "num_agent_steps_sampled_lifetime": 77400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 77400, "timers": {"training_iteration_time_ms": 10384.083, "restore_workers_time_ms": 0.014, "training_step_time_ms": 668.984, "sample_time_ms": 654.588, "synch_weights_time_ms": 12.987}, "counters": {"num_env_steps_sampled": 77400, "num_env_steps_trained": 77000, "num_agent_steps_sampled": 77400, "num_agent_steps_trained": 77000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 516, "num_samples_added_to_queue": 77000}, "done": false, "training_iteration": 33, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-00", "timestamp": 1728775140, "time_this_iter_s": 10.552385568618774, "time_total_s": 340.4018659591675, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e341c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.4018659591675, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.72666666666667, "ram_util_percent": 52.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 124214.5625, "policy_loss": 123987.34375, "entropy": 28.397485733032227, "entropy_coeff": 0.01, "var_gnorm": 16.174287796020508, "vf_loss": 38340.8359375, "vf_explained_var": -0.04075980186462402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 144.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 79650, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79650, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 531, "num_samples_added_to_queue": 79200, "learner_queue": {"size_count": 144, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.618, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 2364.436, "learner_dequeue_time_ms": 19455.451}}, "env_runners": {"episode_reward_max": 118.89008498583556, "episode_reward_min": -106.10956471412462, "episode_reward_mean": -6.5277721526698995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -106.10956471412462}, "policy_reward_max": {"default_policy": 118.89008498583556}, "policy_reward_mean": {"default_policy": -6.5277721526698995}, "custom_metrics": {"num_consolidated_mean": 0.7978000000000002, "num_consolidated_min": 0.64, "num_consolidated_max": 1.0, "num_overloaded_mean": 0.6382, "num_overloaded_min": 0.38, "num_overloaded_max": 0.85, "num_moves_mean": 9.8176, "num_moves_min": 9.29, "num_moves_max": 10.15, "mean_accuracy_mean": 40.84951666666666, "mean_accuracy_min": 40.56166666666666, "mean_accuracy_max": 41.157, "num_model_switches_mean": 5.775600000000002, "num_model_switches_min": 5.04, "num_model_switches_max": 6.21, "num_slav_mean": 0.11376866666666667, "num_slav_min": 0.08231666666666665, "num_slav_max": 0.14231666666666667, "cpu_conserved_cost_mean": 2.5454000000000003, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5235104591259203, "mean_cluster_cpu_util_min": 0.49818963830000557, "mean_cluster_cpu_util_max": 0.5529851066634468, "mean_cluster_mem_util_mean": 0.3435346947655644, "mean_cluster_mem_util_min": 0.3306440120985102, "mean_cluster_mem_util_max": 0.357582220356497, "reward_consolidation_mean_mean": 0.905352278473301, "reward_consolidation_mean_min": 0.5725486612446312, "reward_consolidation_mean_max": 1.3545273995552711, "reward_illegal_mean_mean": -1.0636666666666668, "reward_illegal_mean_min": -1.4166666666666663, "reward_illegal_mean_max": -0.6333333333333332, "reward_accuracy_mean_mean": 2.0420833333333333, "reward_accuracy_mean_min": 1.1833333333333313, "reward_accuracy_mean_max": 3.091666666666667, "reward_sla_mean_mean": -1.9490466666666666, "reward_sla_mean_min": -3.005333333333333, "reward_sla_mean_max": -1.2299999999999998, "reward_consolidation_sum_mean": 90.53522784733009, "reward_consolidation_sum_min": 57.25486612446312, "reward_consolidation_sum_max": 135.4527399555271, "reward_illegal_sum_mean": -106.36666666666665, "reward_illegal_sum_min": -141.66666666666663, "reward_illegal_sum_max": -63.33333333333332, "reward_accuracy_sum_mean": 204.2083333333333, "reward_accuracy_sum_min": 118.33333333333313, "reward_accuracy_sum_max": 309.1666666666667, "reward_sla_sum_mean": -194.90466666666663, "reward_sla_sum_min": -300.5333333333333, "reward_sla_sum_max": -122.99999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2171.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-59.76996557921353, -89.07846720887052, -106.10956471412462, -41.12064942581257, -29.211687836973486, -61.618169910749636, -69.41485881385356, -83.17363916049835, -70.94324225532306, -77.61245240488581, -82.55283743032088, -68.52098754150282, -62.235419903134535, -83.68221085016299, -50.197371226659335, -58.48160772487746, -32.78558591489232, -67.90680800511743, -44.15609369764537, -4.049355752535819, -23.848298760242457, -44.18115995004404, -34.60382588564983, -80.45679125163751, -41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2505338691219151, "mean_inference_ms": 2.0764183396489786, "mean_action_processing_ms": 0.09273555882382759, "mean_env_wait_ms": 1.8009615806888672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006071329116821289, "StateBufferConnector_ms": 0.0036933422088623047, "ViewRequirementAgentConnector_ms": 0.09461545944213867}, "num_episodes": 21, "episode_return_max": 118.89008498583556, "episode_return_min": -106.10956471412462, "episode_return_mean": -6.5277721526698995, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79650, "num_agent_steps_trained": 79200, "num_env_steps_sampled": 79650, "num_env_steps_trained": 79200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.48377726966356, "num_env_steps_trained_throughput_per_sec": 218.5174711081155, "timesteps_total": 79650, "num_env_steps_sampled_lifetime": 79650, "num_agent_steps_sampled_lifetime": 79650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 79650, "timers": {"training_iteration_time_ms": 10341.933, "restore_workers_time_ms": 0.013, "training_step_time_ms": 670.171, "sample_time_ms": 655.32, "synch_weights_time_ms": 13.217}, "counters": {"num_env_steps_sampled": 79650, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79650, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 531, "num_samples_added_to_queue": 79200}, "done": false, "training_iteration": 34, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-10", "timestamp": 1728775150, "time_this_iter_s": 10.079208374023438, "time_total_s": 350.4810743331909, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754199600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.4810743331909, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.466666666666665, "ram_util_percent": 52.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 306833.125, "policy_loss": 305432.8125, "entropy": 27.988252639770508, "entropy_coeff": 0.01, "var_gnorm": 16.191516876220703, "vf_loss": 155425.75, "vf_explained_var": -0.05981612205505371}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 148.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 82050, "num_env_steps_trained": 81400, "num_agent_steps_sampled": 82050, "num_agent_steps_trained": 81400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 547, "num_samples_added_to_queue": 81950, "learner_queue": {"size_count": 148, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.11, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 2393.413, "learner_dequeue_time_ms": 19556.827}}, "env_runners": {"episode_reward_max": 174.43014712601655, "episode_reward_min": -77.71442322336954, "episode_reward_mean": 37.0533217277407, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -77.71442322336954}, "policy_reward_max": {"default_policy": 174.43014712601655}, "policy_reward_mean": {"default_policy": 37.0533217277407}, "custom_metrics": {"num_consolidated_mean": 0.8405, "num_consolidated_min": 0.66, "num_consolidated_max": 1.09, "num_overloaded_mean": 0.5679000000000002, "num_overloaded_min": 0.34, "num_overloaded_max": 0.78, "num_moves_mean": 9.7654, "num_moves_min": 9.29, "num_moves_max": 10.15, "mean_accuracy_mean": 40.837863333333324, "mean_accuracy_min": 40.56166666666666, "mean_accuracy_max": 41.157, "num_model_switches_mean": 5.6958, "num_model_switches_min": 4.95, "num_model_switches_max": 6.11, "num_slav_mean": 0.1044045, "num_slav_min": 0.07576666666666666, "num_slav_max": 0.1388333333333333, "cpu_conserved_cost_mean": 2.5627999999999997, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5165341453036421, "mean_cluster_cpu_util_min": 0.49382578799059185, "mean_cluster_cpu_util_max": 0.5425964818561159, "mean_cluster_mem_util_mean": 0.3399498600257613, "mean_cluster_mem_util_min": 0.3290910977998795, "mean_cluster_mem_util_max": 0.35522441749906714, "reward_consolidation_mean_mean": 1.0334398839440737, "reward_consolidation_mean_min": 0.5929274422004935, "reward_consolidation_mean_max": 1.5239681379268328, "reward_illegal_mean_mean": -0.9464999999999999, "reward_illegal_mean_min": -1.2999999999999998, "reward_illegal_mean_max": -0.5666666666666665, "reward_accuracy_mean_mean": 2.2793333333333337, "reward_accuracy_mean_min": 1.483333333333334, "reward_accuracy_mean_max": 3.158333333333333, "reward_sla_mean_mean": -1.9957399999999998, "reward_sla_mean_min": -3.005333333333333, "reward_sla_mean_max": -1.3726666666666665, "reward_consolidation_sum_mean": 103.34398839440739, "reward_consolidation_sum_min": 59.29274422004935, "reward_consolidation_sum_max": 152.39681379268328, "reward_illegal_sum_mean": -94.65, "reward_illegal_sum_min": -129.99999999999997, "reward_illegal_sum_max": -56.66666666666666, "reward_accuracy_sum_mean": 227.93333333333337, "reward_accuracy_sum_min": 148.3333333333334, "reward_accuracy_sum_max": 315.8333333333333, "reward_sla_sum_mean": -199.574, "reward_sla_sum_min": -300.5333333333333, "reward_sla_sum_max": -137.26666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2271.0, "global_timestep_min": 300, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-41.57268878126043, -62.33833196259398, -29.547814432361516, -55.32451186450996, -29.504279752657723, -42.90991501416431, -37.302062201102665, -32.62312589478817, -70.70067318529348, -77.71442322336954, -31.14556337384622, -26.47495507021253, -5.820134637058805, -43.15800968655734, -28.601172743610753, -7.514191720734667, 12.131590971397069, -20.757571049986275, -40.13170976880204, -36.558076700478146, -40.88329221115477, -30.77574400682343, -23.069063937372434, -11.40250997593596, -32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508747580657099, "mean_inference_ms": 2.0808886912412303, "mean_action_processing_ms": 0.09287615808033042, "mean_env_wait_ms": 1.805094090299822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005795717239379883, "StateBufferConnector_ms": 0.003539562225341797, "ViewRequirementAgentConnector_ms": 0.09063124656677246}, "num_episodes": 24, "episode_return_max": 174.43014712601655, "episode_return_min": -77.71442322336954, "episode_return_mean": 37.0533217277407, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82050, "num_agent_steps_trained": 81400, "num_env_steps_sampled": 82050, "num_env_steps_trained": 81400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 228.27273675990045, "num_env_steps_trained_throughput_per_sec": 209.2500086965754, "timesteps_total": 82050, "num_env_steps_sampled_lifetime": 82050, "num_agent_steps_sampled_lifetime": 82050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 82050, "timers": {"training_iteration_time_ms": 10389.185, "restore_workers_time_ms": 0.016, "training_step_time_ms": 662.328, "sample_time_ms": 646.612, "synch_weights_time_ms": 14.259}, "counters": {"num_env_steps_sampled": 82050, "num_env_steps_trained": 81400, "num_agent_steps_sampled": 82050, "num_agent_steps_trained": 81400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 547, "num_samples_added_to_queue": 81950}, "done": false, "training_iteration": 35, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-21", "timestamp": 1728775161, "time_this_iter_s": 10.525100469589233, "time_total_s": 361.00617480278015, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6830>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.00617480278015, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 16.599999999999998, "ram_util_percent": 52.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 358989.59375, "policy_loss": 357007.96875, "entropy": 27.459497451782227, "entropy_coeff": 0.01, "var_gnorm": 16.210792541503906, "vf_loss": 213267.09375, "vf_explained_var": -0.05782806873321533}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 84300, "num_env_steps_trained": 84150, "num_agent_steps_sampled": 84300, "num_agent_steps_trained": 84150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 562, "num_samples_added_to_queue": 84150, "learner_queue": {"size_count": 153, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.886, "learner_load_time_ms": 0.375, "learner_load_wait_time_ms": 2329.628, "learner_dequeue_time_ms": 19594.404}}, "env_runners": {"episode_reward_max": 230.03362271162706, "episode_reward_min": -73.4405891132839, "episode_reward_mean": 85.58427015748269, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -73.4405891132839}, "policy_reward_max": {"default_policy": 230.03362271162706}, "policy_reward_mean": {"default_policy": 85.58427015748269}, "custom_metrics": {"num_consolidated_mean": 0.8936, "num_consolidated_min": 0.66, "num_consolidated_max": 1.12, "num_overloaded_mean": 0.49620000000000003, "num_overloaded_min": 0.3, "num_overloaded_max": 0.78, "num_moves_mean": 9.688600000000001, "num_moves_min": 9.17, "num_moves_max": 10.08, "mean_accuracy_mean": 40.820383333333325, "mean_accuracy_min": 40.56166666666666, "mean_accuracy_max": 41.03033333333334, "num_model_switches_mean": 5.577800000000001, "num_model_switches_min": 4.95, "num_model_switches_max": 6.11, "num_slav_mean": 0.09446249999999999, "num_slav_min": 0.06686666666666667, "num_slav_max": 0.12726666666666667, "cpu_conserved_cost_mean": 2.5999999999999996, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5093783359973891, "mean_cluster_cpu_util_min": 0.4903521076223866, "mean_cluster_cpu_util_max": 0.5367535655699053, "mean_cluster_mem_util_mean": 0.33600514618674476, "mean_cluster_mem_util_min": 0.3229380080513218, "mean_cluster_mem_util_max": 0.3492273477640002, "reward_consolidation_mean_mean": 1.1698927015748268, "reward_consolidation_mean_min": 0.5929274422004935, "reward_consolidation_mean_max": 1.5811049681683877, "reward_illegal_mean_mean": -0.8269999999999998, "reward_illegal_mean_min": -1.2999999999999998, "reward_illegal_mean_max": -0.49999999999999994, "reward_accuracy_mean_mean": 2.52625, "reward_accuracy_mean_min": 1.483333333333334, "reward_accuracy_mean_max": 3.3250000000000006, "reward_sla_mean_mean": -2.0133, "reward_sla_mean_min": -3.005333333333333, "reward_sla_mean_max": -1.4399999999999997, "reward_consolidation_sum_mean": 116.9892701574827, "reward_consolidation_sum_min": 59.29274422004935, "reward_consolidation_sum_max": 158.11049681683878, "reward_illegal_sum_mean": -82.7, "reward_illegal_sum_min": -129.99999999999997, "reward_illegal_sum_max": -49.99999999999999, "reward_accuracy_sum_mean": 252.62499999999997, "reward_accuracy_sum_min": 148.3333333333334, "reward_accuracy_sum_max": 332.50000000000006, "reward_sla_sum_mean": -201.33000000000004, "reward_sla_sum_min": -300.5333333333333, "reward_sla_sum_max": -143.99999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3067.0, "global_timestep_min": 1000, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-32.997288982302244, -73.4405891132839, -29.867324621523547, -38.62233695817718, 63.67019403576109, -41.879225684608116, -35.11699107496404, 28.568506503396307, 31.83352523683342, 9.06529592738118, 81.72626641079529, 44.258609765755864, 30.235956014499422, 6.745124737274949, 52.34383928843409, -28.901398154071043, -50.780578147369766, 43.415397971305666, 1.8086843948948323, -8.304611776173296, -26.277419354838653, 13.042709190045532, 85.75967589631135, 106.66408967680998, -21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510814021482565, "mean_inference_ms": 2.083373751700876, "mean_action_processing_ms": 0.09294470165117313, "mean_env_wait_ms": 1.8077851640312737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005644559860229492, "StateBufferConnector_ms": 0.003458261489868164, "ViewRequirementAgentConnector_ms": 0.08866381645202637}, "num_episodes": 24, "episode_return_max": 230.03362271162706, "episode_return_min": -73.4405891132839, "episode_return_mean": 85.58427015748269, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84300, "num_agent_steps_trained": 84150, "num_env_steps_sampled": 84300, "num_env_steps_trained": 84150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 221.50440265743768, "num_env_steps_trained_throughput_per_sec": 270.7276032479794, "timesteps_total": 84300, "num_env_steps_sampled_lifetime": 84300, "num_agent_steps_sampled_lifetime": 84300, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 84300, "timers": {"training_iteration_time_ms": 10350.479, "restore_workers_time_ms": 0.015, "training_step_time_ms": 659.45, "sample_time_ms": 644.292, "synch_weights_time_ms": 13.727}, "counters": {"num_env_steps_sampled": 84300, "num_env_steps_trained": 84150, "num_agent_steps_sampled": 84300, "num_agent_steps_trained": 84150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 562, "num_samples_added_to_queue": 84150}, "done": false, "training_iteration": 36, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-31", "timestamp": 1728775171, "time_this_iter_s": 10.17333436012268, "time_total_s": 371.17950916290283, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419a320>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 371.17950916290283, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.37142857142857, "ram_util_percent": 52.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 472639.15625, "policy_loss": 469157.84375, "entropy": 27.02037811279297, "entropy_coeff": 0.01, "var_gnorm": 16.22416114807129, "vf_loss": 362993.34375, "vf_explained_var": -0.05764138698577881}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 86700, "num_env_steps_trained": 86350, "num_agent_steps_sampled": 86700, "num_agent_steps_trained": 86350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 578, "num_samples_added_to_queue": 86350, "learner_queue": {"size_count": 157, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.608, "learner_load_time_ms": 0.375, "learner_load_wait_time_ms": 2393.904, "learner_dequeue_time_ms": 19594.404}}, "env_runners": {"episode_reward_max": 287.6910049042008, "episode_reward_min": -21.704861555332116, "episode_reward_mean": 138.11026153705566, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -21.704861555332116}, "policy_reward_max": {"default_policy": 287.6910049042008}, "policy_reward_mean": {"default_policy": 138.11026153705566}, "custom_metrics": {"num_consolidated_mean": 0.9461999999999999, "num_consolidated_min": 0.7, "num_consolidated_max": 1.2, "num_overloaded_mean": 0.4316000000000002, "num_overloaded_min": 0.24, "num_overloaded_max": 0.7, "num_moves_mean": 9.600900000000001, "num_moves_min": 9.16, "num_moves_max": 10.06, "mean_accuracy_mean": 40.810946666666666, "mean_accuracy_min": 40.56166666666666, "mean_accuracy_max": 41.15700000000001, "num_model_switches_mean": 5.438700000000001, "num_model_switches_min": 4.9, "num_model_switches_max": 5.97, "num_slav_mean": 0.08484766666666667, "num_slav_min": 0.05756666666666666, "num_slav_max": 0.11803333333333332, "cpu_conserved_cost_mean": 2.6332, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.14, "mean_cluster_cpu_util_mean": 0.5029647162643537, "mean_cluster_cpu_util_min": 0.48523667244852703, "mean_cluster_cpu_util_max": 0.5330451236160687, "mean_cluster_mem_util_mean": 0.33247133522058614, "mean_cluster_mem_util_min": 0.3190438809595568, "mean_cluster_mem_util_max": 0.3492273477640002, "reward_consolidation_mean_mean": 1.3097126153705565, "reward_consolidation_mean_min": 0.8039513844466782, "reward_consolidation_mean_max": 1.8602433823753386, "reward_illegal_mean_mean": -0.719333333333333, "reward_illegal_mean_min": -1.1666666666666665, "reward_illegal_mean_max": -0.3999999999999999, "reward_accuracy_mean_mean": 2.7587500000000005, "reward_accuracy_mean_min": 1.766666666666665, "reward_accuracy_mean_max": 3.6333333333333355, "reward_sla_mean_mean": -1.968026666666667, "reward_sla_mean_min": -3.005333333333333, "reward_sla_mean_max": -1.4333333333333331, "reward_consolidation_sum_mean": 130.97126153705565, "reward_consolidation_sum_min": 80.39513844466782, "reward_consolidation_sum_max": 186.02433823753387, "reward_illegal_sum_mean": -71.93333333333334, "reward_illegal_sum_min": -116.66666666666664, "reward_illegal_sum_max": -39.99999999999999, "reward_accuracy_sum_mean": 275.875, "reward_accuracy_sum_min": 176.66666666666652, "reward_accuracy_sum_max": 363.33333333333354, "reward_sla_sum_mean": -196.80266666666662, "reward_sla_sum_min": -300.5333333333333, "reward_sla_sum_max": -143.33333333333331, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3867.0, "global_timestep_min": 1800, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-21.704861555332116, 24.24024795150604, 7.427268573517313, -6.828356026683716, 18.98315209113879, 25.824362606232242, 52.83802430777681, 80.75273995552718, 46.283353132900544, 93.0335069603095, 11.402372902007402, 118.89008498583556, 45.33863352523674, 78.57718480611639, 56.15094581010703, 44.59232081391463, 76.2517164701939, 72.14007432453013, 57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2511954001976359, "mean_inference_ms": 2.0833996128075234, "mean_action_processing_ms": 0.092970894412975, "mean_env_wait_ms": 1.8093657315809382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056536197662353516, "StateBufferConnector_ms": 0.00344085693359375, "ViewRequirementAgentConnector_ms": 0.08850383758544922}, "num_episodes": 24, "episode_return_max": 287.6910049042008, "episode_return_min": -21.704861555332116, "episode_return_mean": 138.11026153705566, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86700, "num_agent_steps_trained": 86350, "num_env_steps_sampled": 86700, "num_env_steps_trained": 86350, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 226.74072146463132, "num_env_steps_trained_throughput_per_sec": 207.84566134257872, "timesteps_total": 86700, "num_env_steps_sampled_lifetime": 86700, "num_agent_steps_sampled_lifetime": 86700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 86700, "timers": {"training_iteration_time_ms": 10371.329, "restore_workers_time_ms": 0.015, "training_step_time_ms": 672.841, "sample_time_ms": 656.538, "synch_weights_time_ms": 14.672}, "counters": {"num_env_steps_sampled": 86700, "num_env_steps_trained": 86350, "num_agent_steps_sampled": 86700, "num_agent_steps_trained": 86350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 578, "num_samples_added_to_queue": 86350}, "done": false, "training_iteration": 37, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-42", "timestamp": 1728775182, "time_this_iter_s": 10.59434175491333, "time_total_s": 381.77385091781616, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754199ea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.77385091781616, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 16.95625, "ram_util_percent": 52.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 505104.59375, "policy_loss": 501075.5625, "entropy": 26.668193817138672, "entropy_coeff": 0.01, "var_gnorm": 16.23335838317871, "vf_loss": 417570.8125, "vf_explained_var": -0.053937673568725586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 160.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 88650, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 591, "num_samples_added_to_queue": 88550, "learner_queue": {"size_count": 160, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.938, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2530.858, "learner_dequeue_time_ms": 19938.115}}, "env_runners": {"episode_reward_max": 297.42555362636693, "episode_reward_min": -13.054552377471243, "episode_reward_mean": 177.79189162021382, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -13.054552377471243}, "policy_reward_max": {"default_policy": 297.42555362636693}, "policy_reward_mean": {"default_policy": 177.79189162021382}, "custom_metrics": {"num_consolidated_mean": 0.9964999999999999, "num_consolidated_min": 0.74, "num_consolidated_max": 1.23, "num_overloaded_mean": 0.3907, "num_overloaded_min": 0.24, "num_overloaded_max": 0.68, "num_moves_mean": 9.536999999999999, "num_moves_min": 8.96, "num_moves_max": 10.06, "mean_accuracy_mean": 40.81721666666667, "mean_accuracy_min": 40.56166666666666, "mean_accuracy_max": 41.15700000000001, "num_model_switches_mean": 5.3485000000000005, "num_model_switches_min": 4.73, "num_model_switches_max": 5.97, "num_slav_mean": 0.078316, "num_slav_min": 0.057216666666666666, "num_slav_max": 0.10576666666666668, "cpu_conserved_cost_mean": 2.697, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.26, "mean_cluster_cpu_util_mean": 0.49876234217113713, "mean_cluster_cpu_util_min": 0.48372609362660485, "mean_cluster_cpu_util_max": 0.5272619399734407, "mean_cluster_mem_util_mean": 0.3299175887851976, "mean_cluster_mem_util_min": 0.3190438809595568, "mean_cluster_mem_util_max": 0.34410757861161334, "reward_consolidation_mean_mean": 1.416785582868805, "reward_consolidation_mean_min": 0.8321211428919552, "reward_consolidation_mean_max": 1.8602433823753386, "reward_illegal_mean_mean": -0.6511666666666666, "reward_illegal_mean_min": -1.133333333333333, "reward_illegal_mean_max": -0.3999999999999999, "reward_accuracy_mean_mean": 2.938, "reward_accuracy_mean_min": 1.766666666666665, "reward_accuracy_mean_max": 3.6833333333333353, "reward_sla_mean_mean": -1.9256999999999997, "reward_sla_mean_min": -2.4646666666666666, "reward_sla_mean_max": -1.3073333333333335, "reward_consolidation_sum_mean": 141.6785582868805, "reward_consolidation_sum_min": 83.21211428919551, "reward_consolidation_sum_max": 186.02433823753387, "reward_illegal_sum_mean": -65.11666666666666, "reward_illegal_sum_min": -113.3333333333333, "reward_illegal_sum_max": -39.99999999999999, "reward_accuracy_sum_mean": 293.80000000000007, "reward_accuracy_sum_min": 176.66666666666652, "reward_accuracy_sum_max": 368.33333333333354, "reward_sla_sum_mean": -192.57, "reward_sla_sum_min": -246.46666666666667, "reward_sla_sum_max": -130.73333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4471.0, "global_timestep_min": 2500, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [57.72104237107446, 96.39968016083331, 73.3851899235432, -13.054552377471243, 65.96403789332606, 59.489451399677364, 80.61904718389229, 23.83330591854757, 38.62213287032804, 46.50984800024364, 65.34600505650481, 73.79258277742223, 22.064918212555927, 121.98596972189196, 163.16873495994386, 173.24955679429766, 159.68182095098845, 118.43454872216641, 76.44597764171924, 50.41107557342602, 112.97925309939369, 160.79372810624758, 174.43014712601655, 167.13871881568133, 132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25139317014357726, "mean_inference_ms": 2.0836363632005344, "mean_action_processing_ms": 0.09302364200732784, "mean_env_wait_ms": 1.8112667358823737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005709409713745117, "StateBufferConnector_ms": 0.0034797191619873047, "ViewRequirementAgentConnector_ms": 0.08937430381774902}, "num_episodes": 18, "episode_return_max": 297.42555362636693, "episode_return_min": -13.054552377471243, "episode_return_mean": 177.79189162021382, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88650, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 188.9074205927678, "num_env_steps_trained_throughput_per_sec": 159.84474050157274, "timesteps_total": 88650, "num_env_steps_sampled_lifetime": 88650, "num_agent_steps_sampled_lifetime": 88650, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 88650, "timers": {"training_iteration_time_ms": 10372.633, "restore_workers_time_ms": 0.013, "training_step_time_ms": 703.381, "sample_time_ms": 687.206, "synch_weights_time_ms": 14.772}, "counters": {"num_env_steps_sampled": 88650, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 591, "num_samples_added_to_queue": 88550}, "done": false, "training_iteration": 38, "trial_id": "90ffb_00000", "date": "2024-10-13_00-19-52", "timestamp": 1728775192, "time_this_iter_s": 10.339869499206543, "time_total_s": 392.1137204170227, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7d00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 392.1137204170227, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.507142857142863, "ram_util_percent": 54.94285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 511296.53125, "policy_loss": 506938.125, "entropy": 26.196292877197266, "entropy_coeff": 0.01, "var_gnorm": 16.24474334716797, "vf_loss": 450248.8125, "vf_explained_var": -0.048156142234802246}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 165.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 90900, "num_env_steps_trained": 90750, "num_agent_steps_sampled": 90900, "num_agent_steps_trained": 90750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 606, "num_samples_added_to_queue": 90750, "learner_queue": {"size_count": 165, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.381, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2488.149, "learner_dequeue_time_ms": 19938.115}}, "env_runners": {"episode_reward_max": 410.5222699442565, "episode_reward_min": 45.75664503944684, "episode_reward_mean": 227.74283944073846, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 45.75664503944684}, "policy_reward_max": {"default_policy": 410.5222699442565}, "policy_reward_mean": {"default_policy": 227.74283944073846}, "custom_metrics": {"num_consolidated_mean": 1.0578, "num_consolidated_min": 0.83, "num_consolidated_max": 1.29, "num_overloaded_mean": 0.3391, "num_overloaded_min": 0.17, "num_overloaded_max": 0.55, "num_moves_mean": 9.445100000000002, "num_moves_min": 8.96, "num_moves_max": 9.99, "mean_accuracy_mean": 40.828046666666665, "mean_accuracy_min": 40.56166666666667, "mean_accuracy_max": 41.15700000000001, "num_model_switches_mean": 5.214700000000001, "num_model_switches_min": 4.63, "num_model_switches_max": 5.93, "num_slav_mean": 0.07037183333333334, "num_slav_min": 0.04208333333333334, "num_slav_max": 0.10576666666666668, "cpu_conserved_cost_mean": 2.7769999999999992, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.32, "mean_cluster_cpu_util_mean": 0.4937225752438789, "mean_cluster_cpu_util_min": 0.47525656205732547, "mean_cluster_cpu_util_max": 0.5134156366190925, "mean_cluster_mem_util_mean": 0.3267832317715061, "mean_cluster_mem_util_min": 0.31593323950888375, "mean_cluster_mem_util_max": 0.3383248968469244, "reward_consolidation_mean_mean": 1.5441050610740508, "reward_consolidation_mean_min": 1.0633267842456364, "reward_consolidation_mean_max": 1.9595560327758994, "reward_illegal_mean_mean": -0.5651666666666666, "reward_illegal_mean_min": -0.9166666666666667, "reward_illegal_mean_max": -0.28333333333333327, "reward_accuracy_mean_mean": 3.1522499999999996, "reward_accuracy_mean_min": 2.3083333333333336, "reward_accuracy_mean_max": 4.0000000000000036, "reward_sla_mean_mean": -1.85376, "reward_sla_mean_min": -2.4646666666666666, "reward_sla_mean_max": -1.2373333333333334, "reward_consolidation_sum_mean": 154.410506107405, "reward_consolidation_sum_min": 106.33267842456364, "reward_consolidation_sum_max": 195.95560327758994, "reward_illegal_sum_mean": -56.51666666666666, "reward_illegal_sum_min": -91.66666666666667, "reward_illegal_sum_max": -28.33333333333333, "reward_accuracy_sum_mean": 315.2250000000001, "reward_accuracy_sum_min": 230.83333333333337, "reward_accuracy_sum_max": 400.00000000000034, "reward_sla_sum_mean": -185.37600000000003, "reward_sla_sum_min": -246.46666666666667, "reward_sla_sum_max": -123.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5266.0, "global_timestep_min": 3200, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [132.07889975326682, 158.80207133936477, 45.75664503944684, 134.95092144140838, 104.00040512961117, 151.84326053184685, 171.35416247829627, 128.4637393767703, 91.9356544518564, 173.28953973620884, 174.70933321148996, 115.80811477656938, 178.3873100003044, 177.91205945962426, 196.5884736056537, 172.36639251880962, 159.65868287185114, 163.5964695848182, 159.69260714612096, 157.38026744646507, 149.96742818849188, 230.03362271162706, 133.80467269791944, 188.0841999451706, 215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516612084442284, "mean_inference_ms": 2.0859973361871407, "mean_action_processing_ms": 0.09310831599955996, "mean_env_wait_ms": 1.8142043854970757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005912303924560547, "StateBufferConnector_ms": 0.003505706787109375, "ViewRequirementAgentConnector_ms": 0.0892791748046875}, "num_episodes": 24, "episode_return_max": 410.5222699442565, "episode_return_min": 45.75664503944684, "episode_return_mean": 227.74283944073846, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90900, "num_agent_steps_trained": 90750, "num_env_steps_sampled": 90900, "num_env_steps_trained": 90750, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 223.5146995293422, "num_env_steps_trained_throughput_per_sec": 273.18463275808494, "timesteps_total": 90900, "num_env_steps_sampled_lifetime": 90900, "num_agent_steps_sampled_lifetime": 90900, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 90900, "timers": {"training_iteration_time_ms": 10369.193, "restore_workers_time_ms": 0.013, "training_step_time_ms": 665.053, "sample_time_ms": 649.351, "synch_weights_time_ms": 14.203}, "counters": {"num_env_steps_sampled": 90900, "num_env_steps_trained": 90750, "num_agent_steps_sampled": 90900, "num_agent_steps_trained": 90750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 606, "num_samples_added_to_queue": 90750}, "done": false, "training_iteration": 39, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-02", "timestamp": 1728775202, "time_this_iter_s": 10.079480648040771, "time_total_s": 402.1932010650635, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419a230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.1932010650635, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 16.673333333333336, "ram_util_percent": 54.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 585987.875, "policy_loss": 580038.0625, "entropy": 25.902053833007812, "entropy_coeff": 0.01, "var_gnorm": 16.25139045715332, "vf_loss": 609225.875, "vf_explained_var": -0.042896151542663574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 169.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 93300, "num_env_steps_trained": 92950, "num_agent_steps_sampled": 93300, "num_agent_steps_trained": 92950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 622, "num_samples_added_to_queue": 92950, "learner_queue": {"size_count": 169, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.735, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 2399.115, "learner_dequeue_time_ms": 19909.919}}, "env_runners": {"episode_reward_max": 410.5222699442565, "episode_reward_min": 96.56601175789702, "episode_reward_mean": 271.42811888878737, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 96.56601175789702}, "policy_reward_max": {"default_policy": 410.5222699442565}, "policy_reward_mean": {"default_policy": 271.42811888878737}, "custom_metrics": {"num_consolidated_mean": 1.111, "num_consolidated_min": 0.84, "num_consolidated_max": 1.36, "num_overloaded_mean": 0.3033, "num_overloaded_min": 0.17, "num_overloaded_max": 0.52, "num_moves_mean": 9.365699999999999, "num_moves_min": 8.95, "num_moves_max": 9.83, "mean_accuracy_mean": 40.843246666666666, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.15700000000001, "num_model_switches_mean": 5.0503, "num_model_switches_min": 4.44, "num_model_switches_max": 5.64, "num_slav_mean": 0.06332483333333333, "num_slav_min": 0.04186666666666666, "num_slav_max": 0.08291666666666667, "cpu_conserved_cost_mean": 2.8475999999999995, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.4899802207282822, "mean_cluster_cpu_util_min": 0.47525656205732547, "mean_cluster_cpu_util_max": 0.5134156366190925, "mean_cluster_mem_util_mean": 0.3242639511592612, "mean_cluster_mem_util_min": 0.31480681779040726, "mean_cluster_mem_util_max": 0.3383248968469244, "reward_consolidation_mean_mean": 1.6477311888878736, "reward_consolidation_mean_min": 1.0633267842456364, "reward_consolidation_mean_max": 1.996155533217582, "reward_illegal_mean_mean": -0.5055, "reward_illegal_mean_min": -0.8666666666666665, "reward_illegal_mean_max": -0.28333333333333327, "reward_accuracy_mean_mean": 3.3139166666666675, "reward_accuracy_mean_min": 2.3083333333333336, "reward_accuracy_mean_max": 4.0000000000000036, "reward_sla_mean_mean": -1.7418666666666667, "reward_sla_mean_min": -2.372666666666667, "reward_sla_mean_max": -1.1680000000000001, "reward_consolidation_sum_mean": 164.77311888878737, "reward_consolidation_sum_min": 106.33267842456364, "reward_consolidation_sum_max": 199.6155533217582, "reward_illegal_sum_mean": -50.54999999999999, "reward_illegal_sum_min": -86.66666666666664, "reward_illegal_sum_max": -28.33333333333333, "reward_accuracy_sum_mean": 331.3916666666667, "reward_accuracy_sum_min": 230.83333333333337, "reward_accuracy_sum_max": 400.00000000000034, "reward_sla_sum_mean": -174.18666666666664, "reward_sla_sum_min": -237.26666666666668, "reward_sla_sum_max": -116.80000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6066.0, "global_timestep_min": 4000, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [215.210496816839, 205.4160102348534, 153.25886259100176, 119.87172621767331, 175.26454658990536, 157.2398336836333, 96.56601175789702, 191.3589235127476, 178.0156203356788, 189.20494684577665, 211.57594200249778, 201.38128788571095, 267.9257912211763, 180.9666301136191, 213.0856833896862, 206.3415394925219, 279.2651558073656, 252.1243351914466, 182.30646684333988, 137.02063114928862, 225.92983642511183, 228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518973706618428, "mean_inference_ms": 2.0881687539388194, "mean_action_processing_ms": 0.0931934413279498, "mean_env_wait_ms": 1.8170627936916202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006385087966918945, "StateBufferConnector_ms": 0.0035698413848876953, "ViewRequirementAgentConnector_ms": 0.09137415885925293}, "num_episodes": 24, "episode_return_max": 410.5222699442565, "episode_return_min": 96.56601175789702, "episode_return_mean": 271.42811888878737, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93300, "num_agent_steps_trained": 92950, "num_env_steps_sampled": 93300, "num_env_steps_trained": 92950, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 227.20780590579207, "num_env_steps_trained_throughput_per_sec": 208.2738220803094, "timesteps_total": 93300, "num_env_steps_sampled_lifetime": 93300, "num_agent_steps_sampled_lifetime": 93300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 93300, "timers": {"training_iteration_time_ms": 10341.657, "restore_workers_time_ms": 0.015, "training_step_time_ms": 663.293, "sample_time_ms": 647.286, "synch_weights_time_ms": 14.635}, "counters": {"num_env_steps_sampled": 93300, "num_env_steps_trained": 92950, "num_agent_steps_sampled": 93300, "num_agent_steps_trained": 92950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 622, "num_samples_added_to_queue": 92950}, "done": false, "training_iteration": 40, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-13", "timestamp": 1728775213, "time_this_iter_s": 10.57477617263794, "time_total_s": 412.7679772377014, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e34610>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.7679772377014, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 16.666666666666668, "ram_util_percent": 54.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 658894.1875, "policy_loss": 651200.5, "entropy": 25.371654510498047, "entropy_coeff": 0.01, "var_gnorm": 16.25796127319336, "vf_loss": 783324.25, "vf_explained_var": -0.04306793212890625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 95550, "num_env_steps_trained": 95150, "num_agent_steps_sampled": 95550, "num_agent_steps_trained": 95150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 637, "num_samples_added_to_queue": 95150, "learner_queue": {"size_count": 173, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.418, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 2399.549, "learner_dequeue_time_ms": 19909.919}}, "env_runners": {"episode_reward_max": 472.038542142618, "episode_reward_min": 197.75727253343086, "episode_reward_mean": 312.50062575771426, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 197.75727253343086}, "policy_reward_max": {"default_policy": 472.038542142618}, "policy_reward_mean": {"default_policy": 312.50062575771426}, "custom_metrics": {"num_consolidated_mean": 1.1662000000000001, "num_consolidated_min": 0.93, "num_consolidated_max": 1.43, "num_overloaded_mean": 0.27140000000000003, "num_overloaded_min": 0.14, "num_overloaded_max": 0.45, "num_moves_mean": 9.2746, "num_moves_min": 8.6, "num_moves_max": 9.75, "mean_accuracy_mean": 40.861486666666664, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.15700000000001, "num_model_switches_mean": 4.9103, "num_model_switches_min": 4.32, "num_model_switches_max": 5.64, "num_slav_mean": 0.05746683333333334, "num_slav_min": 0.03754999999999999, "num_slav_max": 0.08126666666666667, "cpu_conserved_cost_mean": 2.9352000000000005, "cpu_conserved_cost_min": 2.34, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.4871782950779405, "mean_cluster_cpu_util_min": 0.4719508906422813, "mean_cluster_cpu_util_max": 0.5015724588422752, "mean_cluster_mem_util_mean": 0.32223518728651795, "mean_cluster_mem_util_min": 0.31175243548896353, "mean_cluster_mem_util_max": 0.3302505001578691, "reward_consolidation_mean_mean": 1.7528862575771418, "reward_consolidation_mean_min": 1.3831790490115445, "reward_consolidation_mean_max": 2.178385421426178, "reward_illegal_mean_mean": -0.45233333333333337, "reward_illegal_mean_min": -0.7499999999999999, "reward_illegal_mean_max": -0.23333333333333328, "reward_accuracy_mean_mean": 3.479500000000001, "reward_accuracy_mean_min": 2.833333333333333, "reward_accuracy_mean_max": 4.100000000000002, "reward_sla_mean_mean": -1.6550466666666668, "reward_sla_mean_min": -2.372666666666667, "reward_sla_mean_max": -0.9519999999999998, "reward_consolidation_sum_mean": 175.28862575771421, "reward_consolidation_sum_min": 138.31790490115446, "reward_consolidation_sum_max": 217.8385421426178, "reward_illegal_sum_mean": -45.23333333333333, "reward_illegal_sum_min": -74.99999999999999, "reward_illegal_sum_max": -23.33333333333333, "reward_accuracy_sum_mean": 347.95000000000016, "reward_accuracy_sum_min": 283.3333333333333, "reward_accuracy_sum_max": 410.0000000000002, "reward_sla_sum_mean": -165.50466666666662, "reward_sla_sum_min": -237.26666666666668, "reward_sla_sum_max": -95.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5363.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [228.52562368637513, 253.48554326967013, 287.6910049042008, 198.3020713393648, 238.84176490298222, 197.75727253343086, 216.31083797861686, 264.4404764080539, 255.0064607511653, 262.96108928081867, 263.7095098845533, 217.9185049803527, 242.67578969813292, 277.0532151451461, 286.90993329068823, 269.2309695695883, 276.67209174814934, 241.70230588808676, 294.51094763775933, 258.1068171433795, 271.9204361997016, 250.78727344725692, 297.42555362636693, 211.78457156782142, 293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2520218766012538, "mean_inference_ms": 2.0885477172203224, "mean_action_processing_ms": 0.09324843763785343, "mean_env_wait_ms": 1.8191200687092186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063321590423583984, "StateBufferConnector_ms": 0.0035181045532226562, "ViewRequirementAgentConnector_ms": 0.0901944637298584}, "num_episodes": 21, "episode_return_max": 472.038542142618, "episode_return_min": 197.75727253343086, "episode_return_mean": 312.50062575771426, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95550, "num_agent_steps_trained": 95150, "num_env_steps_sampled": 95550, "num_env_steps_trained": 95150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 222.18932859847226, "num_env_steps_trained_throughput_per_sec": 217.25178796295066, "timesteps_total": 95550, "num_env_steps_sampled_lifetime": 95550, "num_agent_steps_sampled_lifetime": 95550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 95550, "timers": {"training_iteration_time_ms": 10320.629, "restore_workers_time_ms": 0.014, "training_step_time_ms": 676.243, "sample_time_ms": 660.521, "synch_weights_time_ms": 14.172}, "counters": {"num_env_steps_sampled": 95550, "num_env_steps_trained": 95150, "num_agent_steps_sampled": 95550, "num_agent_steps_trained": 95150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 637, "num_samples_added_to_queue": 95150}, "done": false, "training_iteration": 41, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-23", "timestamp": 1728775223, "time_this_iter_s": 10.139427185058594, "time_total_s": 422.90740442276, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419b370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.90740442276, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.8, "ram_util_percent": 53.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 628599.1875, "policy_loss": 621651.0625, "entropy": 24.918949127197266, "entropy_coeff": 0.01, "var_gnorm": 16.265445709228516, "vf_loss": 708516.125, "vf_explained_var": -0.04685699939727783}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 177.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97350, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 652, "num_samples_added_to_queue": 97350, "learner_queue": {"size_count": 177, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.627, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 2353.446, "learner_dequeue_time_ms": 20023.572}}, "env_runners": {"episode_reward_max": 472.038542142618, "episode_reward_min": 214.93550214749175, "episode_reward_mean": 349.82430131895586, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 214.93550214749175}, "policy_reward_max": {"default_policy": 472.038542142618}, "policy_reward_mean": {"default_policy": 349.82430131895586}, "custom_metrics": {"num_consolidated_mean": 1.2217, "num_consolidated_min": 0.98, "num_consolidated_max": 1.47, "num_overloaded_mean": 0.24450000000000005, "num_overloaded_min": 0.12, "num_overloaded_max": 0.4, "num_moves_mean": 9.150300000000001, "num_moves_min": 8.45, "num_moves_max": 9.56, "mean_accuracy_mean": 40.87085999999999, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.1, "num_model_switches_mean": 4.771399999999999, "num_model_switches_min": 4.23, "num_model_switches_max": 5.64, "num_slav_mean": 0.051774166666666656, "num_slav_min": 0.033466666666666665, "num_slav_max": 0.07406666666666668, "cpu_conserved_cost_mean": 3.0257999999999994, "cpu_conserved_cost_min": 2.48, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.48415460814630273, "mean_cluster_cpu_util_min": 0.4719508906422813, "mean_cluster_cpu_util_max": 0.5015724588422752, "mean_cluster_mem_util_mean": 0.32022801850835264, "mean_cluster_mem_util_min": 0.31175243548896353, "mean_cluster_mem_util_max": 0.3302505001578691, "reward_consolidation_mean_mean": 1.843006346522891, "reward_consolidation_mean_min": 1.482021688141582, "reward_consolidation_mean_max": 2.2413381461512683, "reward_illegal_mean_mean": -0.4075, "reward_illegal_mean_min": -0.6666666666666667, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 3.6042500000000013, "reward_accuracy_mean_min": 2.833333333333333, "reward_accuracy_mean_max": 4.133333333333336, "reward_sla_mean_mean": -1.5415133333333333, "reward_sla_mean_min": -2.322, "reward_sla_mean_max": -0.9519999999999998, "reward_consolidation_sum_mean": 184.30063465228912, "reward_consolidation_sum_min": 148.2021688141582, "reward_consolidation_sum_max": 224.13381461512682, "reward_illegal_sum_mean": -40.74999999999999, "reward_illegal_sum_min": -66.66666666666667, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 360.42500000000007, "reward_accuracy_sum_min": 283.3333333333333, "reward_accuracy_sum_max": 413.3333333333336, "reward_sla_sum_mean": -154.15133333333333, "reward_sla_sum_min": -232.2, "reward_sla_sum_max": -95.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4297.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [293.58731304639196, 214.93550214749175, 291.8553778671298, 266.0057662432605, 266.4908952450578, 248.7938438575651, 274.58296627981383, 245.95331261994005, 235.25807365439115, 328.4685735173168, 272.93454262999165, 297.7807913734807, 282.47604861555334, 322.2995400408178, 291.7792805141794, 286.7055804319353, 285.9169636601785, 294.45596576197863, 410.5222699442565, 356.87617655121994, 333.92357671570903, 280.74181973255344, 313.08177221359176, 275.69917451034155, 271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25215601570803226, "mean_inference_ms": 2.092077505045474, "mean_action_processing_ms": 0.09330938937909916, "mean_env_wait_ms": 1.8215697042355685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006328582763671875, "StateBufferConnector_ms": 0.0035376548767089844, "ViewRequirementAgentConnector_ms": 0.09074544906616211}, "num_episodes": 24, "episode_return_max": 472.038542142618, "episode_return_min": 214.93550214749175, "episode_return_mean": 349.82430131895586, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97350, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.99434682236262, "num_env_steps_trained_throughput_per_sec": 219.01669467075456, "timesteps_total": 97800, "num_env_steps_sampled_lifetime": 97800, "num_agent_steps_sampled_lifetime": 97800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 97800, "timers": {"training_iteration_time_ms": 10298.454, "restore_workers_time_ms": 0.014, "training_step_time_ms": 663.439, "sample_time_ms": 648.186, "synch_weights_time_ms": 13.946}, "counters": {"num_env_steps_sampled": 97800, "num_env_steps_trained": 97350, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 652, "num_samples_added_to_queue": 97350}, "done": false, "training_iteration": 42, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-33", "timestamp": 1728775233, "time_this_iter_s": 10.059372901916504, "time_total_s": 432.9667773246765, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5fc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.9667773246765, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 16.426666666666666, "ram_util_percent": 53.29999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 739335.5625, "policy_loss": 728875.375, "entropy": 24.5722599029541, "entropy_coeff": 0.01, "var_gnorm": 16.271154403686523, "vf_loss": 1059534.125, "vf_explained_var": -0.032978057861328125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 181.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 100200, "num_env_steps_trained": 99550, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 668, "num_samples_added_to_queue": 100100, "learner_queue": {"size_count": 181, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.875, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 2405.524, "learner_dequeue_time_ms": 20023.572}}, "env_runners": {"episode_reward_max": 507.49200097474784, "episode_reward_min": 263.6037801943406, "episode_reward_mean": 385.5142965975205, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 263.6037801943406}, "policy_reward_max": {"default_policy": 507.49200097474784}, "policy_reward_mean": {"default_policy": 385.5142965975205}, "custom_metrics": {"num_consolidated_mean": 1.273, "num_consolidated_min": 0.98, "num_consolidated_max": 1.47, "num_overloaded_mean": 0.21830000000000002, "num_overloaded_min": 0.12, "num_overloaded_max": 0.35, "num_moves_mean": 9.0343, "num_moves_min": 8.45, "num_moves_max": 9.56, "mean_accuracy_mean": 40.89264666666667, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.176, "num_model_switches_mean": 4.6258, "num_model_switches_min": 4.13, "num_model_switches_max": 5.14, "num_slav_mean": 0.04720883333333333, "num_slav_min": 0.03145, "num_slav_max": 0.06633333333333333, "cpu_conserved_cost_mean": 3.1048, "cpu_conserved_cost_min": 2.54, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.48153063411281577, "mean_cluster_cpu_util_min": 0.4671930419170889, "mean_cluster_cpu_util_max": 0.4962046376849647, "mean_cluster_mem_util_mean": 0.3184704103357588, "mean_cluster_mem_util_min": 0.31136552265420936, "mean_cluster_mem_util_max": 0.3260646027081719, "reward_consolidation_mean_mean": 1.935072965975205, "reward_consolidation_mean_min": 1.5843201133144476, "reward_consolidation_mean_max": 2.244435712327515, "reward_illegal_mean_mean": -0.3638333333333334, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 3.741583333333334, "reward_accuracy_mean_min": 3.0333333333333314, "reward_accuracy_mean_max": 4.516666666666671, "reward_sla_mean_mean": -1.45768, "reward_sla_mean_min": -2.322, "reward_sla_mean_max": -0.9519999999999998, "reward_consolidation_sum_mean": 193.5072965975205, "reward_consolidation_sum_min": 158.43201133144476, "reward_consolidation_sum_max": 224.44357123275148, "reward_illegal_sum_mean": -36.38333333333333, "reward_illegal_sum_min": -58.33333333333332, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 374.1583333333334, "reward_accuracy_sum_min": 303.33333333333314, "reward_accuracy_sum_max": 451.6666666666671, "reward_sla_sum_mean": -145.768, "reward_sla_sum_min": -232.2, "reward_sla_sum_max": -95.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3219.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [271.39129732858146, 290.6605470772793, 316.9426482682995, 303.10274147857064, 285.42435651405793, 318.5081696061409, 263.6037801943406, 344.548786134211, 323.46316366627053, 286.9663986109845, 376.94196899083136, 334.4528557068449, 317.53561789880877, 377.5822199884247, 337.567501294587, 296.66534466477833, 346.93440555606344, 344.78768466904233, 327.8208656980105, 350.07678881476727, 371.3883852691218, 292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25215946242835313, "mean_inference_ms": 2.0924188515963085, "mean_action_processing_ms": 0.09331430938603552, "mean_env_wait_ms": 1.8226445478263011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159305572509766, "StateBufferConnector_ms": 0.0034766197204589844, "ViewRequirementAgentConnector_ms": 0.08963704109191895}, "num_episodes": 24, "episode_return_max": 507.49200097474784, "episode_return_min": 263.6037801943406, "episode_return_mean": 385.5142965975205, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99550, "num_env_steps_sampled": 100200, "num_env_steps_trained": 99550, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 221.56257557774524, "num_env_steps_trained_throughput_per_sec": 203.09902761293313, "timesteps_total": 100200, "num_env_steps_sampled_lifetime": 100200, "num_agent_steps_sampled_lifetime": 100200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 100200, "timers": {"training_iteration_time_ms": 10327.98, "restore_workers_time_ms": 0.013, "training_step_time_ms": 671.141, "sample_time_ms": 654.97, "synch_weights_time_ms": 14.77}, "counters": {"num_env_steps_sampled": 100200, "num_env_steps_trained": 99550, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 668, "num_samples_added_to_queue": 100100}, "done": false, "training_iteration": 43, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-44", "timestamp": 1728775244, "time_this_iter_s": 10.85938835144043, "time_total_s": 443.82616567611694, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5450>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.82616567611694, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 16.84, "ram_util_percent": 53.10666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 701262.625, "policy_loss": 691975.9375, "entropy": 24.49654769897461, "entropy_coeff": 0.01, "var_gnorm": 16.27719497680664, "vf_loss": 942142.5, "vf_explained_var": -0.036176443099975586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 186.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 683, "num_samples_added_to_queue": 102300, "learner_queue": {"size_count": 186, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 98.406, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 2346.155, "learner_dequeue_time_ms": 20277.986}}, "env_runners": {"episode_reward_max": 507.49200097474784, "episode_reward_min": 292.6442962015292, "episode_reward_mean": 411.7743066191477, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 292.6442962015292}, "policy_reward_max": {"default_policy": 507.49200097474784}, "policy_reward_mean": {"default_policy": 411.7743066191477}, "custom_metrics": {"num_consolidated_mean": 1.3185, "num_consolidated_min": 0.98, "num_consolidated_max": 1.5, "num_overloaded_mean": 0.20170000000000002, "num_overloaded_min": 0.1, "num_overloaded_max": 0.35, "num_moves_mean": 8.9337, "num_moves_min": 8.45, "num_moves_max": 9.43, "mean_accuracy_mean": 40.901893333333334, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.176, "num_model_switches_mean": 4.5302, "num_model_switches_min": 4.13, "num_model_switches_max": 5.13, "num_slav_mean": 0.043750166666666666, "num_slav_min": 0.029783333333333335, "num_slav_max": 0.06583333333333333, "cpu_conserved_cost_mean": 3.194200000000001, "cpu_conserved_cost_min": 2.54, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4799836636785982, "mean_cluster_cpu_util_min": 0.4671930419170889, "mean_cluster_cpu_util_max": 0.4962046376849647, "mean_cluster_mem_util_mean": 0.31744462603870666, "mean_cluster_mem_util_min": 0.3096775653721404, "mean_cluster_mem_util_max": 0.3260646027081719, "reward_consolidation_mean_mean": 2.00284639952481, "reward_consolidation_mean_min": 1.6491096286819582, "reward_consolidation_mean_max": 2.2491442017728227, "reward_illegal_mean_mean": -0.3361666666666666, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.8260833333333353, "reward_accuracy_mean_min": 3.0333333333333314, "reward_accuracy_mean_max": 4.516666666666671, "reward_sla_mean_mean": -1.3750200000000001, "reward_sla_mean_min": -2.018, "reward_sla_mean_max": -0.9519999999999998, "reward_consolidation_sum_mean": 200.28463995248106, "reward_consolidation_sum_min": 164.9109628681958, "reward_consolidation_sum_max": 224.91442017728227, "reward_illegal_sum_mean": -33.61666666666667, "reward_illegal_sum_min": -58.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 382.6083333333335, "reward_accuracy_sum_min": 303.33333333333314, "reward_accuracy_sum_max": 451.6666666666671, "reward_sla_sum_mean": -137.50199999999998, "reward_sla_sum_min": -201.79999999999998, "reward_sla_sum_max": -95.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2280.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [292.6442962015292, 308.26005970331124, 325.2607176581684, 358.71841664382106, 335.7858600627494, 359.59297572268423, 303.6231929087085, 327.35101587011496, 334.1215541137407, 336.90280240031683, 407.7359011849281, 346.98538182704357, 436.76708398062704, 420.3268177525971, 472.038542142618, 430.47814736970355, 387.4795120168145, 341.0114502421637, 317.9379755703797, 424.28769989947926, 404.6686892686345, 372.0984008041671, 401.65383350086813, 412.58330744159156, 375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2521319962430721, "mean_inference_ms": 2.0912822058491627, "mean_action_processing_ms": 0.09330400743715529, "mean_env_wait_ms": 1.8231855245294053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005870342254638672, "StateBufferConnector_ms": 0.0034465789794921875, "ViewRequirementAgentConnector_ms": 0.0883328914642334}, "num_episodes": 21, "episode_return_max": 507.49200097474784, "episode_return_min": 292.6442962015292, "episode_return_mean": 411.7743066191477, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 221.1769793588505, "num_env_steps_trained_throughput_per_sec": 270.32741921637285, "timesteps_total": 102450, "num_env_steps_sampled_lifetime": 102450, "num_agent_steps_sampled_lifetime": 102450, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 102450, "timers": {"training_iteration_time_ms": 10338.481, "restore_workers_time_ms": 0.014, "training_step_time_ms": 651.265, "sample_time_ms": 635.347, "synch_weights_time_ms": 14.591}, "counters": {"num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 683, "num_samples_added_to_queue": 102300}, "done": false, "training_iteration": 44, "trial_id": "90ffb_00000", "date": "2024-10-13_00-20-54", "timestamp": 1728775254, "time_this_iter_s": 10.184455156326294, "time_total_s": 454.01062083244324, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35ba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 454.01062083244324, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.513333333333332, "ram_util_percent": 54.37333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 765143.0625, "policy_loss": 753513.0625, "entropy": 24.142011642456055, "entropy_coeff": 0.01, "var_gnorm": 16.282981872558594, "vf_loss": 1176276.75, "vf_explained_var": -0.028646111488342285}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 190.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 104850, "num_env_steps_trained": 104500, "num_agent_steps_sampled": 104850, "num_agent_steps_trained": 104500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 699, "num_samples_added_to_queue": 104500, "learner_queue": {"size_count": 190, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.846, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 2403.787, "learner_dequeue_time_ms": 20277.986}}, "env_runners": {"episode_reward_max": 557.312979377989, "episode_reward_min": 321.32612019860477, "episode_reward_mean": 432.9502655274302, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 321.32612019860477}, "policy_reward_max": {"default_policy": 557.312979377989}, "policy_reward_mean": {"default_policy": 432.9502655274302}, "custom_metrics": {"num_consolidated_mean": 1.3575, "num_consolidated_min": 1.14, "num_consolidated_max": 1.55, "num_overloaded_mean": 0.18779999999999997, "num_overloaded_min": 0.1, "num_overloaded_max": 0.35, "num_moves_mean": 8.8233, "num_moves_min": 8.26, "num_moves_max": 9.4, "mean_accuracy_mean": 40.91715666666666, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.446299999999999, "num_model_switches_min": 3.79, "num_model_switches_max": 5.01, "num_slav_mean": 0.041204666666666674, "num_slav_min": 0.0248, "num_slav_max": 0.05605, "cpu_conserved_cost_mean": 3.2644, "cpu_conserved_cost_min": 2.68, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.47839246782592054, "mean_cluster_cpu_util_min": 0.4671930419170889, "mean_cluster_cpu_util_max": 0.4905248683169529, "mean_cluster_mem_util_mean": 0.3164654410323201, "mean_cluster_mem_util_min": 0.30934424997847243, "mean_cluster_mem_util_max": 0.3237229491374609, "reward_consolidation_mean_mean": 2.0627559886076337, "reward_consolidation_mean_min": 1.6569278686527156, "reward_consolidation_mean_max": 2.3944631271132226, "reward_illegal_mean_mean": -0.31299999999999994, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.9041666666666686, "reward_accuracy_mean_min": 3.0916666666666672, "reward_accuracy_mean_max": 4.516666666666671, "reward_sla_mean_mean": -1.3244199999999997, "reward_sla_mean_min": -2.018, "reward_sla_mean_max": -0.7933333333333333, "reward_consolidation_sum_mean": 206.27559886076335, "reward_consolidation_sum_min": 165.69278686527156, "reward_consolidation_sum_max": 239.44631271132226, "reward_illegal_sum_mean": -31.299999999999997, "reward_illegal_sum_min": -58.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 390.41666666666686, "reward_accuracy_sum_min": 309.16666666666674, "reward_accuracy_sum_max": 451.6666666666671, "reward_sla_sum_mean": -132.44199999999998, "reward_sla_sum_min": -201.79999999999998, "reward_sla_sum_max": -79.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2145.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [375.95408632611395, 413.92979682597684, 341.657074537756, 321.32612019860477, 379.90370708824526, 357.7419689908313, 380.01546803131373, 421.21149897956076, 411.1795394316, 440.45399494349493, 404.4637332845959, 410.178586006275, 371.4844253556307, 440.5616558530572, 464.60048128179363, 368.24475311462425, 387.3440190075848, 368.6869536080907, 382.3135946876237, 391.7090682018947, 353.9748210423708, 413.3666301136189, 434.3659995735476, 359.42177647811377, 432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25215573407181985, "mean_inference_ms": 2.0929592723026604, "mean_action_processing_ms": 0.0933177191191098, "mean_env_wait_ms": 1.8244050927321975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005758047103881836, "StateBufferConnector_ms": 0.003448486328125, "ViewRequirementAgentConnector_ms": 0.08873796463012695}, "num_episodes": 24, "episode_return_max": 557.312979377989, "episode_return_min": 321.32612019860477, "episode_return_mean": 432.9502655274302, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104850, "num_agent_steps_trained": 104500, "num_env_steps_sampled": 104850, "num_env_steps_trained": 104500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 230.55532651941658, "num_env_steps_trained_throughput_per_sec": 211.34238264279853, "timesteps_total": 104850, "num_env_steps_sampled_lifetime": 104850, "num_agent_steps_sampled_lifetime": 104850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 104850, "timers": {"training_iteration_time_ms": 10328.072, "restore_workers_time_ms": 0.013, "training_step_time_ms": 658.051, "sample_time_ms": 642.775, "synch_weights_time_ms": 13.948}, "counters": {"num_env_steps_sampled": 104850, "num_env_steps_trained": 104500, "num_agent_steps_sampled": 104850, "num_agent_steps_trained": 104500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 699, "num_samples_added_to_queue": 104500}, "done": false, "training_iteration": 45, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-05", "timestamp": 1728775265, "time_this_iter_s": 10.421160459518433, "time_total_s": 464.43178129196167, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5f60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.43178129196167, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 16.626666666666665, "ram_util_percent": 54.17333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 752341.9375, "policy_loss": 740747.8125, "entropy": 23.691011428833008, "entropy_coeff": 0.01, "var_gnorm": 16.290023803710938, "vf_loss": 1172446.625, "vf_explained_var": -0.02739584445953369}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 107250, "num_env_steps_trained": 106700, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 106700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 715, "num_samples_added_to_queue": 107250, "learner_queue": {"size_count": 194, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.058, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 2284.438, "learner_dequeue_time_ms": 20236.851}}, "env_runners": {"episode_reward_max": 557.312979377989, "episode_reward_min": 378.16982241311047, "episode_reward_mean": 456.8404985835694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 378.16982241311047}, "policy_reward_max": {"default_policy": 557.312979377989}, "policy_reward_mean": {"default_policy": 456.8404985835694}, "custom_metrics": {"num_consolidated_mean": 1.4012, "num_consolidated_min": 1.14, "num_consolidated_max": 1.62, "num_overloaded_mean": 0.1733, "num_overloaded_min": 0.08, "num_overloaded_max": 0.26, "num_moves_mean": 8.721699999999998, "num_moves_min": 8.26, "num_moves_max": 9.25, "mean_accuracy_mean": 40.94179333333332, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.3674, "num_model_switches_min": 3.79, "num_model_switches_max": 5.01, "num_slav_mean": 0.03891116666666667, "num_slav_min": 0.0248, "num_slav_max": 0.05105, "cpu_conserved_cost_mean": 3.367999999999999, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 4.08, "mean_cluster_cpu_util_mean": 0.4779067275831895, "mean_cluster_cpu_util_min": 0.4671930419170889, "mean_cluster_cpu_util_max": 0.4905248683169529, "mean_cluster_mem_util_mean": 0.3160340667176153, "mean_cluster_mem_util_min": 0.30934424997847243, "mean_cluster_mem_util_max": 0.32335447953442986, "reward_consolidation_mean_mean": 2.1287516525023604, "reward_consolidation_mean_min": 1.855738523866094, "reward_consolidation_mean_max": 2.413149349660361, "reward_illegal_mean_mean": -0.2888333333333333, "reward_illegal_mean_min": -0.4333333333333333, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 4.000500000000002, "reward_accuracy_mean_min": 3.5000000000000013, "reward_accuracy_mean_max": 4.5750000000000055, "reward_sla_mean_mean": -1.2720133333333332, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.7933333333333333, "reward_consolidation_sum_mean": 212.87516525023605, "reward_consolidation_sum_min": 185.5738523866094, "reward_consolidation_sum_max": 241.31493496603608, "reward_illegal_sum_mean": -28.88333333333333, "reward_illegal_sum_min": -43.33333333333333, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 400.0500000000001, "reward_accuracy_sum_min": 350.0000000000001, "reward_accuracy_sum_max": 457.50000000000057, "reward_sla_sum_mean": -127.20133333333334, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -79.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2867.0, "global_timestep_min": 800, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [432.36464711078634, 430.75608151329624, 401.6673520363093, 450.5220628103201, 407.0230253739072, 408.7893386944469, 441.41358250327477, 392.1143105181397, 385.57385238660936, 425.0691065825948, 469.4927807730971, 432.15305065643173, 423.98821773432024, 441.23771056078505, 471.3809771848064, 466.17596637119635, 443.3209753571536, 482.7272289743827, 448.78262816412314, 507.49200097474784, 455.809506838466, 411.53071674434204, 428.8948216515887, 378.16982241311047, 401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25210055428463546, "mean_inference_ms": 2.092728630714328, "mean_action_processing_ms": 0.09331023361091466, "mean_env_wait_ms": 1.8249761233743647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005734682083129883, "StateBufferConnector_ms": 0.0034308433532714844, "ViewRequirementAgentConnector_ms": 0.08802938461303711}, "num_episodes": 24, "episode_return_max": 557.312979377989, "episode_return_min": 378.16982241311047, "episode_return_mean": 456.8404985835694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 106700, "num_env_steps_sampled": 107250, "num_env_steps_trained": 106700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 225.90127077759107, "num_env_steps_trained_throughput_per_sec": 207.07616487945847, "timesteps_total": 107250, "num_env_steps_sampled_lifetime": 107250, "num_agent_steps_sampled_lifetime": 107250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 107250, "timers": {"training_iteration_time_ms": 10374.702, "restore_workers_time_ms": 0.013, "training_step_time_ms": 663.118, "sample_time_ms": 645.686, "synch_weights_time_ms": 15.98}, "counters": {"num_env_steps_sampled": 107250, "num_env_steps_trained": 106700, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 106700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 715, "num_samples_added_to_queue": 107250}, "done": false, "training_iteration": 46, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-15", "timestamp": 1728775275, "time_this_iter_s": 10.635506391525269, "time_total_s": 475.06728768348694, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e34d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 475.06728768348694, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 16.89333333333333, "ram_util_percent": 54.08666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 772802.0, "policy_loss": 760271.4375, "entropy": 23.244802474975586, "entropy_coeff": 0.01, "var_gnorm": 16.29669952392578, "vf_loss": 1265843.0, "vf_explained_var": -0.027150273323059082}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 109650, "num_env_steps_trained": 109450, "num_agent_steps_sampled": 109650, "num_agent_steps_trained": 109450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 731, "num_samples_added_to_queue": 109450, "learner_queue": {"size_count": 199, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.019, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 2367.356, "learner_dequeue_time_ms": 20236.851}}, "env_runners": {"episode_reward_max": 595.2331810289686, "episode_reward_min": 379.067345944135, "episode_reward_mean": 477.57943010752706, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 379.067345944135}, "policy_reward_max": {"default_policy": 595.2331810289686}, "policy_reward_mean": {"default_policy": 477.57943010752706}, "custom_metrics": {"num_consolidated_mean": 1.4332000000000003, "num_consolidated_min": 1.26, "num_consolidated_max": 1.62, "num_overloaded_mean": 0.16080000000000003, "num_overloaded_min": 0.07, "num_overloaded_max": 0.26, "num_moves_mean": 8.629900000000001, "num_moves_min": 8.04, "num_moves_max": 9.22, "mean_accuracy_mean": 40.96693666666667, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.2856, "num_model_switches_min": 3.77, "num_model_switches_max": 5.01, "num_slav_mean": 0.03705583333333333, "num_slav_min": 0.019716666666666664, "num_slav_max": 0.04986666666666666, "cpu_conserved_cost_mean": 3.4406000000000008, "cpu_conserved_cost_min": 2.86, "cpu_conserved_cost_max": 4.08, "mean_cluster_cpu_util_mean": 0.47731083592975243, "mean_cluster_cpu_util_min": 0.4676752557807887, "mean_cluster_cpu_util_max": 0.4905248683169529, "mean_cluster_mem_util_mean": 0.3157754594653262, "mean_cluster_mem_util_min": 0.30934424997847243, "mean_cluster_mem_util_max": 0.32335447953442986, "reward_consolidation_mean_mean": 2.181404301075269, "reward_consolidation_mean_min": 1.9254803679673458, "reward_consolidation_mean_max": 2.4871464254165523, "reward_illegal_mean_mean": -0.26799999999999996, "reward_illegal_mean_min": -0.4333333333333333, "reward_illegal_mean_max": -0.11666666666666665, "reward_accuracy_mean_mean": 4.079750000000002, "reward_accuracy_mean_min": 3.5000000000000013, "reward_accuracy_mean_max": 4.5750000000000055, "reward_sla_mean_mean": -1.21736, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.7559999999999999, "reward_consolidation_sum_mean": 218.14043010752687, "reward_consolidation_sum_min": 192.54803679673458, "reward_consolidation_sum_max": 248.71464254165522, "reward_illegal_sum_mean": -26.8, "reward_illegal_sum_min": -43.33333333333333, "reward_illegal_sum_max": -11.666666666666666, "reward_accuracy_sum_mean": 407.97500000000036, "reward_accuracy_sum_min": 350.0000000000001, "reward_accuracy_sum_max": 457.50000000000057, "reward_sla_sum_mean": -121.73599999999999, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -75.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3667.0, "global_timestep_min": 1600, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [401.756931371653, 462.94689451399734, 425.93650735630064, 401.148889701179, 488.1102378994184, 476.22923634591376, 420.08228395625787, 432.6626884766517, 442.26842730512686, 454.26166803740614, 463.28760547077286, 467.9776295348622, 460.64883791769466, 458.7679795302933, 405.04727527490934, 495.1550001523044, 447.96553961436535, 478.66928934783266, 479.46051661640644, 480.08805324560603, 415.11138627433064, 392.0480367967349, 409.9816808309726, 421.7400134027841, 464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2520480305282314, "mean_inference_ms": 2.0922235790324577, "mean_action_processing_ms": 0.0933003973882545, "mean_env_wait_ms": 1.82549026043184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005649089813232422, "StateBufferConnector_ms": 0.003383159637451172, "ViewRequirementAgentConnector_ms": 0.08722329139709473}, "num_episodes": 24, "episode_return_max": 595.2331810289686, "episode_return_min": 379.067345944135, "episode_return_mean": 477.57943010752706, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109650, "num_agent_steps_trained": 109450, "num_env_steps_sampled": 109650, "num_env_steps_trained": 109450, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 228.55414177471678, "num_env_steps_trained_throughput_per_sec": 261.884954116863, "timesteps_total": 109650, "num_env_steps_sampled_lifetime": 109650, "num_agent_steps_sampled_lifetime": 109650, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 109650, "timers": {"training_iteration_time_ms": 10366.304, "restore_workers_time_ms": 0.014, "training_step_time_ms": 659.446, "sample_time_ms": 642.893, "synch_weights_time_ms": 15.058}, "counters": {"num_env_steps_sampled": 109650, "num_env_steps_trained": 109450, "num_agent_steps_sampled": 109650, "num_agent_steps_trained": 109450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 731, "num_samples_added_to_queue": 109450}, "done": false, "training_iteration": 47, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-26", "timestamp": 1728775286, "time_this_iter_s": 10.511707782745361, "time_total_s": 485.5789954662323, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 485.5789954662323, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 16.366666666666667, "ram_util_percent": 53.573333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 815631.4375, "policy_loss": 801150.5, "entropy": 22.939199447631836, "entropy_coeff": 0.01, "var_gnorm": 16.301101684570312, "vf_loss": 1460711.625, "vf_explained_var": -0.023702025413513184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 112050, "num_env_steps_trained": 111650, "num_agent_steps_sampled": 112050, "num_agent_steps_trained": 111650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 747, "num_samples_added_to_queue": 111650, "learner_queue": {"size_count": 203, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.868, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 2362.604, "learner_dequeue_time_ms": 20206.476}}, "env_runners": {"episode_reward_max": 624.1090499253711, "episode_reward_min": 379.067345944135, "episode_reward_mean": 501.0762274817998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 379.067345944135}, "policy_reward_max": {"default_policy": 624.1090499253711}, "policy_reward_mean": {"default_policy": 501.0762274817998}, "custom_metrics": {"num_consolidated_mean": 1.4641, "num_consolidated_min": 1.26, "num_consolidated_max": 1.66, "num_overloaded_mean": 0.14530000000000004, "num_overloaded_min": 0.04, "num_overloaded_max": 0.25, "num_moves_mean": 8.536299999999999, "num_moves_min": 8.04, "num_moves_max": 9.1, "mean_accuracy_mean": 40.99936333333333, "mean_accuracy_min": 40.72633333333333, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.1936, "num_model_switches_min": 3.69, "num_model_switches_max": 5.01, "num_slav_mean": 0.035070333333333335, "num_slav_min": 0.019716666666666664, "num_slav_max": 0.04986666666666666, "cpu_conserved_cost_mean": 3.495199999999999, "cpu_conserved_cost_min": 2.86, "cpu_conserved_cost_max": 4.08, "mean_cluster_cpu_util_mean": 0.4760311763934218, "mean_cluster_cpu_util_min": 0.46603136252628063, "mean_cluster_cpu_util_max": 0.48564410035001965, "mean_cluster_mem_util_mean": 0.31496634376166077, "mean_cluster_mem_util_min": 0.30930767727977265, "mean_cluster_mem_util_max": 0.3218022742113723, "reward_consolidation_mean_mean": 2.2417156081513294, "reward_consolidation_mean_min": 1.9663401261080142, "reward_consolidation_mean_max": 2.5644238325870417, "reward_illegal_mean_mean": -0.2421666666666666, "reward_illegal_mean_min": -0.41666666666666663, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 4.18116666666667, "reward_accuracy_mean_min": 3.5500000000000025, "reward_accuracy_mean_max": 4.7083333333333375, "reward_sla_mean_mean": -1.1699533333333334, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.7353333333333333, "reward_consolidation_sum_mean": 224.17156081513298, "reward_consolidation_sum_min": 196.63401261080142, "reward_consolidation_sum_max": 256.4423832587042, "reward_illegal_sum_mean": -24.21666666666666, "reward_illegal_sum_min": -41.666666666666664, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 418.116666666667, "reward_accuracy_sum_min": 355.0000000000002, "reward_accuracy_sum_max": 470.83333333333377, "reward_sla_sum_mean": -116.99533333333333, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -73.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4478.0, "global_timestep_min": 2600, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [464.4058332571813, 462.03730238508655, 501.71442017728225, 379.067345944135, 496.5280392336044, 429.4261902586131, 444.1739559535775, 449.22373206616095, 429.0720704255384, 524.3847665174086, 557.312979377989, 462.9337658777303, 457.70593377806244, 404.75061987876575, 422.2920009747483, 490.77158914374496, 444.4327941758814, 435.58370343294024, 447.0149806573458, 468.4633372932467, 448.9581437143991, 465.00988455329116, 431.5004599591825, 488.8306984678183, 418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25194848367942096, "mean_inference_ms": 2.0921093033145857, "mean_action_processing_ms": 0.09328306016294985, "mean_env_wait_ms": 1.8257918320066548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005701303482055664, "StateBufferConnector_ms": 0.0034132003784179688, "ViewRequirementAgentConnector_ms": 0.08878827095031738}, "num_episodes": 24, "episode_return_max": 624.1090499253711, "episode_return_min": 379.067345944135, "episode_return_mean": 501.0762274817998, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112050, "num_agent_steps_trained": 111650, "num_env_steps_sampled": 112050, "num_env_steps_trained": 111650, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 225.70042811946914, "num_env_steps_trained_throughput_per_sec": 206.89205910951338, "timesteps_total": 112050, "num_env_steps_sampled_lifetime": 112050, "num_agent_steps_sampled_lifetime": 112050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 112050, "timers": {"training_iteration_time_ms": 10397.408, "restore_workers_time_ms": 0.014, "training_step_time_ms": 665.199, "sample_time_ms": 649.269, "synch_weights_time_ms": 14.627}, "counters": {"num_env_steps_sampled": 112050, "num_env_steps_trained": 111650, "num_agent_steps_sampled": 112050, "num_agent_steps_trained": 111650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 747, "num_samples_added_to_queue": 111650}, "done": false, "training_iteration": 48, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-37", "timestamp": 1728775297, "time_this_iter_s": 10.656428337097168, "time_total_s": 496.23542380332947, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419b3d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.23542380332947, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 16.720000000000002, "ram_util_percent": 53.68666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 831686.6875, "policy_loss": 816647.5, "entropy": 22.633243560791016, "entropy_coeff": 0.01, "var_gnorm": 16.304948806762695, "vf_loss": 1516367.125, "vf_explained_var": -0.02458500862121582}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 114300, "num_env_steps_trained": 113850, "num_agent_steps_sampled": 114300, "num_agent_steps_trained": 113850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 762, "num_samples_added_to_queue": 113850, "learner_queue": {"size_count": 207, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.425, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 2328.809, "learner_dequeue_time_ms": 20206.476}}, "env_runners": {"episode_reward_max": 645.9461360382596, "episode_reward_min": 418.9247037680101, "episode_reward_mean": 525.5290413963265, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 418.9247037680101}, "policy_reward_max": {"default_policy": 645.9461360382596}, "policy_reward_mean": {"default_policy": 525.5290413963265}, "custom_metrics": {"num_consolidated_mean": 1.5067000000000002, "num_consolidated_min": 1.28, "num_consolidated_max": 1.82, "num_overloaded_mean": 0.1322, "num_overloaded_min": 0.04, "num_overloaded_max": 0.25, "num_moves_mean": 8.433300000000001, "num_moves_min": 7.84, "num_moves_max": 9.03, "mean_accuracy_mean": 41.03286666666667, "mean_accuracy_min": 40.76433333333333, "mean_accuracy_max": 41.22666666666666, "num_model_switches_mean": 4.0839, "num_model_switches_min": 3.52, "num_model_switches_max": 4.73, "num_slav_mean": 0.03276016666666667, "num_slav_min": 0.019716666666666664, "num_slav_max": 0.04928333333333334, "cpu_conserved_cost_mean": 3.5934, "cpu_conserved_cost_min": 3.0, "cpu_conserved_cost_max": 4.56, "mean_cluster_cpu_util_mean": 0.47543362867312766, "mean_cluster_cpu_util_min": 0.46603136252628063, "mean_cluster_cpu_util_max": 0.4851849877694391, "mean_cluster_mem_util_mean": 0.3144256716808031, "mean_cluster_mem_util_min": 0.30660295340710125, "mean_cluster_mem_util_max": 0.3218022742113723, "reward_consolidation_mean_mean": 2.3058904139632643, "reward_consolidation_mean_min": 1.9819137043467665, "reward_consolidation_mean_max": 2.6464613603825886, "reward_illegal_mean_mean": -0.22033333333333333, "reward_illegal_mean_min": -0.41666666666666663, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 4.277500000000003, "reward_accuracy_mean_min": 3.5500000000000025, "reward_accuracy_mean_max": 4.975000000000006, "reward_sla_mean_mean": -1.1077666666666668, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.7353333333333333, "reward_consolidation_sum_mean": 230.5890413963264, "reward_consolidation_sum_min": 198.19137043467666, "reward_consolidation_sum_max": 264.6461360382589, "reward_illegal_sum_mean": -22.033333333333335, "reward_illegal_sum_min": -41.666666666666664, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 427.75000000000034, "reward_accuracy_sum_min": 355.0000000000002, "reward_accuracy_sum_max": 497.50000000000057, "reward_sla_sum_mean": -110.77666666666669, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -73.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5278.0, "global_timestep_min": 3400, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [418.9247037680101, 460.2415547229586, 456.2719394437849, 442.1016814401901, 437.3155106765363, 470.5855219470591, 508.55304456425716, 508.12214810076426, 454.0708733132295, 526.5717658168087, 510.7098754150295, 503.6113314447591, 531.1690121538885, 481.7260196777242, 492.946136038259, 519.1070303694905, 524.2965213683025, 495.70153218191234, 463.9393859088003, 536.2816016327031, 465.57469310670456, 462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25188272947492685, "mean_inference_ms": 2.0913674840758456, "mean_action_processing_ms": 0.09327253732378736, "mean_env_wait_ms": 1.8262224508504779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005789518356323242, "StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.09048843383789062}, "num_episodes": 24, "episode_return_max": 645.9461360382596, "episode_return_min": 418.9247037680101, "episode_return_mean": 525.5290413963265, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114300, "num_agent_steps_trained": 113850, "num_env_steps_sampled": 114300, "num_env_steps_trained": 113850, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 224.35743424543935, "num_env_steps_trained_throughput_per_sec": 219.3717134844296, "timesteps_total": 114300, "num_env_steps_sampled_lifetime": 114300, "num_agent_steps_sampled_lifetime": 114300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 114300, "timers": {"training_iteration_time_ms": 10393.628, "restore_workers_time_ms": 0.015, "training_step_time_ms": 668.447, "sample_time_ms": 651.743, "synch_weights_time_ms": 15.289}, "counters": {"num_env_steps_sampled": 114300, "num_env_steps_trained": 113850, "num_agent_steps_sampled": 114300, "num_agent_steps_trained": 113850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 762, "num_samples_added_to_queue": 113850}, "done": false, "training_iteration": 49, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-47", "timestamp": 1728775307, "time_this_iter_s": 10.043148279190063, "time_total_s": 506.27857208251953, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5900>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.27857208251953, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.44, "ram_util_percent": 53.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 853544.6875, "policy_loss": 837188.625, "entropy": 22.337017059326172, "entropy_coeff": 0.01, "var_gnorm": 16.309513092041016, "vf_loss": 1647891.125, "vf_explained_var": -0.021039128303527832}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 211.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 116550, "num_env_steps_trained": 116050, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 777, "num_samples_added_to_queue": 116050, "learner_queue": {"size_count": 211, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.14, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 2414.21, "learner_dequeue_time_ms": 20118.842}}, "env_runners": {"episode_reward_max": 645.9461360382596, "episode_reward_min": 458.9830302476469, "episode_reward_mean": 543.0128318255204, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 458.9830302476469}, "policy_reward_max": {"default_policy": 645.9461360382596}, "policy_reward_mean": {"default_policy": 543.0128318255204}, "custom_metrics": {"num_consolidated_mean": 1.5386000000000002, "num_consolidated_min": 1.28, "num_consolidated_max": 1.82, "num_overloaded_mean": 0.12240000000000001, "num_overloaded_min": 0.04, "num_overloaded_max": 0.22, "num_moves_mean": 8.3512, "num_moves_min": 7.51, "num_moves_max": 9.03, "mean_accuracy_mean": 41.06048, "mean_accuracy_min": 40.76433333333333, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 4.0098, "num_model_switches_min": 3.52, "num_model_switches_max": 4.5, "num_slav_mean": 0.03124733333333333, "num_slav_min": 0.019716666666666664, "num_slav_max": 0.04928333333333334, "cpu_conserved_cost_mean": 3.6596, "cpu_conserved_cost_min": 3.0, "cpu_conserved_cost_max": 4.56, "mean_cluster_cpu_util_mean": 0.4747585233090961, "mean_cluster_cpu_util_min": 0.46603136252628063, "mean_cluster_cpu_util_max": 0.4851849877694391, "mean_cluster_mem_util_mean": 0.3138440524053503, "mean_cluster_mem_util_min": 0.30660295340710125, "mean_cluster_mem_util_max": 0.3218022742113723, "reward_consolidation_mean_mean": 2.3532383182552015, "reward_consolidation_mean_min": 2.010781626001401, "reward_consolidation_mean_max": 2.6610102348533307, "reward_illegal_mean_mean": -0.20400000000000001, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 4.354416666666671, "reward_accuracy_mean_min": 3.8666666666666667, "reward_accuracy_mean_max": 4.975000000000006, "reward_sla_mean_mean": -1.0735266666666665, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.6673333333333333, "reward_consolidation_sum_mean": 235.32383182552013, "reward_consolidation_sum_min": 201.0781626001401, "reward_consolidation_sum_max": 266.1010234853331, "reward_illegal_sum_mean": -20.399999999999995, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 435.441666666667, "reward_accuracy_sum_min": 386.6666666666667, "reward_accuracy_sum_max": 497.50000000000057, "reward_sla_sum_mean": -107.35266666666665, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -66.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5967.0, "global_timestep_min": 3900, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [462.4384659904353, 458.9830302476469, 481.74348594230753, 501.59519327423953, 471.51705199671017, 476.4415120777365, 500.11231533095753, 468.36614883182546, 504.87703554783917, 595.2331810289686, 543.064086630723, 522.9165189314326, 565.4861311645194, 466.8781626001403, 499.6849980200435, 468.3168144019008, 502.00908647841834, 577.0572969021295, 541.8278777909775, 542.9217003259314, 573.3347558561032, 468.7684851807855, 561.4813092083224, 498.7104023881327, 512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518479271013256, "mean_inference_ms": 2.0899451433424794, "mean_action_processing_ms": 0.09326249907034884, "mean_env_wait_ms": 1.8266512073673613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005839347839355469, "StateBufferConnector_ms": 0.0035202503204345703, "ViewRequirementAgentConnector_ms": 0.09124064445495605}, "num_episodes": 21, "episode_return_max": 645.9461360382596, "episode_return_min": 458.9830302476469, "episode_return_mean": 543.0128318255204, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116050, "num_env_steps_sampled": 116550, "num_env_steps_trained": 116050, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.45984776896373, "num_env_steps_trained_throughput_per_sec": 218.49407337409787, "timesteps_total": 116550, "num_env_steps_sampled_lifetime": 116550, "num_agent_steps_sampled_lifetime": 116550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 116550, "timers": {"training_iteration_time_ms": 10344.218, "restore_workers_time_ms": 0.013, "training_step_time_ms": 670.271, "sample_time_ms": 655.35, "synch_weights_time_ms": 13.477}, "counters": {"num_env_steps_sampled": 116550, "num_env_steps_trained": 116050, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 777, "num_samples_added_to_queue": 116050}, "done": false, "training_iteration": 50, "trial_id": "90ffb_00000", "date": "2024-10-13_00-21-57", "timestamp": 1728775317, "time_this_iter_s": 10.079209566116333, "time_total_s": 516.3577816486359, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6170>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 516.3577816486359, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 54.01428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 826976.75, "policy_loss": 809862.125, "entropy": 21.78120994567871, "entropy_coeff": 0.01, "var_gnorm": 16.31175994873047, "vf_loss": 1723444.875, "vf_explained_var": -0.017696142196655273}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 118800, "num_env_steps_trained": 118250, "num_agent_steps_sampled": 118800, "num_agent_steps_trained": 118250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 792, "num_samples_added_to_queue": 118800, "learner_queue": {"size_count": 215, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.787, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 2350.426, "learner_dequeue_time_ms": 20118.842}}, "env_runners": {"episode_reward_max": 663.3853300435594, "episode_reward_min": 477.7675287093726, "episode_reward_mean": 564.3176627676752, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 477.7675287093726}, "policy_reward_max": {"default_policy": 663.3853300435594}, "policy_reward_mean": {"default_policy": 564.3176627676752}, "custom_metrics": {"num_consolidated_mean": 1.5872000000000002, "num_consolidated_min": 1.32, "num_consolidated_max": 1.83, "num_overloaded_mean": 0.1139, "num_overloaded_min": 0.04, "num_overloaded_max": 0.22, "num_moves_mean": 8.237400000000001, "num_moves_min": 7.51, "num_moves_max": 8.69, "mean_accuracy_mean": 41.09151333333333, "mean_accuracy_min": 40.76433333333333, "mean_accuracy_max": 41.33433333333333, "num_model_switches_mean": 3.911, "num_model_switches_min": 3.42, "num_model_switches_max": 4.32, "num_slav_mean": 0.02910866666666667, "num_slav_min": 0.016583333333333332, "num_slav_max": 0.04028333333333333, "cpu_conserved_cost_mean": 3.7672, "cpu_conserved_cost_min": 3.0, "cpu_conserved_cost_max": 4.56, "mean_cluster_cpu_util_mean": 0.47423058587271383, "mean_cluster_cpu_util_min": 0.4648513447127205, "mean_cluster_cpu_util_max": 0.4851849877694391, "mean_cluster_mem_util_mean": 0.31308077937620193, "mean_cluster_mem_util_min": 0.30660295340710125, "mean_cluster_mem_util_max": 0.32117595761933465, "reward_consolidation_mean_mean": 2.4102199610100823, "reward_consolidation_mean_min": 2.139675287093728, "reward_consolidation_mean_max": 2.7007193335160986, "reward_illegal_mean_mean": -0.18983333333333335, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 4.4350833333333375, "reward_accuracy_mean_min": 3.8666666666666667, "reward_accuracy_mean_max": 4.975000000000006, "reward_sla_mean_mean": -1.0122933333333333, "reward_sla_mean_min": -1.4806666666666664, "reward_sla_mean_max": -0.5666666666666667, "reward_consolidation_sum_mean": 241.0219961010083, "reward_consolidation_sum_min": 213.9675287093728, "reward_consolidation_sum_max": 270.07193335160986, "reward_illegal_sum_mean": -18.983333333333334, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 443.5083333333338, "reward_accuracy_sum_min": 386.6666666666667, "reward_accuracy_sum_max": 497.50000000000057, "reward_sla_sum_mean": -101.22933333333333, "reward_sla_sum_min": -148.06666666666663, "reward_sla_sum_max": -56.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5363.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [512.9738249718238, 494.5027628011819, 489.3426634987362, 518.0720887020623, 505.68758110207443, 541.9949374029061, 546.8350665570077, 552.8550915349233, 516.7192908708766, 534.9375277955467, 558.8420238204027, 554.2115659934816, 624.1090499253711, 572.8765786347439, 519.8613299217158, 522.2211946754395, 513.3210789241224, 521.0976880197392, 477.7675287093726, 565.2750555910935, 535.0840628712423, 543.1366596606662, 519.4740747509824, 554.876855828688, 540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518236509849683, "mean_inference_ms": 2.0895735854505557, "mean_action_processing_ms": 0.09326586351604572, "mean_env_wait_ms": 1.827353941513313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005841970443725586, "StateBufferConnector_ms": 0.0035200119018554688, "ViewRequirementAgentConnector_ms": 0.09098291397094727}, "num_episodes": 24, "episode_return_max": 663.3853300435594, "episode_return_min": 477.7675287093726, "episode_return_mean": 564.3176627676752, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118800, "num_agent_steps_trained": 118250, "num_env_steps_sampled": 118800, "num_env_steps_trained": 118250, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 224.563391317483, "num_env_steps_trained_throughput_per_sec": 219.57309373265005, "timesteps_total": 118800, "num_env_steps_sampled_lifetime": 118800, "num_agent_steps_sampled_lifetime": 118800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 118800, "timers": {"training_iteration_time_ms": 10333.512, "restore_workers_time_ms": 0.014, "training_step_time_ms": 665.51, "sample_time_ms": 650.317, "synch_weights_time_ms": 13.755}, "counters": {"num_env_steps_sampled": 118800, "num_env_steps_trained": 118250, "num_agent_steps_sampled": 118800, "num_agent_steps_trained": 118250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 792, "num_samples_added_to_queue": 118800}, "done": false, "training_iteration": 51, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-07", "timestamp": 1728775327, "time_this_iter_s": 10.029366254806519, "time_total_s": 526.3871479034424, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35d50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.3871479034424, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.15, "ram_util_percent": 54.221428571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 831452.125, "policy_loss": 814188.75, "entropy": 21.33134651184082, "entropy_coeff": 0.01, "var_gnorm": 16.318784713745117, "vf_loss": 1738070.625, "vf_explained_var": -0.016743063926696777}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 220.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 121200, "num_env_steps_trained": 121000, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 121000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 808, "num_samples_added_to_queue": 121000, "learner_queue": {"size_count": 220, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.153, "learner_load_time_ms": 0.348, "learner_load_wait_time_ms": 2397.859, "learner_dequeue_time_ms": 19830.763}}, "env_runners": {"episode_reward_max": 695.8914679094707, "episode_reward_min": 480.2426421761249, "episode_reward_mean": 586.5289702397274, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 480.2426421761249}, "policy_reward_max": {"default_policy": 695.8914679094707}, "policy_reward_mean": {"default_policy": 586.5289702397274}, "custom_metrics": {"num_consolidated_mean": 1.641, "num_consolidated_min": 1.4, "num_consolidated_max": 1.89, "num_overloaded_mean": 0.1039, "num_overloaded_min": 0.03, "num_overloaded_max": 0.22, "num_moves_mean": 8.1079, "num_moves_min": 7.51, "num_moves_max": 8.57, "mean_accuracy_mean": 41.12564999999999, "mean_accuracy_min": 40.84666666666667, "mean_accuracy_max": 41.33433333333333, "num_model_switches_mean": 3.8024, "num_model_switches_min": 3.27, "num_model_switches_max": 4.32, "num_slav_mean": 0.027250333333333335, "num_slav_min": 0.015883333333333333, "num_slav_max": 0.03963333333333334, "cpu_conserved_cost_mean": 3.8961999999999994, "cpu_conserved_cost_min": 3.16, "cpu_conserved_cost_max": 4.62, "mean_cluster_cpu_util_mean": 0.4738723311112377, "mean_cluster_cpu_util_min": 0.4645085088372977, "mean_cluster_cpu_util_max": 0.4851849877694391, "mean_cluster_mem_util_mean": 0.3126137532309337, "mean_cluster_mem_util_min": 0.30649584678808234, "mean_cluster_mem_util_max": 0.3189898301831281, "reward_consolidation_mean_mean": 2.475596369063937, "reward_consolidation_mean_min": 2.1731881872734475, "reward_consolidation_mean_max": 2.8017965822900486, "reward_illegal_mean_mean": -0.17316666666666664, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.5285000000000055, "reward_accuracy_mean_min": 3.891666666666668, "reward_accuracy_mean_max": 4.975000000000008, "reward_sla_mean_mean": -0.9656399999999999, "reward_sla_mean_min": -1.4806666666666664, "reward_sla_mean_max": -0.5666666666666667, "reward_consolidation_sum_mean": 247.55963690639376, "reward_consolidation_sum_min": 217.31881872734473, "reward_consolidation_sum_max": 280.1796582290049, "reward_illegal_sum_mean": -17.316666666666663, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 452.85000000000053, "reward_accuracy_sum_min": 389.1666666666668, "reward_accuracy_sum_max": 497.50000000000074, "reward_sla_sum_mean": -96.56400000000002, "reward_sla_sum_min": -148.06666666666663, "reward_sla_sum_max": -56.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4291.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [540.3508848883612, 557.7326205489052, 507.3509305796706, 531.5163818575041, 575.2801486490608, 602.5851686009324, 529.5495537482107, 497.6573365012642, 532.1349629900395, 533.2337811081669, 559.7540589113287, 578.7284626397397, 621.7678180876668, 586.5257181150816, 531.4117091595848, 520.5521520606783, 567.8901154467088, 555.3576959395657, 569.2947515915813, 597.3557433976065, 561.9091748149502, 582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25182431306875763, "mean_inference_ms": 2.0890553335142106, "mean_action_processing_ms": 0.09326987074486116, "mean_env_wait_ms": 1.8280341569466623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006133079528808594, "StateBufferConnector_ms": 0.003538846969604492, "ViewRequirementAgentConnector_ms": 0.09122204780578613}, "num_episodes": 24, "episode_return_max": 695.8914679094707, "episode_return_min": 480.2426421761249, "episode_return_mean": 586.5289702397274, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 121000, "num_env_steps_sampled": 121200, "num_env_steps_trained": 121000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 226.8905396955511, "num_env_steps_trained_throughput_per_sec": 259.97874340115226, "timesteps_total": 121200, "num_env_steps_sampled_lifetime": 121200, "num_agent_steps_sampled_lifetime": 121200, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 121200, "timers": {"training_iteration_time_ms": 10386.801, "restore_workers_time_ms": 0.014, "training_step_time_ms": 662.067, "sample_time_ms": 644.945, "synch_weights_time_ms": 15.707}, "counters": {"num_env_steps_sampled": 121200, "num_env_steps_trained": 121000, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 121000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 808, "num_samples_added_to_queue": 121000}, "done": false, "training_iteration": 52, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-18", "timestamp": 1728775338, "time_this_iter_s": 10.59620714187622, "time_total_s": 536.9833550453186, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d6b730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.9833550453186, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 16.53125, "ram_util_percent": 54.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 820711.625, "policy_loss": 802510.0625, "entropy": 20.773780822753906, "entropy_coeff": 0.01, "var_gnorm": 16.324880599975586, "vf_loss": 1831581.0, "vf_explained_var": -0.016666054725646973}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 224.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 123450, "num_env_steps_trained": 123200, "num_agent_steps_sampled": 123450, "num_agent_steps_trained": 123200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 823, "num_samples_added_to_queue": 123200, "learner_queue": {"size_count": 224, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.753, "learner_load_time_ms": 0.348, "learner_load_wait_time_ms": 2395.647, "learner_dequeue_time_ms": 19830.763}}, "env_runners": {"episode_reward_max": 722.8074111304035, "episode_reward_min": 480.2426421761249, "episode_reward_mean": 607.0440636936859, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 480.2426421761249}, "policy_reward_max": {"default_policy": 722.8074111304035}, "policy_reward_mean": {"default_policy": 607.0440636936859}, "custom_metrics": {"num_consolidated_mean": 1.6801, "num_consolidated_min": 1.4, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.09610000000000002, "num_overloaded_min": 0.03, "num_overloaded_max": 0.22, "num_moves_mean": 7.981299999999999, "num_moves_min": 7.31, "num_moves_max": 8.51, "mean_accuracy_mean": 41.167513333333325, "mean_accuracy_min": 40.935333333333325, "mean_accuracy_max": 41.39766666666667, "num_model_switches_mean": 3.6944, "num_model_switches_min": 3.08, "num_model_switches_max": 4.29, "num_slav_mean": 0.02533283333333334, "num_slav_min": 0.014450000000000001, "num_slav_max": 0.03963333333333334, "cpu_conserved_cost_mean": 3.9802000000000004, "cpu_conserved_cost_min": 3.16, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.47356419386653625, "mean_cluster_cpu_util_min": 0.4645085088372977, "mean_cluster_cpu_util_max": 0.48445113809054646, "mean_cluster_mem_util_mean": 0.3121591131903183, "mean_cluster_mem_util_min": 0.3064168028287264, "mean_cluster_mem_util_max": 0.31875665453945295, "reward_consolidation_mean_mean": 2.5253606369368544, "reward_consolidation_mean_min": 2.2227597550945806, "reward_consolidation_mean_max": 2.88307411130403, "reward_illegal_mean_mean": -0.16016666666666665, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.61433333333334, "reward_accuracy_mean_min": 3.9583333333333384, "reward_accuracy_mean_max": 5.1083333333333405, "reward_sla_mean_mean": -0.9090866666666667, "reward_sla_mean_min": -1.4806666666666664, "reward_sla_mean_max": -0.534, "reward_consolidation_sum_mean": 252.53606369368546, "reward_consolidation_sum_min": 222.27597550945808, "reward_consolidation_sum_max": 288.307411130403, "reward_illegal_sum_mean": -16.016666666666666, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 461.4333333333338, "reward_accuracy_sum_min": 395.8333333333338, "reward_accuracy_sum_max": 510.83333333333405, "reward_sla_sum_mean": -90.90866666666665, "reward_sla_sum_min": -148.06666666666663, "reward_sla_sum_max": -53.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3352.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [582.2368850711265, 630.4444881050292, 494.4946663011365, 551.4911267476928, 645.9461360382596, 529.2560266837253, 480.2426421761249, 571.9500685369646, 567.2792470072196, 583.9611715251762, 565.1059886076338, 514.8231654939234, 590.603880715222, 559.0689725547542, 609.640168753237, 609.9996527460478, 591.7807426360844, 505.76659356057166, 601.367690152, 540.5565323342173, 607.972384172531, 582.8347558561034, 613.0235706235344, 509.59456882634254, 627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.251795734318589, "mean_inference_ms": 2.0873133349115234, "mean_action_processing_ms": 0.0932616208770419, "mean_env_wait_ms": 1.8282840609195483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006472110748291016, "StateBufferConnector_ms": 0.0035567283630371094, "ViewRequirementAgentConnector_ms": 0.09131503105163574}, "num_episodes": 21, "episode_return_max": 722.8074111304035, "episode_return_min": 480.2426421761249, "episode_return_mean": 607.0440636936859, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123450, "num_agent_steps_trained": 123200, "num_env_steps_sampled": 123450, "num_env_steps_trained": 123200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.14809021637305, "num_env_steps_trained_throughput_per_sec": 218.18924376712033, "timesteps_total": 123450, "num_env_steps_sampled_lifetime": 123450, "num_agent_steps_sampled_lifetime": 123450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 123450, "timers": {"training_iteration_time_ms": 10311.885, "restore_workers_time_ms": 0.014, "training_step_time_ms": 676.95, "sample_time_ms": 661.767, "synch_weights_time_ms": 13.669}, "counters": {"num_env_steps_sampled": 123450, "num_env_steps_trained": 123200, "num_agent_steps_sampled": 123450, "num_agent_steps_trained": 123200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 823, "num_samples_added_to_queue": 123200}, "done": false, "training_iteration": 53, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-28", "timestamp": 1728775348, "time_this_iter_s": 10.099748134613037, "time_total_s": 547.0831031799316, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d68a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 547.0831031799316, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.557142857142857, "ram_util_percent": 54.39285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 820503.875, "policy_loss": 803428.75, "entropy": 20.839595794677734, "entropy_coeff": 0.01, "var_gnorm": 16.330095291137695, "vf_loss": 1718977.875, "vf_explained_var": -0.014543890953063965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 228.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 839, "num_samples_added_to_queue": 125400, "learner_queue": {"size_count": 228, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.12, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 2323.234, "learner_dequeue_time_ms": 19794.206}}, "env_runners": {"episode_reward_max": 722.8074111304035, "episode_reward_min": 520.2118492796004, "episode_reward_mean": 622.8818098936921, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 520.2118492796004}, "policy_reward_max": {"default_policy": 722.8074111304035}, "policy_reward_mean": {"default_policy": 622.8818098936921}, "custom_metrics": {"num_consolidated_mean": 1.7161999999999995, "num_consolidated_min": 1.51, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.0891, "num_overloaded_min": 0.03, "num_overloaded_max": 0.15, "num_moves_mean": 7.880599999999999, "num_moves_min": 7.31, "num_moves_max": 8.51, "mean_accuracy_mean": 41.202790000000014, "mean_accuracy_min": 40.935333333333325, "mean_accuracy_max": 41.429333333333346, "num_model_switches_mean": 3.6052999999999997, "num_model_switches_min": 3.08, "num_model_switches_max": 4.29, "num_slav_mean": 0.0243905, "num_slav_min": 0.014450000000000001, "num_slav_max": 0.03976666666666667, "cpu_conserved_cost_mean": 4.0662, "cpu_conserved_cost_min": 3.54, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.4732114383723399, "mean_cluster_cpu_util_min": 0.4645085088372977, "mean_cluster_cpu_util_max": 0.4828648501884299, "mean_cluster_mem_util_mean": 0.31193336581668535, "mean_cluster_mem_util_min": 0.3059645076279457, "mean_cluster_mem_util_max": 0.3191832588837223, "reward_consolidation_mean_mean": 2.5689214322702494, "reward_consolidation_mean_min": 2.2940980535502145, "reward_consolidation_mean_max": 2.88307411130403, "reward_illegal_mean_mean": -0.14849999999999997, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.684250000000005, "reward_accuracy_mean_min": 4.0916666666666694, "reward_accuracy_mean_max": 5.116666666666673, "reward_sla_mean_mean": -0.8758533333333332, "reward_sla_mean_min": -1.4806666666666664, "reward_sla_mean_max": -0.534, "reward_consolidation_sum_mean": 256.89214322702486, "reward_consolidation_sum_min": 229.40980535502146, "reward_consolidation_sum_max": 288.307411130403, "reward_illegal_sum_mean": -14.85, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 468.4250000000005, "reward_accuracy_sum_min": 409.1666666666669, "reward_accuracy_sum_max": 511.6666666666673, "reward_sla_sum_mean": -87.58533333333335, "reward_sla_sum_min": -148.06666666666663, "reward_sla_sum_max": -53.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2281.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [627.6784611166959, 546.8639038654853, 535.9431386883552, 526.438798013951, 563.4609826677637, 575.4176581680837, 578.2593164580102, 613.2295379085563, 520.2118492796004, 580.4847391026226, 553.7542599530906, 620.7659508361514, 656.9230223278203, 663.3853300435594, 630.1198117518056, 556.6494258125439, 556.9817051996713, 639.1893447866223, 577.2583142952882, 593.2443175241403, 626.7765390356093, 641.8386000182768, 628.9511620823058, 548.5717323098485, 581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518125490874979, "mean_inference_ms": 2.088336514158241, "mean_action_processing_ms": 0.09327572596725163, "mean_env_wait_ms": 1.8292097338920046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006342172622680664, "StateBufferConnector_ms": 0.0034990310668945312, "ViewRequirementAgentConnector_ms": 0.08942985534667969}, "num_episodes": 24, "episode_return_max": 722.8074111304035, "episode_return_min": 520.2118492796004, "episode_return_mean": 622.8818098936921, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 225.8293370297599, "num_env_steps_trained_throughput_per_sec": 207.01022561061325, "timesteps_total": 125850, "num_env_steps_sampled_lifetime": 125850, "num_agent_steps_sampled_lifetime": 125850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 125850, "timers": {"training_iteration_time_ms": 10357.349, "restore_workers_time_ms": 0.014, "training_step_time_ms": 666.039, "sample_time_ms": 650.962, "synch_weights_time_ms": 13.727}, "counters": {"num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 839, "num_samples_added_to_queue": 125400}, "done": false, "training_iteration": 54, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-38", "timestamp": 1728775358, "time_this_iter_s": 10.640906572341919, "time_total_s": 557.7240097522736, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6050>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.7240097522736, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 16.320000000000004, "ram_util_percent": 54.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 851303.9375, "policy_loss": 831875.125, "entropy": 20.64995574951172, "entropy_coeff": 0.01, "var_gnorm": 16.3331298828125, "vf_loss": 1954239.25, "vf_explained_var": -0.01205289363861084}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 128100, "num_env_steps_trained": 127600, "num_agent_steps_sampled": 128100, "num_agent_steps_trained": 127600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 854, "num_samples_added_to_queue": 127600, "learner_queue": {"size_count": 232, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.465, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 2408.112, "learner_dequeue_time_ms": 19794.206}}, "env_runners": {"episode_reward_max": 722.8074111304035, "episode_reward_min": 553.7909104754942, "episode_reward_mean": 639.0371811203514, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 553.7909104754942}, "policy_reward_max": {"default_policy": 722.8074111304035}, "policy_reward_mean": {"default_policy": 639.0371811203514}, "custom_metrics": {"num_consolidated_mean": 1.7508999999999997, "num_consolidated_min": 1.54, "num_consolidated_max": 1.97, "num_overloaded_mean": 0.08310000000000001, "num_overloaded_min": 0.03, "num_overloaded_max": 0.13, "num_moves_mean": 7.785, "num_moves_min": 7.24, "num_moves_max": 8.48, "mean_accuracy_mean": 41.243829999999996, "mean_accuracy_min": 40.94799999999999, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 3.502100000000001, "num_model_switches_min": 2.87, "num_model_switches_max": 3.9, "num_slav_mean": 0.023451999999999997, "num_slav_min": 0.013766666666666665, "num_slav_max": 0.03976666666666667, "cpu_conserved_cost_mean": 4.1462, "cpu_conserved_cost_min": 3.54, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.47299076206060603, "mean_cluster_cpu_util_min": 0.4645085088372977, "mean_cluster_cpu_util_max": 0.4828648501884299, "mean_cluster_mem_util_mean": 0.31170998762701285, "mean_cluster_mem_util_min": 0.3053491893065243, "mean_cluster_mem_util_max": 0.3191832588837223, "reward_consolidation_mean_mean": 2.6137951445368426, "reward_consolidation_mean_min": 2.3525757714216087, "reward_consolidation_mean_max": 2.88307411130403, "reward_illegal_mean_mean": -0.13849999999999998, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.768250000000006, "reward_accuracy_mean_min": 4.191666666666669, "reward_accuracy_mean_max": 5.27500000000001, "reward_sla_mean_mean": -0.8531733333333333, "reward_sla_mean_min": -1.361333333333333, "reward_sla_mean_max": -0.4846666666666667, "reward_consolidation_sum_mean": 261.3795144536842, "reward_consolidation_sum_min": 235.25757714216087, "reward_consolidation_sum_max": 288.307411130403, "reward_illegal_sum_mean": -13.849999999999996, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 476.82500000000067, "reward_accuracy_sum_min": 419.1666666666669, "reward_accuracy_sum_max": 527.500000000001, "reward_sla_sum_mean": -85.31733333333332, "reward_sla_sum_min": -136.1333333333333, "reward_sla_sum_max": -48.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2145.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [581.2348106856751, 578.0617685582874, 644.3343415882305, 604.0228882999791, 557.9200402083528, 553.7909104754942, 656.5477382801795, 629.769831551373, 601.1370373754911, 625.3496238082189, 605.3952968412078, 671.2996405616989, 660.9603978190019, 635.9074507295383, 633.4038746230473, 626.6438514727836, 677.2796582290057, 609.5328124524052, 624.626829936946, 622.7511742666547, 603.7451003685771, 613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179665159905645, "mean_inference_ms": 2.0881039371515686, "mean_action_processing_ms": 0.09327937554471954, "mean_env_wait_ms": 1.8298535581697644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006369113922119141, "StateBufferConnector_ms": 0.003496885299682617, "ViewRequirementAgentConnector_ms": 0.0894320011138916}, "num_episodes": 24, "episode_return_max": 722.8074111304035, "episode_return_min": 553.7909104754942, "episode_return_mean": 639.0371811203514, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128100, "num_agent_steps_trained": 127600, "num_env_steps_sampled": 128100, "num_env_steps_trained": 127600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.10193588042517, "num_env_steps_trained_throughput_per_sec": 218.1441150830824, "timesteps_total": 128100, "num_env_steps_sampled_lifetime": 128100, "num_agent_steps_sampled_lifetime": 128100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 128100, "timers": {"training_iteration_time_ms": 10324.892, "restore_workers_time_ms": 0.013, "training_step_time_ms": 669.96, "sample_time_ms": 655.59, "synch_weights_time_ms": 12.931}, "counters": {"num_env_steps_sampled": 128100, "num_env_steps_trained": 127600, "num_agent_steps_sampled": 128100, "num_agent_steps_trained": 127600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 854, "num_samples_added_to_queue": 127600}, "done": false, "training_iteration": 55, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-49", "timestamp": 1728775369, "time_this_iter_s": 10.096986532211304, "time_total_s": 567.8209962844849, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d6b730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.8209962844849, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 16.62666666666667, "ram_util_percent": 54.680000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 835161.375, "policy_loss": 815750.3125, "entropy": 20.26424789428711, "entropy_coeff": 0.01, "var_gnorm": 16.33806800842285, "vf_loss": 1952247.875, "vf_explained_var": -0.010153889656066895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 130350, "num_env_steps_trained": 129800, "num_agent_steps_sampled": 130350, "num_agent_steps_trained": 129800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 869, "num_samples_added_to_queue": 130350, "learner_queue": {"size_count": 236, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.522, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 2344.289, "learner_dequeue_time_ms": 19871.942}}, "env_runners": {"episode_reward_max": 722.8074111304035, "episode_reward_min": 572.5039660056658, "episode_reward_mean": 648.2831027749862, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 572.5039660056658}, "policy_reward_max": {"default_policy": 722.8074111304035}, "policy_reward_mean": {"default_policy": 648.2831027749862}, "custom_metrics": {"num_consolidated_mean": 1.7679, "num_consolidated_min": 1.57, "num_consolidated_max": 1.97, "num_overloaded_mean": 0.07999999999999999, "num_overloaded_min": 0.03, "num_overloaded_max": 0.13, "num_moves_mean": 7.6869, "num_moves_min": 7.14, "num_moves_max": 8.24, "mean_accuracy_mean": 41.27359666666667, "mean_accuracy_min": 40.94799999999999, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 3.4419000000000004, "num_model_switches_min": 2.87, "num_model_switches_max": 3.75, "num_slav_mean": 0.022977833333333333, "num_slav_min": 0.013766666666666665, "num_slav_max": 0.03976666666666667, "cpu_conserved_cost_mean": 4.179399999999999, "cpu_conserved_cost_min": 3.56, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.47237021407714813, "mean_cluster_cpu_util_min": 0.46114063004297784, "mean_cluster_cpu_util_max": 0.4828648501884299, "mean_cluster_mem_util_mean": 0.3114281417161801, "mean_cluster_mem_util_min": 0.300709362352536, "mean_cluster_mem_util_max": 0.3191832588837223, "reward_consolidation_mean_mean": 2.635974361083189, "reward_consolidation_mean_min": 2.4269794998324654, "reward_consolidation_mean_max": 2.88307411130403, "reward_illegal_mean_mean": -0.1333333333333333, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.818750000000007, "reward_accuracy_mean_min": 4.191666666666669, "reward_accuracy_mean_max": 5.27500000000001, "reward_sla_mean_mean": -0.83856, "reward_sla_mean_min": -1.361333333333333, "reward_sla_mean_max": -0.4846666666666667, "reward_consolidation_sum_mean": 263.59743610831885, "reward_consolidation_sum_min": 242.69794998324653, "reward_consolidation_sum_max": 288.307411130403, "reward_illegal_sum_mean": -13.333333333333332, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 481.8750000000007, "reward_accuracy_sum_min": 419.1666666666669, "reward_accuracy_sum_max": 527.500000000001, "reward_sla_sum_mean": -83.85600000000001, "reward_sla_sum_min": -136.1333333333333, "reward_sla_sum_max": -48.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2766.0, "global_timestep_min": 700, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [613.9604831094467, 628.0658990526676, 597.2546315757415, 695.8914679094707, 572.5039660056658, 607.6206220110274, 634.9145389746872, 594.7069785860067, 622.4772183130774, 622.0079441956813, 645.801066130556, 639.6896006579556, 659.9708824514913, 627.853732979988, 677.8316244783582, 722.8074111304035, 652.8324560601909, 669.7597703250178, 598.3754942276652, 614.8917268268915, 635.8774863687602, 667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517173649133076, "mean_inference_ms": 2.0865089264483525, "mean_action_processing_ms": 0.09326469386716706, "mean_env_wait_ms": 1.8299578360030972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006244182586669922, "StateBufferConnector_ms": 0.003512144088745117, "ViewRequirementAgentConnector_ms": 0.09011030197143555}, "num_episodes": 21, "episode_return_max": 722.8074111304035, "episode_return_min": 572.5039660056658, "episode_return_mean": 648.2831027749862, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130350, "num_agent_steps_trained": 129800, "num_env_steps_sampled": 130350, "num_env_steps_trained": 129800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.0102746961813, "num_env_steps_trained_throughput_per_sec": 218.05449081404393, "timesteps_total": 130350, "num_env_steps_sampled_lifetime": 130350, "num_agent_steps_sampled_lifetime": 130350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 130350, "timers": {"training_iteration_time_ms": 10271.403, "restore_workers_time_ms": 0.015, "training_step_time_ms": 668.216, "sample_time_ms": 638.961, "synch_weights_time_ms": 27.81}, "counters": {"num_env_steps_sampled": 130350, "num_env_steps_trained": 129800, "num_agent_steps_sampled": 130350, "num_agent_steps_trained": 129800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 869, "num_samples_added_to_queue": 130350}, "done": false, "training_iteration": 56, "trial_id": "90ffb_00000", "date": "2024-10-13_00-22-59", "timestamp": 1728775379, "time_this_iter_s": 10.105581283569336, "time_total_s": 577.9265775680542, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611946a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.9265775680542, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 54.87142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 816028.9375, "policy_loss": 796166.625, "entropy": 19.74518394470215, "entropy_coeff": 0.01, "var_gnorm": 16.3448429107666, "vf_loss": 1997096.375, "vf_explained_var": -0.008924245834350586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 240.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 132300, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132300, "num_agent_steps_trained": 132000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 882, "num_samples_added_to_queue": 132000, "learner_queue": {"size_count": 240, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 101.247, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 2478.078, "learner_dequeue_time_ms": 19871.942}}, "env_runners": {"episode_reward_max": 722.9759907398949, "episode_reward_min": 596.1646166499136, "episode_reward_mean": 659.3185238356336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 596.1646166499136}, "policy_reward_max": {"default_policy": 722.9759907398949}, "policy_reward_mean": {"default_policy": 659.3185238356336}, "custom_metrics": {"num_consolidated_mean": 1.7906, "num_consolidated_min": 1.6, "num_consolidated_max": 1.97, "num_overloaded_mean": 0.0747, "num_overloaded_min": 0.03, "num_overloaded_max": 0.13, "num_moves_mean": 7.573499999999999, "num_moves_min": 7.02, "num_moves_max": 8.24, "mean_accuracy_mean": 41.30228666666667, "mean_accuracy_min": 41.062, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 3.3876, "num_model_switches_min": 2.87, "num_model_switches_max": 3.75, "num_slav_mean": 0.02276, "num_slav_min": 0.013766666666666665, "num_slav_max": 0.03976666666666667, "cpu_conserved_cost_mean": 4.2414, "cpu_conserved_cost_min": 3.72, "cpu_conserved_cost_max": 4.7, "mean_cluster_cpu_util_mean": 0.4723475337284419, "mean_cluster_cpu_util_min": 0.46114063004297784, "mean_cluster_cpu_util_max": 0.4828648501884299, "mean_cluster_mem_util_mean": 0.31158964529873134, "mean_cluster_mem_util_min": 0.300709362352536, "mean_cluster_mem_util_max": 0.3191832588837223, "reward_consolidation_mean_mean": 2.6699585716896648, "reward_consolidation_mean_min": 2.4269794998324654, "reward_consolidation_mean_max": 2.8676959395656287, "reward_illegal_mean_mean": -0.12449999999999997, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.879500000000007, "reward_accuracy_mean_min": 4.4500000000000055, "reward_accuracy_mean_max": 5.27500000000001, "reward_sla_mean_mean": -0.8317733333333334, "reward_sla_mean_min": -1.361333333333333, "reward_sla_mean_max": -0.4846666666666667, "reward_consolidation_sum_mean": 266.9958571689665, "reward_consolidation_sum_min": 242.69794998324653, "reward_consolidation_sum_max": 286.76959395656286, "reward_illegal_sum_mean": -12.45, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 487.9500000000007, "reward_accuracy_sum_min": 445.0000000000005, "reward_accuracy_sum_max": 527.500000000001, "reward_sla_sum_mean": -83.17733333333334, "reward_sla_sum_min": -136.1333333333333, "reward_sla_sum_max": -48.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3471.0, "global_timestep_min": 1500, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [667.2804898108384, 624.8428005726648, 596.1646166499136, 662.4264613603831, 678.9742483779593, 688.1011331444765, 661.8095159767289, 665.9559474854558, 631.9049163849045, 686.2971336318506, 644.0222851746934, 609.4160863870366, 644.3356361753334, 686.7295470468188, 626.795586219502, 646.6509945475042, 651.7871668342021, 640.0477596027908, 616.7703219714283, 623.5415425386096, 616.69442566024, 613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517851484903316, "mean_inference_ms": 2.0874834959889705, "mean_action_processing_ms": 0.09330064539458, "mean_env_wait_ms": 1.8311887787421346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006037712097167969, "StateBufferConnector_ms": 0.0035424232482910156, "ViewRequirementAgentConnector_ms": 0.09102201461791992}, "num_episodes": 21, "episode_return_max": 722.9759907398949, "episode_return_min": 596.1646166499136, "episode_return_mean": 659.3185238356336, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132300, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132300, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 191.16249731097523, "num_env_steps_trained_throughput_per_sec": 215.6705097867413, "timesteps_total": 132300, "num_env_steps_sampled_lifetime": 132300, "num_agent_steps_sampled_lifetime": 132300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 132300, "timers": {"training_iteration_time_ms": 10241.398, "restore_workers_time_ms": 0.014, "training_step_time_ms": 690.901, "sample_time_ms": 674.783, "synch_weights_time_ms": 14.723}, "counters": {"num_env_steps_sampled": 132300, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132300, "num_agent_steps_trained": 132000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 882, "num_samples_added_to_queue": 132000}, "done": false, "training_iteration": 57, "trial_id": "90ffb_00000", "date": "2024-10-13_00-23-09", "timestamp": 1728775389, "time_this_iter_s": 10.218812704086304, "time_total_s": 588.1453902721405, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef48b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 588.1453902721405, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.220000000000002, "ram_util_percent": 57.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 850848.3125, "policy_loss": 827988.6875, "entropy": 19.194568634033203, "entropy_coeff": 0.01, "var_gnorm": 16.352399826049805, "vf_loss": 2296518.5, "vf_explained_var": -0.0074236392974853516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 244.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 134550, "num_env_steps_trained": 134200, "num_agent_steps_sampled": 134550, "num_agent_steps_trained": 134200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 897, "num_samples_added_to_queue": 134200, "learner_queue": {"size_count": 244, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 94.486, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2550.704, "learner_dequeue_time_ms": 19812.478}}, "env_runners": {"episode_reward_max": 763.5356148527226, "episode_reward_min": 609.7401322001894, "episode_reward_mean": 671.0211521216005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 609.7401322001894}, "policy_reward_max": {"default_policy": 763.5356148527226}, "policy_reward_mean": {"default_policy": 671.0211521216005}, "custom_metrics": {"num_consolidated_mean": 1.8122, "num_consolidated_min": 1.61, "num_consolidated_max": 2.08, "num_overloaded_mean": 0.07170000000000001, "num_overloaded_min": 0.02, "num_overloaded_max": 0.13, "num_moves_mean": 7.461400000000001, "num_moves_min": 6.76, "num_moves_max": 8.24, "mean_accuracy_mean": 41.317930000000004, "mean_accuracy_min": 41.062, "mean_accuracy_max": 41.50533333333334, "num_model_switches_mean": 3.3059999999999996, "num_model_switches_min": 2.71, "num_model_switches_max": 3.69, "num_slav_mean": 0.0212865, "num_slav_min": 0.010816666666666667, "num_slav_max": 0.031549999999999995, "cpu_conserved_cost_mean": 4.2962, "cpu_conserved_cost_min": 3.74, "cpu_conserved_cost_max": 5.06, "mean_cluster_cpu_util_mean": 0.4722339007899495, "mean_cluster_cpu_util_min": 0.46114063004297784, "mean_cluster_cpu_util_max": 0.48219293911059735, "mean_cluster_mem_util_mean": 0.311585531462585, "mean_cluster_mem_util_min": 0.300709362352536, "mean_cluster_mem_util_max": 0.3191832588837223, "reward_consolidation_mean_mean": 2.696241521215998, "reward_consolidation_mean_min": 2.4502386609400224, "reward_consolidation_mean_max": 3.0340228151938833, "reward_illegal_mean_mean": -0.1195, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 4.912416666666674, "reward_accuracy_mean_min": 4.4500000000000055, "reward_accuracy_mean_max": 5.27500000000001, "reward_sla_mean_mean": -0.7789466666666668, "reward_sla_mean_min": -1.226, "reward_sla_mean_max": -0.4026666666666667, "reward_consolidation_sum_mean": 269.6241521215998, "reward_consolidation_sum_min": 245.02386609400224, "reward_consolidation_sum_max": 303.40228151938834, "reward_illegal_sum_mean": -11.95, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 491.2416666666673, "reward_accuracy_sum_min": 445.0000000000005, "reward_accuracy_sum_max": 527.500000000001, "reward_sla_sum_mean": -77.89466666666667, "reward_sla_sum_min": -122.6, "reward_sla_sum_max": -40.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4167.0, "global_timestep_min": 2200, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [613.1987907033423, 638.2087666392524, 622.1981662554451, 618.5211581223925, 622.6022632428655, 612.7905327606695, 632.4810320143775, 615.4361052727776, 665.9934052209942, 658.4616436687079, 641.1105973377202, 646.0007158305168, 629.421215998051, 676.126406530812, 635.5687745590793, 622.3542112156942, 684.7071065216737, 665.5847391026235, 673.2392853879198, 643.669621371349, 696.7591245545096, 616.5908495537487, 717.678656066284, 631.8834475616075, 624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25187022177354756, "mean_inference_ms": 2.087140455678496, "mean_action_processing_ms": 0.0933247909608496, "mean_env_wait_ms": 1.8321514291618188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005875825881958008, "StateBufferConnector_ms": 0.003527402877807617, "ViewRequirementAgentConnector_ms": 0.09078741073608398}, "num_episodes": 21, "episode_return_max": 763.5356148527226, "episode_return_min": 609.7401322001894, "episode_return_mean": 671.0211521216005, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134550, "num_agent_steps_trained": 134200, "num_env_steps_sampled": 134550, "num_env_steps_trained": 134200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 224.991352890471, "num_env_steps_trained_throughput_per_sec": 219.99154504846052, "timesteps_total": 134550, "num_env_steps_sampled_lifetime": 134550, "num_agent_steps_sampled_lifetime": 134550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 134550, "timers": {"training_iteration_time_ms": 10178.08, "restore_workers_time_ms": 0.013, "training_step_time_ms": 660.927, "sample_time_ms": 645.617, "synch_weights_time_ms": 13.788}, "counters": {"num_env_steps_sampled": 134550, "num_env_steps_trained": 134200, "num_agent_steps_sampled": 134550, "num_agent_steps_trained": 134200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 897, "num_samples_added_to_queue": 134200}, "done": false, "training_iteration": 58, "trial_id": "90ffb_00000", "date": "2024-10-13_00-23-19", "timestamp": 1728775399, "time_this_iter_s": 10.014915704727173, "time_total_s": 598.1603059768677, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7430>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.1603059768677, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 16.671428571428574, "ram_util_percent": 56.792857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 824626.1875, "policy_loss": 801761.4375, "entropy": 18.614992141723633, "entropy_coeff": 0.01, "var_gnorm": 16.36012077331543, "vf_loss": 2296714.75, "vf_explained_var": -0.0059882402420043945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 136800, "num_env_steps_trained": 136400, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 912, "num_samples_added_to_queue": 136400, "learner_queue": {"size_count": 248, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.889, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2428.356, "learner_dequeue_time_ms": 19812.478}}, "env_runners": {"episode_reward_max": 773.4532577903693, "episode_reward_min": 609.7401322001894, "episode_reward_mean": 691.2708939657018, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 609.7401322001894}, "policy_reward_max": {"default_policy": 773.4532577903693}, "policy_reward_mean": {"default_policy": 691.2708939657018}, "custom_metrics": {"num_consolidated_mean": 1.8614000000000002, "num_consolidated_min": 1.64, "num_consolidated_max": 2.15, "num_overloaded_mean": 0.0641, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 7.283499999999999, "num_moves_min": 6.55, "num_moves_max": 8.24, "mean_accuracy_mean": 41.34845666666667, "mean_accuracy_min": 41.1, "mean_accuracy_max": 41.594000000000015, "num_model_switches_mean": 3.1927, "num_model_switches_min": 2.71, "num_model_switches_max": 3.6, "num_slav_mean": 0.01955883333333333, "num_slav_min": 0.006833333333333334, "num_slav_max": 0.029716666666666666, "cpu_conserved_cost_mean": 4.4176, "cpu_conserved_cost_min": 3.92, "cpu_conserved_cost_max": 5.16, "mean_cluster_cpu_util_mean": 0.4719960275197742, "mean_cluster_cpu_util_min": 0.46114063004297784, "mean_cluster_cpu_util_max": 0.48118671201238505, "mean_cluster_mem_util_mean": 0.3113650260376303, "mean_cluster_mem_util_min": 0.300709362352536, "mean_cluster_mem_util_max": 0.3190216142469646, "reward_consolidation_mean_mean": 2.756638939657011, "reward_consolidation_mean_min": 2.521593255962715, "reward_consolidation_mean_max": 3.0588406591732924, "reward_illegal_mean_mean": -0.10683333333333334, "reward_illegal_mean_min": -0.19999999999999996, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.986416666666674, "reward_accuracy_mean_min": 4.608333333333339, "reward_accuracy_mean_max": 5.416666666666678, "reward_sla_mean_mean": -0.7235133333333333, "reward_sla_mean_min": -1.1886666666666668, "reward_sla_mean_max": -0.2733333333333333, "reward_consolidation_sum_mean": 275.66389396570105, "reward_consolidation_sum_min": 252.15932559627154, "reward_consolidation_sum_max": 305.8840659173292, "reward_illegal_sum_mean": -10.683333333333335, "reward_illegal_sum_min": -19.999999999999996, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 498.64166666666745, "reward_accuracy_sum_min": 460.8333333333339, "reward_accuracy_sum_max": 541.6666666666678, "reward_sla_sum_mean": -72.35133333333334, "reward_sla_sum_min": -118.86666666666667, "reward_sla_sum_max": -27.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4967.0, "global_timestep_min": 3000, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [624.4570166620982, 609.7401322001894, 661.9375186572856, 650.560729842518, 670.7100185811331, 654.949154710775, 661.8663833805482, 654.2678363641908, 647.3365865545713, 675.5415273081735, 672.2277529013987, 656.0087270401177, 674.1694172834998, 658.899521764294, 662.8744098205859, 652.8177556428775, 662.2659995735484, 671.1329282037232, 622.0175119558936, 681.0008041670484, 626.939267111396, 662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2520146409751326, "mean_inference_ms": 2.0886697993664596, "mean_action_processing_ms": 0.09337340745525945, "mean_env_wait_ms": 1.833787751953774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00588536262512207, "StateBufferConnector_ms": 0.0035233497619628906, "ViewRequirementAgentConnector_ms": 0.09142684936523438}, "num_episodes": 24, "episode_return_max": 773.4532577903693, "episode_return_min": 609.7401322001894, "episode_return_mean": 691.2708939657018, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136400, "num_env_steps_sampled": 136800, "num_env_steps_trained": 136400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 221.27601106006776, "num_env_steps_trained_throughput_per_sec": 216.35876636984403, "timesteps_total": 136800, "num_env_steps_sampled_lifetime": 136800, "num_agent_steps_sampled_lifetime": 136800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 136800, "timers": {"training_iteration_time_ms": 10192.045, "restore_workers_time_ms": 0.014, "training_step_time_ms": 679.89, "sample_time_ms": 666.572, "synch_weights_time_ms": 12.026}, "counters": {"num_env_steps_sampled": 136800, "num_env_steps_trained": 136400, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 912, "num_samples_added_to_queue": 136400}, "done": false, "training_iteration": 59, "trial_id": "90ffb_00000", "date": "2024-10-13_00-23-29", "timestamp": 1728775409, "time_this_iter_s": 10.178834438323975, "time_total_s": 608.3391404151917, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754199f30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.3391404151917, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.366666666666664, "ram_util_percent": 56.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 803510.9375, "policy_loss": 780125.9375, "entropy": 17.979026794433594, "entropy_coeff": 0.01, "var_gnorm": 16.368986129760742, "vf_loss": 2348385.25, "vf_explained_var": -0.004261612892150879}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 252.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 139050, "num_env_steps_trained": 138600, "num_agent_steps_sampled": 139050, "num_agent_steps_trained": 138600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 927, "num_samples_added_to_queue": 138600, "learner_queue": {"size_count": 252, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.569, "learner_load_time_ms": 0.361, "learner_load_wait_time_ms": 2357.581, "learner_dequeue_time_ms": 19838.61}}, "env_runners": {"episode_reward_max": 792.8483779585135, "episode_reward_min": 615.9926589296056, "episode_reward_mean": 709.8249171464262, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 615.9926589296056}, "policy_reward_max": {"default_policy": 792.8483779585135}, "policy_reward_mean": {"default_policy": 709.8249171464262}, "custom_metrics": {"num_consolidated_mean": 1.9028, "num_consolidated_min": 1.7, "num_consolidated_max": 2.18, "num_overloaded_mean": 0.0572, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 7.096699999999999, "num_moves_min": 6.31, "num_moves_max": 7.75, "mean_accuracy_mean": 41.38164333333334, "mean_accuracy_min": 41.11900000000001, "mean_accuracy_max": 41.619333333333344, "num_model_switches_mean": 3.0757, "num_model_switches_min": 2.51, "num_model_switches_max": 3.6, "num_slav_mean": 0.018170166666666664, "num_slav_min": 0.006833333333333334, "num_slav_max": 0.029716666666666666, "cpu_conserved_cost_mean": 4.5264, "cpu_conserved_cost_min": 3.94, "cpu_conserved_cost_max": 5.32, "mean_cluster_cpu_util_mean": 0.47237456480283085, "mean_cluster_cpu_util_min": 0.46114063004297784, "mean_cluster_cpu_util_max": 0.4838356526685033, "mean_cluster_mem_util_mean": 0.3114880317209162, "mean_cluster_mem_util_min": 0.300709362352536, "mean_cluster_mem_util_max": 0.3190216142469646, "reward_consolidation_mean_mean": 2.8076825047975875, "reward_consolidation_mean_min": 2.521593255962715, "reward_consolidation_mean_max": 3.0588406591732924, "reward_illegal_mean_mean": -0.09533333333333331, "reward_illegal_mean_min": -0.19999999999999996, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.060833333333342, "reward_accuracy_mean_min": 4.666666666666672, "reward_accuracy_mean_max": 5.458333333333344, "reward_sla_mean_mean": -0.6749333333333334, "reward_sla_mean_min": -1.1886666666666668, "reward_sla_mean_max": -0.2733333333333333, "reward_consolidation_sum_mean": 280.76825047975876, "reward_consolidation_sum_min": 252.15932559627154, "reward_consolidation_sum_max": 305.8840659173292, "reward_illegal_sum_mean": -9.533333333333333, "reward_illegal_sum_min": -19.999999999999996, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 506.0833333333341, "reward_accuracy_sum_min": 466.66666666666725, "reward_accuracy_sum_max": 545.8333333333344, "reward_sla_sum_mean": -67.49333333333333, "reward_sla_sum_min": -118.86666666666667, "reward_sla_sum_max": -27.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5669.0, "global_timestep_min": 3800, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [662.1656675500325, 692.8822078040762, 665.5669103536512, 683.6947698681048, 677.9871028663687, 679.7547442809717, 652.2943312315336, 617.3946937159226, 700.3659508361515, 710.0259557098916, 674.5300130981761, 615.9926589296056, 657.7040391117619, 716.622096317281, 687.6300435590491, 660.2993511834059, 704.3495111029888, 680.5695634956907, 685.0337536933816, 694.6426878674351, 702.5234548722176, 722.9759907398949, 665.84386670322, 706.0399768497372, 673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25212983078381157, "mean_inference_ms": 2.0897987714465027, "mean_action_processing_ms": 0.09341449742242648, "mean_env_wait_ms": 1.8350553012374804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005782127380371094, "StateBufferConnector_ms": 0.0034978389739990234, "ViewRequirementAgentConnector_ms": 0.09030532836914062}, "num_episodes": 21, "episode_return_max": 792.8483779585135, "episode_return_min": 615.9926589296056, "episode_return_mean": 709.8249171464262, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139050, "num_agent_steps_trained": 138600, "num_env_steps_sampled": 139050, "num_env_steps_trained": 138600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 222.83861677083743, "num_env_steps_trained_throughput_per_sec": 217.88664750926324, "timesteps_total": 139050, "num_env_steps_sampled_lifetime": 139050, "num_agent_steps_sampled_lifetime": 139050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 139050, "timers": {"training_iteration_time_ms": 10194.852, "restore_workers_time_ms": 0.015, "training_step_time_ms": 668.96, "sample_time_ms": 653.852, "synch_weights_time_ms": 13.725}, "counters": {"num_env_steps_sampled": 139050, "num_env_steps_trained": 138600, "num_agent_steps_sampled": 139050, "num_agent_steps_trained": 138600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 927, "num_samples_added_to_queue": 138600}, "done": false, "training_iteration": 60, "trial_id": "90ffb_00000", "date": "2024-10-13_00-23-39", "timestamp": 1728775419, "time_this_iter_s": 10.109396696090698, "time_total_s": 618.4485371112823, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d68850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.4485371112823, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.307142857142853, "ram_util_percent": 56.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 818576.5625, "policy_loss": 792289.1875, "entropy": 17.180465698242188, "entropy_coeff": 0.01, "var_gnorm": 16.377525329589844, "vf_loss": 2638185.75, "vf_explained_var": -0.0024374723434448242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 256.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 141450, "num_env_steps_trained": 140800, "num_agent_steps_sampled": 141450, "num_agent_steps_trained": 140800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 943, "num_samples_added_to_queue": 141350, "learner_queue": {"size_count": 256, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.822, "learner_load_time_ms": 0.332, "learner_load_wait_time_ms": 2437.433, "learner_dequeue_time_ms": 19904.79}}, "env_runners": {"episode_reward_max": 829.1246915836614, "episode_reward_min": 642.9301105729697, "episode_reward_mean": 732.0082215114693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 642.9301105729697}, "policy_reward_max": {"default_policy": 829.1246915836614}, "policy_reward_mean": {"default_policy": 732.0082215114693}, "custom_metrics": {"num_consolidated_mean": 1.9585, "num_consolidated_min": 1.7, "num_consolidated_max": 2.21, "num_overloaded_mean": 0.05130000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 6.8285, "num_moves_min": 5.86, "num_moves_max": 7.73, "mean_accuracy_mean": 41.412233333333354, "mean_accuracy_min": 41.11900000000001, "mean_accuracy_max": 41.619333333333344, "num_model_switches_mean": 2.9305000000000008, "num_model_switches_min": 2.48, "num_model_switches_max": 3.59, "num_slav_mean": 0.015947166666666665, "num_slav_min": 0.006833333333333334, "num_slav_max": 0.0297, "cpu_conserved_cost_mean": 4.6658, "cpu_conserved_cost_min": 4.02, "cpu_conserved_cost_max": 5.46, "mean_cluster_cpu_util_mean": 0.4725651132447116, "mean_cluster_cpu_util_min": 0.4628688638688916, "mean_cluster_cpu_util_max": 0.4838356526685033, "mean_cluster_mem_util_mean": 0.3112591221906484, "mean_cluster_mem_util_min": 0.30424301142397886, "mean_cluster_mem_util_max": 0.3190216142469646, "reward_consolidation_mean_mean": 2.8701222151146855, "reward_consolidation_mean_min": 2.5280529409972887, "reward_consolidation_mean_max": 3.2329135825032744, "reward_illegal_mean_mean": -0.0855, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.128333333333342, "reward_accuracy_mean_min": 4.666666666666672, "reward_accuracy_mean_max": 5.516666666666677, "reward_sla_mean_mean": -0.5928733333333333, "reward_sla_mean_min": -1.1553333333333333, "reward_sla_mean_max": -0.2733333333333333, "reward_consolidation_sum_mean": 287.01222151146857, "reward_consolidation_sum_min": 252.80529409972885, "reward_consolidation_sum_max": 323.29135825032745, "reward_illegal_sum_mean": -8.549999999999999, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 512.8333333333342, "reward_accuracy_sum_min": 466.66666666666725, "reward_accuracy_sum_max": 551.6666666666678, "reward_sla_sum_mean": -59.287333333333315, "reward_sla_sum_min": -115.53333333333333, "reward_sla_sum_max": -27.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5769.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [673.3726034908168, 691.168948186056, 659.0342441134374, 669.2693594078413, 714.3135154893546, 676.1470559566243, 707.602927289897, 700.1022358280793, 651.8061043589518, 669.289816930154, 694.6106704438158, 706.7381400590947, 716.1007676140007, 681.7100003046096, 716.4609826677638, 691.7906424198133, 703.1394316001096, 642.9301105729697, 730.4002589174212, 705.5764659295145, 692.8624569740173, 763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25229199781116324, "mean_inference_ms": 2.0921750223721443, "mean_action_processing_ms": 0.09346533521912903, "mean_env_wait_ms": 1.8366965620526248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005728244781494141, "StateBufferConnector_ms": 0.003472566604614258, "ViewRequirementAgentConnector_ms": 0.08962655067443848}, "num_episodes": 24, "episode_return_max": 829.1246915836614, "episode_return_min": 642.9301105729697, "episode_return_mean": 732.0082215114693, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141450, "num_agent_steps_trained": 140800, "num_env_steps_sampled": 141450, "num_env_steps_trained": 140800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 219.9696728874425, "num_env_steps_trained_throughput_per_sec": 201.63886681348896, "timesteps_total": 141450, "num_env_steps_sampled_lifetime": 141450, "num_agent_steps_sampled_lifetime": 141450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 141450, "timers": {"training_iteration_time_ms": 10283.968, "restore_workers_time_ms": 0.013, "training_step_time_ms": 689.557, "sample_time_ms": 671.043, "synch_weights_time_ms": 16.617}, "counters": {"num_env_steps_sampled": 141450, "num_env_steps_trained": 140800, "num_agent_steps_sampled": 141450, "num_agent_steps_trained": 140800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 943, "num_samples_added_to_queue": 141350}, "done": false, "training_iteration": 61, "trial_id": "90ffb_00000", "date": "2024-10-13_00-23-50", "timestamp": 1728775430, "time_this_iter_s": 10.962643384933472, "time_total_s": 629.4111804962158, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7e20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.4111804962158, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.8375, "ram_util_percent": 56.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 767867.25, "policy_loss": 740346.9375, "entropy": 16.290184020996094, "entropy_coeff": 0.01, "var_gnorm": 16.382619857788086, "vf_loss": 2760991.5, "vf_explained_var": -0.0009416341781616211}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 260.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 143550, "num_env_steps_trained": 143000, "num_agent_steps_sampled": 143550, "num_agent_steps_trained": 143000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 957, "num_samples_added_to_queue": 143550, "learner_queue": {"size_count": 260, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 111.691, "learner_load_time_ms": 0.332, "learner_load_wait_time_ms": 2427.978, "learner_dequeue_time_ms": 19904.79}}, "env_runners": {"episode_reward_max": 837.1103902037842, "episode_reward_min": 661.0052940997294, "episode_reward_mean": 751.2846990770365, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 661.0052940997294}, "policy_reward_max": {"default_policy": 837.1103902037842}, "policy_reward_mean": {"default_policy": 751.2846990770365}, "custom_metrics": {"num_consolidated_mean": 2.0102, "num_consolidated_min": 1.7, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.0479, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 6.603000000000001, "num_moves_min": 5.64, "num_moves_max": 7.6, "mean_accuracy_mean": 41.446686666666665, "mean_accuracy_min": 41.20766666666666, "mean_accuracy_max": 41.625666666666675, "num_model_switches_mean": 2.792, "num_model_switches_min": 2.3, "num_model_switches_max": 3.4, "num_slav_mean": 0.013967333333333333, "num_slav_min": 0.0059499999999999996, "num_slav_max": 0.0225, "cpu_conserved_cost_mean": 4.794999999999999, "cpu_conserved_cost_min": 4.1, "cpu_conserved_cost_max": 5.66, "mean_cluster_cpu_util_mean": 0.4730580539123506, "mean_cluster_cpu_util_min": 0.4628688638688916, "mean_cluster_cpu_util_max": 0.4838356526685033, "mean_cluster_mem_util_mean": 0.31118812282033065, "mean_cluster_mem_util_min": 0.30424301142397886, "mean_cluster_mem_util_max": 0.3190216142469646, "reward_consolidation_mean_mean": 2.921340324103688, "reward_consolidation_mean_min": 2.5280529409972887, "reward_consolidation_mean_max": 3.2329135825032744, "reward_illegal_mean_mean": -0.07983333333333331, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.190333333333342, "reward_accuracy_mean_min": 4.766666666666675, "reward_accuracy_mean_max": 5.691666666666678, "reward_sla_mean_mean": -0.5189933333333334, "reward_sla_mean_min": -0.8679999999999999, "reward_sla_mean_max": -0.23799999999999996, "reward_consolidation_sum_mean": 292.13403241036883, "reward_consolidation_sum_min": 252.80529409972885, "reward_consolidation_sum_max": 323.29135825032745, "reward_illegal_sum_mean": -7.983333333333333, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 519.0333333333341, "reward_accuracy_sum_min": 476.6666666666674, "reward_accuracy_sum_max": 569.1666666666678, "reward_sla_sum_mean": -51.899333333333324, "reward_sla_sum_min": -86.79999999999998, "reward_sla_sum_max": -23.799999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4831.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [763.5356148527226, 702.400618355723, 706.7037284108568, 661.0052940997294, 744.3263303786293, 709.420545858845, 672.1466751957119, 697.8863931280279, 690.587130281155, 710.4791860854739, 720.9415059855622, 691.3542477687415, 699.856709007281, 717.7695025739446, 773.4532577903693, 728.6645618203428, 724.3235066557019, 729.0152791739024, 702.7320296079691, 733.6708641749682, 748.4569283255669, 727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25237192338556697, "mean_inference_ms": 2.0929682076067193, "mean_action_processing_ms": 0.09349717389120528, "mean_env_wait_ms": 1.8377598058344027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058498382568359375, "StateBufferConnector_ms": 0.0035429000854492188, "ViewRequirementAgentConnector_ms": 0.09166932106018066}, "num_episodes": 21, "episode_return_max": 837.1103902037842, "episode_return_min": 661.0052940997294, "episode_return_mean": 751.2846990770365, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143550, "num_agent_steps_trained": 143000, "num_env_steps_sampled": 143550, "num_env_steps_trained": 143000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.45718783519607, "num_env_steps_trained_throughput_per_sec": 215.24086344639588, "timesteps_total": 143550, "num_env_steps_sampled_lifetime": 143550, "num_agent_steps_sampled_lifetime": 143550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 143550, "timers": {"training_iteration_time_ms": 10248.3, "restore_workers_time_ms": 0.014, "training_step_time_ms": 665.867, "sample_time_ms": 648.585, "synch_weights_time_ms": 15.926}, "counters": {"num_env_steps_sampled": 143550, "num_env_steps_trained": 143000, "num_agent_steps_sampled": 143550, "num_agent_steps_trained": 143000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 957, "num_samples_added_to_queue": 143550}, "done": false, "training_iteration": 62, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-01", "timestamp": 1728775441, "time_this_iter_s": 10.236497163772583, "time_total_s": 639.6476776599884, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d6b0a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 639.6476776599884, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.971428571428568, "ram_util_percent": 57.82142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 735939.9375, "policy_loss": 710988.5, "entropy": 16.22028350830078, "entropy_coeff": 0.01, "var_gnorm": 16.386991500854492, "vf_loss": 2504064.75, "vf_explained_var": 0.0007423758506774902}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 264.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 145650, "num_env_steps_trained": 145200, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 971, "num_samples_added_to_queue": 145200, "learner_queue": {"size_count": 264, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 117.898, "learner_load_time_ms": 0.332, "learner_load_wait_time_ms": 2519.072, "learner_dequeue_time_ms": 19904.79}}, "env_runners": {"episode_reward_max": 855.1246489384396, "episode_reward_min": 683.0355630692382, "episode_reward_mean": 768.9572609887608, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 683.0355630692382}, "policy_reward_max": {"default_policy": 855.1246489384396}, "policy_reward_mean": {"default_policy": 768.9572609887608}, "custom_metrics": {"num_consolidated_mean": 2.0582, "num_consolidated_min": 1.86, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.041399999999999985, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 6.3602, "num_moves_min": 5.52, "num_moves_max": 7.18, "mean_accuracy_mean": 41.467586666666676, "mean_accuracy_min": 41.20766666666666, "mean_accuracy_max": 41.625666666666675, "num_model_switches_mean": 2.6973000000000003, "num_model_switches_min": 2.23, "num_model_switches_max": 3.4, "num_slav_mean": 0.012665333333333332, "num_slav_min": 0.004416666666666667, "num_slav_max": 0.0225, "cpu_conserved_cost_mean": 4.9108, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.66, "mean_cluster_cpu_util_mean": 0.47294183043493093, "mean_cluster_cpu_util_min": 0.4628688638688916, "mean_cluster_cpu_util_max": 0.4838356526685033, "mean_cluster_mem_util_mean": 0.3108021226337582, "mean_cluster_mem_util_min": 0.30424301142397886, "mean_cluster_mem_util_max": 0.3156848555139355, "reward_consolidation_mean_mean": 2.980099276554266, "reward_consolidation_mean_min": 2.7467080934539583, "reward_consolidation_mean_max": 3.2446545737000814, "reward_illegal_mean_mean": -0.06899999999999999, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.2520000000000095, "reward_accuracy_mean_min": 4.783333333333342, "reward_accuracy_mean_max": 5.691666666666678, "reward_sla_mean_mean": -0.47352666666666665, "reward_sla_mean_min": -0.8679999999999999, "reward_sla_mean_max": -0.17400000000000002, "reward_consolidation_sum_mean": 298.00992765542657, "reward_consolidation_sum_min": 274.6708093453958, "reward_consolidation_sum_max": 324.46545737000815, "reward_illegal_sum_mean": -6.899999999999999, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 525.2000000000008, "reward_accuracy_sum_min": 478.33333333333417, "reward_accuracy_sum_max": 569.1666666666678, "reward_sla_sum_mean": -47.352666666666664, "reward_sla_sum_min": -86.79999999999998, "reward_sla_sum_max": -17.400000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3889.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [727.695120168145, 684.5554479271382, 757.4173992506629, 731.7809528161088, 769.4179079472428, 761.1322976636513, 713.2768954278231, 713.4644978525093, 770.739605227087, 721.4448353589823, 709.6374760120634, 730.7663651040249, 743.9936062627563, 759.142471595237, 747.9848974991628, 744.9020774315402, 732.7155685521958, 747.1235188400512, 728.1899235432097, 792.8483779585135, 683.0355630692382, 769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524910502869521, "mean_inference_ms": 2.0931216732175564, "mean_action_processing_ms": 0.09354221871662811, "mean_env_wait_ms": 1.8390439269872374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005902290344238281, "StateBufferConnector_ms": 0.003564119338989258, "ViewRequirementAgentConnector_ms": 0.09273195266723633}, "num_episodes": 21, "episode_return_max": 855.1246489384396, "episode_return_min": 683.0355630692382, "episode_return_mean": 768.9572609887608, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145200, "num_env_steps_sampled": 145650, "num_env_steps_trained": 145200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.8126741661124, "num_env_steps_trained_throughput_per_sec": 209.32756341211774, "timesteps_total": 145650, "num_env_steps_sampled_lifetime": 145650, "num_agent_steps_sampled_lifetime": 145650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 145650, "timers": {"training_iteration_time_ms": 10290.985, "restore_workers_time_ms": 0.016, "training_step_time_ms": 764.859, "sample_time_ms": 748.063, "synch_weights_time_ms": 15.341}, "counters": {"num_env_steps_sampled": 145650, "num_env_steps_trained": 145200, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 971, "num_samples_added_to_queue": 145200}, "done": false, "training_iteration": 63, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-11", "timestamp": 1728775451, "time_this_iter_s": 10.520503282546997, "time_total_s": 650.1681809425354, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5630>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.1681809425354, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.581250000000004, "ram_util_percent": 57.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 768371.1875, "policy_loss": 741464.875, "entropy": 16.066434860229492, "entropy_coeff": 0.01, "var_gnorm": 16.393138885498047, "vf_loss": 2699467.75, "vf_explained_var": 0.0023035407066345215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 147750, "num_env_steps_trained": 147400, "num_agent_steps_sampled": 147750, "num_agent_steps_trained": 147400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 985, "num_samples_added_to_queue": 147400, "learner_queue": {"size_count": 268, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.477, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2600.949, "learner_dequeue_time_ms": 20030.566}}, "env_runners": {"episode_reward_max": 855.1246489384396, "episode_reward_min": 689.8169758445285, "episode_reward_mean": 782.5807363611451, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 689.8169758445285}, "policy_reward_max": {"default_policy": 855.1246489384396}, "policy_reward_mean": {"default_policy": 782.5807363611451}, "custom_metrics": {"num_consolidated_mean": 2.0845999999999996, "num_consolidated_min": 1.86, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.03729999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 6.169599999999999, "num_moves_min": 5.5, "num_moves_max": 6.94, "mean_accuracy_mean": 41.48202666666667, "mean_accuracy_min": 41.25833333333333, "mean_accuracy_max": 41.64466666666667, "num_model_switches_mean": 2.6087000000000007, "num_model_switches_min": 2.11, "num_model_switches_max": 3.38, "num_slav_mean": 0.011237166666666664, "num_slav_min": 0.0040999999999999995, "num_slav_max": 0.0218, "cpu_conserved_cost_mean": 4.973800000000001, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.66, "mean_cluster_cpu_util_mean": 0.4729356330393521, "mean_cluster_cpu_util_min": 0.46346053802857784, "mean_cluster_cpu_util_max": 0.48260016138124484, "mean_cluster_mem_util_mean": 0.31049418313707333, "mean_cluster_mem_util_min": 0.3015439902121186, "mean_cluster_mem_util_max": 0.3161578676196216, "reward_consolidation_mean_mean": 3.0131973636114413, "reward_consolidation_mean_min": 2.750393402174906, "reward_consolidation_mean_max": 3.2446545737000814, "reward_illegal_mean_mean": -0.06216666666666665, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.291916666666676, "reward_accuracy_mean_min": 4.783333333333342, "reward_accuracy_mean_max": 5.691666666666678, "reward_sla_mean_mean": -0.41714, "reward_sla_mean_min": -0.834, "reward_sla_mean_max": -0.16399999999999998, "reward_consolidation_sum_mean": 301.3197363611441, "reward_consolidation_sum_min": 275.03934021749063, "reward_consolidation_sum_max": 324.46545737000815, "reward_illegal_sum_mean": -6.216666666666665, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 529.1916666666676, "reward_accuracy_sum_min": 478.33333333333417, "reward_accuracy_sum_max": 569.1666666666678, "reward_sla_sum_mean": -41.714000000000006, "reward_sla_sum_min": -83.39999999999999, "reward_sla_sum_max": -16.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2953.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [769.4240762740267, 761.088586310885, 760.5836120503222, 741.126802522161, 775.3161747235687, 733.6528800755437, 692.4352675987702, 743.1396174114362, 760.2018124219447, 718.3393402174917, 756.5954917907957, 741.5675134789369, 717.7097444332765, 727.5830668006951, 776.9237716652968, 751.6965670596127, 763.079530293339, 727.3335252368344, 795.4482317463227, 772.7721587620712, 829.1246915836614, 760.2907277102572, 784.7764385147285, 772.6450820920535, 723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25270965675555374, "mean_inference_ms": 2.0953196481880725, "mean_action_processing_ms": 0.09362779492406735, "mean_env_wait_ms": 1.8411416768116913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006001949310302734, "StateBufferConnector_ms": 0.0035898685455322266, "ViewRequirementAgentConnector_ms": 0.09369397163391113}, "num_episodes": 21, "episode_return_max": 855.1246489384396, "episode_return_min": 689.8169758445285, "episode_return_mean": 782.5807363611451, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147750, "num_agent_steps_trained": 147400, "num_env_steps_sampled": 147750, "num_env_steps_trained": 147400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.61031739715082, "num_env_steps_trained_throughput_per_sec": 209.11557060653897, "timesteps_total": 147750, "num_env_steps_sampled_lifetime": 147750, "num_agent_steps_sampled_lifetime": 147750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 147750, "timers": {"training_iteration_time_ms": 10280.285, "restore_workers_time_ms": 0.014, "training_step_time_ms": 733.087, "sample_time_ms": 716.263, "synch_weights_time_ms": 15.15}, "counters": {"num_env_steps_sampled": 147750, "num_env_steps_trained": 147400, "num_agent_steps_sampled": 147750, "num_agent_steps_trained": 147400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 985, "num_samples_added_to_queue": 147400}, "done": false, "training_iteration": 64, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-22", "timestamp": 1728775462, "time_this_iter_s": 10.554954767227173, "time_total_s": 660.7231357097626, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d698d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 660.7231357097626, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 24.973333333333336, "ram_util_percent": 58.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 766663.8125, "policy_loss": 739621.8125, "entropy": 15.866338729858398, "entropy_coeff": 0.01, "var_gnorm": 16.39837646484375, "vf_loss": 2712922.25, "vf_explained_var": 0.0041939616203308105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 272.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 149600, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 149600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1000, "num_samples_added_to_queue": 149600, "learner_queue": {"size_count": 272, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.656, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2595.837, "learner_dequeue_time_ms": 20030.566}}, "env_runners": {"episode_reward_max": 855.1246489384396, "episode_reward_min": 689.8169758445285, "episode_reward_mean": 790.7269649395362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 689.8169758445285}, "policy_reward_max": {"default_policy": 855.1246489384396}, "policy_reward_mean": {"default_policy": 790.7269649395362}, "custom_metrics": {"num_consolidated_mean": 2.1081, "num_consolidated_min": 1.93, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.03679999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 5.9956, "num_moves_min": 5.29, "num_moves_max": 6.56, "mean_accuracy_mean": 41.497416666666666, "mean_accuracy_min": 41.36600000000001, "mean_accuracy_max": 41.64466666666667, "num_model_switches_mean": 2.5317, "num_model_switches_min": 2.11, "num_model_switches_max": 2.95, "num_slav_mean": 0.010201, "num_slav_min": 0.0040999999999999995, "num_slav_max": 0.01833333333333333, "cpu_conserved_cost_mean": 5.028600000000001, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.66, "mean_cluster_cpu_util_mean": 0.47303082935247687, "mean_cluster_cpu_util_min": 0.46346053802857784, "mean_cluster_cpu_util_max": 0.48260016138124484, "mean_cluster_mem_util_mean": 0.3102613586892563, "mean_cluster_mem_util_min": 0.3015439902121186, "mean_cluster_mem_util_max": 0.3161578676196216, "reward_consolidation_mean_mean": 3.034372982728685, "reward_consolidation_mean_min": 2.7581697584452773, "reward_consolidation_mean_max": 3.2446545737000814, "reward_illegal_mean_mean": -0.06133333333333332, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.315083333333344, "reward_accuracy_mean_min": 4.783333333333342, "reward_accuracy_mean_max": 5.691666666666678, "reward_sla_mean_mean": -0.3808533333333333, "reward_sla_mean_min": -0.7306666666666666, "reward_sla_mean_max": -0.16399999999999998, "reward_consolidation_sum_mean": 303.4372982728685, "reward_consolidation_sum_min": 275.81697584452775, "reward_consolidation_sum_max": 324.46545737000815, "reward_illegal_sum_mean": -6.133333333333331, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 531.5083333333342, "reward_accuracy_sum_min": 478.33333333333417, "reward_accuracy_sum_max": 569.1666666666678, "reward_sla_sum_mean": -38.08533333333333, "reward_sla_sum_min": -73.06666666666666, "reward_sla_sum_max": -16.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2113.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [723.8011757896987, 783.0019586341353, 775.224807334979, 797.2025465289848, 805.6353315666039, 767.4309604313272, 816.8294526181129, 733.2414328794671, 750.5431904718396, 769.708455938348, 774.7804380273551, 783.85905754059, 792.2871790185517, 818.8937951201696, 751.6595662371692, 803.4038593926115, 837.1103902037842, 818.9170184897513, 804.9849736513456, 814.3037009960713, 737.5762405190542, 689.8169758445285, 757.2932590088036, 784.1980383197795, 789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25299389295419167, "mean_inference_ms": 2.098192588888416, "mean_action_processing_ms": 0.09373020253244854, "mean_env_wait_ms": 1.843711943874369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917549133300781, "StateBufferConnector_ms": 0.003552675247192383, "ViewRequirementAgentConnector_ms": 0.09255170822143555}, "num_episodes": 24, "episode_return_max": 855.1246489384396, "episode_return_min": 689.8169758445285, "episode_return_mean": 790.7269649395362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 149600, "num_env_steps_sampled": 150000, "num_env_steps_trained": 149600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 218.43505962255844, "num_env_steps_trained_throughput_per_sec": 213.58094718650156, "timesteps_total": 150000, "num_env_steps_sampled_lifetime": 150000, "num_agent_steps_sampled_lifetime": 150000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 10301.833, "restore_workers_time_ms": 0.013, "training_step_time_ms": 699.936, "sample_time_ms": 683.499, "synch_weights_time_ms": 15.031}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 149600, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 149600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1000, "num_samples_added_to_queue": 149600}, "done": false, "training_iteration": 65, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-32", "timestamp": 1728775472, "time_this_iter_s": 10.31485366821289, "time_total_s": 671.0379893779755, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611945b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 671.0379893779755, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.521428571428572, "ram_util_percent": 58.59285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 740199.9375, "policy_loss": 713136.875, "entropy": 15.685175895690918, "entropy_coeff": 0.01, "var_gnorm": 16.401777267456055, "vf_loss": 2714932.5, "vf_explained_var": 0.005698025226593018}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 276.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 152400, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1016, "num_samples_added_to_queue": 152350, "learner_queue": {"size_count": 276, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.711, "learner_load_time_ms": 0.374, "learner_load_wait_time_ms": 2432.564, "learner_dequeue_time_ms": 20204.391}}, "env_runners": {"episode_reward_max": 855.1246489384396, "episode_reward_min": 729.6420664656257, "episode_reward_mean": 795.1941392061907, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 729.6420664656257}, "policy_reward_max": {"default_policy": 855.1246489384396}, "policy_reward_mean": {"default_policy": 795.1941392061907}, "custom_metrics": {"num_consolidated_mean": 2.119, "num_consolidated_min": 1.94, "num_consolidated_max": 2.27, "num_overloaded_mean": 0.03519999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 5.8526, "num_moves_min": 5.23, "num_moves_max": 6.44, "mean_accuracy_mean": 41.49754333333334, "mean_accuracy_min": 41.36600000000001, "mean_accuracy_max": 41.64466666666667, "num_model_switches_mean": 2.4861999999999997, "num_model_switches_min": 2.11, "num_model_switches_max": 2.92, "num_slav_mean": 0.009522666666666665, "num_slav_min": 0.0034333333333333334, "num_slav_max": 0.0165, "cpu_conserved_cost_mean": 5.0484, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.5, "mean_cluster_cpu_util_mean": 0.4726124442842044, "mean_cluster_cpu_util_min": 0.46346053802857784, "mean_cluster_cpu_util_max": 0.48242257578637116, "mean_cluster_mem_util_mean": 0.30992161435639654, "mean_cluster_mem_util_min": 0.3015439902121186, "mean_cluster_mem_util_max": 0.3165606558024054, "reward_consolidation_mean_mean": 3.04673472539523, "reward_consolidation_mean_min": 2.845420664656249, "reward_consolidation_mean_max": 3.2446545737000814, "reward_illegal_mean_mean": -0.05866666666666665, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.3226666666666755, "reward_accuracy_mean_min": 5.050000000000008, "reward_accuracy_mean_max": 5.5833333333333455, "reward_sla_mean_mean": -0.35879333333333335, "reward_sla_mean_min": -0.626, "reward_sla_mean_max": -0.10466666666666669, "reward_consolidation_sum_mean": 304.67347253952295, "reward_consolidation_sum_min": 284.5420664656249, "reward_consolidation_sum_max": 324.46545737000815, "reward_illegal_sum_mean": -5.866666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 532.2666666666677, "reward_accuracy_sum_min": 505.0000000000008, "reward_accuracy_sum_max": 558.3333333333345, "reward_sla_sum_mean": -35.879333333333335, "reward_sla_sum_min": -62.6, "reward_sla_sum_max": -10.466666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2371.0, "global_timestep_min": 400, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [789.0837125712034, 785.4548691705513, 764.5914679094712, 792.6916780894951, 729.6420664656257, 806.0547229583608, 770.8561850802653, 768.8714216089443, 790.8925279478519, 805.7780255262124, 789.9048219561979, 800.0963355569779, 764.0545280087742, 855.1246489384396, 798.5880075542972, 791.9545280087735, 815.4285113771376, 801.7569009107813, 816.4674556032784, 780.8770599165384, 791.5253251698202, 802.6909653050669, 772.6596332510896, 844.5654573700094, 810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25324300500171737, "mean_inference_ms": 2.101686842191251, "mean_action_processing_ms": 0.0938235465987309, "mean_env_wait_ms": 1.8460291111584421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006167411804199219, "StateBufferConnector_ms": 0.003458261489868164, "ViewRequirementAgentConnector_ms": 0.08985662460327148}, "num_episodes": 24, "episode_return_max": 855.1246489384396, "episode_return_min": 729.6420664656257, "episode_return_mean": 795.1941392061907, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 151800, "num_env_steps_sampled": 152400, "num_env_steps_trained": 151800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 228.30676184565073, "num_env_steps_trained_throughput_per_sec": 209.28119835851317, "timesteps_total": 152400, "num_env_steps_sampled_lifetime": 152400, "num_agent_steps_sampled_lifetime": 152400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 152400, "timers": {"training_iteration_time_ms": 10344.128, "restore_workers_time_ms": 0.016, "training_step_time_ms": 651.085, "sample_time_ms": 634.75, "synch_weights_time_ms": 15.074}, "counters": {"num_env_steps_sampled": 152400, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 152400, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1016, "num_samples_added_to_queue": 152350}, "done": false, "training_iteration": 66, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-43", "timestamp": 1728775483, "time_this_iter_s": 10.521822929382324, "time_total_s": 681.5598123073578, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611964a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.5598123073578, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 58.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 720292.8125, "policy_loss": 692864.6875, "entropy": 15.239239692687988, "entropy_coeff": 0.01, "var_gnorm": 16.40931510925293, "vf_loss": 2751195.25, "vf_explained_var": 0.007830262184143066}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 154800, "num_env_steps_trained": 154550, "num_agent_steps_sampled": 154800, "num_agent_steps_trained": 154550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1032, "num_samples_added_to_queue": 154550, "learner_queue": {"size_count": 281, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.844, "learner_load_time_ms": 0.4, "learner_load_wait_time_ms": 2387.228, "learner_dequeue_time_ms": 20241.56}}, "env_runners": {"episode_reward_max": 842.584105516465, "episode_reward_min": 717.3898199762413, "episode_reward_mean": 796.8379737427285, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 717.3898199762413}, "policy_reward_max": {"default_policy": 842.584105516465}, "policy_reward_mean": {"default_policy": 796.8379737427285}, "custom_metrics": {"num_consolidated_mean": 2.1327000000000003, "num_consolidated_min": 1.94, "num_consolidated_max": 2.32, "num_overloaded_mean": 0.0372, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.7494, "num_moves_min": 5.23, "num_moves_max": 6.2, "mean_accuracy_mean": 41.50793000000001, "mean_accuracy_min": 41.347, "mean_accuracy_max": 41.66366666666668, "num_model_switches_mean": 2.432, "num_model_switches_min": 2.11, "num_model_switches_max": 2.81, "num_slav_mean": 0.009046833333333334, "num_slav_min": 0.0034333333333333334, "num_slav_max": 0.014433333333333333, "cpu_conserved_cost_mean": 5.084999999999999, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.58, "mean_cluster_cpu_util_mean": 0.47281764759685724, "mean_cluster_cpu_util_min": 0.46346053802857784, "mean_cluster_cpu_util_max": 0.48196817381745455, "mean_cluster_mem_util_mean": 0.3098713896818221, "mean_cluster_mem_util_min": 0.3015439902121186, "mean_cluster_mem_util_max": 0.316766414614369, "reward_consolidation_mean_mean": 3.049513070760608, "reward_consolidation_mean_min": 2.829564866429072, "reward_consolidation_mean_max": 3.2418410551646413, "reward_illegal_mean_mean": -0.06199999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.3241666666666765, "reward_accuracy_mean_min": 4.841666666666675, "reward_accuracy_mean_max": 5.625000000000011, "reward_sla_mean_mean": -0.34330000000000005, "reward_sla_mean_min": -0.5466666666666667, "reward_sla_mean_max": -0.10466666666666669, "reward_consolidation_sum_mean": 304.95130707606074, "reward_consolidation_sum_min": 282.9564866429072, "reward_consolidation_sum_max": 324.1841055164641, "reward_illegal_sum_mean": -6.199999999999999, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 532.4166666666677, "reward_accuracy_sum_min": 484.1666666666675, "reward_accuracy_sum_max": 562.500000000001, "reward_sla_sum_mean": -34.330000000000005, "reward_sla_sum_min": -54.66666666666667, "reward_sla_sum_max": -10.466666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3167.0, "global_timestep_min": 1100, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [810.8582686039792, 795.1553474062576, 769.4150354869175, 824.0108836699272, 752.7590453562409, 787.3468975600853, 830.7464436930774, 823.0619635078752, 813.0815407109579, 806.0302689695095, 809.862627554907, 796.853763440861, 811.0693746382781, 793.9710134332457, 834.356678546408, 822.5734563952609, 791.130000913827, 810.5381766121432, 777.5894788144636, 813.4198513509405, 809.6909043833205, 784.6118157726413, 796.0072588260391, 810.5237990800827, 761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25339899208778216, "mean_inference_ms": 2.1041498143452593, "mean_action_processing_ms": 0.09387713909878834, "mean_env_wait_ms": 1.8475703558203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061550140380859375, "StateBufferConnector_ms": 0.0034055709838867188, "ViewRequirementAgentConnector_ms": 0.08793950080871582}, "num_episodes": 24, "episode_return_max": 842.584105516465, "episode_return_min": 717.3898199762413, "episode_return_mean": 796.8379737427285, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154800, "num_agent_steps_trained": 154550, "num_env_steps_sampled": 154800, "num_env_steps_trained": 154550, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 230.62095074852903, "num_env_steps_trained_throughput_per_sec": 264.2531727326895, "timesteps_total": 154800, "num_env_steps_sampled_lifetime": 154800, "num_agent_steps_sampled_lifetime": 154800, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 154800, "timers": {"training_iteration_time_ms": 10364.722, "restore_workers_time_ms": 0.016, "training_step_time_ms": 654.705, "sample_time_ms": 639.584, "synch_weights_time_ms": 13.669}, "counters": {"num_env_steps_sampled": 154800, "num_env_steps_trained": 154550, "num_agent_steps_sampled": 154800, "num_agent_steps_trained": 154550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1032, "num_samples_added_to_queue": 154550}, "done": false, "training_iteration": 67, "trial_id": "90ffb_00000", "date": "2024-10-13_00-24-53", "timestamp": 1728775493, "time_this_iter_s": 10.419641256332397, "time_total_s": 691.9794535636902, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d695d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 691.9794535636902, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.166666666666668, "ram_util_percent": 58.72666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 675117.6875, "policy_loss": 649102.4375, "entropy": 14.768447875976562, "entropy_coeff": 0.01, "var_gnorm": 16.41678237915039, "vf_loss": 2609651.5, "vf_explained_var": 0.01002037525177002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 285.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 157200, "num_env_steps_trained": 156750, "num_agent_steps_sampled": 157200, "num_agent_steps_trained": 156750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1048, "num_samples_added_to_queue": 156750, "learner_queue": {"size_count": 285, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.174, "learner_load_time_ms": 0.4, "learner_load_wait_time_ms": 2287.088, "learner_dequeue_time_ms": 20241.56}}, "env_runners": {"episode_reward_max": 850.0383502391188, "episode_reward_min": 717.3898199762413, "episode_reward_mean": 800.099211550764, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 717.3898199762413}, "policy_reward_max": {"default_policy": 850.0383502391188}, "policy_reward_mean": {"default_policy": 800.099211550764}, "custom_metrics": {"num_consolidated_mean": 2.153, "num_consolidated_min": 1.99, "num_consolidated_max": 2.32, "num_overloaded_mean": 0.038299999999999994, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.6270999999999995, "num_moves_min": 5.06, "num_moves_max": 6.12, "mean_accuracy_mean": 41.52522000000001, "mean_accuracy_min": 41.347, "mean_accuracy_max": 41.67633333333335, "num_model_switches_mean": 2.3744, "num_model_switches_min": 2.05, "num_model_switches_max": 2.7, "num_slav_mean": 0.008877666666666667, "num_slav_min": 0.0034333333333333334, "num_slav_max": 0.014533333333333334, "cpu_conserved_cost_mean": 5.1402, "cpu_conserved_cost_min": 4.58, "cpu_conserved_cost_max": 5.68, "mean_cluster_cpu_util_mean": 0.4731338780802652, "mean_cluster_cpu_util_min": 0.4649830349164592, "mean_cluster_cpu_util_max": 0.4827346291345274, "mean_cluster_mem_util_mean": 0.3099564284799363, "mean_cluster_mem_util_min": 0.30407202327133387, "mean_cluster_mem_util_max": 0.31698465566606393, "reward_consolidation_mean_mean": 3.062768782174297, "reward_consolidation_mean_min": 2.829564866429072, "reward_consolidation_mean_max": 3.256436687075452, "reward_illegal_mean_mean": -0.06383333333333333, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.3392500000000105, "reward_accuracy_mean_min": 4.841666666666675, "reward_accuracy_mean_max": 5.6666666666666785, "reward_sla_mean_mean": -0.3371933333333333, "reward_sla_mean_min": -0.5506666666666667, "reward_sla_mean_max": -0.10466666666666669, "reward_consolidation_sum_mean": 306.27687821742967, "reward_consolidation_sum_min": 282.9564866429072, "reward_consolidation_sum_max": 325.6436687075452, "reward_illegal_sum_mean": -6.383333333333334, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 533.925000000001, "reward_accuracy_sum_min": 484.1666666666675, "reward_accuracy_sum_max": 566.6666666666679, "reward_sla_sum_mean": -33.71933333333333, "reward_sla_sum_min": -55.06666666666667, "reward_sla_sum_max": -10.466666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3978.0, "global_timestep_min": 2100, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [761.6423984891418, 788.713229157149, 800.4929026165898, 778.3918395321215, 766.7710682628174, 804.1472783209977, 814.359995735479, 780.2242407627415, 766.7035517377938, 811.5398154071105, 787.9746535075707, 778.0941423741216, 787.4200188857423, 792.8163605348939, 778.6294252033274, 781.8900971701856, 785.237951201682, 770.2766486947523, 794.0805994699814, 779.7622315635572, 787.0036004751908, 775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534053019036533, "mean_inference_ms": 2.1051358262905677, "mean_action_processing_ms": 0.09388569475794913, "mean_env_wait_ms": 1.8479864995494928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00603175163269043, "StateBufferConnector_ms": 0.0033333301544189453, "ViewRequirementAgentConnector_ms": 0.0859975814819336}, "num_episodes": 24, "episode_return_max": 850.0383502391188, "episode_return_min": 717.3898199762413, "episode_return_mean": 800.099211550764, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157200, "num_agent_steps_trained": 156750, "num_env_steps_sampled": 157200, "num_env_steps_trained": 156750, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 226.29593625056995, "num_env_steps_trained_throughput_per_sec": 207.43794156302246, "timesteps_total": 157200, "num_env_steps_sampled_lifetime": 157200, "num_agent_steps_sampled_lifetime": 157200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 157200, "timers": {"training_iteration_time_ms": 10425.242, "restore_workers_time_ms": 0.014, "training_step_time_ms": 661.591, "sample_time_ms": 647.18, "synch_weights_time_ms": 13.08}, "counters": {"num_env_steps_sampled": 157200, "num_env_steps_trained": 156750, "num_agent_steps_sampled": 157200, "num_agent_steps_trained": 156750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1048, "num_samples_added_to_queue": 156750}, "done": false, "training_iteration": 68, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-04", "timestamp": 1728775504, "time_this_iter_s": 10.617196798324585, "time_total_s": 702.5966503620148, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d68eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.5966503620148, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.75625, "ram_util_percent": 58.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 640686.0, "policy_loss": 614514.5, "entropy": 14.063072204589844, "entropy_coeff": 0.01, "var_gnorm": 16.426761627197266, "vf_loss": 2624886.0, "vf_explained_var": 0.011834204196929932}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 289.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 159450, "num_env_steps_trained": 158950, "num_agent_steps_sampled": 159450, "num_agent_steps_trained": 158950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1063, "num_samples_added_to_queue": 158950, "learner_queue": {"size_count": 289, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.365, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2432.306, "learner_dequeue_time_ms": 20222.51}}, "env_runners": {"episode_reward_max": 866.5348624691595, "episode_reward_min": 717.3898199762413, "episode_reward_mean": 806.1372546224385, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 717.3898199762413}, "policy_reward_max": {"default_policy": 866.5348624691595}, "policy_reward_mean": {"default_policy": 806.1372546224385}, "custom_metrics": {"num_consolidated_mean": 2.1739, "num_consolidated_min": 1.99, "num_consolidated_max": 2.32, "num_overloaded_mean": 0.0394, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.490600000000001, "num_moves_min": 4.76, "num_moves_max": 6.07, "mean_accuracy_mean": 41.55815333333335, "mean_accuracy_min": 41.347, "mean_accuracy_max": 41.777666666666676, "num_model_switches_mean": 2.2825999999999995, "num_model_switches_min": 1.81, "num_model_switches_max": 2.7, "num_slav_mean": 0.0083825, "num_slav_min": 0.0034333333333333334, "num_slav_max": 0.014533333333333334, "cpu_conserved_cost_mean": 5.1966, "cpu_conserved_cost_min": 4.58, "cpu_conserved_cost_max": 5.78, "mean_cluster_cpu_util_mean": 0.47335856150444366, "mean_cluster_cpu_util_min": 0.46375246972248496, "mean_cluster_cpu_util_max": 0.48606056788455476, "mean_cluster_mem_util_mean": 0.30999968419013174, "mean_cluster_mem_util_min": 0.30325036704555236, "mean_cluster_mem_util_max": 0.3178282512055455, "reward_consolidation_mean_mean": 3.0749258795577084, "reward_consolidation_mean_min": 2.829564866429072, "reward_consolidation_mean_max": 3.2836819580249164, "reward_illegal_mean_mean": -0.06566666666666666, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.372833333333344, "reward_accuracy_mean_min": 4.841666666666675, "reward_accuracy_mean_max": 5.675000000000012, "reward_sla_mean_mean": -0.32071999999999995, "reward_sla_mean_min": -0.5506666666666667, "reward_sla_mean_max": -0.10466666666666669, "reward_consolidation_sum_mean": 307.4925879557708, "reward_consolidation_sum_min": 282.9564866429072, "reward_consolidation_sum_max": 328.36819580249164, "reward_illegal_sum_mean": -6.566666666666666, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 537.2833333333343, "reward_accuracy_sum_min": 484.1666666666675, "reward_accuracy_sum_max": 567.5000000000013, "reward_sla_sum_mean": -32.071999999999996, "reward_sla_sum_min": -55.06666666666667, "reward_sla_sum_max": -10.466666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4667.0, "global_timestep_min": 2600, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [775.9363702823734, 803.6736939900713, 770.6711809680476, 794.3894574918526, 828.9679490694214, 802.2933290688118, 804.613908434617, 753.9288555850019, 762.6202503883773, 806.0732431691505, 832.0797831185856, 802.0405708367612, 841.3473361966566, 762.3289743824065, 794.8705108288417, 800.9242316244793, 817.9715769593967, 818.3748179962848, 762.4423375673949, 774.0143105181398, 805.7159158061479, 815.8260196777245, 782.4735203630944, 842.584105516465, 776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533976819728363, "mean_inference_ms": 2.10360773283247, "mean_action_processing_ms": 0.09386148306408323, "mean_env_wait_ms": 1.8478092731025277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006127834320068359, "StateBufferConnector_ms": 0.0033919811248779297, "ViewRequirementAgentConnector_ms": 0.08788204193115234}, "num_episodes": 21, "episode_return_max": 866.5348624691595, "episode_return_min": 717.3898199762413, "episode_return_mean": 806.1372546224385, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159450, "num_agent_steps_trained": 158950, "num_env_steps_sampled": 159450, "num_env_steps_trained": 158950, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.0665906923843, "num_env_steps_trained_throughput_per_sec": 208.33177756588685, "timesteps_total": 159450, "num_env_steps_sampled_lifetime": 159450, "num_agent_steps_sampled_lifetime": 159450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 159450, "timers": {"training_iteration_time_ms": 10464.42, "restore_workers_time_ms": 0.014, "training_step_time_ms": 684.14, "sample_time_ms": 667.393, "synch_weights_time_ms": 15.086}, "counters": {"num_env_steps_sampled": 159450, "num_env_steps_trained": 158950, "num_agent_steps_sampled": 159450, "num_agent_steps_trained": 158950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1063, "num_samples_added_to_queue": 158950}, "done": false, "training_iteration": 69, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-14", "timestamp": 1728775514, "time_this_iter_s": 10.585569143295288, "time_total_s": 713.1822195053101, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760d69360>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.1822195053101, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.55333333333333, "ram_util_percent": 58.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 655054.125, "policy_loss": 625427.5625, "entropy": 13.371091842651367, "entropy_coeff": 0.01, "var_gnorm": 16.436338424682617, "vf_loss": 2970012.75, "vf_explained_var": 0.013333678245544434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 161700, "num_env_steps_trained": 161150, "num_agent_steps_sampled": 161700, "num_agent_steps_trained": 161150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1078, "num_samples_added_to_queue": 161700, "learner_queue": {"size_count": 293, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.403, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2413.383, "learner_dequeue_time_ms": 20222.51}}, "env_runners": {"episode_reward_max": 875.084364433886, "episode_reward_min": 717.3898199762413, "episode_reward_mean": 814.3910410917188, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 717.3898199762413}, "policy_reward_max": {"default_policy": 875.084364433886}, "policy_reward_mean": {"default_policy": 814.3910410917188}, "custom_metrics": {"num_consolidated_mean": 2.2127, "num_consolidated_min": 2.0, "num_consolidated_max": 2.38, "num_overloaded_mean": 0.041499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.2999, "num_moves_min": 4.36, "num_moves_max": 5.98, "mean_accuracy_mean": 41.60261333333334, "mean_accuracy_min": 41.347, "mean_accuracy_max": 41.80933333333334, "num_model_switches_mean": 2.1590000000000003, "num_model_switches_min": 1.63, "num_model_switches_max": 2.59, "num_slav_mean": 0.007804500000000001, "num_slav_min": 0.001716666666666667, "num_slav_max": 0.014533333333333334, "cpu_conserved_cost_mean": 5.307199999999999, "cpu_conserved_cost_min": 4.58, "cpu_conserved_cost_max": 5.88, "mean_cluster_cpu_util_mean": 0.4743978652140033, "mean_cluster_cpu_util_min": 0.46375246972248496, "mean_cluster_cpu_util_max": 0.48606056788455476, "mean_cluster_mem_util_mean": 0.31036316143904824, "mean_cluster_mem_util_min": 0.30325036704555236, "mean_cluster_mem_util_max": 0.3178282512055455, "reward_consolidation_mean_mean": 3.09827374425051, "reward_consolidation_mean_min": 2.829564866429072, "reward_consolidation_mean_max": 3.306843644338847, "reward_illegal_mean_mean": -0.06916666666666664, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.4145833333333435, "reward_accuracy_mean_min": 4.841666666666675, "reward_accuracy_mean_max": 5.783333333333348, "reward_sla_mean_mean": -0.29978, "reward_sla_mean_min": -0.5506666666666667, "reward_sla_mean_max": -0.06866666666666667, "reward_consolidation_sum_mean": 309.827374425051, "reward_consolidation_sum_min": 282.9564866429072, "reward_consolidation_sum_max": 330.6843644338847, "reward_illegal_sum_mean": -6.916666666666668, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 541.4583333333346, "reward_accuracy_sum_min": 484.1666666666675, "reward_accuracy_sum_max": 578.3333333333348, "reward_sla_sum_mean": -29.977999999999998, "reward_sla_sum_min": -55.06666666666667, "reward_sla_sum_max": -6.866666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5467.0, "global_timestep_min": 3400, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [776.432047884494, 818.1484388802593, 769.5896981327497, 754.4313625148504, 839.704416826587, 807.7309848000252, 796.767921654636, 779.7798927777282, 717.3898199762413, 793.9563983063764, 824.7736147918007, 796.6501477352351, 821.7637485150337, 805.4757104998635, 819.7635291967481, 771.5827804684894, 807.5486003228864, 824.1324347375806, 819.9219165981306, 823.2027780316199, 839.9464193243789, 816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25339982338990896, "mean_inference_ms": 2.1035325103785016, "mean_action_processing_ms": 0.09385805491922711, "mean_env_wait_ms": 1.8480302501780494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005888938903808594, "StateBufferConnector_ms": 0.0034356117248535156, "ViewRequirementAgentConnector_ms": 0.08854532241821289}, "num_episodes": 24, "episode_return_max": 875.084364433886, "episode_return_min": 717.3898199762413, "episode_return_mean": 814.3910410917188, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161700, "num_agent_steps_trained": 161150, "num_env_steps_sampled": 161700, "num_env_steps_trained": 161150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 218.12594245119132, "num_env_steps_trained_throughput_per_sec": 213.2786992856093, "timesteps_total": 161700, "num_env_steps_sampled_lifetime": 161700, "num_agent_steps_sampled_lifetime": 161700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 161700, "timers": {"training_iteration_time_ms": 10486.235, "restore_workers_time_ms": 0.014, "training_step_time_ms": 662.776, "sample_time_ms": 646.036, "synch_weights_time_ms": 15.242}, "counters": {"num_env_steps_sampled": 161700, "num_env_steps_trained": 161150, "num_agent_steps_sampled": 161700, "num_agent_steps_trained": 161150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1078, "num_samples_added_to_queue": 161700}, "done": false, "training_iteration": 70, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-25", "timestamp": 1728775525, "time_this_iter_s": 10.327109336853027, "time_total_s": 723.5093288421631, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6b00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.5093288421631, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 58.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 615392.6875, "policy_loss": 588323.3125, "entropy": 13.004685401916504, "entropy_coeff": 0.01, "var_gnorm": 16.442550659179688, "vf_loss": 2714086.75, "vf_explained_var": 0.0164983868598938}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 297.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 163950, "num_env_steps_trained": 163350, "num_agent_steps_sampled": 163950, "num_agent_steps_trained": 163350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1093, "num_samples_added_to_queue": 163900, "learner_queue": {"size_count": 297, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.828, "learner_load_time_ms": 0.407, "learner_load_wait_time_ms": 2464.437, "learner_dequeue_time_ms": 20270.819}}, "env_runners": {"episode_reward_max": 882.4286484510653, "episode_reward_min": 745.6047244814049, "episode_reward_mean": 821.9025055286496, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 745.6047244814049}, "policy_reward_max": {"default_policy": 882.4286484510653}, "policy_reward_mean": {"default_policy": 821.9025055286496}, "custom_metrics": {"num_consolidated_mean": 2.2472, "num_consolidated_min": 2.03, "num_consolidated_max": 2.46, "num_overloaded_mean": 0.0425, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 5.119000000000001, "num_moves_min": 4.36, "num_moves_max": 5.91, "mean_accuracy_mean": 41.63428000000001, "mean_accuracy_min": 41.347, "mean_accuracy_max": 41.80933333333334, "num_model_switches_mean": 2.0740000000000003, "num_model_switches_min": 1.63, "num_model_switches_max": 2.59, "num_slav_mean": 0.007321833333333334, "num_slav_min": 0.00125, "num_slav_max": 0.014533333333333334, "cpu_conserved_cost_mean": 5.4112, "cpu_conserved_cost_min": 4.7, "cpu_conserved_cost_max": 6.14, "mean_cluster_cpu_util_mean": 0.4754522445466477, "mean_cluster_cpu_util_min": 0.46375246972248496, "mean_cluster_cpu_util_max": 0.4886298750026197, "mean_cluster_mem_util_mean": 0.31089224888056494, "mean_cluster_mem_util_min": 0.30325036704555236, "mean_cluster_mem_util_max": 0.3178282512055455, "reward_consolidation_mean_mean": 3.122948388619817, "reward_consolidation_mean_min": 2.833467208870206, "reward_consolidation_mean_max": 3.3539883944073834, "reward_illegal_mean_mean": -0.07083333333333332, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.445416666666679, "reward_accuracy_mean_min": 5.108333333333343, "reward_accuracy_mean_max": 5.783333333333348, "reward_sla_mean_mean": -0.2785066666666667, "reward_sla_mean_min": -0.5506666666666667, "reward_sla_mean_max": -0.05, "reward_consolidation_sum_mean": 312.29483886198176, "reward_consolidation_sum_min": 283.34672088702064, "reward_consolidation_sum_max": 335.39883944073836, "reward_illegal_sum_mean": -7.083333333333334, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 544.5416666666679, "reward_accuracy_sum_min": 510.83333333333434, "reward_accuracy_sum_max": 578.3333333333348, "reward_sla_sum_mean": -27.850666666666665, "reward_sla_sum_min": -55.06666666666667, "reward_sla_sum_max": -5.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6166.0, "global_timestep_min": 4100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [816.0029242438097, 807.1537207956392, 768.8482622071958, 796.2291388711207, 782.6640653081123, 770.7330165402556, 792.5355265161904, 804.363696731549, 803.5322245575569, 806.043942855403, 808.7023028420004, 790.6165889914417, 818.3889457491862, 798.3729355143331, 847.0436687075461, 768.769283255659, 846.9254439672251, 850.0383502391188, 780.3326662402154, 800.4226628895193, 844.433976057755, 849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25338175929669193, "mean_inference_ms": 2.1024047559086174, "mean_action_processing_ms": 0.09384841834432475, "mean_env_wait_ms": 1.847988149774593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00579524040222168, "StateBufferConnector_ms": 0.0034787654876708984, "ViewRequirementAgentConnector_ms": 0.08977317810058594}, "num_episodes": 21, "episode_return_max": 882.4286484510653, "episode_return_min": 745.6047244814049, "episode_return_mean": 821.9025055286496, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163950, "num_agent_steps_trained": 163350, "num_env_steps_sampled": 163950, "num_env_steps_trained": 163350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 218.18408306360638, "num_env_steps_trained_throughput_per_sec": 213.33554788441515, "timesteps_total": 163950, "num_env_steps_sampled_lifetime": 163950, "num_agent_steps_sampled_lifetime": 163950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 163950, "timers": {"training_iteration_time_ms": 10426.416, "restore_workers_time_ms": 0.014, "training_step_time_ms": 682.069, "sample_time_ms": 665.857, "synch_weights_time_ms": 14.806}, "counters": {"num_env_steps_sampled": 163950, "num_env_steps_trained": 163350, "num_agent_steps_sampled": 163950, "num_agent_steps_trained": 163350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1093, "num_samples_added_to_queue": 163900}, "done": false, "training_iteration": 71, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-35", "timestamp": 1728775535, "time_this_iter_s": 10.325640678405762, "time_total_s": 733.8349695205688, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef09de0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 733.8349695205688, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.026666666666667, "ram_util_percent": 57.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 634333.5, "policy_loss": 602578.0625, "entropy": 12.460959434509277, "entropy_coeff": 0.01, "var_gnorm": 16.446086883544922, "vf_loss": 3182397.75, "vf_explained_var": 0.01732027530670166}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 301.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 165900, "num_env_steps_trained": 165550, "num_agent_steps_sampled": 165900, "num_agent_steps_trained": 165550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1106, "num_samples_added_to_queue": 165550, "learner_queue": {"size_count": 301, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.621, "learner_load_time_ms": 0.407, "learner_load_wait_time_ms": 2473.007, "learner_dequeue_time_ms": 20270.819}}, "env_runners": {"episode_reward_max": 883.9595540528206, "episode_reward_min": 745.6047244814049, "episode_reward_mean": 832.1689928112352, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 745.6047244814049}, "policy_reward_max": {"default_policy": 883.9595540528206}, "policy_reward_mean": {"default_policy": 832.1689928112352}, "custom_metrics": {"num_consolidated_mean": 2.2901, "num_consolidated_min": 2.03, "num_consolidated_max": 2.51, "num_overloaded_mean": 0.0435, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 4.8980999999999995, "num_moves_min": 4.09, "num_moves_max": 5.71, "mean_accuracy_mean": 41.66708666666668, "mean_accuracy_min": 41.467333333333336, "mean_accuracy_max": 41.923333333333346, "num_model_switches_mean": 1.9606000000000001, "num_model_switches_min": 1.32, "num_model_switches_max": 2.37, "num_slav_mean": 0.0063616666666666665, "num_slav_min": 0.00125, "num_slav_max": 0.012549999999999999, "cpu_conserved_cost_mean": 5.5358, "cpu_conserved_cost_min": 4.7, "cpu_conserved_cost_max": 6.32, "mean_cluster_cpu_util_mean": 0.47670781776633947, "mean_cluster_cpu_util_min": 0.46375246972248496, "mean_cluster_cpu_util_max": 0.4886298750026197, "mean_cluster_mem_util_mean": 0.31137431229369383, "mean_cluster_mem_util_min": 0.30325036704555236, "mean_cluster_mem_util_max": 0.3184024875139929, "reward_consolidation_mean_mean": 3.1547399281123387, "reward_consolidation_mean_min": 2.833467208870206, "reward_consolidation_mean_max": 3.383271040848031, "reward_illegal_mean_mean": -0.07249999999999998, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.48041666666668, "reward_accuracy_mean_min": 5.108333333333343, "reward_accuracy_mean_max": 5.783333333333348, "reward_sla_mean_mean": -0.24096666666666666, "reward_sla_mean_min": -0.502, "reward_sla_mean_max": -0.05, "reward_consolidation_sum_mean": 315.4739928112339, "reward_consolidation_sum_min": 283.34672088702064, "reward_consolidation_sum_max": 338.32710408480307, "reward_illegal_sum_mean": -7.25, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 548.0416666666679, "reward_accuracy_sum_min": 510.83333333333434, "reward_accuracy_sum_max": 578.3333333333348, "reward_sla_sum_mean": -24.09666666666667, "reward_sla_sum_min": -50.2, "reward_sla_sum_max": -5.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5229.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [849.8110908038637, 839.2601632702804, 811.3053093301666, 816.942340613483, 839.8080843156977, 835.1263760699393, 801.7586889640269, 809.5041152639444, 775.1544640409405, 778.8420573273638, 816.638749276555, 831.7415943220946, 840.8478174784502, 817.2289530597957, 866.5348624691595, 840.5463584026331, 790.1662980901043, 811.7503152700368, 809.6079502878569, 832.9610070364632, 821.7047488501029, 804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534549289080184, "mean_inference_ms": 2.1023772236442926, "mean_action_processing_ms": 0.09387661645215958, "mean_env_wait_ms": 1.8486796036734985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006021261215209961, "StateBufferConnector_ms": 0.003643035888671875, "ViewRequirementAgentConnector_ms": 0.09501814842224121}, "num_episodes": 21, "episode_return_max": 883.9595540528206, "episode_return_min": 745.6047244814049, "episode_return_mean": 832.1689928112352, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165900, "num_agent_steps_trained": 165550, "num_env_steps_sampled": 165900, "num_env_steps_trained": 165550, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 188.81366305800606, "num_env_steps_trained_throughput_per_sec": 213.0205429372376, "timesteps_total": 165900, "num_env_steps_sampled_lifetime": 165900, "num_agent_steps_sampled_lifetime": 165900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 165900, "timers": {"training_iteration_time_ms": 10437.069, "restore_workers_time_ms": 0.015, "training_step_time_ms": 802.974, "sample_time_ms": 785.404, "synch_weights_time_ms": 16.009}, "counters": {"num_env_steps_sampled": 165900, "num_env_steps_trained": 165550, "num_agent_steps_sampled": 165900, "num_agent_steps_trained": 165550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1106, "num_samples_added_to_queue": 165550}, "done": false, "training_iteration": 72, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-46", "timestamp": 1728775546, "time_this_iter_s": 10.353960514068604, "time_total_s": 744.1889300346375, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d576139b250>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.1889300346375, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.186666666666667, "ram_util_percent": 58.42666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 590783.875, "policy_loss": 560696.0625, "entropy": 12.189164161682129, "entropy_coeff": 0.01, "var_gnorm": 16.451129913330078, "vf_loss": 3015490.5, "vf_explained_var": 0.01968759298324585}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 305.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 167750, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 167750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1120, "num_samples_added_to_queue": 167750, "learner_queue": {"size_count": 305, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.688, "learner_load_time_ms": 0.45, "learner_load_wait_time_ms": 2678.645, "learner_dequeue_time_ms": 20623.239}}, "env_runners": {"episode_reward_max": 898.7809619543706, "episode_reward_min": 745.6047244814049, "episode_reward_mean": 839.1845786956667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 745.6047244814049}, "policy_reward_max": {"default_policy": 898.7809619543706}, "policy_reward_mean": {"default_policy": 839.1845786956667}, "custom_metrics": {"num_consolidated_mean": 2.3356, "num_consolidated_min": 2.03, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.04610000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 4.6972000000000005, "num_moves_min": 3.9, "num_moves_max": 5.47, "mean_accuracy_mean": 41.69033000000001, "mean_accuracy_min": 41.537000000000006, "mean_accuracy_max": 41.923333333333346, "num_model_switches_mean": 1.8703, "num_model_switches_min": 1.32, "num_model_switches_max": 2.29, "num_slav_mean": 0.005538333333333334, "num_slav_min": 0.00125, "num_slav_max": 0.012549999999999999, "cpu_conserved_cost_mean": 5.672600000000001, "cpu_conserved_cost_min": 4.7, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.4784608365021334, "mean_cluster_cpu_util_min": 0.46375246972248496, "mean_cluster_cpu_util_max": 0.49245484106224763, "mean_cluster_mem_util_mean": 0.312087514046758, "mean_cluster_mem_util_min": 0.30325036704555236, "mean_cluster_mem_util_max": 0.3193931192413675, "reward_consolidation_mean_mean": 3.183802453623321, "reward_consolidation_mean_min": 2.833467208870206, "reward_consolidation_mean_max": 3.383271040848031, "reward_illegal_mean_mean": -0.07683333333333332, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.494416666666679, "reward_accuracy_mean_min": 5.108333333333343, "reward_accuracy_mean_max": 5.7916666666666785, "reward_sla_mean_mean": -0.20953999999999998, "reward_sla_mean_min": -0.502, "reward_sla_mean_max": -0.05, "reward_consolidation_sum_mean": 318.3802453623321, "reward_consolidation_sum_min": 283.34672088702064, "reward_consolidation_sum_max": 338.32710408480307, "reward_illegal_sum_mean": -7.683333333333332, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 549.4416666666679, "reward_accuracy_sum_min": 510.83333333333434, "reward_accuracy_sum_max": 579.1666666666679, "reward_sla_sum_mean": -20.953999999999997, "reward_sla_sum_min": -50.2, "reward_sla_sum_max": -5.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4293.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [804.0219836120515, 845.3254896585349, 822.5917847025507, 822.6366809832783, 785.8093057967054, 829.588376130861, 803.9602729294234, 785.8861463949571, 777.146720887022, 836.472259282952, 745.6047244814049, 815.2021931828576, 835.2299247616451, 860.5521246458935, 767.002933382072, 862.1748515032452, 815.4818666422989, 838.6952846568593, 821.6087879618641, 823.7085747357531, 868.5354808248815, 855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253629310881837, "mean_inference_ms": 2.104433106847497, "mean_action_processing_ms": 0.0939459196882349, "mean_env_wait_ms": 1.8502558328152703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006106138229370117, "StateBufferConnector_ms": 0.0037088394165039062, "ViewRequirementAgentConnector_ms": 0.09653878211975098}, "num_episodes": 21, "episode_return_max": 898.7809619543706, "episode_return_min": 745.6047244814049, "episode_return_mean": 839.1845786956667, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 167750, "num_env_steps_sampled": 168000, "num_env_steps_trained": 167750, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.55185307827782, "num_env_steps_trained_throughput_per_sec": 209.05432227248153, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 10438.443, "restore_workers_time_ms": 0.017, "training_step_time_ms": 739.691, "sample_time_ms": 720.62, "synch_weights_time_ms": 17.377}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 167750, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 167750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1120, "num_samples_added_to_queue": 167750}, "done": false, "training_iteration": 73, "trial_id": "90ffb_00000", "date": "2024-10-13_00-25-56", "timestamp": 1728775556, "time_this_iter_s": 10.536487817764282, "time_total_s": 754.7254178524017, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e36b00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 754.7254178524017, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.826666666666668, "ram_util_percent": 61.09333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 526475.5, "policy_loss": 500842.5625, "entropy": 11.784594535827637, "entropy_coeff": 0.01, "var_gnorm": 16.45625114440918, "vf_loss": 2569775.5, "vf_explained_var": 0.02427583932876587}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 309.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 170100, "num_env_steps_trained": 169950, "num_agent_steps_sampled": 170100, "num_agent_steps_trained": 169950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1134, "num_samples_added_to_queue": 169950, "learner_queue": {"size_count": 309, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.69, "learner_load_time_ms": 0.45, "learner_load_wait_time_ms": 2667.666, "learner_dequeue_time_ms": 20623.239}}, "env_runners": {"episode_reward_max": 898.7809619543706, "episode_reward_min": 765.6561180663447, "episode_reward_mean": 843.3522192573652, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 765.6561180663447}, "policy_reward_max": {"default_policy": 898.7809619543706}, "policy_reward_mean": {"default_policy": 843.3522192573652}, "custom_metrics": {"num_consolidated_mean": 2.3764000000000003, "num_consolidated_min": 2.19, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.0486, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.5392, "num_moves_min": 3.9, "num_moves_max": 5.25, "mean_accuracy_mean": 41.70274333333334, "mean_accuracy_min": 41.575, "mean_accuracy_max": 41.923333333333346, "num_model_switches_mean": 1.7980999999999998, "num_model_switches_min": 1.32, "num_model_switches_max": 2.17, "num_slav_mean": 0.0049795, "num_slav_min": 0.00125, "num_slav_max": 0.012549999999999999, "cpu_conserved_cost_mean": 5.796, "cpu_conserved_cost_min": 5.1, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.47995553706561916, "mean_cluster_cpu_util_min": 0.4684372172806597, "mean_cluster_cpu_util_max": 0.49245484106224763, "mean_cluster_mem_util_mean": 0.3126926569469559, "mean_cluster_mem_util_min": 0.30557776898734174, "mean_cluster_mem_util_max": 0.3193931192413675, "reward_consolidation_mean_mean": 3.2076488592403054, "reward_consolidation_mean_min": 2.9301848974991622, "reward_consolidation_mean_max": 3.383271040848031, "reward_illegal_mean_mean": -0.081, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.494166666666679, "reward_accuracy_mean_min": 5.1250000000000115, "reward_accuracy_mean_max": 5.7916666666666785, "reward_sla_mean_mean": -0.18729333333333328, "reward_sla_mean_min": -0.502, "reward_sla_mean_max": -0.05, "reward_consolidation_sum_mean": 320.7648859240306, "reward_consolidation_sum_min": 293.0184897499162, "reward_consolidation_sum_max": 338.32710408480307, "reward_illegal_sum_mean": -8.1, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 549.416666666668, "reward_accuracy_sum_min": 512.5000000000011, "reward_accuracy_sum_max": 579.1666666666679, "reward_sla_sum_mean": -18.72933333333333, "reward_sla_sum_min": -50.2, "reward_sla_sum_max": -5.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3348.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [855.2487038898547, 819.6583295257253, 815.9801151421011, 875.084364433886, 819.7110603429909, 835.9327363002236, 839.0288586310893, 821.3762587955781, 796.9851564165841, 833.835039142223, 802.2570745377573, 839.6865972158771, 851.6828200676243, 854.1498583569419, 836.0278564683675, 827.1361631484373, 842.7914922781702, 789.1007066922548, 845.5511773127429, 881.1321727740732, 846.5658229004855, 789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25383385745069553, "mean_inference_ms": 2.105506984608103, "mean_action_processing_ms": 0.09401282829424602, "mean_env_wait_ms": 1.8517844617240262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006109476089477539, "StateBufferConnector_ms": 0.003695964813232422, "ViewRequirementAgentConnector_ms": 0.09646987915039062}, "num_episodes": 21, "episode_return_max": 898.7809619543706, "episode_return_min": 765.6561180663447, "episode_return_mean": 843.3522192573652, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170100, "num_agent_steps_trained": 169950, "num_env_steps_sampled": 170100, "num_env_steps_trained": 169950, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.59693280986096, "num_env_steps_trained_throughput_per_sec": 213.29202484842577, "timesteps_total": 170100, "num_env_steps_sampled_lifetime": 170100, "num_agent_steps_sampled_lifetime": 170100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 170100, "timers": {"training_iteration_time_ms": 10417.843, "restore_workers_time_ms": 0.015, "training_step_time_ms": 750.715, "sample_time_ms": 733.534, "synch_weights_time_ms": 15.781}, "counters": {"num_env_steps_sampled": 170100, "num_env_steps_trained": 169950, "num_agent_steps_sampled": 170100, "num_agent_steps_trained": 169950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1134, "num_samples_added_to_queue": 169950}, "done": false, "training_iteration": 74, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-07", "timestamp": 1728775567, "time_this_iter_s": 10.326900005340576, "time_total_s": 765.0523178577423, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef08df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 765.0523178577423, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 20.013333333333332, "ram_util_percent": 61.12666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 579238.0, "policy_loss": 549339.9375, "entropy": 12.141475677490234, "entropy_coeff": 0.01, "var_gnorm": 16.459762573242188, "vf_loss": 2996483.5, "vf_explained_var": 0.022307157516479492}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 172350, "num_env_steps_trained": 172150, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1149, "num_samples_added_to_queue": 172150, "learner_queue": {"size_count": 313, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.847, "learner_load_time_ms": 0.446, "learner_load_wait_time_ms": 2554.732, "learner_dequeue_time_ms": 20666.248}}, "env_runners": {"episode_reward_max": 898.7809619543706, "episode_reward_min": 765.6561180663447, "episode_reward_mean": 847.6507926223775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 765.6561180663447}, "policy_reward_max": {"default_policy": 898.7809619543706}, "policy_reward_mean": {"default_policy": 847.6507926223775}, "custom_metrics": {"num_consolidated_mean": 2.3981999999999997, "num_consolidated_min": 2.2, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.04829999999999999, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.433299999999999, "num_moves_min": 3.9, "num_moves_max": 5.15, "mean_accuracy_mean": 41.70717666666668, "mean_accuracy_min": 41.606666666666676, "mean_accuracy_max": 41.923333333333346, "num_model_switches_mean": 1.7423000000000002, "num_model_switches_min": 1.32, "num_model_switches_max": 2.11, "num_slav_mean": 0.004552833333333333, "num_slav_min": 0.00125, "num_slav_max": 0.009566666666666666, "cpu_conserved_cost_mean": 5.8674, "cpu_conserved_cost_min": 5.24, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.4811792880874921, "mean_cluster_cpu_util_min": 0.4706933269644155, "mean_cluster_cpu_util_max": 0.49245484106224763, "mean_cluster_mem_util_mean": 0.31317683071414215, "mean_cluster_mem_util_min": 0.30642821084129857, "mean_cluster_mem_util_max": 0.3193931192413675, "reward_consolidation_mean_mean": 3.2265679262237654, "reward_consolidation_mean_min": 2.9468945139967713, "reward_consolidation_mean_max": 3.383271040848031, "reward_illegal_mean_mean": -0.08049999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.5016666666666785, "reward_accuracy_mean_min": 5.1250000000000115, "reward_accuracy_mean_max": 5.7916666666666785, "reward_sla_mean_mean": -0.1712266666666666, "reward_sla_mean_min": -0.38266666666666665, "reward_sla_mean_max": -0.05, "reward_consolidation_sum_mean": 322.65679262237654, "reward_consolidation_sum_min": 294.6894513996771, "reward_consolidation_sum_max": 338.32710408480307, "reward_illegal_sum_mean": -8.05, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 550.166666666668, "reward_accuracy_sum_min": 512.5000000000011, "reward_accuracy_sum_max": 579.1666666666679, "reward_sla_sum_mean": -17.122666666666664, "reward_sla_sum_min": -38.266666666666666, "reward_sla_sum_max": -5.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2423.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [789.3429437387686, 828.031012214811, 831.9369642693974, 876.1193152395762, 810.5536781504169, 882.4286484510653, 845.3634499984784, 819.870209266199, 847.4643059490099, 842.9830668006956, 765.6561180663447, 863.3923573669631, 834.8610801425582, 812.6873495994407, 831.9890340857183, 872.0182003716236, 836.6985013250492, 883.9595540528206, 874.2267416004152, 865.2849127296001, 883.1479362758547, 869.1056108928096, 818.1460994852124, 821.5957750769147, 859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2541531578203422, "mean_inference_ms": 2.111034684931538, "mean_action_processing_ms": 0.09413520465734809, "mean_env_wait_ms": 1.8546195497882325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061664581298828125, "StateBufferConnector_ms": 0.003726959228515625, "ViewRequirementAgentConnector_ms": 0.09741425514221191}, "num_episodes": 21, "episode_return_max": 898.7809619543706, "episode_return_min": 765.6561180663447, "episode_return_mean": 847.6507926223775, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172150, "num_env_steps_sampled": 172350, "num_env_steps_trained": 172150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 222.0051484806035, "num_env_steps_trained_throughput_per_sec": 217.07170073659012, "timesteps_total": 172350, "num_env_steps_sampled_lifetime": 172350, "num_agent_steps_sampled_lifetime": 172350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 172350, "timers": {"training_iteration_time_ms": 10401.279, "restore_workers_time_ms": 0.014, "training_step_time_ms": 676.563, "sample_time_ms": 659.035, "synch_weights_time_ms": 15.807}, "counters": {"num_env_steps_sampled": 172350, "num_env_steps_trained": 172150, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1149, "num_samples_added_to_queue": 172150}, "done": false, "training_iteration": 75, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-17", "timestamp": 1728775577, "time_this_iter_s": 10.150128841400146, "time_total_s": 775.2024466991425, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0baf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.2024466991425, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.05, "ram_util_percent": 60.9357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 579496.8125, "policy_loss": 550515.4375, "entropy": 11.931716918945312, "entropy_coeff": 0.01, "var_gnorm": 16.46442985534668, "vf_loss": 2904702.0, "vf_explained_var": 0.02623957395553589}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 317.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 174600, "num_env_steps_trained": 174350, "num_agent_steps_sampled": 174600, "num_agent_steps_trained": 174350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1164, "num_samples_added_to_queue": 174350, "learner_queue": {"size_count": 317, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.015, "learner_load_time_ms": 0.446, "learner_load_wait_time_ms": 2501.755, "learner_dequeue_time_ms": 20666.248}}, "env_runners": {"episode_reward_max": 898.7809619543706, "episode_reward_min": 790.9025587133342, "episode_reward_mean": 849.9763177069068, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 790.9025587133342}, "policy_reward_max": {"default_policy": 898.7809619543706}, "policy_reward_mean": {"default_policy": 849.9763177069068}, "custom_metrics": {"num_consolidated_mean": 2.4149000000000003, "num_consolidated_min": 2.24, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.049800000000000004, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.3654, "num_moves_min": 3.9, "num_moves_max": 5.13, "mean_accuracy_mean": 41.719463333333344, "mean_accuracy_min": 41.606666666666676, "mean_accuracy_max": 41.923333333333346, "num_model_switches_mean": 1.6846, "num_model_switches_min": 1.29, "num_model_switches_max": 2.04, "num_slav_mean": 0.004298333333333334, "num_slav_min": 0.0014000000000000002, "num_slav_max": 0.008166666666666666, "cpu_conserved_cost_mean": 5.9224, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.48219765406740867, "mean_cluster_cpu_util_min": 0.47162554497502673, "mean_cluster_cpu_util_max": 0.49245484106224763, "mean_cluster_mem_util_mean": 0.31356918576523435, "mean_cluster_mem_util_min": 0.30642821084129857, "mean_cluster_mem_util_max": 0.3193931192413675, "reward_consolidation_mean_mean": 3.235969843735721, "reward_consolidation_mean_min": 3.038358920466661, "reward_consolidation_mean_max": 3.4145682171251024, "reward_illegal_mean_mean": -0.083, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.508666666666681, "reward_accuracy_mean_min": 5.233333333333345, "reward_accuracy_mean_max": 5.7916666666666785, "reward_sla_mean_mean": -0.16187333333333334, "reward_sla_mean_min": -0.32466666666666666, "reward_sla_mean_max": -0.05399999999999999, "reward_consolidation_sum_mean": 323.5969843735721, "reward_consolidation_sum_min": 303.83589204666606, "reward_consolidation_sum_max": 341.45682171251025, "reward_illegal_sum_mean": -8.3, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 550.8666666666679, "reward_accuracy_sum_min": 523.3333333333345, "reward_accuracy_sum_max": 579.1666666666679, "reward_sla_sum_mean": -16.18733333333333, "reward_sla_sum_min": -32.46666666666667, "reward_sla_sum_max": -5.3999999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1969.0, "global_timestep_min": 100, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [859.1077736147931, 871.052136830243, 861.4488379176964, 854.7089524505785, 850.586286514973, 868.5604374181378, 871.2964391239464, 846.1687136373337, 843.6269670108755, 848.9528221998862, 832.8607785799152, 839.4423071065228, 828.824487495813, 898.7809619543706, 825.471156599349, 839.7162935209734, 826.43451216912, 829.9493770751483, 845.1167382497196, 867.1492004020846, 856.7246154314797, 852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25438783748317695, "mean_inference_ms": 2.1117867165724804, "mean_action_processing_ms": 0.09420295684675944, "mean_env_wait_ms": 1.8561657164388712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005982160568237305, "StateBufferConnector_ms": 0.003638744354248047, "ViewRequirementAgentConnector_ms": 0.09426188468933105}, "num_episodes": 24, "episode_return_max": 898.7809619543706, "episode_return_min": 790.9025587133342, "episode_return_mean": 849.9763177069068, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174600, "num_agent_steps_trained": 174350, "num_env_steps_sampled": 174600, "num_env_steps_trained": 174350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 216.95986100126092, "num_env_steps_trained_throughput_per_sec": 212.13853075678847, "timesteps_total": 174600, "num_env_steps_sampled_lifetime": 174600, "num_agent_steps_sampled_lifetime": 174600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 174600, "timers": {"training_iteration_time_ms": 10387.12, "restore_workers_time_ms": 0.016, "training_step_time_ms": 709.937, "sample_time_ms": 693.183, "synch_weights_time_ms": 15.174}, "counters": {"num_env_steps_sampled": 174600, "num_env_steps_trained": 174350, "num_agent_steps_sampled": 174600, "num_agent_steps_trained": 174350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1164, "num_samples_added_to_queue": 174350}, "done": false, "training_iteration": 76, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-27", "timestamp": 1728775587, "time_this_iter_s": 10.382796049118042, "time_total_s": 785.5852427482605, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0abf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 785.5852427482605, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.673333333333332, "ram_util_percent": 60.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 543599.4375, "policy_loss": 516680.59375, "entropy": 11.7703218460083, "entropy_coeff": 0.01, "var_gnorm": 16.468660354614258, "vf_loss": 2698362.0, "vf_explained_var": 0.027677297592163086}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 321.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 176700, "num_env_steps_trained": 176550, "num_agent_steps_sampled": 176700, "num_agent_steps_trained": 176550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1178, "num_samples_added_to_queue": 176550, "learner_queue": {"size_count": 321, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.082, "learner_load_time_ms": 0.411, "learner_load_wait_time_ms": 2494.047, "learner_dequeue_time_ms": 20675.235}}, "env_runners": {"episode_reward_max": 906.0393859088007, "episode_reward_min": 790.9025587133342, "episode_reward_mean": 850.7608989003638, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 790.9025587133342}, "policy_reward_max": {"default_policy": 906.0393859088007}, "policy_reward_mean": {"default_policy": 850.7608989003638}, "custom_metrics": {"num_consolidated_mean": 2.4137, "num_consolidated_min": 2.24, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.0507, "num_overloaded_min": 0.02, "num_overloaded_max": 0.11, "num_moves_mean": 4.3423, "num_moves_min": 3.9, "num_moves_max": 4.82, "mean_accuracy_mean": 41.73016666666668, "mean_accuracy_min": 41.62566666666667, "mean_accuracy_max": 41.89800000000001, "num_model_switches_mean": 1.651, "num_model_switches_min": 1.28, "num_model_switches_max": 1.92, "num_slav_mean": 0.004121166666666667, "num_slav_min": 0.0006666666666666666, "num_slav_max": 0.008166666666666666, "cpu_conserved_cost_mean": 5.916999999999999, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.48211782897300326, "mean_cluster_cpu_util_min": 0.47162554497502673, "mean_cluster_cpu_util_max": 0.49245484106224763, "mean_cluster_mem_util_mean": 0.31349102591384653, "mean_cluster_mem_util_min": 0.30642821084129857, "mean_cluster_mem_util_max": 0.3193931192413675, "reward_consolidation_mean_mean": 3.2308923223369583, "reward_consolidation_mean_min": 3.038358920466661, "reward_consolidation_mean_max": 3.4145682171251024, "reward_illegal_mean_mean": -0.08449999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.517583333333345, "reward_accuracy_mean_min": 5.233333333333345, "reward_accuracy_mean_max": 5.88333333333335, "reward_sla_mean_mean": -0.15636666666666665, "reward_sla_mean_min": -0.32466666666666666, "reward_sla_mean_max": -0.02666666666666667, "reward_consolidation_sum_mean": 323.0892322336958, "reward_consolidation_sum_min": 303.83589204666606, "reward_consolidation_sum_max": 341.45682171251025, "reward_illegal_sum_mean": -8.45, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 551.7583333333346, "reward_accuracy_sum_min": 523.3333333333345, "reward_accuracy_sum_max": 588.333333333335, "reward_sla_sum_mean": -15.636666666666667, "reward_sla_sum_min": -32.46666666666667, "reward_sla_sum_max": -2.666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2669.0, "global_timestep_min": 800, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [852.7577964604475, 855.5108593012291, 866.2755612415866, 844.7619513235262, 888.9771391148086, 853.3091199853797, 864.6619817843991, 834.3270888543678, 869.092698528741, 821.8750769137054, 879.1393493557537, 853.2025800359447, 865.5658746839698, 813.1389015809207, 863.1294648024626, 839.6565049194319, 838.9564165829006, 862.7152395747673, 853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2546018028395051, "mean_inference_ms": 2.1135511418622808, "mean_action_processing_ms": 0.09427049291748983, "mean_env_wait_ms": 1.8577145826029464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006030082702636719, "StateBufferConnector_ms": 0.003673076629638672, "ViewRequirementAgentConnector_ms": 0.09406661987304688}, "num_episodes": 21, "episode_return_max": 906.0393859088007, "episode_return_min": 790.9025587133342, "episode_return_mean": 850.7608989003638, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176700, "num_agent_steps_trained": 176550, "num_env_steps_sampled": 176700, "num_env_steps_trained": 176550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 195.20648281271812, "num_env_steps_trained_throughput_per_sec": 204.50202961332374, "timesteps_total": 176700, "num_env_steps_sampled_lifetime": 176700, "num_agent_steps_sampled_lifetime": 176700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 176700, "timers": {"training_iteration_time_ms": 10422.235, "restore_workers_time_ms": 0.014, "training_step_time_ms": 735.722, "sample_time_ms": 720.952, "synch_weights_time_ms": 13.234}, "counters": {"num_env_steps_sampled": 176700, "num_env_steps_trained": 176550, "num_agent_steps_sampled": 176700, "num_agent_steps_trained": 176550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1178, "num_samples_added_to_queue": 176550}, "done": false, "training_iteration": 77, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-38", "timestamp": 1728775598, "time_this_iter_s": 10.776434183120728, "time_total_s": 796.3616769313812, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef08a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.3616769313812, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.581249999999997, "ram_util_percent": 60.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 536668.4375, "policy_loss": 509167.21875, "entropy": 11.574346542358398, "entropy_coeff": 0.01, "var_gnorm": 16.472352981567383, "vf_loss": 2756485.25, "vf_explained_var": 0.029917359352111816}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 324.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 178500, "num_env_steps_trained": 178200, "num_agent_steps_sampled": 178500, "num_agent_steps_trained": 178200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1190, "num_samples_added_to_queue": 178200, "learner_queue": {"size_count": 324, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.793, "learner_load_time_ms": 0.411, "learner_load_wait_time_ms": 2650.672, "learner_dequeue_time_ms": 20675.235}}, "env_runners": {"episode_reward_max": 913.3398458679841, "episode_reward_min": 790.9025587133342, "episode_reward_mean": 852.5735996222865, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 790.9025587133342}, "policy_reward_max": {"default_policy": 913.3398458679841}, "policy_reward_mean": {"default_policy": 852.5735996222865}, "custom_metrics": {"num_consolidated_mean": 2.4115, "num_consolidated_min": 2.24, "num_consolidated_max": 2.54, "num_overloaded_mean": 0.05050000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.338, "num_moves_min": 3.9, "num_moves_max": 4.82, "mean_accuracy_mean": 41.74530333333335, "mean_accuracy_min": 41.62566666666667, "mean_accuracy_max": 41.89800000000001, "num_model_switches_mean": 1.6239, "num_model_switches_min": 1.28, "num_model_switches_max": 1.92, "num_slav_mean": 0.004201666666666667, "num_slav_min": 0.0006666666666666666, "num_slav_max": 0.008166666666666666, "cpu_conserved_cost_mean": 5.9068, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.32, "mean_cluster_cpu_util_mean": 0.48210973969389775, "mean_cluster_cpu_util_min": 0.47162554497502673, "mean_cluster_cpu_util_max": 0.4946132819711696, "mean_cluster_mem_util_mean": 0.3133610176113694, "mean_cluster_mem_util_min": 0.30642821084129857, "mean_cluster_mem_util_max": 0.31953071019547064, "reward_consolidation_mean_mean": 3.231072662889518, "reward_consolidation_mean_min": 3.038358920466661, "reward_consolidation_mean_max": 3.4230651253464917, "reward_illegal_mean_mean": -0.08416666666666667, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.538083333333346, "reward_accuracy_mean_min": 5.233333333333345, "reward_accuracy_mean_max": 5.958333333333346, "reward_sla_mean_mean": -0.15925333333333333, "reward_sla_mean_min": -0.32466666666666666, "reward_sla_mean_max": -0.02666666666666667, "reward_consolidation_sum_mean": 323.10726628895185, "reward_consolidation_sum_min": 303.83589204666606, "reward_consolidation_sum_max": 342.3065125346492, "reward_illegal_sum_mean": -8.416666666666666, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 553.8083333333346, "reward_accuracy_sum_min": 523.3333333333345, "reward_accuracy_sum_max": 595.8333333333346, "reward_sla_sum_mean": -15.925333333333334, "reward_sla_sum_min": -32.46666666666667, "reward_sla_sum_max": -2.666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3275.0, "global_timestep_min": 1500, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [853.6475189618943, 828.1281306162248, 811.3341070395091, 790.9025587133342, 799.0732979987222, 847.1999329860805, 835.0634621828269, 817.5943220932725, 861.3877455907899, 857.4323372627869, 859.7635962106688, 846.2147065094904, 808.4465929513556, 826.5837430320768, 853.5526181120366, 870.0786256054107, 854.3464193243794, 854.8567242377175, 859.4840110877592, 860.1454780834027, 846.6333973011677, 820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548861199824936, "mean_inference_ms": 2.11723763412078, "mean_action_processing_ms": 0.09436679143094892, "mean_env_wait_ms": 1.859974707155813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006136894226074219, "StateBufferConnector_ms": 0.003712892532348633, "ViewRequirementAgentConnector_ms": 0.09580802917480469}, "num_episodes": 18, "episode_return_max": 913.3398458679841, "episode_return_min": 790.9025587133342, "episode_return_mean": 852.5735996222865, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178500, "num_agent_steps_trained": 178200, "num_env_steps_sampled": 178500, "num_env_steps_trained": 178200, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 177.95235973319453, "num_env_steps_trained_throughput_per_sec": 163.12299642209499, "timesteps_total": 178500, "num_env_steps_sampled_lifetime": 178500, "num_agent_steps_sampled_lifetime": 178500, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 178500, "timers": {"training_iteration_time_ms": 10373.184, "restore_workers_time_ms": 0.015, "training_step_time_ms": 806.199, "sample_time_ms": 786.3, "synch_weights_time_ms": 18.159}, "counters": {"num_env_steps_sampled": 178500, "num_env_steps_trained": 178200, "num_agent_steps_sampled": 178500, "num_agent_steps_trained": 178200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1190, "num_samples_added_to_queue": 178200}, "done": false, "training_iteration": 78, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-48", "timestamp": 1728775608, "time_this_iter_s": 10.135979413986206, "time_total_s": 806.4976563453674, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef08ca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 806.4976563453674, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.885714285714283, "ram_util_percent": 60.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 570144.125, "policy_loss": 537828.9375, "entropy": 11.411405563354492, "entropy_coeff": 0.01, "var_gnorm": 16.476770401000977, "vf_loss": 3237794.25, "vf_explained_var": 0.030656278133392334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 328.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 180600, "num_env_steps_trained": 180400, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1204, "num_samples_added_to_queue": 180400, "learner_queue": {"size_count": 328, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.672, "learner_load_time_ms": 0.411, "learner_load_wait_time_ms": 2810.718, "learner_dequeue_time_ms": 20675.235}}, "env_runners": {"episode_reward_max": 914.3520606780605, "episode_reward_min": 804.7596789423999, "episode_reward_mean": 858.8217366352933, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 804.7596789423999}, "policy_reward_max": {"default_policy": 914.3520606780605}, "policy_reward_mean": {"default_policy": 858.8217366352933}, "custom_metrics": {"num_consolidated_mean": 2.4084999999999996, "num_consolidated_min": 2.24, "num_consolidated_max": 2.54, "num_overloaded_mean": 0.048499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.297999999999999, "num_moves_min": 3.85, "num_moves_max": 4.82, "mean_accuracy_mean": 41.767913333333354, "mean_accuracy_min": 41.62566666666667, "mean_accuracy_max": 41.94866666666669, "num_model_switches_mean": 1.5765, "num_model_switches_min": 1.09, "num_model_switches_max": 1.87, "num_slav_mean": 0.003911, "num_slav_min": 0.0005166666666666667, "num_slav_max": 0.008166666666666666, "cpu_conserved_cost_mean": 5.888799999999999, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.32, "mean_cluster_cpu_util_mean": 0.48179740057691783, "mean_cluster_cpu_util_min": 0.47162554497502673, "mean_cluster_cpu_util_max": 0.4946132819711696, "mean_cluster_mem_util_mean": 0.31305388535298095, "mean_cluster_mem_util_min": 0.30642821084129857, "mean_cluster_mem_util_max": 0.31953071019547064, "reward_consolidation_mean_mean": 3.2373540330195856, "reward_consolidation_mean_min": 3.0596691949191266, "reward_consolidation_mean_max": 3.4230651253464917, "reward_illegal_mean_mean": -0.08083333333333334, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.580750000000014, "reward_accuracy_mean_min": 5.250000000000012, "reward_accuracy_mean_max": 5.958333333333346, "reward_sla_mean_mean": -0.14905333333333332, "reward_sla_mean_min": -0.32466666666666666, "reward_sla_mean_max": -0.018000000000000002, "reward_consolidation_sum_mean": 323.7354033019586, "reward_consolidation_sum_min": 305.9669194919127, "reward_consolidation_sum_max": 342.3065125346492, "reward_illegal_sum_mean": -8.083333333333334, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 558.0750000000014, "reward_accuracy_sum_min": 525.0000000000013, "reward_accuracy_sum_max": 595.8333333333346, "reward_sla_sum_mean": -14.905333333333331, "reward_sla_sum_min": -32.46666666666667, "reward_sla_sum_max": -1.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3975.0, "global_timestep_min": 2200, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [820.6699137957303, 881.5433488683799, 873.2654573700096, 864.2363733284609, 810.9486277376726, 862.4736726674597, 858.9488074568226, 840.6530628407824, 856.0257394376938, 834.8872978159567, 861.469584818302, 881.5656766882948, 883.9286910962885, 851.6630052697326, 850.6161503548703, 850.4182612933698, 847.3725212464605, 853.5948246976772, 855.5504919431, 856.3354595022706, 837.4827591458782, 888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2551795025339878, "mean_inference_ms": 2.1197148758945734, "mean_action_processing_ms": 0.09445712487775043, "mean_env_wait_ms": 1.8620738897027689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006331205368041992, "StateBufferConnector_ms": 0.0037620067596435547, "ViewRequirementAgentConnector_ms": 0.09675025939941406}, "num_episodes": 21, "episode_return_max": 914.3520606780605, "episode_return_min": 804.7596789423999, "episode_return_mean": 858.8217366352933, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180400, "num_env_steps_sampled": 180600, "num_env_steps_trained": 180400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.7784043514934, "num_env_steps_trained_throughput_per_sec": 215.5773759872788, "timesteps_total": 180600, "num_env_steps_sampled_lifetime": 180600, "num_agent_steps_sampled_lifetime": 180600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 180600, "timers": {"training_iteration_time_ms": 10337.691, "restore_workers_time_ms": 0.014, "training_step_time_ms": 708.64, "sample_time_ms": 691.138, "synch_weights_time_ms": 15.993}, "counters": {"num_env_steps_sampled": 180600, "num_env_steps_trained": 180400, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1204, "num_samples_added_to_queue": 180400}, "done": false, "training_iteration": 79, "trial_id": "90ffb_00000", "date": "2024-10-13_00-26-58", "timestamp": 1728775618, "time_this_iter_s": 10.222914934158325, "time_total_s": 816.7205712795258, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e37a90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.7205712795258, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 20.313333333333333, "ram_util_percent": 60.34666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 562891.375, "policy_loss": 531966.625, "entropy": 11.316457748413086, "entropy_coeff": 0.01, "var_gnorm": 16.480144500732422, "vf_loss": 3098701.25, "vf_explained_var": 0.033682286739349365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 182700, "num_env_steps_trained": 182050, "num_agent_steps_sampled": 182700, "num_agent_steps_trained": 182050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1218, "num_samples_added_to_queue": 182600, "learner_queue": {"size_count": 331, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.388, "learner_load_time_ms": 0.427, "learner_load_wait_time_ms": 2696.888, "learner_dequeue_time_ms": 21064.859}}, "env_runners": {"episode_reward_max": 914.3520606780605, "episode_reward_min": 804.7596789423999, "episode_reward_mean": 862.2307268268922, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 804.7596789423999}, "policy_reward_max": {"default_policy": 914.3520606780605}, "policy_reward_mean": {"default_policy": 862.2307268268922}, "custom_metrics": {"num_consolidated_mean": 2.4145000000000003, "num_consolidated_min": 2.29, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.049499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.251900000000001, "num_moves_min": 3.81, "num_moves_max": 4.82, "mean_accuracy_mean": 41.788560000000004, "mean_accuracy_min": 41.62566666666667, "mean_accuracy_max": 41.96133333333334, "num_model_switches_mean": 1.5392, "num_model_switches_min": 1.04, "num_model_switches_max": 1.87, "num_slav_mean": 0.003623166666666667, "num_slav_min": 0.0005166666666666667, "num_slav_max": 0.008166666666666666, "cpu_conserved_cost_mean": 5.899999999999999, "cpu_conserved_cost_min": 5.5, "cpu_conserved_cost_max": 6.54, "mean_cluster_cpu_util_mean": 0.4816619663435112, "mean_cluster_cpu_util_min": 0.4723860854000611, "mean_cluster_cpu_util_max": 0.496449585222515, "mean_cluster_mem_util_mean": 0.3129520390959126, "mean_cluster_mem_util_min": 0.3070499321880651, "mean_cluster_mem_util_max": 0.3196911693791441, "reward_consolidation_mean_mean": 3.239617268268908, "reward_consolidation_mean_min": 3.0596691949191266, "reward_consolidation_mean_max": 3.4486301745408023, "reward_illegal_mean_mean": -0.08249999999999998, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.601250000000014, "reward_accuracy_mean_min": 5.250000000000012, "reward_accuracy_mean_max": 5.958333333333346, "reward_sla_mean_mean": -0.13606, "reward_sla_mean_min": -0.32466666666666666, "reward_sla_mean_max": -0.018000000000000002, "reward_consolidation_sum_mean": 323.96172682689087, "reward_consolidation_sum_min": 305.9669194919127, "reward_consolidation_sum_max": 344.86301745408025, "reward_illegal_sum_mean": -8.25, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 560.1250000000014, "reward_accuracy_sum_min": 525.0000000000013, "reward_accuracy_sum_max": 595.8333333333346, "reward_sla_sum_mean": -13.606000000000002, "reward_sla_sum_min": -32.46666666666667, "reward_sla_sum_max": -1.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4675.0, "global_timestep_min": 2900, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [888.0705595662381, 840.3652867891205, 883.1113344908479, 857.4373480763973, 843.6736878978965, 852.9399220201666, 843.2063297694124, 842.465369033478, 849.1881537664881, 826.1143287946645, 883.2234883791785, 832.911486795213, 841.9819702092673, 836.7609278381931, 852.9201407292347, 863.185841786227, 847.2678028572315, 842.5537238417262, 861.7016144262706, 906.0393859088007, 846.5343019890963, 809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2554884445169052, "mean_inference_ms": 2.1225739156406758, "mean_action_processing_ms": 0.09456088785459574, "mean_env_wait_ms": 1.8644428580043984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069310665130615234, "StateBufferConnector_ms": 0.0038368701934814453, "ViewRequirementAgentConnector_ms": 0.09911537170410156}, "num_episodes": 21, "episode_return_max": 914.3520606780605, "episode_return_min": 804.7596789423999, "episode_return_mean": 862.2307268268922, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182700, "num_agent_steps_trained": 182050, "num_env_steps_sampled": 182700, "num_env_steps_trained": 182050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 205.8925065809695, "num_env_steps_trained_throughput_per_sec": 161.77268374219034, "timesteps_total": 182700, "num_env_steps_sampled_lifetime": 182700, "num_agent_steps_sampled_lifetime": 182700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 182700, "timers": {"training_iteration_time_ms": 10326.127, "restore_workers_time_ms": 0.015, "training_step_time_ms": 727.841, "sample_time_ms": 711.999, "synch_weights_time_ms": 14.299}, "counters": {"num_env_steps_sampled": 182700, "num_env_steps_trained": 182050, "num_agent_steps_sampled": 182700, "num_agent_steps_trained": 182050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1218, "num_samples_added_to_queue": 182600}, "done": false, "training_iteration": 80, "trial_id": "90ffb_00000", "date": "2024-10-13_00-27-09", "timestamp": 1728775629, "time_this_iter_s": 10.223334550857544, "time_total_s": 826.9439058303833, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0a800>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.9439058303833, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.657142857142855, "ram_util_percent": 60.29285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 561091.0625, "policy_loss": 529727.0625, "entropy": 11.291632652282715, "entropy_coeff": 0.01, "var_gnorm": 16.482561111450195, "vf_loss": 3142614.0, "vf_explained_var": 0.03490406274795532}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 184800, "num_env_steps_trained": 184250, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1232, "num_samples_added_to_queue": 184800, "learner_queue": {"size_count": 335, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.263, "learner_load_time_ms": 0.427, "learner_load_wait_time_ms": 2524.347, "learner_dequeue_time_ms": 21064.859}}, "env_runners": {"episode_reward_max": 914.3520606780605, "episode_reward_min": 804.7596789423999, "episode_reward_mean": 866.5760540071292, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 804.7596789423999}, "policy_reward_max": {"default_policy": 914.3520606780605}, "policy_reward_mean": {"default_policy": 866.5760540071292}, "custom_metrics": {"num_consolidated_mean": 2.4158, "num_consolidated_min": 2.3, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.048499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.2122, "num_moves_min": 3.81, "num_moves_max": 4.61, "mean_accuracy_mean": 41.80832000000001, "mean_accuracy_min": 41.62566666666667, "mean_accuracy_max": 41.96766666666667, "num_model_switches_mean": 1.5020000000000002, "num_model_switches_min": 1.04, "num_model_switches_max": 1.86, "num_slav_mean": 0.0034913333333333337, "num_slav_min": 0.0005166666666666667, "num_slav_max": 0.007983333333333334, "cpu_conserved_cost_mean": 5.8964, "cpu_conserved_cost_min": 5.5, "cpu_conserved_cost_max": 6.54, "mean_cluster_cpu_util_mean": 0.4813641585107961, "mean_cluster_cpu_util_min": 0.4723860854000611, "mean_cluster_cpu_util_max": 0.496449585222515, "mean_cluster_mem_util_mean": 0.312715386739717, "mean_cluster_mem_util_min": 0.3070499321880651, "mean_cluster_mem_util_max": 0.3196911693791441, "reward_consolidation_mean_mean": 3.245013873404611, "reward_consolidation_mean_min": 3.0596691949191266, "reward_consolidation_mean_max": 3.4486301745408023, "reward_illegal_mean_mean": -0.08083333333333333, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.6326666666666805, "reward_accuracy_mean_min": 5.250000000000012, "reward_accuracy_mean_max": 5.958333333333346, "reward_sla_mean_mean": -0.13108666666666666, "reward_sla_mean_min": -0.3193333333333333, "reward_sla_mean_max": -0.018000000000000002, "reward_consolidation_sum_mean": 324.5013873404611, "reward_consolidation_sum_min": 305.9669194919127, "reward_consolidation_sum_max": 344.86301745408025, "reward_illegal_sum_mean": -8.083333333333332, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 563.2666666666681, "reward_accuracy_sum_min": 525.0000000000013, "reward_accuracy_sum_max": 595.8333333333346, "reward_sla_sum_mean": -13.108666666666668, "reward_sla_sum_min": -31.93333333333333, "reward_sla_sum_max": -1.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5382.0, "global_timestep_min": 3700, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [809.191224222487, 835.2959091047562, 884.2215662980916, 873.2794785098556, 857.239699655794, 829.6582625118051, 833.5855737305444, 833.4278016387962, 854.5917968869004, 834.044064698895, 869.05004112218, 875.9782052453638, 850.2235858539719, 843.4784123792999, 853.4896037040435, 849.0507325839969, 857.3651344847556, 873.925389137654, 874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2558905795375278, "mean_inference_ms": 2.1287420263131396, "mean_action_processing_ms": 0.09471348847912454, "mean_env_wait_ms": 1.8678722329602677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989479064941406, "StateBufferConnector_ms": 0.0037970542907714844, "ViewRequirementAgentConnector_ms": 0.09923744201660156}, "num_episodes": 21, "episode_return_max": 914.3520606780605, "episode_return_min": 804.7596789423999, "episode_return_mean": 866.5760540071292, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184250, "num_env_steps_sampled": 184800, "num_env_steps_trained": 184250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.86977321117232, "num_env_steps_trained_throughput_per_sec": 215.67309574503767, "timesteps_total": 184800, "num_env_steps_sampled_lifetime": 184800, "num_agent_steps_sampled_lifetime": 184800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 184800, "timers": {"training_iteration_time_ms": 10314.948, "restore_workers_time_ms": 0.016, "training_step_time_ms": 722.576, "sample_time_ms": 704.679, "synch_weights_time_ms": 16.262}, "counters": {"num_env_steps_sampled": 184800, "num_env_steps_trained": 184250, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1232, "num_samples_added_to_queue": 184800}, "done": false, "training_iteration": 81, "trial_id": "90ffb_00000", "date": "2024-10-13_00-27-19", "timestamp": 1728775639, "time_this_iter_s": 10.211000680923462, "time_total_s": 837.1549065113068, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e36860>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.1549065113068, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.313333333333333, "ram_util_percent": 59.31333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 537251.9375, "policy_loss": 509124.71875, "entropy": 11.336809158325195, "entropy_coeff": 0.01, "var_gnorm": 16.484071731567383, "vf_loss": 2818955.75, "vf_explained_var": 0.03940844535827637}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 339.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 186600, "num_env_steps_trained": 186450, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1244, "num_samples_added_to_queue": 186450, "learner_queue": {"size_count": 339, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.006, "learner_load_time_ms": 0.49, "learner_load_wait_time_ms": 2712.84, "learner_dequeue_time_ms": 21350.038}}, "env_runners": {"episode_reward_max": 930.7527003563936, "episode_reward_min": 804.7596789423999, "episode_reward_mean": 870.9106193000106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 804.7596789423999}, "policy_reward_max": {"default_policy": 930.7527003563936}, "policy_reward_mean": {"default_policy": 870.9106193000106}, "custom_metrics": {"num_consolidated_mean": 2.4222999999999995, "num_consolidated_min": 2.26, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.04689999999999998, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.171399999999999, "num_moves_min": 3.7, "num_moves_max": 4.61, "mean_accuracy_mean": 41.820606666666684, "mean_accuracy_min": 41.68900000000001, "mean_accuracy_max": 41.96766666666667, "num_model_switches_mean": 1.4767000000000001, "num_model_switches_min": 1.04, "num_model_switches_max": 1.86, "num_slav_mean": 0.0033549999999999995, "num_slav_min": 0.0005166666666666667, "num_slav_max": 0.00735, "cpu_conserved_cost_mean": 5.914, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.54, "mean_cluster_cpu_util_mean": 0.4814808510464805, "mean_cluster_cpu_util_min": 0.4723860854000611, "mean_cluster_cpu_util_max": 0.496449585222515, "mean_cluster_mem_util_mean": 0.3127921263347111, "mean_cluster_mem_util_min": 0.3070499321880651, "mean_cluster_mem_util_max": 0.3196911693791441, "reward_consolidation_mean_mean": 3.2565661930000918, "reward_consolidation_mean_min": 3.0483490206829322, "reward_consolidation_mean_max": 3.4486301745408023, "reward_illegal_mean_mean": -0.07816666666666666, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.65666666666668, "reward_accuracy_mean_min": 5.250000000000012, "reward_accuracy_mean_max": 5.991666666666682, "reward_sla_mean_mean": -0.12596000000000002, "reward_sla_mean_min": -0.29133333333333333, "reward_sla_mean_max": -0.018000000000000002, "reward_consolidation_sum_mean": 325.65661930000914, "reward_consolidation_sum_min": 304.8349020682932, "reward_consolidation_sum_max": 344.86301745408025, "reward_illegal_sum_mean": -7.816666666666667, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 565.6666666666682, "reward_accuracy_sum_min": 525.0000000000013, "reward_accuracy_sum_max": 599.1666666666682, "reward_sla_sum_mean": -12.595999999999997, "reward_sla_sum_min": -29.133333333333333, "reward_sla_sum_max": -1.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5983.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.7677449815727, 840.7837582625134, 891.5387340461191, 848.017545462854, 849.2978738310654, 873.4549270462106, 913.3398458679841, 897.7569466020908, 818.3335861585807, 901.9947790063674, 815.0006335861601, 841.0410064272454, 907.4256328246378, 861.693755521035, 886.2248743489002, 845.8523470102665, 804.7596789423999, 873.8168509549497, 877.9909013372334, 909.2737000822458, 853.3508605196635, 884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25627153526716895, "mean_inference_ms": 2.1334579802608227, "mean_action_processing_ms": 0.09484703458179876, "mean_env_wait_ms": 1.8708860630361612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007136344909667969, "StateBufferConnector_ms": 0.0039048194885253906, "ViewRequirementAgentConnector_ms": 0.10195398330688477}, "num_episodes": 18, "episode_return_max": 930.7527003563936, "episode_return_min": 804.7596789423999, "episode_return_mean": 870.9106193000106, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186450, "num_env_steps_sampled": 186600, "num_env_steps_trained": 186450, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 173.54721349125356, "num_env_steps_trained_throughput_per_sec": 212.11326093375436, "timesteps_total": 186600, "num_env_steps_sampled_lifetime": 186600, "num_agent_steps_sampled_lifetime": 186600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 186600, "timers": {"training_iteration_time_ms": 10319.366, "restore_workers_time_ms": 0.018, "training_step_time_ms": 838.041, "sample_time_ms": 819.426, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 186600, "num_env_steps_trained": 186450, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1244, "num_samples_added_to_queue": 186450}, "done": false, "training_iteration": 82, "trial_id": "90ffb_00000", "date": "2024-10-13_00-27-29", "timestamp": 1728775649, "time_this_iter_s": 10.394583702087402, "time_total_s": 847.5494902133942, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35e10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.5494902133942, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.706666666666663, "ram_util_percent": 62.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 486449.8125, "policy_loss": 458184.125, "entropy": 10.674468994140625, "entropy_coeff": 0.01, "var_gnorm": 16.48764419555664, "vf_loss": 2832442.0, "vf_explained_var": 0.04191344976425171}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 342.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 188700, "num_env_steps_trained": 188100, "num_agent_steps_sampled": 188700, "num_agent_steps_trained": 188100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1258, "num_samples_added_to_queue": 188650, "learner_queue": {"size_count": 342, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.318, "learner_load_time_ms": 0.49, "learner_load_wait_time_ms": 2787.772, "learner_dequeue_time_ms": 21350.038}}, "env_runners": {"episode_reward_max": 930.7527003563936, "episode_reward_min": 810.9682354016279, "episode_reward_mean": 871.2502040269289, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.9682354016279}, "policy_reward_max": {"default_policy": 930.7527003563936}, "policy_reward_mean": {"default_policy": 871.2502040269289}, "custom_metrics": {"num_consolidated_mean": 2.4335, "num_consolidated_min": 2.26, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.04940000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 4.1213999999999995, "num_moves_min": 3.65, "num_moves_max": 4.61, "mean_accuracy_mean": 41.83473000000001, "mean_accuracy_min": 41.71433333333334, "mean_accuracy_max": 41.96766666666668, "num_model_switches_mean": 1.4498, "num_model_switches_min": 1.04, "num_model_switches_max": 1.86, "num_slav_mean": 0.0032216666666666665, "num_slav_min": 0.0004, "num_slav_max": 0.00735, "cpu_conserved_cost_mean": 5.9508, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.54, "mean_cluster_cpu_util_mean": 0.48193692201353316, "mean_cluster_cpu_util_min": 0.4723860854000611, "mean_cluster_cpu_util_max": 0.496449585222515, "mean_cluster_mem_util_mean": 0.31311021832572694, "mean_cluster_mem_util_min": 0.30798309922070094, "mean_cluster_mem_util_max": 0.3196911693791441, "reward_consolidation_mean_mean": 3.2563487069359405, "reward_consolidation_mean_min": 3.0483490206829322, "reward_consolidation_mean_max": 3.4486301745408023, "reward_illegal_mean_mean": -0.08233333333333333, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.658500000000014, "reward_accuracy_mean_min": 5.383333333333346, "reward_accuracy_mean_max": 5.991666666666682, "reward_sla_mean_mean": -0.12001333333333335, "reward_sla_mean_min": -0.29133333333333333, "reward_sla_mean_max": -0.016, "reward_consolidation_sum_mean": 325.6348706935941, "reward_consolidation_sum_min": 304.8349020682932, "reward_consolidation_sum_max": 344.86301745408025, "reward_illegal_sum_mean": -8.23333333333333, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 565.8500000000015, "reward_accuracy_sum_min": 538.3333333333346, "reward_accuracy_sum_max": 599.1666666666682, "reward_sla_sum_mean": -12.001333333333335, "reward_sla_sum_min": -29.133333333333333, "reward_sla_sum_max": -1.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5512.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [884.4314356209462, 839.0952877029474, 867.0069389868729, 883.8709068201911, 914.3520606780605, 857.6390782539838, 862.3391635444285, 829.3528587529335, 869.4984891407005, 878.9098023089359, 885.7788723384826, 867.7248073349793, 866.4296627981369, 868.449462365593, 835.5010691766433, 846.5322793871287, 905.9148496755937, 857.408964634928, 883.8224770781945, 904.5650431021368, 866.5653690334779, 878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2565486929291503, "mean_inference_ms": 2.1347616715425097, "mean_action_processing_ms": 0.09494035738641506, "mean_env_wait_ms": 1.8727477807246624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007027626037597656, "StateBufferConnector_ms": 0.0038857460021972656, "ViewRequirementAgentConnector_ms": 0.10108089447021484}, "num_episodes": 21, "episode_return_max": 930.7527003563936, "episode_return_min": 810.9682354016279, "episode_return_mean": 871.2502040269289, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188700, "num_agent_steps_trained": 188100, "num_env_steps_sampled": 188700, "num_env_steps_trained": 188100, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 203.67804219451588, "num_env_steps_trained_throughput_per_sec": 160.0327474385482, "timesteps_total": 188700, "num_env_steps_sampled_lifetime": 188700, "num_agent_steps_sampled_lifetime": 188700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 188700, "timers": {"training_iteration_time_ms": 10298.047, "restore_workers_time_ms": 0.016, "training_step_time_ms": 739.295, "sample_time_ms": 721.851, "synch_weights_time_ms": 15.979}, "counters": {"num_env_steps_sampled": 188700, "num_env_steps_trained": 188100, "num_agent_steps_sampled": 188700, "num_agent_steps_trained": 188100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1258, "num_samples_added_to_queue": 188650}, "done": false, "training_iteration": 83, "trial_id": "90ffb_00000", "date": "2024-10-13_00-27-40", "timestamp": 1728775660, "time_this_iter_s": 10.328449964523315, "time_total_s": 857.8779401779175, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e34610>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 857.8779401779175, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 19.526666666666667, "ram_util_percent": 62.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 497539.75, "policy_loss": 466179.46875, "entropy": 10.501456260681152, "entropy_coeff": 0.01, "var_gnorm": 16.496397018432617, "vf_loss": 3141803.75, "vf_explained_var": 0.04015636444091797}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 346.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 190800, "num_env_steps_trained": 190300, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1272, "num_samples_added_to_queue": 190300, "learner_queue": {"size_count": 346, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.805, "learner_load_time_ms": 0.489, "learner_load_wait_time_ms": 2812.294, "learner_dequeue_time_ms": 21294.265}}, "env_runners": {"episode_reward_max": 930.7527003563936, "episode_reward_min": 810.5860215053776, "episode_reward_mean": 874.2055703189269, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.5860215053776}, "policy_reward_max": {"default_policy": 930.7527003563936}, "policy_reward_mean": {"default_policy": 874.2055703189269}, "custom_metrics": {"num_consolidated_mean": 2.4602, "num_consolidated_min": 2.26, "num_consolidated_max": 2.61, "num_overloaded_mean": 0.051399999999999994, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.041899999999999, "num_moves_min": 3.5, "num_moves_max": 4.57, "mean_accuracy_mean": 41.853603333333346, "mean_accuracy_min": 41.71433333333334, "mean_accuracy_max": 42.005666666666684, "num_model_switches_mean": 1.4014000000000002, "num_model_switches_min": 1.04, "num_model_switches_max": 1.86, "num_slav_mean": 0.0030696666666666667, "num_slav_min": 0.0004, "num_slav_max": 0.00735, "cpu_conserved_cost_mean": 6.0424, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.56, "mean_cluster_cpu_util_mean": 0.48313324087774717, "mean_cluster_cpu_util_min": 0.4723860854000611, "mean_cluster_cpu_util_max": 0.496449585222515, "mean_cluster_mem_util_mean": 0.31396552742257244, "mean_cluster_mem_util_min": 0.30798309922070094, "mean_cluster_mem_util_max": 0.3196911693791441, "reward_consolidation_mean_mean": 3.2716190365225857, "reward_consolidation_mean_min": 3.0483490206829322, "reward_consolidation_mean_max": 3.4486301745408023, "reward_illegal_mean_mean": -0.08566666666666667, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.669416666666681, "reward_accuracy_mean_min": 5.258333333333346, "reward_accuracy_mean_max": 5.991666666666682, "reward_sla_mean_mean": -0.11331333333333334, "reward_sla_mean_min": -0.29133333333333333, "reward_sla_mean_max": -0.016, "reward_consolidation_sum_mean": 327.1619036522586, "reward_consolidation_sum_min": 304.8349020682932, "reward_consolidation_sum_max": 344.86301745408025, "reward_illegal_sum_mean": -8.566666666666665, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 566.9416666666681, "reward_accuracy_sum_min": 525.8333333333346, "reward_accuracy_sum_max": 599.1666666666682, "reward_sla_sum_mean": -11.331333333333331, "reward_sla_sum_min": -29.133333333333333, "reward_sla_sum_max": -1.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4574.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [878.2779219592445, 888.1256084559403, 873.0430655822609, 883.4939169636618, 860.1339059977472, 893.8192908708781, 906.029684120748, 845.7530293338222, 851.748789180299, 884.2376922842623, 884.2912089920511, 842.4358737701432, 858.753464924306, 888.4487556733391, 845.2733071369839, 874.3289286910971, 863.8318224740336, 838.7255262115824, 842.6665417770887, 875.9249261323846, 858.9198574431159, 867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2568575145588796, "mean_inference_ms": 2.137698192562659, "mean_action_processing_ms": 0.09505246872110189, "mean_env_wait_ms": 1.8750649504431578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006914377212524414, "StateBufferConnector_ms": 0.0038945674896240234, "ViewRequirementAgentConnector_ms": 0.10127997398376465}, "num_episodes": 21, "episode_return_max": 930.7527003563936, "episode_return_min": 810.5860215053776, "episode_return_mean": 874.2055703189269, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190300, "num_env_steps_sampled": 190800, "num_env_steps_trained": 190300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.99605943223025, "num_env_steps_trained_throughput_per_sec": 212.66253845281264, "timesteps_total": 190800, "num_env_steps_sampled_lifetime": 190800, "num_agent_steps_sampled_lifetime": 190800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 190800, "timers": {"training_iteration_time_ms": 10301.101, "restore_workers_time_ms": 0.013, "training_step_time_ms": 733.69, "sample_time_ms": 718.097, "synch_weights_time_ms": 14.16}, "counters": {"num_env_steps_sampled": 190800, "num_env_steps_trained": 190300, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1272, "num_samples_added_to_queue": 190300}, "done": false, "training_iteration": 84, "trial_id": "90ffb_00000", "date": "2024-10-13_00-27-50", "timestamp": 1728775670, "time_this_iter_s": 10.355324983596802, "time_total_s": 868.2332651615143, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 868.2332651615143, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.2, "ram_util_percent": 61.94666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 454087.0, "policy_loss": 424705.625, "entropy": 9.744537353515625, "entropy_coeff": 0.01, "var_gnorm": 16.507095336914062, "vf_loss": 2943496.5, "vf_explained_var": 0.04568767547607422}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 350.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 192900, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 192900, "num_agent_steps_trained": 192500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1286, "num_samples_added_to_queue": 192500, "learner_queue": {"size_count": 350, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.626, "learner_load_time_ms": 0.489, "learner_load_wait_time_ms": 2645.047, "learner_dequeue_time_ms": 21294.265}}, "env_runners": {"episode_reward_max": 938.8272655274309, "episode_reward_min": 810.5860215053776, "episode_reward_mean": 880.2153696426955, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.5860215053776}, "policy_reward_max": {"default_policy": 938.8272655274309}, "policy_reward_mean": {"default_policy": 880.2153696426955}, "custom_metrics": {"num_consolidated_mean": 2.4869000000000003, "num_consolidated_min": 2.26, "num_consolidated_max": 2.63, "num_overloaded_mean": 0.05140000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 3.9407999999999994, "num_moves_min": 3.41, "num_moves_max": 4.57, "mean_accuracy_mean": 41.88121666666668, "mean_accuracy_min": 41.74600000000001, "mean_accuracy_max": 42.018333333333345, "num_model_switches_mean": 1.3366000000000002, "num_model_switches_min": 0.98, "num_model_switches_max": 1.86, "num_slav_mean": 0.002946666666666667, "num_slav_min": 0.0004, "num_slav_max": 0.00735, "cpu_conserved_cost_mean": 6.1322, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.62, "mean_cluster_cpu_util_mean": 0.4844096768782502, "mean_cluster_cpu_util_min": 0.4724566373804809, "mean_cluster_cpu_util_max": 0.4942740111357525, "mean_cluster_mem_util_mean": 0.31481006149358476, "mean_cluster_mem_util_min": 0.30838166494445873, "mean_cluster_mem_util_max": 0.3224435621717041, "reward_consolidation_mean_mean": 3.294120363093606, "reward_consolidation_mean_min": 3.0483490206829322, "reward_consolidation_mean_max": 3.5046059886076337, "reward_illegal_mean_mean": -0.08566666666666667, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.703833333333349, "reward_accuracy_mean_min": 5.258333333333346, "reward_accuracy_mean_max": 6.0500000000000185, "reward_sla_mean_mean": -0.1101333333333333, "reward_sla_mean_min": -0.29133333333333333, "reward_sla_mean_max": -0.016, "reward_consolidation_sum_mean": 329.41203630936064, "reward_consolidation_sum_min": 304.8349020682932, "reward_consolidation_sum_max": 350.46059886076335, "reward_illegal_sum_mean": -8.566666666666665, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 570.3833333333349, "reward_accuracy_sum_min": 525.8333333333346, "reward_accuracy_sum_max": 605.0000000000018, "reward_sla_sum_mean": -11.013333333333332, "reward_sla_sum_min": -29.133333333333333, "reward_sla_sum_max": -1.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3636.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.0072466416898, 895.2025708976832, 885.4745590788649, 842.5342106064774, 863.142861494412, 877.5357397423026, 879.8806451612918, 894.4985317859223, 880.271756678548, 912.3434737579593, 868.7762923025389, 874.4895214596861, 853.129943038169, 884.3411678698724, 870.5571659203771, 870.039885467119, 906.5864845106474, 870.2630113619069, 845.2658716378826, 877.6472569983869, 920.3186481464575, 810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25716490598558395, "mean_inference_ms": 2.1405989585283787, "mean_action_processing_ms": 0.0951599395780059, "mean_env_wait_ms": 1.8772696085969591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006371021270751953, "StateBufferConnector_ms": 0.003846883773803711, "ViewRequirementAgentConnector_ms": 0.10029458999633789}, "num_episodes": 21, "episode_return_max": 938.8272655274309, "episode_return_min": 810.5860215053776, "episode_return_mean": 880.2153696426955, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192900, "num_agent_steps_trained": 192500, "num_env_steps_sampled": 192900, "num_env_steps_trained": 192500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 206.1211055437958, "num_env_steps_trained_throughput_per_sec": 215.93639628397653, "timesteps_total": 192900, "num_env_steps_sampled_lifetime": 192900, "num_agent_steps_sampled_lifetime": 192900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 192900, "timers": {"training_iteration_time_ms": 10306.43, "restore_workers_time_ms": 0.014, "training_step_time_ms": 724.265, "sample_time_ms": 708.732, "synch_weights_time_ms": 13.97}, "counters": {"num_env_steps_sampled": 192900, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 192900, "num_agent_steps_trained": 192500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1286, "num_samples_added_to_queue": 192500}, "done": false, "training_iteration": 85, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-00", "timestamp": 1728775680, "time_this_iter_s": 10.202425241470337, "time_total_s": 878.4356904029846, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d576139bf10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 878.4356904029846, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.064285714285713, "ram_util_percent": 61.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 453785.4375, "policy_loss": 423910.8125, "entropy": 9.893424034118652, "entropy_coeff": 0.01, "var_gnorm": 16.5158634185791, "vf_loss": 2992903.0, "vf_explained_var": 0.04677098989486694}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 354.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1300, "num_samples_added_to_queue": 194700, "learner_queue": {"size_count": 354, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.773, "learner_load_time_ms": 0.488, "learner_load_wait_time_ms": 2554.213, "learner_dequeue_time_ms": 21404.186}}, "env_runners": {"episode_reward_max": 950.8133570928156, "episode_reward_min": 810.5860215053776, "episode_reward_mean": 886.3429444089081, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.5860215053776}, "policy_reward_max": {"default_policy": 950.8133570928156}, "policy_reward_mean": {"default_policy": 886.3429444089081}, "custom_metrics": {"num_consolidated_mean": 2.5228, "num_consolidated_min": 2.26, "num_consolidated_max": 2.7, "num_overloaded_mean": 0.052800000000000014, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 3.8028999999999997, "num_moves_min": 3.37, "num_moves_max": 4.57, "mean_accuracy_mean": 41.91047666666668, "mean_accuracy_min": 41.74600000000001, "mean_accuracy_max": 42.08166666666668, "num_model_switches_mean": 1.2619999999999998, "num_model_switches_min": 0.96, "num_model_switches_max": 1.73, "num_slav_mean": 0.0027178333333333325, "num_slav_min": 0.0004, "num_slav_max": 0.005699999999999999, "cpu_conserved_cost_mean": 6.2542, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.94, "mean_cluster_cpu_util_mean": 0.48602814871750577, "mean_cluster_cpu_util_min": 0.4724566373804809, "mean_cluster_cpu_util_max": 0.4994093751131246, "mean_cluster_mem_util_mean": 0.3159728356870174, "mean_cluster_mem_util_min": 0.30838166494445873, "mean_cluster_mem_util_max": 0.3246498907474382, "reward_consolidation_mean_mean": 3.319566110755734, "reward_consolidation_mean_min": 3.0483490206829322, "reward_consolidation_mean_max": 3.54515885345274, "reward_illegal_mean_mean": -0.08799999999999997, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.732916666666683, "reward_accuracy_mean_min": 5.258333333333346, "reward_accuracy_mean_max": 6.116666666666685, "reward_sla_mean_mean": -0.10105333333333333, "reward_sla_mean_min": -0.22333333333333333, "reward_sla_mean_max": -0.016, "reward_consolidation_sum_mean": 331.9566110755734, "reward_consolidation_sum_min": 304.8349020682932, "reward_consolidation_sum_max": 354.515885345274, "reward_illegal_sum_mean": -8.799999999999997, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 573.2916666666682, "reward_accuracy_sum_min": 525.8333333333346, "reward_accuracy_sum_max": 611.6666666666684, "reward_sla_sum_mean": -10.105333333333332, "reward_sla_sum_min": -22.333333333333332, "reward_sla_sum_max": -1.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2698.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [810.9682354016279, 870.9795790307363, 860.3627067531769, 871.44946541168, 930.7527003563936, 846.0492521855687, 860.9689786469296, 895.4639160498352, 889.0657772091762, 861.4695909104765, 837.4537543025995, 868.9085199061815, 884.310807517745, 888.4081726522292, 857.7813792683311, 918.1942703097889, 852.0557037984727, 852.1193152395765, 825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25746510042864756, "mean_inference_ms": 2.1434006644534858, "mean_action_processing_ms": 0.0952586243517473, "mean_env_wait_ms": 1.8793134141875272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006352424621582031, "StateBufferConnector_ms": 0.003874063491821289, "ViewRequirementAgentConnector_ms": 0.10087323188781738}, "num_episodes": 21, "episode_return_max": 950.8133570928156, "episode_return_min": 810.5860215053776, "episode_return_mean": 886.3429444089081, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.7375618986732, "num_env_steps_trained_throughput_per_sec": 214.48696960813382, "timesteps_total": 195000, "num_env_steps_sampled_lifetime": 195000, "num_agent_steps_sampled_lifetime": 195000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 195000, "timers": {"training_iteration_time_ms": 10295.075, "restore_workers_time_ms": 0.014, "training_step_time_ms": 736.799, "sample_time_ms": 719.812, "synch_weights_time_ms": 15.503}, "counters": {"num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1300, "num_samples_added_to_queue": 194700}, "done": false, "training_iteration": 86, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-11", "timestamp": 1728775691, "time_this_iter_s": 10.276156902313232, "time_total_s": 888.7118473052979, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d576139ab90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 888.7118473052979, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.573333333333334, "ram_util_percent": 60.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 423290.0625, "policy_loss": 393234.59375, "entropy": 9.520685195922852, "entropy_coeff": 0.01, "var_gnorm": 16.52362823486328, "vf_loss": 3010783.25, "vf_explained_var": 0.04793757200241089}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 357.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 196950, "num_env_steps_trained": 196350, "num_agent_steps_sampled": 196950, "num_agent_steps_trained": 196350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1313, "num_samples_added_to_queue": 196900, "learner_queue": {"size_count": 357, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.393, "learner_load_time_ms": 0.488, "learner_load_wait_time_ms": 2696.656, "learner_dequeue_time_ms": 21404.186}}, "env_runners": {"episode_reward_max": 950.8133570928156, "episode_reward_min": 810.5860215053776, "episode_reward_mean": 894.313783788725, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.5860215053776}, "policy_reward_max": {"default_policy": 950.8133570928156}, "policy_reward_mean": {"default_policy": 894.313783788725}, "custom_metrics": {"num_consolidated_mean": 2.5507, "num_consolidated_min": 2.38, "num_consolidated_max": 2.7, "num_overloaded_mean": 0.05240000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 3.6820000000000004, "num_moves_min": 3.18, "num_moves_max": 4.57, "mean_accuracy_mean": 41.94170000000002, "mean_accuracy_min": 41.79666666666668, "mean_accuracy_max": 42.08166666666668, "num_model_switches_mean": 1.186, "num_model_switches_min": 0.85, "num_model_switches_max": 1.64, "num_slav_mean": 0.002414833333333333, "num_slav_min": 0.0004, "num_slav_max": 0.005699999999999999, "cpu_conserved_cost_mean": 6.3536, "cpu_conserved_cost_min": 5.7, "cpu_conserved_cost_max": 6.94, "mean_cluster_cpu_util_mean": 0.4874737993052004, "mean_cluster_cpu_util_min": 0.47437771128826833, "mean_cluster_cpu_util_max": 0.4994093751131246, "mean_cluster_mem_util_mean": 0.3170178684520221, "mean_cluster_mem_util_min": 0.30838166494445873, "mean_cluster_mem_util_max": 0.3246498907474382, "reward_consolidation_mean_mean": 3.344201171220567, "reward_consolidation_mean_min": 3.133872795394316, "reward_consolidation_mean_max": 3.54515885345274, "reward_illegal_mean_mean": -0.08733333333333335, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.775583333333348, "reward_accuracy_mean_min": 5.258333333333346, "reward_accuracy_mean_max": 6.116666666666685, "reward_sla_mean_mean": -0.08931333333333333, "reward_sla_mean_min": -0.22333333333333333, "reward_sla_mean_max": -0.016, "reward_consolidation_sum_mean": 334.4201171220567, "reward_consolidation_sum_min": 313.3872795394316, "reward_consolidation_sum_max": 354.515885345274, "reward_illegal_sum_mean": -8.73333333333333, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 577.558333333335, "reward_accuracy_sum_min": 525.8333333333346, "reward_accuracy_sum_max": 611.6666666666684, "reward_sla_sum_mean": -8.931333333333333, "reward_sla_sum_min": -22.333333333333332, "reward_sla_sum_max": -1.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1894.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [825.5206128727662, 874.184333973013, 865.1322580645174, 898.4975143927644, 857.250132504799, 861.5460933930377, 882.8460690243394, 865.9959730725897, 877.4349873587397, 877.3454750373161, 843.7889061500518, 846.2887386152503, 870.8776782722608, 909.4350025891756, 877.5995034877712, 897.9877547290521, 860.873700082246, 863.0837186633775, 859.8109841908081, 917.3024795150642, 905.1411587316107, 895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2576884426984224, "mean_inference_ms": 2.145359591692925, "mean_action_processing_ms": 0.09533280982473577, "mean_env_wait_ms": 1.8808017540871251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006414890289306641, "StateBufferConnector_ms": 0.003868579864501953, "ViewRequirementAgentConnector_ms": 0.10036730766296387}, "num_episodes": 18, "episode_return_max": 950.8133570928156, "episode_return_min": 810.5860215053776, "episode_return_mean": 894.313783788725, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196950, "num_agent_steps_trained": 196350, "num_env_steps_sampled": 196950, "num_env_steps_trained": 196350, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 191.46373308889454, "num_env_steps_trained_throughput_per_sec": 162.00777415214154, "timesteps_total": 196950, "num_env_steps_sampled_lifetime": 196950, "num_agent_steps_sampled_lifetime": 196950, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 196950, "timers": {"training_iteration_time_ms": 10237.76, "restore_workers_time_ms": 0.014, "training_step_time_ms": 808.291, "sample_time_ms": 790.01, "synch_weights_time_ms": 16.583}, "counters": {"num_env_steps_sampled": 196950, "num_env_steps_trained": 196350, "num_agent_steps_sampled": 196950, "num_agent_steps_trained": 196350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1313, "num_samples_added_to_queue": 196900}, "done": false, "training_iteration": 87, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-21", "timestamp": 1728775701, "time_this_iter_s": 10.212993144989014, "time_total_s": 898.9248404502869, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761398820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.9248404502869, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 22.28571428571429, "ram_util_percent": 60.87142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 431435.6875, "policy_loss": 395028.90625, "entropy": 9.033302307128906, "entropy_coeff": 0.01, "var_gnorm": 16.534446716308594, "vf_loss": 3645645.75, "vf_explained_var": 0.04686349630355835}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 361.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 199050, "num_env_steps_trained": 198550, "num_agent_steps_sampled": 199050, "num_agent_steps_trained": 198550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1327, "num_samples_added_to_queue": 198550, "learner_queue": {"size_count": 361, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.904, "learner_load_time_ms": 0.477, "learner_load_wait_time_ms": 2685.805, "learner_dequeue_time_ms": 21647.397}}, "env_runners": {"episode_reward_max": 987.5474123488394, "episode_reward_min": 810.5860215053776, "episode_reward_mean": 909.3159993298625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.5860215053776}, "policy_reward_max": {"default_policy": 987.5474123488394}, "policy_reward_mean": {"default_policy": 909.3159993298625}, "custom_metrics": {"num_consolidated_mean": 2.5844, "num_consolidated_min": 2.45, "num_consolidated_max": 2.8, "num_overloaded_mean": 0.04649999999999999, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 3.5272, "num_moves_min": 2.91, "num_moves_max": 4.15, "mean_accuracy_mean": 41.980903333333345, "mean_accuracy_min": 41.80933333333334, "mean_accuracy_max": 42.13233333333336, "num_model_switches_mean": 1.102, "num_model_switches_min": 0.72, "num_model_switches_max": 1.5, "num_slav_mean": 0.0023545, "num_slav_min": 0.00043333333333333337, "num_slav_max": 0.005699999999999999, "cpu_conserved_cost_mean": 6.4722, "cpu_conserved_cost_min": 5.96, "cpu_conserved_cost_max": 7.26, "mean_cluster_cpu_util_mean": 0.488994298902804, "mean_cluster_cpu_util_min": 0.4790482201086569, "mean_cluster_cpu_util_max": 0.5031204073773466, "mean_cluster_mem_util_mean": 0.31828993114756454, "mean_cluster_mem_util_min": 0.3122672715921812, "mean_cluster_mem_util_max": 0.3267199205631619, "reward_consolidation_mean_mean": 3.3959799932986083, "reward_consolidation_mean_min": 3.1541935483870964, "reward_consolidation_mean_max": 3.6671407901550457, "reward_illegal_mean_mean": -0.07749999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.863000000000016, "reward_accuracy_mean_min": 5.258333333333346, "reward_accuracy_mean_max": 6.291666666666686, "reward_sla_mean_mean": -0.08832000000000002, "reward_sla_mean_min": -0.22333333333333333, "reward_sla_mean_max": -0.017333333333333333, "reward_consolidation_sum_mean": 339.5979993298608, "reward_consolidation_sum_min": 315.41935483870964, "reward_consolidation_sum_max": 366.7140790155046, "reward_illegal_sum_mean": -7.750000000000001, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 586.3000000000015, "reward_accuracy_sum_min": 525.8333333333346, "reward_accuracy_sum_max": 629.1666666666686, "reward_sla_sum_mean": -8.832, "reward_sla_sum_min": -22.333333333333332, "reward_sla_sum_max": -1.7333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2282.0, "global_timestep_min": 600, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [895.7303451216928, 886.5699107496433, 893.954494501814, 860.6060373450321, 885.2719973194448, 869.7341253160328, 875.0386487556748, 901.1309177861051, 873.2843583417118, 889.6033324195088, 903.2665661457875, 924.3373602607468, 890.7767644460704, 866.824718998448, 885.7302963842961, 840.6924944408919, 887.1544274878934, 810.5860215053776, 907.9890523622421, 869.8249261323846, 888.9224009260122, 875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25792770731506, "mean_inference_ms": 2.1474464571118896, "mean_action_processing_ms": 0.09541340633960647, "mean_env_wait_ms": 1.88241627427703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006356000900268555, "StateBufferConnector_ms": 0.003826618194580078, "ViewRequirementAgentConnector_ms": 0.09939813613891602}, "num_episodes": 21, "episode_return_max": 987.5474123488394, "episode_return_min": 810.5860215053776, "episode_return_mean": 909.3159993298625, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199050, "num_agent_steps_trained": 198550, "num_env_steps_sampled": 199050, "num_env_steps_trained": 198550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.52493964450915, "num_env_steps_trained_throughput_per_sec": 218.45469867520006, "timesteps_total": 199050, "num_env_steps_sampled_lifetime": 199050, "num_agent_steps_sampled_lifetime": 199050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 199050, "timers": {"training_iteration_time_ms": 10233.328, "restore_workers_time_ms": 0.015, "training_step_time_ms": 708.396, "sample_time_ms": 692.318, "synch_weights_time_ms": 14.557}, "counters": {"num_env_steps_sampled": 199050, "num_env_steps_trained": 198550, "num_agent_steps_sampled": 199050, "num_agent_steps_trained": 198550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1327, "num_samples_added_to_queue": 198550}, "done": false, "training_iteration": 88, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-31", "timestamp": 1728775711, "time_this_iter_s": 10.083968877792358, "time_total_s": 909.0088093280792, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d576139a140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 909.0088093280792, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.086666666666666, "ram_util_percent": 63.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 398275.6875, "policy_loss": 367133.9375, "entropy": 8.464374542236328, "entropy_coeff": 0.01, "var_gnorm": 16.545026779174805, "vf_loss": 3118831.5, "vf_explained_var": 0.05222350358963013}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 201150, "num_env_steps_trained": 200750, "num_agent_steps_sampled": 201150, "num_agent_steps_trained": 200750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1341, "num_samples_added_to_queue": 200750, "learner_queue": {"size_count": 365, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.483, "learner_load_time_ms": 0.477, "learner_load_wait_time_ms": 2676.266, "learner_dequeue_time_ms": 21647.397}}, "env_runners": {"episode_reward_max": 999.4119010630861, "episode_reward_min": 839.3620731670186, "episode_reward_mean": 924.7748281092952, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 839.3620731670186}, "policy_reward_max": {"default_policy": 999.4119010630861}, "policy_reward_mean": {"default_policy": 924.7748281092952}, "custom_metrics": {"num_consolidated_mean": 2.6094999999999997, "num_consolidated_min": 2.47, "num_consolidated_max": 2.8, "num_overloaded_mean": 0.039, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 3.3594999999999997, "num_moves_min": 2.51, "num_moves_max": 3.99, "mean_accuracy_mean": 42.014343333333336, "mean_accuracy_min": 41.82833333333335, "mean_accuracy_max": 42.170333333333346, "num_model_switches_mean": 1.0285000000000002, "num_model_switches_min": 0.72, "num_model_switches_max": 1.47, "num_slav_mean": 0.0022601666666666664, "num_slav_min": 0.00036666666666666667, "num_slav_max": 0.005699999999999999, "cpu_conserved_cost_mean": 6.563400000000001, "cpu_conserved_cost_min": 6.02, "cpu_conserved_cost_max": 7.26, "mean_cluster_cpu_util_mean": 0.4903789356797945, "mean_cluster_cpu_util_min": 0.48007503454171896, "mean_cluster_cpu_util_max": 0.5031204073773466, "mean_cluster_mem_util_mean": 0.31935431243541723, "mean_cluster_mem_util_min": 0.3122672715921812, "mean_cluster_mem_util_max": 0.3273639186687333, "reward_consolidation_mean_mean": 3.4451349477596023, "reward_consolidation_mean_min": 3.2160591245545103, "reward_consolidation_mean_max": 3.717119010630845, "reward_illegal_mean_mean": -0.06499999999999999, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.95333333333335, "reward_accuracy_mean_min": 5.433333333333348, "reward_accuracy_mean_max": 6.358333333333353, "reward_sla_mean_mean": -0.08572000000000003, "reward_sla_mean_min": -0.22333333333333333, "reward_sla_mean_max": -0.014666666666666668, "reward_consolidation_sum_mean": 344.5134947759603, "reward_consolidation_sum_min": 321.605912455451, "reward_consolidation_sum_max": 371.7119010630845, "reward_illegal_sum_mean": -6.5, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 595.333333333335, "reward_accuracy_sum_min": 543.3333333333347, "reward_accuracy_sum_max": 635.8333333333353, "reward_sla_sum_mean": -8.571999999999997, "reward_sla_sum_min": -22.333333333333332, "reward_sla_sum_max": -1.4666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2982.0, "global_timestep_min": 1300, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.8764811599513, 937.1715708672226, 894.951929696306, 903.39206798867, 897.5229979591234, 883.8817569831562, 901.9360930884291, 903.976983764356, 839.3620731670186, 885.8108379786181, 878.6671357641125, 926.7162265070531, 904.6800054829582, 907.8511894970927, 938.8272655274309, 904.5876176551235, 933.3483840506891, 860.9392457887856, 900.9958603673598, 907.5536294130203, 889.0977915867085, 936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25815283980953196, "mean_inference_ms": 2.1493997210846247, "mean_action_processing_ms": 0.09549231141726074, "mean_env_wait_ms": 1.8839496890004412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00639033317565918, "StateBufferConnector_ms": 0.003864765167236328, "ViewRequirementAgentConnector_ms": 0.10000157356262207}, "num_episodes": 21, "episode_return_max": 999.4119010630861, "episode_return_min": 839.3620731670186, "episode_return_mean": 924.7748281092952, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201150, "num_agent_steps_trained": 200750, "num_env_steps_sampled": 201150, "num_env_steps_trained": 200750, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.94757544083063, "num_env_steps_trained_throughput_per_sec": 215.75460284277494, "timesteps_total": 201150, "num_env_steps_sampled_lifetime": 201150, "num_agent_steps_sampled_lifetime": 201150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 201150, "timers": {"training_iteration_time_ms": 10232.489, "restore_workers_time_ms": 0.014, "training_step_time_ms": 740.016, "sample_time_ms": 724.526, "synch_weights_time_ms": 14.151}, "counters": {"num_env_steps_sampled": 201150, "num_env_steps_trained": 200750, "num_agent_steps_sampled": 201150, "num_agent_steps_trained": 200750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1341, "num_samples_added_to_queue": 200750}, "done": false, "training_iteration": 89, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-41", "timestamp": 1728775721, "time_this_iter_s": 10.212195873260498, "time_total_s": 919.2210052013397, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419b0d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 919.2210052013397, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.82857142857143, "ram_util_percent": 62.26428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 365571.125, "policy_loss": 332727.0, "entropy": 7.801179885864258, "entropy_coeff": 0.01, "var_gnorm": 16.55778694152832, "vf_loss": 3288701.5, "vf_explained_var": 0.056907474994659424}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 369.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 203100, "num_env_steps_trained": 202950, "num_agent_steps_sampled": 203100, "num_agent_steps_trained": 202950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1354, "num_samples_added_to_queue": 202950, "learner_queue": {"size_count": 369, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.313, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2605.197, "learner_dequeue_time_ms": 21854.35}}, "env_runners": {"episode_reward_max": 1003.2093910871502, "episode_reward_min": 856.3996618843112, "episode_reward_mean": 940.1667020622028, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 856.3996618843112}, "policy_reward_max": {"default_policy": 1003.2093910871502}, "policy_reward_mean": {"default_policy": 940.1667020622028}, "custom_metrics": {"num_consolidated_mean": 2.6423, "num_consolidated_min": 2.5, "num_consolidated_max": 2.8, "num_overloaded_mean": 0.032600000000000004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 3.1487000000000007, "num_moves_min": 2.37, "num_moves_max": 3.75, "mean_accuracy_mean": 42.046770000000016, "mean_accuracy_min": 41.86633333333335, "mean_accuracy_max": 42.183000000000014, "num_model_switches_mean": 0.953, "num_model_switches_min": 0.62, "num_model_switches_max": 1.24, "num_slav_mean": 0.0020723333333333336, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.005033333333333333, "cpu_conserved_cost_mean": 6.678, "cpu_conserved_cost_min": 6.08, "cpu_conserved_cost_max": 7.26, "mean_cluster_cpu_util_mean": 0.4920780307563895, "mean_cluster_cpu_util_min": 0.48104957796765246, "mean_cluster_cpu_util_max": 0.5031204073773466, "mean_cluster_mem_util_mean": 0.32053988492422286, "mean_cluster_mem_util_min": 0.3122672715921812, "mean_cluster_mem_util_max": 0.3273639186687333, "reward_consolidation_mean_mean": 3.498553687288678, "reward_consolidation_mean_min": 3.229221572390265, "reward_consolidation_mean_max": 3.7245778123001, "reward_illegal_mean_mean": -0.054333333333333324, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.037166666666685, "reward_accuracy_mean_min": 5.46666666666668, "reward_accuracy_mean_max": 6.391666666666685, "reward_sla_mean_mean": -0.07972, "reward_sla_mean_min": -0.20066666666666666, "reward_sla_mean_max": -0.013333333333333334, "reward_consolidation_sum_mean": 349.85536872886775, "reward_consolidation_sum_min": 322.9221572390265, "reward_consolidation_sum_max": 372.45778123001, "reward_illegal_sum_mean": -5.433333333333334, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 603.7166666666684, "reward_accuracy_sum_min": 546.666666666668, "reward_accuracy_sum_max": 639.1666666666686, "reward_sla_sum_mean": -7.972, "reward_sla_sum_min": -20.066666666666666, "reward_sla_sum_max": -1.3333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3682.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [936.5376405007785, 895.0210484632504, 923.511063389078, 942.8158853452759, 908.1199275031239, 856.3996618843112, 914.1932681470668, 905.9068415120793, 930.7455755581973, 932.7484541106966, 899.0335861585812, 917.327664564868, 950.8133570928156, 871.1138871120062, 893.1759328642377, 913.761058819947, 879.8636754089388, 894.0336470803269, 890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2584414838651872, "mean_inference_ms": 2.151762160625296, "mean_action_processing_ms": 0.09558388704585942, "mean_env_wait_ms": 1.885727646014592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006512880325317383, "StateBufferConnector_ms": 0.0039370059967041016, "ViewRequirementAgentConnector_ms": 0.10191011428833008}, "num_episodes": 21, "episode_return_max": 1003.2093910871502, "episode_return_min": 856.3996618843112, "episode_return_mean": 940.1667020622028, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203100, "num_agent_steps_trained": 202950, "num_env_steps_sampled": 203100, "num_env_steps_trained": 202950, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 189.6245868528275, "num_env_steps_trained_throughput_per_sec": 213.9354313211387, "timesteps_total": 203100, "num_env_steps_sampled_lifetime": 203100, "num_agent_steps_sampled_lifetime": 203100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 203100, "timers": {"training_iteration_time_ms": 10240.887, "restore_workers_time_ms": 0.016, "training_step_time_ms": 790.707, "sample_time_ms": 773.048, "synch_weights_time_ms": 16.01}, "counters": {"num_env_steps_sampled": 203100, "num_env_steps_trained": 202950, "num_agent_steps_sampled": 203100, "num_agent_steps_trained": 202950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1354, "num_samples_added_to_queue": 202950}, "done": false, "training_iteration": 90, "trial_id": "90ffb_00000", "date": "2024-10-13_00-28-52", "timestamp": 1728775732, "time_this_iter_s": 10.30893063545227, "time_total_s": 929.529935836792, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761399510>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 929.529935836792, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 21.42666666666667, "ram_util_percent": 62.95333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 355704.375, "policy_loss": 318845.0625, "entropy": 7.382279396057129, "entropy_coeff": 0.01, "var_gnorm": 16.567298889160156, "vf_loss": 3689989.75, "vf_explained_var": 0.057283103466033936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 372.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1366, "num_samples_added_to_queue": 204600, "learner_queue": {"size_count": 372, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.664, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2773.162, "learner_dequeue_time_ms": 21854.35}}, "env_runners": {"episode_reward_max": 1010.7643912394548, "episode_reward_min": 880.2888239056948, "episode_reward_mean": 954.5144130799007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 880.2888239056948}, "policy_reward_max": {"default_policy": 1010.7643912394548}, "policy_reward_mean": {"default_policy": 954.5144130799007}, "custom_metrics": {"num_consolidated_mean": 2.6726, "num_consolidated_min": 2.5, "num_consolidated_max": 2.82, "num_overloaded_mean": 0.0265, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 2.9486000000000003, "num_moves_min": 2.15, "num_moves_max": 3.64, "mean_accuracy_mean": 42.07881666666668, "mean_accuracy_min": 41.929666666666684, "mean_accuracy_max": 42.18933333333335, "num_model_switches_mean": 0.8751000000000001, "num_model_switches_min": 0.52, "num_model_switches_max": 1.21, "num_slav_mean": 0.0019746666666666667, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.005033333333333333, "cpu_conserved_cost_mean": 6.785200000000002, "cpu_conserved_cost_min": 6.14, "cpu_conserved_cost_max": 7.3, "mean_cluster_cpu_util_mean": 0.49385000820225167, "mean_cluster_cpu_util_min": 0.48104957796765246, "mean_cluster_cpu_util_max": 0.5038736550669841, "mean_cluster_mem_util_mean": 0.32169620353985473, "mean_cluster_mem_util_min": 0.31484773583484027, "mean_cluster_mem_util_max": 0.3286253175320762, "reward_consolidation_mean_mean": 3.5483307974656553, "reward_consolidation_mean_min": 3.229221572390265, "reward_consolidation_mean_max": 3.7406515580736546, "reward_illegal_mean_mean": -0.04416666666666667, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.1175000000000175, "reward_accuracy_mean_min": 5.725000000000015, "reward_accuracy_mean_max": 6.433333333333353, "reward_sla_mean_mean": -0.07652, "reward_sla_mean_min": -0.20066666666666666, "reward_sla_mean_max": -0.013333333333333334, "reward_consolidation_sum_mean": 354.8330797465655, "reward_consolidation_sum_min": 322.9221572390265, "reward_consolidation_sum_max": 374.06515580736544, "reward_illegal_sum_mean": -4.416666666666666, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 611.7500000000018, "reward_accuracy_sum_min": 572.5000000000015, "reward_accuracy_sum_max": 643.3333333333353, "reward_sla_sum_mean": -7.651999999999999, "reward_sla_sum_min": -20.066666666666666, "reward_sla_sum_max": -1.3333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4283.0, "global_timestep_min": 2600, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [890.2907246641705, 910.5543574278853, 918.021627219838, 945.9795607542135, 934.5065247190001, 903.5572877638688, 892.6462974808875, 918.1476804045219, 880.2888239056948, 924.7770142252297, 901.2381735660551, 945.7479454141173, 900.6277620396614, 913.0670809345411, 887.0897346857978, 930.8820128544896, 894.8551280879725, 908.8677510737476, 942.9913003746705, 890.4004355904857, 935.501197112311, 958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2587942014246249, "mean_inference_ms": 2.1562117125562823, "mean_action_processing_ms": 0.09571041184501183, "mean_env_wait_ms": 1.8883622176341555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006669759750366211, "StateBufferConnector_ms": 0.004026174545288086, "ViewRequirementAgentConnector_ms": 0.10474991798400879}, "num_episodes": 18, "episode_return_max": 1010.7643912394548, "episode_return_min": 880.2888239056948, "episode_return_mean": 954.5144130799007, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 170.57954295533284, "num_env_steps_trained_throughput_per_sec": 156.36458104238844, "timesteps_total": 204900, "num_env_steps_sampled_lifetime": 204900, "num_agent_steps_sampled_lifetime": 204900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 204900, "timers": {"training_iteration_time_ms": 10276.051, "restore_workers_time_ms": 0.014, "training_step_time_ms": 895.499, "sample_time_ms": 876.691, "synch_weights_time_ms": 17.018}, "counters": {"num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1366, "num_samples_added_to_queue": 204600}, "done": false, "training_iteration": 91, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-02", "timestamp": 1728775742, "time_this_iter_s": 10.566852569580078, "time_total_s": 940.0967884063721, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef08ca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 940.0967884063721, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.02, "ram_util_percent": 62.25333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 338012.6875, "policy_loss": 300827.46875, "entropy": 6.9506096839904785, "entropy_coeff": 0.01, "var_gnorm": 16.581083297729492, "vf_loss": 3722343.75, "vf_explained_var": 0.05808228254318237}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 376.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 207000, "num_env_steps_trained": 206800, "num_agent_steps_sampled": 207000, "num_agent_steps_trained": 206800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1380, "num_samples_added_to_queue": 206800, "learner_queue": {"size_count": 376, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.008, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2891.176, "learner_dequeue_time_ms": 21854.35}}, "env_runners": {"episode_reward_max": 1023.1934356818682, "episode_reward_min": 898.2695208504696, "episode_reward_mean": 971.3976506747101, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 898.2695208504696}, "policy_reward_max": {"default_policy": 1023.1934356818682}, "policy_reward_mean": {"default_policy": 971.3976506747101}, "custom_metrics": {"num_consolidated_mean": 2.708, "num_consolidated_min": 2.5, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0189, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 2.7003000000000004, "num_moves_min": 1.85, "num_moves_max": 3.54, "mean_accuracy_mean": 42.11276333333334, "mean_accuracy_min": 41.98666666666667, "mean_accuracy_max": 42.22733333333335, "num_model_switches_mean": 0.7889000000000003, "num_model_switches_min": 0.46, "num_model_switches_max": 1.18, "num_slav_mean": 0.0018901666666666667, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.005033333333333333, "cpu_conserved_cost_mean": 6.909400000000001, "cpu_conserved_cost_min": 6.14, "cpu_conserved_cost_max": 7.52, "mean_cluster_cpu_util_mean": 0.4957833640096128, "mean_cluster_cpu_util_min": 0.48104957796765246, "mean_cluster_cpu_util_max": 0.5077505324062828, "mean_cluster_mem_util_mean": 0.32299070994072737, "mean_cluster_mem_util_min": 0.31484773583484027, "mean_cluster_mem_util_max": 0.3302343332902781, "reward_consolidation_mean_mean": 3.6086665067470842, "reward_consolidation_mean_min": 3.3520285418380094, "reward_consolidation_mean_max": 3.826601023485333, "reward_illegal_mean_mean": -0.03149999999999999, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.2107500000000195, "reward_accuracy_mean_min": 5.833333333333351, "reward_accuracy_mean_max": 6.466666666666686, "reward_sla_mean_mean": -0.07393999999999999, "reward_sla_mean_min": -0.20066666666666666, "reward_sla_mean_max": -0.013333333333333334, "reward_consolidation_sum_mean": 360.8666506747083, "reward_consolidation_sum_min": 335.2028541838009, "reward_consolidation_sum_max": 382.6601023485333, "reward_illegal_sum_mean": -3.1499999999999995, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 621.0750000000019, "reward_accuracy_sum_min": 583.3333333333351, "reward_accuracy_sum_max": 646.6666666666687, "reward_sla_sum_mean": -7.394000000000001, "reward_sla_sum_min": -20.066666666666666, "reward_sla_sum_max": -1.3333333333333335, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4982.0, "global_timestep_min": 3300, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [958.8298668859866, 924.5028237229293, 976.3418227786426, 987.5474123488394, 950.0302628773359, 936.5019616802234, 947.3021779524217, 967.6914069877256, 923.3385573730557, 929.4029486125094, 947.5144658685936, 932.9295287702961, 929.7970239727086, 956.7560967437341, 926.9736665752856, 939.4699016113819, 966.8387736452543, 960.7603612659558, 949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2590392175232293, "mean_inference_ms": 2.157499118001772, "mean_action_processing_ms": 0.09579635879737643, "mean_env_wait_ms": 1.889961869276448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006486177444458008, "StateBufferConnector_ms": 0.003938436508178711, "ViewRequirementAgentConnector_ms": 0.1028587818145752}, "num_episodes": 21, "episode_return_max": 1023.1934356818682, "episode_return_min": 898.2695208504696, "episode_return_mean": 971.3976506747101, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207000, "num_agent_steps_trained": 206800, "num_env_steps_sampled": 207000, "num_env_steps_trained": 206800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.67373979281894, "num_env_steps_trained_throughput_per_sec": 214.42010835438174, "timesteps_total": 207000, "num_env_steps_sampled_lifetime": 207000, "num_agent_steps_sampled_lifetime": 207000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 207000, "timers": {"training_iteration_time_ms": 10264.892, "restore_workers_time_ms": 0.014, "training_step_time_ms": 698.601, "sample_time_ms": 681.545, "synch_weights_time_ms": 15.57}, "counters": {"num_env_steps_sampled": 207000, "num_env_steps_trained": 206800, "num_agent_steps_sampled": 207000, "num_agent_steps_trained": 206800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1380, "num_samples_added_to_queue": 206800}, "done": false, "training_iteration": 92, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-13", "timestamp": 1728775753, "time_this_iter_s": 10.272085189819336, "time_total_s": 950.3688735961914, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0b370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 950.3688735961914, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.993333333333336, "ram_util_percent": 61.42666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 312348.21875, "policy_loss": 272503.375, "entropy": 6.700982570648193, "entropy_coeff": 0.01, "var_gnorm": 16.59197235107422, "vf_loss": 3988169.25, "vf_explained_var": 0.061371564865112305}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 379.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 208950, "num_env_steps_trained": 208450, "num_agent_steps_sampled": 208950, "num_agent_steps_trained": 208450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1393, "num_samples_added_to_queue": 208450, "learner_queue": {"size_count": 379, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.879, "learner_load_time_ms": 0.498, "learner_load_wait_time_ms": 2894.104, "learner_dequeue_time_ms": 22267.392}}, "env_runners": {"episode_reward_max": 1023.9378049894931, "episode_reward_min": 898.2695208504696, "episode_reward_mean": 981.6606225593245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 898.2695208504696}, "policy_reward_max": {"default_policy": 1023.9378049894931}, "policy_reward_mean": {"default_policy": 981.6606225593245}, "custom_metrics": {"num_consolidated_mean": 2.7346000000000004, "num_consolidated_min": 2.55, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.015400000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 2.4929999999999994, "num_moves_min": 1.73, "num_moves_max": 3.44, "mean_accuracy_mean": 42.137780000000014, "mean_accuracy_min": 42.03100000000001, "mean_accuracy_max": 42.240000000000016, "num_model_switches_mean": 0.7149, "num_model_switches_min": 0.36, "num_model_switches_max": 1.09, "num_slav_mean": 0.0017390000000000005, "num_slav_min": 0.0002, "num_slav_max": 0.005016666666666667, "cpu_conserved_cost_mean": 7.006, "cpu_conserved_cost_min": 6.28, "cpu_conserved_cost_max": 7.56, "mean_cluster_cpu_util_mean": 0.4974957034137507, "mean_cluster_cpu_util_min": 0.4833913671691545, "mean_cluster_cpu_util_max": 0.5084826761952156, "mean_cluster_mem_util_mean": 0.32408180966732686, "mean_cluster_mem_util_min": 0.3150471034616379, "mean_cluster_mem_util_max": 0.3305219651468183, "reward_consolidation_mean_mean": 3.6447695589265585, "reward_consolidation_mean_min": 3.3520285418380094, "reward_consolidation_mean_max": 3.826601023485333, "reward_illegal_mean_mean": -0.025666666666666664, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.265750000000018, "reward_accuracy_mean_min": 5.833333333333351, "reward_accuracy_mean_max": 6.50000000000002, "reward_sla_mean_mean": -0.06824666666666666, "reward_sla_mean_min": -0.20066666666666666, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 364.47695589265584, "reward_consolidation_sum_min": 335.2028541838009, "reward_consolidation_sum_max": 382.6601023485333, "reward_illegal_sum_mean": -2.566666666666667, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 626.5750000000019, "reward_accuracy_sum_min": 583.3333333333351, "reward_accuracy_sum_max": 650.000000000002, "reward_sla_sum_mean": -6.8246666666666655, "reward_sla_sum_min": -20.066666666666666, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5583.0, "global_timestep_min": 3900, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [949.7339364586207, 952.3256846081225, 981.1595631910828, 963.4859301227592, 922.39126686771, 935.1497182369268, 967.0212312284889, 953.2072070425558, 949.1364494806438, 963.9947333150582, 970.0350208657, 968.1513387553703, 961.2714307472073, 965.8083127722458, 929.0728106247539, 898.2695208504696, 963.9805933778082, 959.5113040299755, 963.7954765603597, 976.8600718876621, 908.872509062111, 999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25940881309171593, "mean_inference_ms": 2.1621773830981392, "mean_action_processing_ms": 0.0959301830280049, "mean_env_wait_ms": 1.8926557775638408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00664067268371582, "StateBufferConnector_ms": 0.004035234451293945, "ViewRequirementAgentConnector_ms": 0.10479116439819336}, "num_episodes": 18, "episode_return_max": 1023.9378049894931, "episode_return_min": 898.2695208504696, "episode_return_mean": 981.6606225593245, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208950, "num_agent_steps_trained": 208450, "num_env_steps_sampled": 208950, "num_env_steps_trained": 208450, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 184.15225572133028, "num_env_steps_trained_throughput_per_sec": 155.82113945651025, "timesteps_total": 208950, "num_env_steps_sampled_lifetime": 208950, "num_agent_steps_sampled_lifetime": 208950, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 208950, "timers": {"training_iteration_time_ms": 10292.759, "restore_workers_time_ms": 0.018, "training_step_time_ms": 821.709, "sample_time_ms": 804.149, "synch_weights_time_ms": 15.994}, "counters": {"num_env_steps_sampled": 208950, "num_env_steps_trained": 208450, "num_agent_steps_sampled": 208950, "num_agent_steps_trained": 208450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1393, "num_samples_added_to_queue": 208450}, "done": false, "training_iteration": 93, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-23", "timestamp": 1728775763, "time_this_iter_s": 10.603234052658081, "time_total_s": 960.9721076488495, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761398970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 960.9721076488495, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 21.96666666666666, "ram_util_percent": 61.14666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 275470.9375, "policy_loss": 238429.21875, "entropy": 6.281177520751953, "entropy_coeff": 0.01, "var_gnorm": 16.607887268066406, "vf_loss": 3707626.25, "vf_explained_var": 0.06486517190933228}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 210900, "num_env_steps_trained": 210650, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1406, "num_samples_added_to_queue": 210650, "learner_queue": {"size_count": 383, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.056, "learner_load_time_ms": 0.498, "learner_load_wait_time_ms": 2807.092, "learner_dequeue_time_ms": 22267.392}}, "env_runners": {"episode_reward_max": 1030.9739529074927, "episode_reward_min": 942.1117000213243, "episode_reward_mean": 993.0830296688923, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 942.1117000213243}, "policy_reward_max": {"default_policy": 1030.9739529074927}, "policy_reward_mean": {"default_policy": 993.0830296688923}, "custom_metrics": {"num_consolidated_mean": 2.7683000000000004, "num_consolidated_min": 2.6, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.012500000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.2757, "num_moves_min": 1.64, "num_moves_max": 2.92, "mean_accuracy_mean": 42.16691333333335, "mean_accuracy_min": 42.03733333333334, "mean_accuracy_max": 42.29700000000002, "num_model_switches_mean": 0.6182, "num_model_switches_min": 0.25, "num_model_switches_max": 0.91, "num_slav_mean": 0.0014485000000000001, "num_slav_min": 0.0002, "num_slav_max": 0.004666666666666667, "cpu_conserved_cost_mean": 7.1284, "cpu_conserved_cost_min": 6.52, "cpu_conserved_cost_max": 7.58, "mean_cluster_cpu_util_mean": 0.49955322716031164, "mean_cluster_cpu_util_min": 0.4868200276268258, "mean_cluster_cpu_util_max": 0.5084826761952156, "mean_cluster_mem_util_mean": 0.325444709049126, "mean_cluster_mem_util_min": 0.3175045315594592, "mean_cluster_mem_util_max": 0.3305219651468183, "reward_consolidation_mean_mean": 3.6858236300222362, "reward_consolidation_mean_min": 3.518504980352737, "reward_consolidation_mean_max": 3.8387395290749025, "reward_illegal_mean_mean": -0.02083333333333333, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.322833333333352, "reward_accuracy_mean_min": 5.975000000000016, "reward_accuracy_mean_max": 6.508333333333354, "reward_sla_mean_mean": -0.056993333333333326, "reward_sla_mean_min": -0.18666666666666668, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 368.5823630022237, "reward_consolidation_sum_min": 351.8504980352737, "reward_consolidation_sum_max": 383.87395290749026, "reward_illegal_sum_mean": -2.083333333333333, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 632.2833333333351, "reward_accuracy_sum_min": 597.5000000000016, "reward_accuracy_sum_max": 650.8333333333354, "reward_sla_sum_mean": -5.699333333333333, "reward_sla_sum_min": -18.666666666666668, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6049.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [999.4119010630861, 1003.2093910871502, 984.5151329617127, 950.62416461056, 986.0297511346698, 1001.9577812300121, 992.559127600599, 973.753239513846, 972.9217307868059, 944.7838313686088, 983.0541533400365, 942.1117000213243, 973.2955984038523, 965.1302446008124, 949.83696122331, 970.6297785494551, 957.7788175089115, 971.1569100490439, 966.2191172439019, 976.7284565475665, 978.0065277650883, 972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25981521472579117, "mean_inference_ms": 2.1661554883313734, "mean_action_processing_ms": 0.09607495908266828, "mean_env_wait_ms": 1.8954220738128975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006970405578613281, "StateBufferConnector_ms": 0.004045963287353516, "ViewRequirementAgentConnector_ms": 0.10538125038146973}, "num_episodes": 21, "episode_return_max": 1030.9739529074927, "episode_return_min": 942.1117000213243, "episode_return_mean": 993.0830296688923, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210650, "num_env_steps_sampled": 210900, "num_env_steps_trained": 210650, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 187.96164245283438, "num_env_steps_trained_throughput_per_sec": 212.05928892114648, "timesteps_total": 210900, "num_env_steps_sampled_lifetime": 210900, "num_agent_steps_sampled_lifetime": 210900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 210900, "timers": {"training_iteration_time_ms": 10295.701, "restore_workers_time_ms": 0.017, "training_step_time_ms": 810.173, "sample_time_ms": 791.328, "synch_weights_time_ms": 17.043}, "counters": {"num_env_steps_sampled": 210900, "num_env_steps_trained": 210650, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1406, "num_samples_added_to_queue": 210650}, "done": false, "training_iteration": 94, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-34", "timestamp": 1728775774, "time_this_iter_s": 10.385249137878418, "time_total_s": 971.3573567867279, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e34850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.3573567867279, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 21.726666666666667, "ram_util_percent": 61.03333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 237429.140625, "policy_loss": 203687.703125, "entropy": 5.64115571975708, "entropy_coeff": 0.01, "var_gnorm": 16.623987197875977, "vf_loss": 3377246.5, "vf_explained_var": 0.07553279399871826}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 387.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 213000, "num_env_steps_trained": 212850, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 212850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1420, "num_samples_added_to_queue": 212850, "learner_queue": {"size_count": 387, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.693, "learner_load_time_ms": 0.484, "learner_load_wait_time_ms": 2734.848, "learner_dequeue_time_ms": 22260.139}}, "env_runners": {"episode_reward_max": 1039.0779828809916, "episode_reward_min": 962.0336684029382, "episode_reward_mean": 1003.4776443693096, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 962.0336684029382}, "policy_reward_max": {"default_policy": 1039.0779828809916}, "policy_reward_mean": {"default_policy": 1003.4776443693096}, "custom_metrics": {"num_consolidated_mean": 2.7963999999999998, "num_consolidated_min": 2.6, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.01, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.0810000000000004, "num_moves_min": 1.47, "num_moves_max": 2.8, "mean_accuracy_mean": 42.19965666666668, "mean_accuracy_min": 42.08166666666668, "mean_accuracy_max": 42.30333333333335, "num_model_switches_mean": 0.5227999999999999, "num_model_switches_min": 0.19, "num_model_switches_max": 0.86, "num_slav_mean": 0.0012991666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.004666666666666667, "cpu_conserved_cost_mean": 7.2307999999999995, "cpu_conserved_cost_min": 6.52, "cpu_conserved_cost_max": 7.7, "mean_cluster_cpu_util_mean": 0.5012370778596781, "mean_cluster_cpu_util_min": 0.48896258874033444, "mean_cluster_cpu_util_max": 0.5095930848746865, "mean_cluster_mem_util_mean": 0.3266007666785068, "mean_cluster_mem_util_min": 0.3190270257470077, "mean_cluster_mem_util_max": 0.3321238778739343, "reward_consolidation_mean_mean": 3.7201131103597436, "reward_consolidation_mean_min": 3.5423523409180904, "reward_consolidation_mean_max": 3.8544041853239515, "reward_illegal_mean_mean": -0.016666666666666666, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.382083333333354, "reward_accuracy_mean_min": 6.116666666666685, "reward_accuracy_mean_max": 6.575000000000021, "reward_sla_mean_mean": -0.05075333333333333, "reward_sla_mean_min": -0.18666666666666668, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 372.01131103597436, "reward_consolidation_sum_min": 354.23523409180905, "reward_consolidation_sum_max": 385.44041853239514, "reward_illegal_sum_mean": -1.6666666666666665, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 638.2083333333353, "reward_accuracy_sum_min": 611.6666666666684, "reward_accuracy_sum_max": 657.500000000002, "reward_sla_sum_mean": -5.075333333333334, "reward_sla_sum_min": -18.666666666666668, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5111.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [972.0321240366767, 1003.7085138140081, 984.7927929574474, 987.3831551372282, 984.7275183526782, 1006.1651558073677, 1001.9869353315686, 977.5941362819477, 975.8369764537466, 1010.7643912394548, 1009.5740199214132, 988.203329373422, 986.0018124219464, 966.6685674251446, 981.1870236681004, 985.910408480309, 976.6809375856731, 977.7891224222506, 994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26016860342941167, "mean_inference_ms": 2.169728631515325, "mean_action_processing_ms": 0.09621002605253132, "mean_env_wait_ms": 1.8979861458622918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007349967956542969, "StateBufferConnector_ms": 0.004046916961669922, "ViewRequirementAgentConnector_ms": 0.10422468185424805}, "num_episodes": 21, "episode_return_max": 1039.0779828809916, "episode_return_min": 962.0336684029382, "episode_return_mean": 1003.4776443693096, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 212850, "num_env_steps_sampled": 213000, "num_env_steps_trained": 212850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.12052930101177, "num_env_steps_trained_throughput_per_sec": 212.7929354582028, "timesteps_total": 213000, "num_env_steps_sampled_lifetime": 213000, "num_agent_steps_sampled_lifetime": 213000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 213000, "timers": {"training_iteration_time_ms": 10310.752, "restore_workers_time_ms": 0.014, "training_step_time_ms": 754.929, "sample_time_ms": 738.255, "synch_weights_time_ms": 15.269}, "counters": {"num_env_steps_sampled": 213000, "num_env_steps_trained": 212850, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 212850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1420, "num_samples_added_to_queue": 212850}, "done": false, "training_iteration": 95, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-44", "timestamp": 1728775784, "time_this_iter_s": 10.349912643432617, "time_total_s": 981.7072694301605, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0beb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 981.7072694301605, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.633333333333333, "ram_util_percent": 61.14666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 229557.390625, "policy_loss": 195401.03125, "entropy": 5.535585403442383, "entropy_coeff": 0.01, "var_gnorm": 16.636754989624023, "vf_loss": 3418681.0, "vf_explained_var": 0.08127838373184204}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 390.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 214950, "num_env_steps_trained": 214500, "num_agent_steps_sampled": 214950, "num_agent_steps_trained": 214500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1433, "num_samples_added_to_queue": 214500, "learner_queue": {"size_count": 390, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.818, "learner_load_time_ms": 0.484, "learner_load_wait_time_ms": 2687.785, "learner_dequeue_time_ms": 22260.139}}, "env_runners": {"episode_reward_max": 1039.1799902525229, "episode_reward_min": 962.0336684029382, "episode_reward_mean": 1010.4479150141663, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 962.0336684029382}, "policy_reward_max": {"default_policy": 1039.1799902525229}, "policy_reward_mean": {"default_policy": 1010.4479150141663}, "custom_metrics": {"num_consolidated_mean": 2.8134999999999994, "num_consolidated_min": 2.6, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.008, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.9347999999999999, "num_moves_min": 1.28, "num_moves_max": 2.6, "mean_accuracy_mean": 42.22005000000002, "mean_accuracy_min": 42.100666666666676, "mean_accuracy_max": 42.30333333333335, "num_model_switches_mean": 0.45600000000000007, "num_model_switches_min": 0.19, "num_model_switches_max": 0.79, "num_slav_mean": 0.0012061666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0030833333333333333, "cpu_conserved_cost_mean": 7.291999999999999, "cpu_conserved_cost_min": 6.52, "cpu_conserved_cost_max": 7.7, "mean_cluster_cpu_util_mean": 0.5022336874658244, "mean_cluster_cpu_util_min": 0.48896258874033444, "mean_cluster_cpu_util_max": 0.5095930848746865, "mean_cluster_mem_util_mean": 0.3272739206977095, "mean_cluster_mem_util_min": 0.3190270257470077, "mean_cluster_mem_util_max": 0.3321238778739343, "reward_consolidation_mean_mean": 3.743015816808309, "reward_consolidation_mean_min": 3.5512856011453295, "reward_consolidation_mean_max": 3.8558146760486154, "reward_illegal_mean_mean": -0.013333333333333332, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.421916666666688, "reward_accuracy_mean_min": 6.116666666666685, "reward_accuracy_mean_max": 6.5750000000000215, "reward_sla_mean_mean": -0.047119999999999995, "reward_sla_mean_min": -0.12333333333333334, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 374.3015816808309, "reward_consolidation_sum_min": 355.12856011453295, "reward_consolidation_sum_max": 385.58146760486153, "reward_illegal_sum_mean": -1.333333333333333, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 642.1916666666687, "reward_accuracy_sum_min": 611.6666666666684, "reward_accuracy_sum_max": 657.5000000000022, "reward_sla_sum_mean": -4.712000000000001, "reward_sla_sum_min": -12.333333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4307.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [994.9184806116566, 982.7649943647408, 996.7811325352604, 992.4773005574361, 986.4427244204838, 992.4077736147937, 1016.8021596758986, 1014.1228882999803, 999.0715343141753, 993.631919948828, 992.9197142770129, 978.390541898933, 978.293661092329, 967.9839440738389, 996.2927716348371, 973.0952267812016, 1015.2865241097829, 981.6708002071356, 994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2604275382064335, "mean_inference_ms": 2.1722840007040167, "mean_action_processing_ms": 0.09630813845423639, "mean_env_wait_ms": 1.8998189004995596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007234096527099609, "StateBufferConnector_ms": 0.003990650177001953, "ViewRequirementAgentConnector_ms": 0.10206460952758789}, "num_episodes": 18, "episode_return_max": 1039.1799902525229, "episode_return_min": 962.0336684029382, "episode_return_mean": 1010.4479150141663, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214950, "num_agent_steps_trained": 214500, "num_env_steps_sampled": 214950, "num_env_steps_trained": 214500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 191.56487058486255, "num_env_steps_trained_throughput_per_sec": 162.09335203334524, "timesteps_total": 214950, "num_env_steps_sampled_lifetime": 214950, "num_agent_steps_sampled_lifetime": 214950, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 214950, "timers": {"training_iteration_time_ms": 10302.98, "restore_workers_time_ms": 0.014, "training_step_time_ms": 788.331, "sample_time_ms": 773.276, "synch_weights_time_ms": 13.551}, "counters": {"num_env_steps_sampled": 214950, "num_env_steps_trained": 214500, "num_agent_steps_sampled": 214950, "num_agent_steps_trained": 214500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1433, "num_samples_added_to_queue": 214500}, "done": false, "training_iteration": 96, "trial_id": "90ffb_00000", "date": "2024-10-13_00-29-54", "timestamp": 1728775794, "time_this_iter_s": 10.190691947937012, "time_total_s": 991.8979613780975, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e367a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 991.8979613780975, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 20.421428571428574, "ram_util_percent": 61.27142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 230149.6875, "policy_loss": 198511.90625, "entropy": 5.35264778137207, "entropy_coeff": 0.01, "var_gnorm": 16.649974822998047, "vf_loss": 3166722.5, "vf_explained_var": 0.08236408233642578}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 216750, "num_env_steps_trained": 216150, "num_agent_steps_sampled": 216750, "num_agent_steps_trained": 216150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1445, "num_samples_added_to_queue": 216700, "learner_queue": {"size_count": 393, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.414, "learner_load_time_ms": 0.467, "learner_load_wait_time_ms": 2874.128, "learner_dequeue_time_ms": 22545.303}}, "env_runners": {"episode_reward_max": 1042.9761125833888, "episode_reward_min": 962.0336684029382, "episode_reward_mean": 1015.9680185506736, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 962.0336684029382}, "policy_reward_max": {"default_policy": 1042.9761125833888}, "policy_reward_mean": {"default_policy": 1015.9680185506736}, "custom_metrics": {"num_consolidated_mean": 2.8274, "num_consolidated_min": 2.74, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.0069, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.8266999999999998, "num_moves_min": 1.28, "num_moves_max": 2.44, "mean_accuracy_mean": 42.24006333333337, "mean_accuracy_min": 42.11966666666668, "mean_accuracy_max": 42.32233333333335, "num_model_switches_mean": 0.3931, "num_model_switches_min": 0.14, "num_model_switches_max": 0.65, "num_slav_mean": 0.0011498333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.003, "cpu_conserved_cost_mean": 7.340800000000001, "cpu_conserved_cost_min": 6.98, "cpu_conserved_cost_max": 7.7, "mean_cluster_cpu_util_mean": 0.5029929674266796, "mean_cluster_cpu_util_min": 0.4951813587604205, "mean_cluster_cpu_util_max": 0.5105765578663547, "mean_cluster_mem_util_mean": 0.32779596738030664, "mean_cluster_mem_util_min": 0.32275774401532764, "mean_cluster_mem_util_max": 0.3323232745629898, "reward_consolidation_mean_mean": 3.7599068521733825, "reward_consolidation_mean_min": 3.5883366840293642, "reward_consolidation_mean_max": 3.8660944591671993, "reward_illegal_mean_mean": -0.0115, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.455833333333353, "reward_accuracy_mean_min": 6.116666666666685, "reward_accuracy_mean_max": 6.608333333333356, "reward_sla_mean_mean": -0.044559999999999995, "reward_sla_mean_min": -0.11666666666666664, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 375.9906852173384, "reward_consolidation_sum_min": 358.83366840293644, "reward_consolidation_sum_max": 386.60944591671995, "reward_illegal_sum_mean": -1.1500000000000001, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 645.5833333333354, "reward_accuracy_sum_min": 611.6666666666684, "reward_accuracy_sum_max": 660.8333333333355, "reward_sla_sum_mean": -4.4559999999999995, "reward_sla_sum_min": -11.666666666666664, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3498.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [994.113619056324, 1023.1934356818682, 988.4881354899652, 994.1313777452883, 1005.6752505406827, 1003.2732919065477, 1002.157376100401, 1018.1181638185768, 1016.9866215845767, 998.2509671327197, 1006.0944012915429, 962.0336684029382, 1005.2866215845761, 1008.8568552194725, 1020.2196564013541, 997.4098997837298, 990.8177617350528, 979.3792195924357, 1020.2906210972027, 1023.9378049894931, 1009.8280879710031, 1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607315354044236, "mean_inference_ms": 2.17414080204376, "mean_action_processing_ms": 0.0964101070435337, "mean_env_wait_ms": 1.9017370191879572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007444620132446289, "StateBufferConnector_ms": 0.004124879837036133, "ViewRequirementAgentConnector_ms": 0.10542583465576172}, "num_episodes": 18, "episode_return_max": 1042.9761125833888, "episode_return_min": 962.0336684029382, "episode_return_mean": 1015.9680185506736, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216750, "num_agent_steps_trained": 216150, "num_env_steps_sampled": 216750, "num_env_steps_trained": 216150, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 175.30401927526427, "num_env_steps_trained_throughput_per_sec": 160.6953510023256, "timesteps_total": 216750, "num_env_steps_sampled_lifetime": 216750, "num_agent_steps_sampled_lifetime": 216750, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 216750, "timers": {"training_iteration_time_ms": 10311.299, "restore_workers_time_ms": 0.015, "training_step_time_ms": 830.014, "sample_time_ms": 811.891, "synch_weights_time_ms": 16.478}, "counters": {"num_env_steps_sampled": 216750, "num_env_steps_trained": 216150, "num_agent_steps_sampled": 216750, "num_agent_steps_trained": 216150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1445, "num_samples_added_to_queue": 216700}, "done": false, "training_iteration": 97, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-05", "timestamp": 1728775805, "time_this_iter_s": 10.285468339920044, "time_total_s": 1002.1834297180176, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef08130>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1002.1834297180176, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.793333333333333, "ram_util_percent": 61.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 228693.40625, "policy_loss": 194118.03125, "entropy": 5.33750581741333, "entropy_coeff": 0.01, "var_gnorm": 16.664772033691406, "vf_loss": 3460474.25, "vf_explained_var": 0.07964271306991577}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 397.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 218700, "num_env_steps_trained": 218350, "num_agent_steps_sampled": 218700, "num_agent_steps_trained": 218350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1458, "num_samples_added_to_queue": 218350, "learner_queue": {"size_count": 397, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.436, "learner_load_time_ms": 0.467, "learner_load_wait_time_ms": 2917.665, "learner_dequeue_time_ms": 22545.303}}, "env_runners": {"episode_reward_max": 1042.9761125833888, "episode_reward_min": 972.7591245545115, "episode_reward_mean": 1019.2588301197131, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 972.7591245545115}, "policy_reward_max": {"default_policy": 1042.9761125833888}, "policy_reward_mean": {"default_policy": 1019.2588301197131}, "custom_metrics": {"num_consolidated_mean": 2.8381000000000007, "num_consolidated_min": 2.74, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.006500000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.7094999999999998, "num_moves_min": 1.27, "num_moves_max": 2.27, "mean_accuracy_mean": 42.25159000000002, "mean_accuracy_min": 42.164000000000016, "mean_accuracy_max": 42.32233333333335, "num_model_switches_mean": 0.3557, "num_model_switches_min": 0.14, "num_model_switches_max": 0.64, "num_slav_mean": 0.001061, "num_slav_min": 0.00025, "num_slav_max": 0.002633333333333333, "cpu_conserved_cost_mean": 7.380199999999999, "cpu_conserved_cost_min": 7.02, "cpu_conserved_cost_max": 7.7, "mean_cluster_cpu_util_mean": 0.503610641067243, "mean_cluster_cpu_util_min": 0.4951813587604205, "mean_cluster_cpu_util_max": 0.5105765578663547, "mean_cluster_mem_util_mean": 0.328248504827564, "mean_cluster_mem_util_min": 0.3233268212348231, "mean_cluster_mem_util_max": 0.3323232745629898, "reward_consolidation_mean_mean": 3.7708449678637788, "reward_consolidation_mean_min": 3.6105912455450975, "reward_consolidation_mean_max": 3.8660944591671993, "reward_illegal_mean_mean": -0.010833333333333332, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.473916666666687, "reward_accuracy_mean_min": 6.225000000000019, "reward_accuracy_mean_max": 6.608333333333356, "reward_sla_mean_mean": -0.041339999999999995, "reward_sla_mean_min": -0.10533333333333335, "reward_sla_mean_max": -0.01, "reward_consolidation_sum_mean": 377.08449678637794, "reward_consolidation_sum_min": 361.05912455450976, "reward_consolidation_sum_max": 386.60944591671995, "reward_illegal_sum_mean": -1.083333333333333, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 647.3916666666687, "reward_accuracy_sum_min": 622.5000000000019, "reward_accuracy_sum_max": 660.8333333333355, "reward_sla_sum_mean": -4.134000000000001, "reward_sla_sum_min": -10.533333333333335, "reward_sla_sum_max": -1.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2565.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1020.2099789819995, 1013.8711139541275, 1004.3991927868673, 994.3678515946285, 1021.711026836031, 1017.0530872094811, 1030.9739529074927, 984.0082609887617, 992.2191812117353, 1010.0862347314893, 1009.1692040573902, 1006.7304821956222, 972.7591245545115, 1016.5049864449136, 996.6790094124118, 979.7327088854382, 1011.4193152395768, 1029.7372627859534, 1016.7122148100784, 1015.6273081726544, 997.2721618081597, 1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.261079443729624, "mean_inference_ms": 2.1790269389414756, "mean_action_processing_ms": 0.0965543541350212, "mean_env_wait_ms": 1.9044513390391518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007411479949951172, "StateBufferConnector_ms": 0.004095554351806641, "ViewRequirementAgentConnector_ms": 0.10489559173583984}, "num_episodes": 21, "episode_return_max": 1042.9761125833888, "episode_return_min": 972.7591245545115, "episode_return_mean": 1019.2588301197131, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218700, "num_agent_steps_trained": 218350, "num_env_steps_sampled": 218700, "num_env_steps_trained": 218350, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 189.22738595516915, "num_env_steps_trained_throughput_per_sec": 213.4873072314729, "timesteps_total": 218700, "num_env_steps_sampled_lifetime": 218700, "num_agent_steps_sampled_lifetime": 218700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 218700, "timers": {"training_iteration_time_ms": 10334.731, "restore_workers_time_ms": 0.017, "training_step_time_ms": 791.752, "sample_time_ms": 773.516, "synch_weights_time_ms": 16.55}, "counters": {"num_env_steps_sampled": 218700, "num_env_steps_trained": 218350, "num_agent_steps_sampled": 218700, "num_agent_steps_trained": 218350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1458, "num_samples_added_to_queue": 218350}, "done": false, "training_iteration": 98, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-15", "timestamp": 1728775815, "time_this_iter_s": 10.317867040634155, "time_total_s": 1012.5012967586517, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761398b20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.5012967586517, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 21.526666666666664, "ram_util_percent": 62.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 209275.328125, "policy_loss": 174021.921875, "entropy": 5.086921691894531, "entropy_coeff": 0.01, "var_gnorm": 16.681137084960938, "vf_loss": 3528139.25, "vf_explained_var": 0.08763259649276733}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 220800, "num_env_steps_trained": 220550, "num_agent_steps_sampled": 220800, "num_agent_steps_trained": 220550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1472, "num_samples_added_to_queue": 220550, "learner_queue": {"size_count": 401, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.789, "learner_load_time_ms": 0.506, "learner_load_wait_time_ms": 2853.276, "learner_dequeue_time_ms": 22753.558}}, "env_runners": {"episode_reward_max": 1042.9761125833888, "episode_reward_min": 984.5350147735254, "episode_reward_mean": 1022.962752931861, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 984.5350147735254}, "policy_reward_max": {"default_policy": 1042.9761125833888}, "policy_reward_mean": {"default_policy": 1022.962752931861}, "custom_metrics": {"num_consolidated_mean": 2.8456999999999995, "num_consolidated_min": 2.74, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.004900000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.6078999999999999, "num_moves_min": 1.21, "num_moves_max": 2.02, "mean_accuracy_mean": 42.259316666666685, "mean_accuracy_min": 42.202000000000005, "mean_accuracy_max": 42.32233333333335, "num_model_switches_mean": 0.33080000000000004, "num_model_switches_min": 0.14, "num_model_switches_max": 0.5, "num_slav_mean": 0.0010321666666666667, "num_slav_min": 0.00025, "num_slav_max": 0.002633333333333333, "cpu_conserved_cost_mean": 7.404399999999999, "cpu_conserved_cost_min": 7.02, "cpu_conserved_cost_max": 7.7, "mean_cluster_cpu_util_mean": 0.5040764875994246, "mean_cluster_cpu_util_min": 0.4973079224794876, "mean_cluster_cpu_util_max": 0.5105765578663547, "mean_cluster_mem_util_mean": 0.328451260295574, "mean_cluster_mem_util_min": 0.32431108402221653, "mean_cluster_mem_util_max": 0.3323232745629898, "reward_consolidation_mean_mean": 3.7839041959852566, "reward_consolidation_mean_min": 3.6553501477352337, "reward_consolidation_mean_max": 3.8660944591671993, "reward_illegal_mean_mean": -0.008166666666666666, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.4944166666666865, "reward_accuracy_mean_min": 6.2833333333333545, "reward_accuracy_mean_max": 6.608333333333356, "reward_sla_mean_mean": -0.04052666666666667, "reward_sla_mean_min": -0.10533333333333333, "reward_sla_mean_max": -0.01, "reward_consolidation_sum_mean": 378.3904195985257, "reward_consolidation_sum_min": 365.53501477352336, "reward_consolidation_sum_max": 386.60944591671995, "reward_illegal_sum_mean": -0.8166666666666665, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 649.4416666666689, "reward_accuracy_sum_min": 628.3333333333354, "reward_accuracy_sum_max": 660.8333333333355, "reward_sla_sum_mean": -4.052666666666666, "reward_sla_sum_min": -10.533333333333333, "reward_sla_sum_max": -1.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1783.0, "global_timestep_min": 100, "global_timestep_max": 3400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1024.4411404550879, 1030.5803466447364, 1026.1583508483372, 1007.0323768619229, 1018.6868378567744, 1012.7383045478101, 1032.3653720795658, 1039.0779828809916, 1033.301343324502, 1020.5306862834705, 1024.3042462456992, 1013.0795729385626, 1021.9175515550294, 1008.1408053854842, 1025.094401291543, 1011.6386974930723, 1033.3073502086593, 1025.623339120901, 1033.6404185323972, 1022.2128331658007, 1027.0664778092562, 1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26136684545754213, "mean_inference_ms": 2.182040018439902, "mean_action_processing_ms": 0.09665987394614202, "mean_env_wait_ms": 1.9065187099427932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139444351196289, "StateBufferConnector_ms": 0.004088640213012695, "ViewRequirementAgentConnector_ms": 0.10413503646850586}, "num_episodes": 21, "episode_return_max": 1042.9761125833888, "episode_return_min": 984.5350147735254, "episode_return_mean": 1022.962752931861, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220800, "num_agent_steps_trained": 220550, "num_env_steps_sampled": 220800, "num_env_steps_trained": 220550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.1650543103865, "num_env_steps_trained_throughput_per_sec": 214.93481880135727, "timesteps_total": 220800, "num_env_steps_sampled_lifetime": 220800, "num_agent_steps_sampled_lifetime": 220800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 220800, "timers": {"training_iteration_time_ms": 10338.621, "restore_workers_time_ms": 0.014, "training_step_time_ms": 706.705, "sample_time_ms": 691.485, "synch_weights_time_ms": 13.774}, "counters": {"num_env_steps_sampled": 220800, "num_env_steps_trained": 220550, "num_agent_steps_sampled": 220800, "num_agent_steps_trained": 220550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1472, "num_samples_added_to_queue": 220550}, "done": false, "training_iteration": 99, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-25", "timestamp": 1728775825, "time_this_iter_s": 10.245661973953247, "time_total_s": 1022.746958732605, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef56f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1022.746958732605, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.76, "ram_util_percent": 62.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 195637.4375, "policy_loss": 161778.34375, "entropy": 4.7816667556762695, "entropy_coeff": 0.01, "var_gnorm": 16.69868278503418, "vf_loss": 3388539.0, "vf_explained_var": 0.0973096489906311}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 405.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 223050, "num_env_steps_trained": 222750, "num_agent_steps_sampled": 223050, "num_agent_steps_trained": 222750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1487, "num_samples_added_to_queue": 222750, "learner_queue": {"size_count": 405, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.275, "learner_load_time_ms": 0.506, "learner_load_wait_time_ms": 2598.105, "learner_dequeue_time_ms": 22753.558}}, "env_runners": {"episode_reward_max": 1042.9761125833888, "episode_reward_min": 984.5350147735254, "episode_reward_mean": 1023.3273817356625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 984.5350147735254}, "policy_reward_max": {"default_policy": 1042.9761125833888}, "policy_reward_mean": {"default_policy": 1023.3273817356625}, "custom_metrics": {"num_consolidated_mean": 2.8421999999999996, "num_consolidated_min": 2.73, "num_consolidated_max": 2.94, "num_overloaded_mean": 0.0045000000000000005, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.5312000000000003, "num_moves_min": 1.14, "num_moves_max": 2.02, "mean_accuracy_mean": 42.26147000000001, "mean_accuracy_min": 42.202000000000005, "mean_accuracy_max": 42.32233333333335, "num_model_switches_mean": 0.3258, "num_model_switches_min": 0.14, "num_model_switches_max": 0.5, "num_slav_mean": 0.0010580000000000001, "num_slav_min": 0.00025, "num_slav_max": 0.0030666666666666663, "cpu_conserved_cost_mean": 7.388800000000001, "cpu_conserved_cost_min": 6.92, "cpu_conserved_cost_max": 7.76, "mean_cluster_cpu_util_mean": 0.5037776801942909, "mean_cluster_cpu_util_min": 0.49382339354660787, "mean_cluster_cpu_util_max": 0.510912259836367, "mean_cluster_mem_util_mean": 0.328234645316671, "mean_cluster_mem_util_min": 0.32175988924050636, "mean_cluster_mem_util_max": 0.3326170886075948, "reward_consolidation_mean_mean": 3.7825904840232725, "reward_consolidation_mean_min": 3.6553501477352337, "reward_consolidation_mean_max": 3.8825308416339213, "reward_illegal_mean_mean": -0.0075, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.499750000000021, "reward_accuracy_mean_min": 6.2833333333333545, "reward_accuracy_mean_max": 6.608333333333356, "reward_sla_mean_mean": -0.04156666666666666, "reward_sla_mean_min": -0.10533333333333333, "reward_sla_mean_max": -0.01, "reward_consolidation_sum_mean": 378.25904840232727, "reward_consolidation_sum_min": 365.53501477352336, "reward_consolidation_sum_max": 388.25308416339215, "reward_illegal_sum_mean": -0.7499999999999999, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 649.9750000000022, "reward_accuracy_sum_min": 628.3333333333354, "reward_accuracy_sum_max": 660.8333333333355, "reward_sla_sum_mean": -4.156666666666667, "reward_sla_sum_min": -10.533333333333333, "reward_sla_sum_max": -1.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2483.0, "global_timestep_min": 800, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1016.678491577571, 1023.8062688476674, 1024.1446921928796, 1033.3148009381969, 1031.453215145148, 1037.3272167900352, 1032.3473361966571, 1013.7722592829534, 1009.2415882299204, 1028.5966340735342, 1033.1349568978665, 1020.7837186633785, 1020.4889883944095, 1015.936571324136, 1026.0747083371425, 1039.1799902525229, 1025.9326114106452, 1029.7937951201704, 1028.7046330987866, 1042.9761125833888, 1005.6352950135577, 1031.6425690700316, 1025.9705321514534, 1035.2278869292415, 1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26162580732130747, "mean_inference_ms": 2.1847543934974003, "mean_action_processing_ms": 0.09675309113019413, "mean_env_wait_ms": 1.9083811067767023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065343379974365234, "StateBufferConnector_ms": 0.0039730072021484375, "ViewRequirementAgentConnector_ms": 0.10262918472290039}, "num_episodes": 21, "episode_return_max": 1042.9761125833888, "episode_return_min": 984.5350147735254, "episode_return_mean": 1023.3273817356625, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223050, "num_agent_steps_trained": 222750, "num_env_steps_sampled": 223050, "num_env_steps_trained": 222750, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.31169683196603, "num_env_steps_trained_throughput_per_sec": 208.5714369023668, "timesteps_total": 223050, "num_env_steps_sampled_lifetime": 223050, "num_agent_steps_sampled_lifetime": 223050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 223050, "timers": {"training_iteration_time_ms": 10365.067, "restore_workers_time_ms": 0.013, "training_step_time_ms": 698.086, "sample_time_ms": 682.695, "synch_weights_time_ms": 13.726}, "counters": {"num_env_steps_sampled": 223050, "num_env_steps_trained": 222750, "num_agent_steps_sampled": 223050, "num_agent_steps_trained": 222750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1487, "num_samples_added_to_queue": 222750}, "done": false, "training_iteration": 100, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-36", "timestamp": 1728775836, "time_this_iter_s": 10.563691854476929, "time_total_s": 1033.310650587082, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0b7c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1033.310650587082, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.600000000000005, "ram_util_percent": 61.680000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 191563.546875, "policy_loss": 153698.328125, "entropy": 4.48308801651001, "entropy_coeff": 0.01, "var_gnorm": 16.718059539794922, "vf_loss": 3788987.0, "vf_explained_var": 0.09886723756790161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 409.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 225300, "num_env_steps_trained": 224950, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 224950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1502, "num_samples_added_to_queue": 224950, "learner_queue": {"size_count": 409, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.846, "learner_load_time_ms": 0.458, "learner_load_wait_time_ms": 2501.089, "learner_dequeue_time_ms": 22421.895}}, "env_runners": {"episode_reward_max": 1041.553084163394, "episode_reward_min": 984.5350147735254, "episode_reward_mean": 1025.0420876359337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 984.5350147735254}, "policy_reward_max": {"default_policy": 1041.553084163394}, "policy_reward_mean": {"default_policy": 1025.0420876359337}, "custom_metrics": {"num_consolidated_mean": 2.8417000000000003, "num_consolidated_min": 2.73, "num_consolidated_max": 2.94, "num_overloaded_mean": 0.0039000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 1.4210999999999998, "num_moves_min": 0.96, "num_moves_max": 2.02, "mean_accuracy_mean": 42.26666333333335, "mean_accuracy_min": 42.202000000000005, "mean_accuracy_max": 42.32866666666668, "num_model_switches_mean": 0.3076, "num_model_switches_min": 0.12, "num_model_switches_max": 0.48, "num_slav_mean": 0.0009756666666666668, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0030666666666666663, "cpu_conserved_cost_mean": 7.384000000000001, "cpu_conserved_cost_min": 6.92, "cpu_conserved_cost_max": 7.76, "mean_cluster_cpu_util_mean": 0.503841494325489, "mean_cluster_cpu_util_min": 0.49382339354660787, "mean_cluster_cpu_util_max": 0.510912259836367, "mean_cluster_mem_util_mean": 0.3281351987481702, "mean_cluster_mem_util_min": 0.32175988924050636, "mean_cluster_mem_util_max": 0.3326170886075948, "reward_consolidation_mean_mean": 3.784937543025982, "reward_consolidation_mean_min": 3.6553501477352337, "reward_consolidation_mean_max": 3.8825308416339213, "reward_illegal_mean_mean": -0.006499999999999999, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.510583333333354, "reward_accuracy_mean_min": 6.2833333333333545, "reward_accuracy_mean_max": 6.616666666666688, "reward_sla_mean_mean": -0.038599999999999995, "reward_sla_mean_min": -0.10533333333333333, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 378.4937543025983, "reward_consolidation_sum_min": 365.53501477352336, "reward_consolidation_sum_max": 388.25308416339215, "reward_illegal_sum_mean": -0.65, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 651.0583333333354, "reward_accuracy_sum_min": 628.3333333333354, "reward_accuracy_sum_max": 661.6666666666688, "reward_sla_sum_mean": -3.8599999999999994, "reward_sla_sum_min": -10.533333333333333, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3275.0, "global_timestep_min": 1500, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1011.7135520424035, 1020.8620670748443, 1023.6911023789955, 1029.845441530356, 1023.3278716988049, 1012.0747418441036, 1016.5512869718865, 1027.6155746443708, 1019.685250845291, 1021.7224100642748, 1013.503204483842, 1014.1303237990821, 1029.1892229431317, 984.5350147735254, 1029.5338054768672, 1032.028943921535, 1030.4589143744877, 1013.2560114532902, 1013.5971336318523, 1019.0448688659436, 1028.3882329647586, 1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26169322641628395, "mean_inference_ms": 2.18223935985597, "mean_action_processing_ms": 0.09676660942653202, "mean_env_wait_ms": 1.9084113835741803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00631403923034668, "StateBufferConnector_ms": 0.0038406848907470703, "ViewRequirementAgentConnector_ms": 0.09922385215759277}, "num_episodes": 24, "episode_return_max": 1041.553084163394, "episode_return_min": 984.5350147735254, "episode_return_mean": 1025.0420876359337, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 224950, "num_env_steps_sampled": 225300, "num_env_steps_trained": 224950, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 215.70064360598914, "num_env_steps_trained_throughput_per_sec": 210.90729597030048, "timesteps_total": 225300, "num_env_steps_sampled_lifetime": 225300, "num_agent_steps_sampled_lifetime": 225300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 225300, "timers": {"training_iteration_time_ms": 10352.954, "restore_workers_time_ms": 0.015, "training_step_time_ms": 707.18, "sample_time_ms": 689.581, "synch_weights_time_ms": 16.165}, "counters": {"num_env_steps_sampled": 225300, "num_env_steps_trained": 224950, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 224950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1502, "num_samples_added_to_queue": 224950}, "done": false, "training_iteration": 101, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-46", "timestamp": 1728775846, "time_this_iter_s": 10.442684412002563, "time_total_s": 1043.7533349990845, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611965c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1043.7533349990845, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.040000000000003, "ram_util_percent": 61.779999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 163747.265625, "policy_loss": 128907.03125, "entropy": 4.22277307510376, "entropy_coeff": 0.01, "var_gnorm": 16.73810577392578, "vf_loss": 3486346.0, "vf_explained_var": 0.10566776990890503}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 227550, "num_env_steps_trained": 227150, "num_agent_steps_sampled": 227550, "num_agent_steps_trained": 227150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1517, "num_samples_added_to_queue": 227150, "learner_queue": {"size_count": 413, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.915, "learner_load_time_ms": 0.458, "learner_load_wait_time_ms": 2538.176, "learner_dequeue_time_ms": 22421.895}}, "env_runners": {"episode_reward_max": 1047.327006610011, "episode_reward_min": 996.8042218770013, "episode_reward_mean": 1028.715038624389, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 996.8042218770013}, "policy_reward_max": {"default_policy": 1047.327006610011}, "policy_reward_mean": {"default_policy": 1028.715038624389}, "custom_metrics": {"num_consolidated_mean": 2.8460999999999994, "num_consolidated_min": 2.73, "num_consolidated_max": 2.94, "num_overloaded_mean": 0.0027, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.3056999999999999, "num_moves_min": 0.84, "num_moves_max": 1.79, "mean_accuracy_mean": 42.279393333333346, "mean_accuracy_min": 42.20833333333335, "mean_accuracy_max": 42.34766666666668, "num_model_switches_mean": 0.2706, "num_model_switches_min": 0.06, "num_model_switches_max": 0.48, "num_slav_mean": 0.0009381666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0030666666666666663, "cpu_conserved_cost_mean": 7.398800000000001, "cpu_conserved_cost_min": 6.92, "cpu_conserved_cost_max": 7.76, "mean_cluster_cpu_util_mean": 0.504419073032679, "mean_cluster_cpu_util_min": 0.49382339354660787, "mean_cluster_cpu_util_max": 0.5112627148832507, "mean_cluster_mem_util_mean": 0.328316748929002, "mean_cluster_mem_util_min": 0.32175988924050636, "mean_cluster_mem_util_max": 0.3326170886075948, "reward_consolidation_mean_mean": 3.793897052910536, "reward_consolidation_mean_min": 3.6861109080386245, "reward_consolidation_mean_max": 3.8825308416339213, "reward_illegal_mean_mean": -0.0045000000000000005, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.5348333333333555, "reward_accuracy_mean_min": 6.341666666666686, "reward_accuracy_mean_max": 6.641666666666688, "reward_sla_mean_mean": -0.03708, "reward_sla_mean_min": -0.10533333333333333, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 379.3897052910536, "reward_consolidation_sum_min": 368.61109080386245, "reward_consolidation_sum_max": 388.25308416339215, "reward_illegal_sum_mean": -0.45, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 653.4833333333355, "reward_accuracy_sum_min": 634.1666666666687, "reward_accuracy_sum_max": 664.1666666666688, "reward_sla_sum_mean": -3.708, "reward_sla_sum_min": -10.533333333333333, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3969.0, "global_timestep_min": 2100, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1018.4112035090944, 1016.7587072405515, 1027.612930640594, 1009.9756526242061, 1019.7298790703364, 1025.782280910173, 1018.3194523135055, 1019.2216211276638, 996.8042218770013, 1031.96225288617, 1029.520323494473, 1020.9638002985188, 1011.7187425751642, 1019.6397636236275, 1025.7549544609965, 1029.636370282374, 1016.8321362210262, 1014.4356666362074, 1027.5758140668336, 1004.6670809345414, 1025.5908038624411, 1032.3781930610153, 1015.198778518994, 1030.5616223460984, 1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2617331166758239, "mean_inference_ms": 2.1815201021191415, "mean_action_processing_ms": 0.0967780674430993, "mean_env_wait_ms": 1.9086074436662048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060329437255859375, "StateBufferConnector_ms": 0.003696441650390625, "ViewRequirementAgentConnector_ms": 0.09538650512695312}, "num_episodes": 21, "episode_return_max": 1047.327006610011, "episode_return_min": 996.8042218770013, "episode_return_mean": 1028.715038624389, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227550, "num_agent_steps_trained": 227150, "num_env_steps_sampled": 227550, "num_env_steps_trained": 227150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 210.62292865639475, "num_env_steps_trained_throughput_per_sec": 205.9424191306971, "timesteps_total": 227550, "num_env_steps_sampled_lifetime": 227550, "num_agent_steps_sampled_lifetime": 227550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 227550, "timers": {"training_iteration_time_ms": 10395.19, "restore_workers_time_ms": 0.015, "training_step_time_ms": 717.722, "sample_time_ms": 701.567, "synch_weights_time_ms": 14.531}, "counters": {"num_env_steps_sampled": 227550, "num_env_steps_trained": 227150, "num_agent_steps_sampled": 227550, "num_agent_steps_trained": 227150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1517, "num_samples_added_to_queue": 227150}, "done": false, "training_iteration": 102, "trial_id": "90ffb_00000", "date": "2024-10-13_00-30-57", "timestamp": 1728775857, "time_this_iter_s": 10.695350170135498, "time_total_s": 1054.44868516922, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5510>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1054.44868516922, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 16.926666666666666, "ram_util_percent": 61.87999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 128224.9765625, "policy_loss": 97486.671875, "entropy": 3.920520305633545, "entropy_coeff": 0.01, "var_gnorm": 16.759803771972656, "vf_loss": 3075986.5, "vf_explained_var": 0.1184433102607727}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 417.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 229800, "num_env_steps_trained": 229350, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1532, "num_samples_added_to_queue": 229350, "learner_queue": {"size_count": 417, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.179, "learner_load_time_ms": 0.405, "learner_load_wait_time_ms": 2480.712, "learner_dequeue_time_ms": 22173.045}}, "env_runners": {"episode_reward_max": 1048.7840689634183, "episode_reward_min": 998.4110908038635, "episode_reward_mean": 1033.9387004782375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 998.4110908038635}, "policy_reward_max": {"default_policy": 1048.7840689634183}, "policy_reward_mean": {"default_policy": 1033.9387004782375}, "custom_metrics": {"num_consolidated_mean": 2.8549000000000007, "num_consolidated_min": 2.73, "num_consolidated_max": 2.94, "num_overloaded_mean": 0.0012, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.1667, "num_moves_min": 0.76, "num_moves_max": 1.68, "mean_accuracy_mean": 42.29750666666668, "mean_accuracy_min": 42.21466666666669, "mean_accuracy_max": 42.35400000000001, "num_model_switches_mean": 0.2164, "num_model_switches_min": 0.04, "num_model_switches_max": 0.46, "num_slav_mean": 0.0008668333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0030666666666666663, "cpu_conserved_cost_mean": 7.4302, "cpu_conserved_cost_min": 6.92, "cpu_conserved_cost_max": 7.76, "mean_cluster_cpu_util_mean": 0.5052545742351643, "mean_cluster_cpu_util_min": 0.49382339354660787, "mean_cluster_cpu_util_max": 0.5114424181834896, "mean_cluster_mem_util_mean": 0.32868647800417633, "mean_cluster_mem_util_min": 0.32175988924050636, "mean_cluster_mem_util_max": 0.3326170886075948, "reward_consolidation_mean_mean": 3.8077836714490236, "reward_consolidation_mean_min": 3.6861109080386245, "reward_consolidation_mean_max": 3.8825308416339213, "reward_illegal_mean_mean": -0.002, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.5679166666666875, "reward_accuracy_mean_min": 6.3833333333333515, "reward_accuracy_mean_max": 6.650000000000023, "reward_sla_mean_mean": -0.03431333333333333, "reward_sla_mean_min": -0.09133333333333335, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 380.77836714490235, "reward_consolidation_sum_min": 368.61109080386245, "reward_consolidation_sum_max": 388.25308416339215, "reward_illegal_sum_mean": -0.2, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 656.7916666666689, "reward_accuracy_sum_min": 638.3333333333352, "reward_accuracy_sum_max": 665.0000000000023, "reward_sla_sum_mean": -3.431333333333334, "reward_sla_sum_min": -9.133333333333335, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4771.0, "global_timestep_min": 2800, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1040.673782326604, 1031.2704438149217, 1026.440634804596, 1028.709720064579, 1028.9503274543865, 1003.1196198483071, 1025.4757257303017, 1031.8201133144496, 1027.130323799082, 1025.7740656127228, 1030.757808644798, 998.4110908038635, 1020.9579548569881, 1036.4557281671716, 1028.8657924396136, 1018.3591702458211, 1041.553084163394, 1020.7064637972549, 1014.391891315607, 1030.6682110329307, 1025.351527612783, 1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2618484010795585, "mean_inference_ms": 2.1837276297218, "mean_action_processing_ms": 0.09682445957545163, "mean_env_wait_ms": 1.909704953430869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005952358245849609, "StateBufferConnector_ms": 0.0036153793334960938, "ViewRequirementAgentConnector_ms": 0.09360885620117188}, "num_episodes": 24, "episode_return_max": 1048.7840689634183, "episode_return_min": 998.4110908038635, "episode_return_mean": 1033.9387004782375, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229350, "num_env_steps_sampled": 229800, "num_env_steps_trained": 229350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 216.60768045974928, "num_env_steps_trained_throughput_per_sec": 211.7941764495326, "timesteps_total": 229800, "num_env_steps_sampled_lifetime": 229800, "num_agent_steps_sampled_lifetime": 229800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 229800, "timers": {"training_iteration_time_ms": 10375.028, "restore_workers_time_ms": 0.016, "training_step_time_ms": 690.609, "sample_time_ms": 676.557, "synch_weights_time_ms": 12.746}, "counters": {"num_env_steps_sampled": 229800, "num_env_steps_trained": 229350, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1532, "num_samples_added_to_queue": 229350}, "done": false, "training_iteration": 103, "trial_id": "90ffb_00000", "date": "2024-10-13_00-31-08", "timestamp": 1728775868, "time_this_iter_s": 10.400415897369385, "time_total_s": 1064.8491010665894, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef54b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1064.8491010665894, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 16.966666666666665, "ram_util_percent": 62.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 122705.3671875, "policy_loss": 88238.234375, "entropy": 3.6679909229278564, "entropy_coeff": 0.01, "var_gnorm": 16.783674240112305, "vf_loss": 3448730.5, "vf_explained_var": 0.12087863683700562}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 421.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 232050, "num_env_steps_trained": 231550, "num_agent_steps_sampled": 232050, "num_agent_steps_trained": 231550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1547, "num_samples_added_to_queue": 231550, "learner_queue": {"size_count": 421, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.063, "learner_load_time_ms": 0.405, "learner_load_wait_time_ms": 2543.983, "learner_dequeue_time_ms": 22173.045}}, "env_runners": {"episode_reward_max": 1054.4168357245137, "episode_reward_min": 1011.21612903226, "episode_reward_mean": 1038.5907452861818, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1011.21612903226}, "policy_reward_max": {"default_policy": 1054.4168357245137}, "policy_reward_mean": {"default_policy": 1038.5907452861818}, "custom_metrics": {"num_consolidated_mean": 2.8718, "num_consolidated_min": 2.73, "num_consolidated_max": 2.98, "num_overloaded_mean": 0.0005, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.0407, "num_moves_min": 0.7, "num_moves_max": 1.48, "mean_accuracy_mean": 42.31353000000002, "mean_accuracy_min": 42.22733333333335, "mean_accuracy_max": 42.35400000000001, "num_model_switches_mean": 0.16689999999999994, "num_model_switches_min": 0.04, "num_model_switches_max": 0.46, "num_slav_mean": 0.0008086666666666665, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0030666666666666663, "cpu_conserved_cost_mean": 7.4952000000000005, "cpu_conserved_cost_min": 6.92, "cpu_conserved_cost_max": 7.92, "mean_cluster_cpu_util_mean": 0.5067862904987439, "mean_cluster_cpu_util_min": 0.49382339354660787, "mean_cluster_cpu_util_max": 0.517596792264203, "mean_cluster_mem_util_mean": 0.32951331168195125, "mean_cluster_mem_util_min": 0.32175988924050636, "mean_cluster_mem_util_max": 0.33507383966244725, "reward_consolidation_mean_mean": 3.8253107861951317, "reward_consolidation_mean_min": 3.7056241432879466, "reward_consolidation_mean_max": 3.9238350239117854, "reward_illegal_mean_mean": -0.0008333333333333334, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.593416666666688, "reward_accuracy_mean_min": 6.483333333333353, "reward_accuracy_mean_max": 6.650000000000023, "reward_sla_mean_mean": -0.03198666666666666, "reward_sla_mean_min": -0.09133333333333335, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 382.53107861951327, "reward_consolidation_sum_min": 370.56241432879466, "reward_consolidation_sum_max": 392.3835023911785, "reward_illegal_sum_mean": -0.08333333333333331, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 659.3416666666687, "reward_accuracy_sum_min": 648.3333333333353, "reward_accuracy_sum_max": 665.0000000000023, "reward_sla_sum_mean": -3.198666666666666, "reward_sla_sum_min": -9.133333333333335, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5471.0, "global_timestep_min": 3500, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1028.1352097231124, 1038.9384659904376, 1020.7957476621303, 1023.4613908434633, 1026.2583508483372, 1011.21612903226, 1031.2052453623348, 1026.262527034027, 1027.8979012458517, 1026.751625087577, 1029.582838344149, 1034.3145816199117, 1029.8328703280656, 1036.9361083188664, 1037.7549300922985, 1036.3639617411457, 1035.7511255292593, 1040.2313290078914, 1034.9855950531567, 1032.4995918243037, 1040.482795698927, 1033.442191355206, 1014.9814005909427, 1026.0502939474263, 1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26185473231789014, "mean_inference_ms": 2.183931544521223, "mean_action_processing_ms": 0.09683764014262787, "mean_env_wait_ms": 1.9099509064527445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005952596664428711, "StateBufferConnector_ms": 0.0035886764526367188, "ViewRequirementAgentConnector_ms": 0.09223723411560059}, "num_episodes": 21, "episode_return_max": 1054.4168357245137, "episode_return_min": 1011.21612903226, "episode_return_mean": 1038.5907452861818, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232050, "num_agent_steps_trained": 231550, "num_env_steps_sampled": 232050, "num_env_steps_trained": 231550, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.82755530218896, "num_env_steps_trained_throughput_per_sec": 209.0758318510292, "timesteps_total": 232050, "num_env_steps_sampled_lifetime": 232050, "num_agent_steps_sampled_lifetime": 232050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 232050, "timers": {"training_iteration_time_ms": 10389.832, "restore_workers_time_ms": 0.013, "training_step_time_ms": 695.536, "sample_time_ms": 680.225, "synch_weights_time_ms": 13.933}, "counters": {"num_env_steps_sampled": 232050, "num_env_steps_trained": 231550, "num_agent_steps_sampled": 232050, "num_agent_steps_trained": 231550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1547, "num_samples_added_to_queue": 231550}, "done": false, "training_iteration": 104, "trial_id": "90ffb_00000", "date": "2024-10-13_00-31-18", "timestamp": 1728775878, "time_this_iter_s": 10.539861917495728, "time_total_s": 1075.388962984085, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419a200>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1075.388962984085, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.126666666666665, "ram_util_percent": 62.08666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 105280.703125, "policy_loss": 75511.859375, "entropy": 3.5059008598327637, "entropy_coeff": 0.01, "var_gnorm": 16.808792114257812, "vf_loss": 2978812.75, "vf_explained_var": 0.1246025562286377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 425.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 234300, "num_env_steps_trained": 233750, "num_agent_steps_sampled": 234300, "num_agent_steps_trained": 233750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1562, "num_samples_added_to_queue": 234300, "learner_queue": {"size_count": 425, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.443, "learner_load_time_ms": 0.384, "learner_load_wait_time_ms": 2444.444, "learner_dequeue_time_ms": 22151.793}}, "env_runners": {"episode_reward_max": 1054.4168357245137, "episode_reward_min": 1026.3543817965842, "episode_reward_mean": 1043.3372435956035, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1026.3543817965842}, "policy_reward_max": {"default_policy": 1054.4168357245137}, "policy_reward_mean": {"default_policy": 1043.3372435956035}, "custom_metrics": {"num_consolidated_mean": 2.8973, "num_consolidated_min": 2.77, "num_consolidated_max": 2.98, "num_overloaded_mean": 0.0003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.9292999999999998, "num_moves_min": 0.59, "num_moves_max": 1.29, "mean_accuracy_mean": 42.32999666666669, "mean_accuracy_min": 42.271666666666675, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 0.11630000000000003, "num_model_switches_min": 0.02, "num_model_switches_max": 0.3, "num_slav_mean": 0.0007688333333333335, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.002183333333333333, "cpu_conserved_cost_mean": 7.594600000000001, "cpu_conserved_cost_min": 7.08, "cpu_conserved_cost_max": 7.92, "mean_cluster_cpu_util_mean": 0.5089795748547004, "mean_cluster_cpu_util_min": 0.4981498954311455, "mean_cluster_cpu_util_max": 0.517596792264203, "mean_cluster_mem_util_mean": 0.33078585340781885, "mean_cluster_mem_util_min": 0.32397481540084394, "mean_cluster_mem_util_max": 0.33507383966244725, "reward_consolidation_mean_mean": 3.8481057692893477, "reward_consolidation_mean_min": 3.741877151299156, "reward_consolidation_mean_max": 3.9238350239117854, "reward_illegal_mean_mean": -0.0005, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.616500000000022, "reward_accuracy_mean_min": 6.516666666666688, "reward_accuracy_mean_max": 6.658333333333355, "reward_sla_mean_mean": -0.030733333333333338, "reward_sla_mean_min": -0.08733333333333335, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 384.8105769289348, "reward_consolidation_sum_min": 374.1877151299156, "reward_consolidation_sum_max": 392.3835023911785, "reward_illegal_sum_mean": -0.05, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 661.6500000000021, "reward_accuracy_sum_min": 651.6666666666688, "reward_accuracy_sum_max": 665.8333333333355, "reward_sla_sum_mean": -3.0733333333333333, "reward_sla_sum_min": -8.733333333333334, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6032.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1026.3543817965842, 1035.7437448597295, 1039.8931097505272, 1031.4195467422123, 1031.0566480855362, 1040.541609552532, 1030.4356970970812, 1037.0708550367074, 1033.1427213743966, 1034.7675348015491, 1028.492512717416, 1047.327006610011, 1038.5430229370395, 1036.992448749583, 1033.189804745806, 1035.7316031557484, 1042.8659447439786, 1039.3289408754476, 1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2618884635871898, "mean_inference_ms": 2.1843561370260844, "mean_action_processing_ms": 0.09685720790829005, "mean_env_wait_ms": 1.9103792360196126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00603485107421875, "StateBufferConnector_ms": 0.0036776065826416016, "ViewRequirementAgentConnector_ms": 0.09349894523620605}, "num_episodes": 24, "episode_return_max": 1054.4168357245137, "episode_return_min": 1026.3543817965842, "episode_return_mean": 1043.3372435956035, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234300, "num_agent_steps_trained": 233750, "num_env_steps_sampled": 234300, "num_env_steps_trained": 233750, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 214.23398994229962, "num_env_steps_trained_throughput_per_sec": 209.4732346102485, "timesteps_total": 234300, "num_env_steps_sampled_lifetime": 234300, "num_agent_steps_sampled_lifetime": 234300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 234300, "timers": {"training_iteration_time_ms": 10406.217, "restore_workers_time_ms": 0.013, "training_step_time_ms": 699.381, "sample_time_ms": 684.167, "synch_weights_time_ms": 13.806}, "counters": {"num_env_steps_sampled": 234300, "num_env_steps_trained": 233750, "num_agent_steps_sampled": 234300, "num_agent_steps_trained": 233750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1562, "num_samples_added_to_queue": 234300}, "done": false, "training_iteration": 105, "trial_id": "90ffb_00000", "date": "2024-10-13_00-31-29", "timestamp": 1728775889, "time_this_iter_s": 10.513593435287476, "time_total_s": 1085.9025564193726, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6a40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1085.9025564193726, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.493333333333332, "ram_util_percent": 61.30666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 89143.9765625, "policy_loss": 62065.328125, "entropy": 3.245318651199341, "entropy_coeff": 0.01, "var_gnorm": 16.836872100830078, "vf_loss": 2709649.5, "vf_explained_var": 0.14339178800582886}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 429.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 236250, "num_env_steps_trained": 235950, "num_agent_steps_sampled": 236250, "num_agent_steps_trained": 235950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1575, "num_samples_added_to_queue": 235950, "learner_queue": {"size_count": 429, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.594, "learner_load_time_ms": 0.384, "learner_load_wait_time_ms": 2548.056, "learner_dequeue_time_ms": 22151.793}}, "env_runners": {"episode_reward_max": 1056.949712144752, "episode_reward_min": 1029.8833683633393, "episode_reward_mean": 1046.2989832465219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1029.8833683633393}, "policy_reward_max": {"default_policy": 1056.949712144752}, "policy_reward_mean": {"default_policy": 1046.2989832465219}, "custom_metrics": {"num_consolidated_mean": 2.9141000000000004, "num_consolidated_min": 2.78, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.8497999999999998, "num_moves_min": 0.45, "num_moves_max": 1.2, "mean_accuracy_mean": 42.33911666666668, "mean_accuracy_min": 42.28433333333335, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.08939999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.25, "num_slav_mean": 0.0007173333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0016166666666666664, "cpu_conserved_cost_mean": 7.660799999999999, "cpu_conserved_cost_min": 7.14, "cpu_conserved_cost_max": 7.96, "mean_cluster_cpu_util_mean": 0.5104188372778709, "mean_cluster_cpu_util_min": 0.499269819632271, "mean_cluster_cpu_util_max": 0.517596792264203, "mean_cluster_mem_util_mean": 0.3316405367207009, "mean_cluster_mem_util_min": 0.32504179852320675, "mean_cluster_mem_util_max": 0.335524789029536, "reward_consolidation_mean_mean": 3.8629331657985313, "reward_consolidation_mean_min": 3.746309360626276, "reward_consolidation_mean_max": 3.9271637881141674, "reward_illegal_mean_mean": -0.0003333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.629083333333353, "reward_accuracy_mean_min": 6.541666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02869333333333333, "reward_sla_mean_min": -0.06466666666666666, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 386.2933165798532, "reward_consolidation_sum_min": 374.6309360626276, "reward_consolidation_sum_max": 392.71637881141675, "reward_illegal_sum_mean": -0.03333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 662.9083333333355, "reward_accuracy_sum_min": 654.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.8693333333333335, "reward_sla_sum_min": -6.466666666666667, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5231.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1036.2858265557913, 1040.1987115050738, 1032.0779981114276, 1036.9119772152687, 1044.7767065704127, 1043.2472600444748, 1032.0030765481756, 1035.282125559721, 1030.3642693959628, 1038.0689512321444, 1033.9716927107147, 1040.4024064089695, 1035.987788236013, 1042.970008224438, 1031.3668159249464, 1039.5301684486294, 1044.7636632245903, 1044.4855463157592, 1043.2573882847505, 1041.92129824241, 1045.4723293429608, 1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26187235777363593, "mean_inference_ms": 2.1830662355270567, "mean_action_processing_ms": 0.09686015046850044, "mean_env_wait_ms": 1.9102124820187436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006239652633666992, "StateBufferConnector_ms": 0.0037994384765625, "ViewRequirementAgentConnector_ms": 0.09675097465515137}, "num_episodes": 18, "episode_return_max": 1056.949712144752, "episode_return_min": 1029.8833683633393, "episode_return_mean": 1046.2989832465219, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236250, "num_agent_steps_trained": 235950, "num_env_steps_sampled": 236250, "num_env_steps_trained": 235950, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 181.63630046488976, "num_env_steps_trained_throughput_per_sec": 204.92300565269613, "timesteps_total": 236250, "num_env_steps_sampled_lifetime": 236250, "num_agent_steps_sampled_lifetime": 236250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 236250, "timers": {"training_iteration_time_ms": 10461.859, "restore_workers_time_ms": 0.015, "training_step_time_ms": 875.179, "sample_time_ms": 855.661, "synch_weights_time_ms": 17.976}, "counters": {"num_env_steps_sampled": 236250, "num_env_steps_trained": 235950, "num_agent_steps_sampled": 236250, "num_agent_steps_trained": 235950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1575, "num_samples_added_to_queue": 235950}, "done": false, "training_iteration": 106, "trial_id": "90ffb_00000", "date": "2024-10-13_00-31-39", "timestamp": 1728775899, "time_this_iter_s": 10.762534618377686, "time_total_s": 1096.6650910377502, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e0beb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.6650910377502, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 23.72666666666667, "ram_util_percent": 62.40666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 82634.7109375, "policy_loss": 50157.703125, "entropy": 2.9943830966949463, "entropy_coeff": 0.01, "var_gnorm": 16.86817741394043, "vf_loss": 3249347.5, "vf_explained_var": 0.15316122770309448}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 238350, "num_env_steps_trained": 238150, "num_agent_steps_sampled": 238350, "num_agent_steps_trained": 238150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1589, "num_samples_added_to_queue": 238150, "learner_queue": {"size_count": 433, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.827, "learner_load_time_ms": 0.365, "learner_load_wait_time_ms": 2755.197, "learner_dequeue_time_ms": 22238.227}}, "env_runners": {"episode_reward_max": 1058.2385451887071, "episode_reward_min": 1029.8833683633393, "episode_reward_mean": 1049.384243961134, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1029.8833683633393}, "policy_reward_max": {"default_policy": 1058.2385451887071}, "policy_reward_mean": {"default_policy": 1049.384243961134}, "custom_metrics": {"num_consolidated_mean": 2.9362000000000013, "num_consolidated_min": 2.83, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.7473000000000001, "num_moves_min": 0.34, "num_moves_max": 1.14, "mean_accuracy_mean": 42.347160000000024, "mean_accuracy_min": 42.29700000000002, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.06340000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.2, "num_slav_mean": 0.0007116666666666665, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0016166666666666664, "cpu_conserved_cost_mean": 7.747999999999998, "cpu_conserved_cost_min": 7.32, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.512243613684171, "mean_cluster_cpu_util_min": 0.5030449071520501, "mean_cluster_cpu_util_max": 0.517596792264203, "mean_cluster_mem_util_mean": 0.33275039665676404, "mean_cluster_mem_util_min": 0.32712710970464143, "mean_cluster_mem_util_max": 0.33581645569620255, "reward_consolidation_mean_mean": 3.8821424396113198, "reward_consolidation_mean_min": 3.793035425995309, "reward_consolidation_mean_max": 3.9343854518870502, "reward_illegal_mean_mean": -0.00016666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.640333333333355, "reward_accuracy_mean_min": 6.541666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02846666666666667, "reward_sla_mean_min": -0.06466666666666666, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 388.21424396113184, "reward_consolidation_sum_min": 379.3035425995309, "reward_consolidation_sum_max": 393.438545188705, "reward_illegal_sum_mean": -0.016666666666666666, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 664.0333333333355, "reward_accuracy_sum_min": 654.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.8466666666666667, "reward_sla_sum_min": -6.466666666666667, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4286.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1047.2199183648622, 1042.7960827317327, 1038.6368759328661, 1045.7309665235023, 1043.4023729020093, 1040.8327149776135, 1029.8833683633393, 1048.7840689634183, 1036.310710042952, 1044.2436504310235, 1045.8568795881713, 1043.1885863108862, 1045.2261597977415, 1045.4767248469361, 1042.7586767796788, 1037.3034634012633, 1049.0681775259704, 1044.2011636053512, 1049.027238112646, 1046.358420908345, 1043.2457461390866, 1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2619484286738077, "mean_inference_ms": 2.1826883865596374, "mean_action_processing_ms": 0.09688744844378959, "mean_env_wait_ms": 1.91064314711431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006321907043457031, "StateBufferConnector_ms": 0.003838777542114258, "ViewRequirementAgentConnector_ms": 0.09782528877258301}, "num_episodes": 21, "episode_return_max": 1058.2385451887071, "episode_return_min": 1029.8833683633393, "episode_return_mean": 1049.384243961134, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238350, "num_agent_steps_trained": 238150, "num_env_steps_sampled": 238350, "num_env_steps_trained": 238150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 196.9626734999238, "num_env_steps_trained_throughput_per_sec": 206.3418484284916, "timesteps_total": 238350, "num_env_steps_sampled_lifetime": 238350, "num_agent_steps_sampled_lifetime": 238350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 238350, "timers": {"training_iteration_time_ms": 10501.263, "restore_workers_time_ms": 0.016, "training_step_time_ms": 773.559, "sample_time_ms": 755.302, "synch_weights_time_ms": 16.773}, "counters": {"num_env_steps_sampled": 238350, "num_env_steps_trained": 238150, "num_agent_steps_sampled": 238350, "num_agent_steps_trained": 238150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1589, "num_samples_added_to_queue": 238150}, "done": false, "training_iteration": 107, "trial_id": "90ffb_00000", "date": "2024-10-13_00-31-50", "timestamp": 1728775910, "time_this_iter_s": 10.675520896911621, "time_total_s": 1107.3406119346619, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0a050>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1107.3406119346619, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 20.4875, "ram_util_percent": 64.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 80318.5546875, "policy_loss": 48435.88671875, "entropy": 2.8330159187316895, "entropy_coeff": 0.01, "var_gnorm": 16.894163131713867, "vf_loss": 3189825.0, "vf_explained_var": 0.1503688097000122}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 436.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 240450, "num_env_steps_trained": 239800, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 239800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1603, "num_samples_added_to_queue": 240350, "learner_queue": {"size_count": 436, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.785, "learner_load_time_ms": 0.365, "learner_load_wait_time_ms": 2846.702, "learner_dequeue_time_ms": 22238.227}}, "env_runners": {"episode_reward_max": 1058.2385451887071, "episode_reward_min": 1043.3580888848298, "episode_reward_mean": 1051.7053390599797, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1043.3580888848298}, "policy_reward_max": {"default_policy": 1058.2385451887071}, "policy_reward_mean": {"default_policy": 1051.7053390599797}, "custom_metrics": {"num_consolidated_mean": 2.9537000000000004, "num_consolidated_min": 2.9, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.6298999999999999, "num_moves_min": 0.28, "num_moves_max": 0.93, "mean_accuracy_mean": 42.35305000000001, "mean_accuracy_min": 42.32233333333335, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0452, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0007264999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0016166666666666664, "cpu_conserved_cost_mean": 7.816399999999999, "cpu_conserved_cost_min": 7.6, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5135978115515392, "mean_cluster_cpu_util_min": 0.5088554163219343, "mean_cluster_cpu_util_max": 0.5178463441119692, "mean_cluster_mem_util_mean": 0.3336023525628606, "mean_cluster_mem_util_min": 0.33067220464135016, "mean_cluster_mem_util_max": 0.33606065400843876, "reward_consolidation_mean_mean": 3.8973633905997747, "reward_consolidation_mean_min": 3.8513235249322237, "reward_consolidation_mean_max": 3.9365251759115414, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.648750000000023, "reward_accuracy_mean_min": 6.608333333333356, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.029060000000000006, "reward_sla_mean_min": -0.06466666666666666, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 389.7363390599774, "reward_consolidation_sum_min": 385.13235249322236, "reward_consolidation_sum_max": 393.65251759115415, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 664.8750000000023, "reward_accuracy_sum_min": 660.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.906, "reward_sla_sum_min": -6.466666666666667, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3361.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1045.2180389289977, 1050.161460903471, 1043.8990191598914, 1046.7998507417244, 1046.5038715769615, 1048.7309177861057, 1049.151762161506, 1046.9400042645245, 1050.8569770629647, 1054.4168357245137, 1043.3580888848298, 1046.0983825276455, 1049.121465777211, 1047.6196685857037, 1052.1404307167466, 1048.1304395503998, 1052.0600018276546, 1045.4593499649723, 1045.9746047701747, 1053.1190624143312, 1047.4864327271641, 1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26220026067107743, "mean_inference_ms": 2.187319185599134, "mean_action_processing_ms": 0.09699182463097732, "mean_env_wait_ms": 1.9127401372718476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00639033317565918, "StateBufferConnector_ms": 0.0038805007934570312, "ViewRequirementAgentConnector_ms": 0.09886503219604492}, "num_episodes": 21, "episode_return_max": 1058.2385451887071, "episode_return_min": 1043.3580888848298, "episode_return_mean": 1051.7053390599797, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 239800, "num_env_steps_sampled": 240450, "num_env_steps_trained": 239800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 200.82984225418204, "num_env_steps_trained_throughput_per_sec": 157.7948760568573, "timesteps_total": 240450, "num_env_steps_sampled_lifetime": 240450, "num_agent_steps_sampled_lifetime": 240450, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 240450, "timers": {"training_iteration_time_ms": 10516.418, "restore_workers_time_ms": 0.014, "training_step_time_ms": 739.946, "sample_time_ms": 723.025, "synch_weights_time_ms": 15.231}, "counters": {"num_env_steps_sampled": 240450, "num_env_steps_trained": 239800, "num_agent_steps_sampled": 240450, "num_agent_steps_trained": 239800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1603, "num_samples_added_to_queue": 240350}, "done": false, "training_iteration": 108, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-01", "timestamp": 1728775921, "time_this_iter_s": 10.46922755241394, "time_total_s": 1117.8098394870758, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e34280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1117.8098394870758, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 19.166666666666668, "ram_util_percent": 64.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 63371.53125, "policy_loss": 32506.494140625, "entropy": 2.68455171585083, "entropy_coeff": 0.01, "var_gnorm": 16.931140899658203, "vf_loss": 3087980.25, "vf_explained_var": 0.17097866535186768}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 440.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 242550, "num_env_steps_trained": 242000, "num_agent_steps_sampled": 242550, "num_agent_steps_trained": 242000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1617, "num_samples_added_to_queue": 242550, "learner_queue": {"size_count": 440, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.611, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2636.46, "learner_dequeue_time_ms": 22235.344}}, "env_runners": {"episode_reward_max": 1058.2385451887071, "episode_reward_min": 1045.368862895613, "episode_reward_mean": 1053.1493049742626, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1045.368862895613}, "policy_reward_max": {"default_policy": 1058.2385451887071}, "policy_reward_mean": {"default_policy": 1053.1493049742626}, "custom_metrics": {"num_consolidated_mean": 2.9650000000000007, "num_consolidated_min": 2.91, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5164000000000001, "num_moves_min": 0.15, "num_moves_max": 0.92, "mean_accuracy_mean": 42.356216666666676, "mean_accuracy_min": 42.335000000000015, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.035, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0007078333333333332, "num_slav_min": 0.0002, "num_slav_max": 0.0016, "cpu_conserved_cost_mean": 7.861599999999998, "cpu_conserved_cost_min": 7.64, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5144899815493695, "mean_cluster_cpu_util_min": 0.5096566246509807, "mean_cluster_cpu_util_max": 0.5179012226512227, "mean_cluster_mem_util_mean": 0.3341705263497804, "mean_cluster_mem_util_min": 0.33141191983122376, "mean_cluster_mem_util_max": 0.33606065400843876, "reward_consolidation_mean_mean": 3.9068897164092715, "reward_consolidation_mean_min": 3.8586233208443748, "reward_consolidation_mean_max": 3.938061774650462, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.652916666666687, "reward_accuracy_mean_min": 6.625000000000021, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02831333333333333, "reward_sla_mean_min": -0.064, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 390.68897164092726, "reward_consolidation_sum_min": 385.86233208443747, "reward_consolidation_sum_max": 393.8061774650462, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 665.2916666666689, "reward_accuracy_sum_min": 662.5000000000022, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.8313333333333333, "reward_sla_sum_min": -6.3999999999999995, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2423.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1050.9545980687826, 1047.237923786898, 1051.8300953425344, 1049.7599926893924, 1048.918547625577, 1048.617307868045, 1050.783334856379, 1048.2149349660383, 1053.2858905236249, 1045.368862895613, 1051.0360443510335, 1050.8112431082293, 1053.1071369825481, 1050.1187974047355, 1049.5384142069536, 1049.2915196929564, 1052.545164336412, 1052.2608638703607, 1051.0019129428274, 1050.900703646169, 1050.6366657528429, 1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2624083970195912, "mean_inference_ms": 2.1891889509204874, "mean_action_processing_ms": 0.09706879155155139, "mean_env_wait_ms": 1.9141226127007354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006804943084716797, "StateBufferConnector_ms": 0.003918886184692383, "ViewRequirementAgentConnector_ms": 0.10012054443359375}, "num_episodes": 21, "episode_return_max": 1058.2385451887071, "episode_return_min": 1045.368862895613, "episode_return_mean": 1053.1493049742626, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242550, "num_agent_steps_trained": 242000, "num_env_steps_sampled": 242550, "num_env_steps_trained": 242000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.61760522604226, "num_env_steps_trained_throughput_per_sec": 209.12320547490143, "timesteps_total": 242550, "num_env_steps_sampled_lifetime": 242550, "num_agent_steps_sampled_lifetime": 242550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 242550, "timers": {"training_iteration_time_ms": 10544.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 734.447, "sample_time_ms": 717.934, "synch_weights_time_ms": 15.028}, "counters": {"num_env_steps_sampled": 242550, "num_env_steps_trained": 242000, "num_agent_steps_sampled": 242550, "num_agent_steps_trained": 242000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1617, "num_samples_added_to_queue": 242550}, "done": false, "training_iteration": 109, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-11", "timestamp": 1728775931, "time_this_iter_s": 10.531264066696167, "time_total_s": 1128.341103553772, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6950>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1128.341103553772, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 19.106666666666666, "ram_util_percent": 63.92666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 55110.59375, "policy_loss": 23443.099609375, "entropy": 2.5311975479125977, "entropy_coeff": 0.01, "var_gnorm": 16.972707748413086, "vf_loss": 3168141.5, "vf_explained_var": 0.17464852333068848}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 444.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1630, "num_samples_added_to_queue": 244200, "learner_queue": {"size_count": 444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 99.606, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2632.468, "learner_dequeue_time_ms": 22235.344}}, "env_runners": {"episode_reward_max": 1058.2385451887071, "episode_reward_min": 1046.0956654177726, "episode_reward_mean": 1054.4066624021466, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1046.0956654177726}, "policy_reward_max": {"default_policy": 1058.2385451887071}, "policy_reward_mean": {"default_policy": 1054.4066624021466}, "custom_metrics": {"num_consolidated_mean": 2.9750000000000005, "num_consolidated_min": 2.91, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3979, "num_moves_min": 0.1, "num_moves_max": 0.84, "mean_accuracy_mean": 42.358940000000004, "mean_accuracy_min": 42.34133333333335, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0251, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.0006958333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 7.900999999999999, "cpu_conserved_cost_min": 7.66, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5152780368473185, "mean_cluster_cpu_util_min": 0.5096566246509807, "mean_cluster_cpu_util_max": 0.5186901113485934, "mean_cluster_mem_util_mean": 0.3346618995145527, "mean_cluster_mem_util_min": 0.33196494768793594, "mean_cluster_mem_util_max": 0.33606065400843876, "reward_consolidation_mean_mean": 3.9153999573547775, "reward_consolidation_mean_min": 3.8586233208443748, "reward_consolidation_mean_max": 3.9386443388467516, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.656500000000019, "reward_accuracy_mean_min": 6.633333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027833333333333335, "reward_sla_mean_min": -0.05866666666666667, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 391.53999573547776, "reward_consolidation_sum_min": 385.86233208443747, "reward_consolidation_sum_max": 393.8644338846752, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 665.6500000000021, "reward_accuracy_sum_min": 663.3333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7833333333333337, "reward_sla_sum_min": -5.866666666666667, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1882.0, "global_timestep_min": 200, "global_timestep_max": 3500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1053.354695543576, 1051.3102835907298, 1052.996414755249, 1054.199518718209, 1054.918093758569, 1052.1455024521022, 1046.0956654177726, 1052.7473179201336, 1051.3800207133957, 1056.0524109781006, 1049.6101130098414, 1052.733811569042, 1050.5919552834405, 1056.949712144752, 1050.5346827500098, 1051.9135307197926, 1053.078351457555, 1052.9729416065088, 1055.0418410551674, 1053.6290931798128, 1058.2385451887071, 1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26275089473135904, "mean_inference_ms": 2.1948447992202684, "mean_action_processing_ms": 0.09720949410027405, "mean_env_wait_ms": 1.916848042583448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007088899612426758, "StateBufferConnector_ms": 0.00398707389831543, "ViewRequirementAgentConnector_ms": 0.10278940200805664}, "num_episodes": 21, "episode_return_max": 1058.2385451887071, "episode_return_min": 1046.0956654177726, "episode_return_mean": 1054.4066624021466, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 182.0981319412325, "num_env_steps_trained_throughput_per_sec": 205.44404629267257, "timesteps_total": 244500, "num_env_steps_sampled_lifetime": 244500, "num_agent_steps_sampled_lifetime": 244500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 244500, "timers": {"training_iteration_time_ms": 10560.92, "restore_workers_time_ms": 0.017, "training_step_time_ms": 853.742, "sample_time_ms": 835.736, "synch_weights_time_ms": 16.388}, "counters": {"num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1630, "num_samples_added_to_queue": 244200}, "done": false, "training_iteration": 110, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-22", "timestamp": 1728775942, "time_this_iter_s": 10.722675085067749, "time_total_s": 1139.0637786388397, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e0bb20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1139.0637786388397, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 22.6, "ram_util_percent": 63.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 46058.55859375, "policy_loss": 16553.1875, "entropy": 2.382340669631958, "entropy_coeff": 0.01, "var_gnorm": 17.01858139038086, "vf_loss": 2951847.5, "vf_explained_var": 0.1818295121192932}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 246600, "num_env_steps_trained": 246400, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1644, "num_samples_added_to_queue": 246400, "learner_queue": {"size_count": 448, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.316, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2808.519, "learner_dequeue_time_ms": 22235.344}}, "env_runners": {"episode_reward_max": 1058.4474458558007, "episode_reward_min": 1049.428940875448, "episode_reward_mean": 1055.0797491242522, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1049.428940875448}, "policy_reward_max": {"default_policy": 1058.4474458558007}, "policy_reward_mean": {"default_policy": 1055.0797491242522}, "custom_metrics": {"num_consolidated_mean": 2.9813000000000005, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2939, "num_moves_min": 0.04, "num_moves_max": 0.67, "mean_accuracy_mean": 42.360206666666684, "mean_accuracy_min": 42.34133333333335, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0208, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.0006984999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 7.925999999999999, "cpu_conserved_cost_min": 7.72, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5156611797614999, "mean_cluster_cpu_util_min": 0.5114058937764294, "mean_cluster_cpu_util_max": 0.5186901113485934, "mean_cluster_mem_util_mean": 0.3349693135925257, "mean_cluster_mem_util_min": 0.3324836497890296, "mean_cluster_mem_util_max": 0.33615717299578063, "reward_consolidation_mean_mean": 3.9205708245758313, "reward_consolidation_mean_min": 3.8778080355783, "reward_consolidation_mean_max": 3.9386443388467516, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.658166666666688, "reward_accuracy_mean_min": 6.633333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02794, "reward_sla_mean_min": -0.05866666666666667, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 392.05708245758325, "reward_consolidation_sum_min": 387.78080355783, "reward_consolidation_sum_max": 393.8644338846752, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 665.8166666666689, "reward_accuracy_sum_min": 663.3333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7940000000000005, "reward_sla_sum_min": -5.866666666666667, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2575.0, "global_timestep_min": 800, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1052.6108958542777, 1051.9952694264246, 1053.9755155502778, 1051.88599713668, 1053.183078985046, 1052.9793597124508, 1052.8459867799831, 1050.8802704925542, 1051.1683937981682, 1052.9153705565225, 1052.0489932681492, 1053.2638947272249, 1054.0140820615945, 1055.2674982485019, 1056.8409790124604, 1053.0357214657793, 1055.3665478692644, 1054.3260623229478, 1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26288400083534547, "mean_inference_ms": 2.194014493457667, "mean_action_processing_ms": 0.09725548449956754, "mean_env_wait_ms": 1.917524275003521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007077932357788086, "StateBufferConnector_ms": 0.003978252410888672, "ViewRequirementAgentConnector_ms": 0.10237669944763184}, "num_episodes": 21, "episode_return_max": 1058.4474458558007, "episode_return_min": 1049.428940875448, "episode_return_mean": 1055.0797491242522, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246400, "num_env_steps_sampled": 246600, "num_env_steps_trained": 246400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 196.27205059411477, "num_env_steps_trained_throughput_per_sec": 205.61833871764406, "timesteps_total": 246600, "num_env_steps_sampled_lifetime": 246600, "num_agent_steps_sampled_lifetime": 246600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 246600, "timers": {"training_iteration_time_ms": 10587.75, "restore_workers_time_ms": 0.015, "training_step_time_ms": 765.621, "sample_time_ms": 747.512, "synch_weights_time_ms": 16.543}, "counters": {"num_env_steps_sampled": 246600, "num_env_steps_trained": 246400, "num_agent_steps_sampled": 246600, "num_agent_steps_trained": 246400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1644, "num_samples_added_to_queue": 246400}, "done": false, "training_iteration": 111, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-33", "timestamp": 1728775953, "time_this_iter_s": 10.717613458633423, "time_total_s": 1149.7813920974731, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1149.7813920974731, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 20.293333333333333, "ram_util_percent": 65.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 46757.50390625, "policy_loss": 15715.736328125, "entropy": 2.3165695667266846, "entropy_coeff": 0.01, "var_gnorm": 17.05681800842285, "vf_loss": 3105451.0, "vf_explained_var": 0.19970422983169556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 451.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 248550, "num_env_steps_trained": 248050, "num_agent_steps_sampled": 248550, "num_agent_steps_trained": 248050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1657, "num_samples_added_to_queue": 248050, "learner_queue": {"size_count": 451, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.255, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2849.712, "learner_dequeue_time_ms": 22414.914}}, "env_runners": {"episode_reward_max": 1058.8999847695654, "episode_reward_min": 1049.428940875448, "episode_reward_mean": 1055.7752633951711, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1049.428940875448}, "policy_reward_max": {"default_policy": 1058.8999847695654}, "policy_reward_mean": {"default_policy": 1055.7752633951711}, "custom_metrics": {"num_consolidated_mean": 2.9868, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.21890000000000012, "num_moves_min": 0.02, "num_moves_max": 0.48, "mean_accuracy_mean": 42.36128333333335, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.017, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006746666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.00125, "cpu_conserved_cost_mean": 7.9474, "cpu_conserved_cost_min": 7.72, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5160180420165196, "mean_cluster_cpu_util_min": 0.5114058937764294, "mean_cluster_cpu_util_max": 0.5186901113485934, "mean_cluster_mem_util_mean": 0.3352281477116163, "mean_cluster_mem_util_min": 0.3324836497890296, "mean_cluster_mem_util_max": 0.33615717299578063, "reward_consolidation_mean_mean": 3.9251559672850225, "reward_consolidation_mean_min": 3.8778080355783, "reward_consolidation_mean_max": 3.9386443388467516, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.659583333333355, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026986666666666666, "reward_sla_mean_min": -0.04999999999999999, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 392.5155967285022, "reward_consolidation_sum_min": 387.78080355783, "reward_consolidation_sum_max": 393.8644338846752, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 665.9583333333356, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.698666666666668, "reward_sla_sum_min": -4.999999999999999, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3182.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1053.631667123582, 1049.428940875448, 1053.7566541777105, 1054.1179262237677, 1054.600542203542, 1056.482116421459, 1053.954671174878, 1054.739891559294, 1056.5289957050193, 1049.547470224499, 1055.0070821529764, 1052.6304395503998, 1056.2858509244898, 1054.0202260196802, 1054.0526211581239, 1053.4303359834314, 1054.8173718358794, 1057.0197569222357, 1057.9163057053242, 1053.9945353193848, 1054.8391087148577, 1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26315868101538414, "mean_inference_ms": 2.1988728774865067, "mean_action_processing_ms": 0.09736949069636854, "mean_env_wait_ms": 1.919738979327108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007130622863769531, "StateBufferConnector_ms": 0.004031181335449219, "ViewRequirementAgentConnector_ms": 0.10365700721740723}, "num_episodes": 18, "episode_return_max": 1058.8999847695654, "episode_return_min": 1049.428940875448, "episode_return_mean": 1055.7752633951711, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248550, "num_agent_steps_trained": 248050, "num_env_steps_sampled": 248550, "num_env_steps_trained": 248050, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 194.7678093908986, "num_env_steps_trained_throughput_per_sec": 164.80353102306805, "timesteps_total": 248550, "num_env_steps_sampled_lifetime": 248550, "num_agent_steps_sampled_lifetime": 248550, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 248550, "timers": {"training_iteration_time_ms": 10520.683, "restore_workers_time_ms": 0.013, "training_step_time_ms": 775.682, "sample_time_ms": 759.96, "synch_weights_time_ms": 14.23}, "counters": {"num_env_steps_sampled": 248550, "num_env_steps_trained": 248050, "num_agent_steps_sampled": 248550, "num_agent_steps_trained": 248050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1657, "num_samples_added_to_queue": 248050}, "done": false, "training_iteration": 112, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-43", "timestamp": 1728775963, "time_this_iter_s": 10.029918193817139, "time_total_s": 1159.8113102912903, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5840>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1159.8113102912903, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 19.76, "ram_util_percent": 64.09333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 44564.1328125, "policy_loss": 16992.44140625, "entropy": 2.2775111198425293, "entropy_coeff": 0.01, "var_gnorm": 17.11310577392578, "vf_loss": 2758422.0, "vf_explained_var": 0.20725244283676147}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 250650, "num_env_steps_trained": 250250, "num_agent_steps_sampled": 250650, "num_agent_steps_trained": 250250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1671, "num_samples_added_to_queue": 250250, "learner_queue": {"size_count": 455, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.93, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2746.233, "learner_dequeue_time_ms": 22414.914}}, "env_runners": {"episode_reward_max": 1058.8999847695654, "episode_reward_min": 1052.690158091933, "episode_reward_mean": 1056.2584602333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1052.690158091933}, "policy_reward_max": {"default_policy": 1058.8999847695654}, "policy_reward_mean": {"default_policy": 1056.2584602333325}, "custom_metrics": {"num_consolidated_mean": 2.9903000000000004, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1611, "num_moves_min": 0.02, "num_moves_max": 0.38, "mean_accuracy_mean": 42.36217000000001, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0142, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006589999999999999, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.00125, "cpu_conserved_cost_mean": 7.9614, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5163229468990806, "mean_cluster_cpu_util_min": 0.513372681674021, "mean_cluster_cpu_util_max": 0.5186901113485934, "mean_cluster_mem_util_mean": 0.3354131806757513, "mean_cluster_mem_util_min": 0.3338802742616033, "mean_cluster_mem_util_max": 0.33615717299578063, "reward_consolidation_mean_mean": 3.9281946023333028, "reward_consolidation_mean_min": 3.9009164153644638, "reward_consolidation_mean_max": 3.9397368180572054, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.660750000000021, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02636, "reward_sla_mean_min": -0.04999999999999999, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 392.81946023333023, "reward_consolidation_sum_min": 390.0916415364464, "reward_consolidation_sum_max": 393.97368180572056, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.0750000000022, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.636000000000001, "reward_sla_sum_min": -4.999999999999999, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3882.0, "global_timestep_min": 2200, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.9728441317147, 1054.1533248042908, 1053.3605897225036, 1056.0869536080927, 1057.612903225809, 1058.1545737000843, 1054.3249748697815, 1055.5351000639698, 1055.2368759328663, 1057.120804776267, 1052.690158091933, 1055.5002193182877, 1053.1619117243915, 1052.8192817326167, 1057.3988729477005, 1054.4754272137461, 1054.6414237412066, 1056.642301014349, 1052.9210728319492, 1053.4851655548464, 1055.448243930674, 1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2633836951834912, "mean_inference_ms": 2.2010421760855348, "mean_action_processing_ms": 0.09745591944475315, "mean_env_wait_ms": 1.921348817522946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007104158401489258, "StateBufferConnector_ms": 0.0040683746337890625, "ViewRequirementAgentConnector_ms": 0.1039271354675293}, "num_episodes": 21, "episode_return_max": 1058.8999847695654, "episode_return_min": 1052.690158091933, "episode_return_mean": 1056.2584602333325, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250650, "num_agent_steps_trained": 250250, "num_env_steps_sampled": 250650, "num_env_steps_trained": 250250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.7609320212974, "num_env_steps_trained_throughput_per_sec": 209.2733573556449, "timesteps_total": 250650, "num_env_steps_sampled_lifetime": 250650, "num_agent_steps_sampled_lifetime": 250650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 250650, "timers": {"training_iteration_time_ms": 10533.195, "restore_workers_time_ms": 0.013, "training_step_time_ms": 751.719, "sample_time_ms": 736.467, "synch_weights_time_ms": 13.846}, "counters": {"num_env_steps_sampled": 250650, "num_env_steps_trained": 250250, "num_agent_steps_sampled": 250650, "num_agent_steps_trained": 250250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1671, "num_samples_added_to_queue": 250250}, "done": false, "training_iteration": 113, "trial_id": "90ffb_00000", "date": "2024-10-13_00-32-53", "timestamp": 1728775973, "time_this_iter_s": 10.524272918701172, "time_total_s": 1170.3355832099915, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef092d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1170.3355832099915, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 19.720000000000002, "ram_util_percent": 64.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 35518.33203125, "policy_loss": 8463.765625, "entropy": 2.276961088180542, "entropy_coeff": 0.01, "var_gnorm": 17.171125411987305, "vf_loss": 2706709.0, "vf_explained_var": 0.2260250449180603}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 459.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 252750, "num_env_steps_trained": 252450, "num_agent_steps_sampled": 252750, "num_agent_steps_trained": 252450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1685, "num_samples_added_to_queue": 252450, "learner_queue": {"size_count": 459, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.531, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 2659.106, "learner_dequeue_time_ms": 22223.775}}, "env_runners": {"episode_reward_max": 1059.431868165344, "episode_reward_min": 1052.9846751347916, "episode_reward_mean": 1056.7147363916072, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1052.9846751347916}, "policy_reward_max": {"default_policy": 1059.431868165344}, "policy_reward_mean": {"default_policy": 1056.7147363916072}, "custom_metrics": {"num_consolidated_mean": 2.9930000000000008, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11959999999999998, "num_moves_min": 0.02, "num_moves_max": 0.37, "mean_accuracy_mean": 42.36369000000001, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.009399999999999999, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006589999999999999, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.00125, "cpu_conserved_cost_mean": 7.972, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5166352946888214, "mean_cluster_cpu_util_min": 0.5135757348547528, "mean_cluster_cpu_util_max": 0.5186901113485934, "mean_cluster_mem_util_mean": 0.3355803111814346, "mean_cluster_mem_util_min": 0.33410443037974685, "mean_cluster_mem_util_max": 0.33623628691983126, "reward_consolidation_mean_mean": 3.9307573639160496, "reward_consolidation_mean_min": 3.9063322062810317, "reward_consolidation_mean_max": 3.9397368180572054, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.662750000000024, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02636, "reward_sla_mean_min": -0.04999999999999999, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.0757363916049, "reward_consolidation_sum_min": 390.6332206281032, "reward_consolidation_sum_max": 393.97368180572056, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.2750000000024, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6359999999999997, "reward_sla_sum_min": -4.999999999999999, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4582.0, "global_timestep_min": 2900, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.7490237290226, 1056.7606201833762, 1056.431070090471, 1056.905266684945, 1057.3731030491354, 1056.555234701029, 1057.5920679886706, 1055.8140637850704, 1057.4761826433967, 1055.8445277041662, 1057.4638794967884, 1055.4311005513443, 1056.560775533829, 1057.6973407657886, 1056.0412044229208, 1054.2213134728468, 1055.9972859362165, 1057.4694416521997, 1054.6387858296043, 1056.2476956349597, 1057.23199610101, 1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2636063149940769, "mean_inference_ms": 2.2032736651048257, "mean_action_processing_ms": 0.09754102774401466, "mean_env_wait_ms": 1.9229510890753978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067861080169677734, "StateBufferConnector_ms": 0.004091739654541016, "ViewRequirementAgentConnector_ms": 0.10494375228881836}, "num_episodes": 21, "episode_return_max": 1059.431868165344, "episode_return_min": 1052.9846751347916, "episode_return_mean": 1056.7147363916072, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252750, "num_agent_steps_trained": 252450, "num_env_steps_sampled": 252750, "num_env_steps_trained": 252450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 195.37042430287465, "num_env_steps_trained_throughput_per_sec": 204.67377784110678, "timesteps_total": 252750, "num_env_steps_sampled_lifetime": 252750, "num_agent_steps_sampled_lifetime": 252750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 252750, "timers": {"training_iteration_time_ms": 10555.826, "restore_workers_time_ms": 0.019, "training_step_time_ms": 774.685, "sample_time_ms": 756.513, "synch_weights_time_ms": 16.464}, "counters": {"num_env_steps_sampled": 252750, "num_env_steps_trained": 252450, "num_agent_steps_sampled": 252750, "num_agent_steps_trained": 252450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1685, "num_samples_added_to_queue": 252450}, "done": false, "training_iteration": 114, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-04", "timestamp": 1728775984, "time_this_iter_s": 10.759943962097168, "time_total_s": 1181.0955271720886, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e0a470>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1181.0955271720886, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 19.626666666666665, "ram_util_percent": 64.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 33842.3203125, "policy_loss": 8531.365234375, "entropy": 2.260321855545044, "entropy_coeff": 0.01, "var_gnorm": 17.218887329101562, "vf_loss": 2532339.0, "vf_explained_var": 0.24242299795150757}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 462.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 254700, "num_env_steps_trained": 254100, "num_agent_steps_sampled": 254700, "num_agent_steps_trained": 254100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1698, "num_samples_added_to_queue": 254650, "learner_queue": {"size_count": 462, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.01, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 2753.936, "learner_dequeue_time_ms": 22223.775}}, "env_runners": {"episode_reward_max": 1059.431868165344, "episode_reward_min": 1052.9846751347916, "episode_reward_mean": 1056.8998854975805, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1052.9846751347916}, "policy_reward_max": {"default_policy": 1059.431868165344}, "policy_reward_mean": {"default_policy": 1056.8998854975805}, "custom_metrics": {"num_consolidated_mean": 2.9945000000000004, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0956, "num_moves_min": 0.0, "num_moves_max": 0.24, "mean_accuracy_mean": 42.36432333333335, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0074, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006639999999999999, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.00125, "cpu_conserved_cost_mean": 7.978, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5167320151337562, "mean_cluster_cpu_util_min": 0.5135757348547528, "mean_cluster_cpu_util_max": 0.5186351810994668, "mean_cluster_mem_util_mean": 0.3356599578059071, "mean_cluster_mem_util_min": 0.33410443037974685, "mean_cluster_mem_util_max": 0.33623628691983126, "reward_consolidation_mean_mean": 3.9319755216424492, "reward_consolidation_mean_min": 3.9063322062810317, "reward_consolidation_mean_max": 3.939950653385726, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.663583333333357, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02656, "reward_sla_mean_min": -0.04999999999999999, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.19755216424505, "reward_consolidation_sum_min": 390.6332206281032, "reward_consolidation_sum_max": 393.9950653385726, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.3583333333356, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6560000000000006, "reward_sla_sum_min": -4.999999999999999, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5282.0, "global_timestep_min": 3600, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1055.5131286362687, 1057.8138871120068, 1055.7247250906232, 1058.0725699838579, 1057.1348655152476, 1056.0408754454927, 1055.3060982667787, 1054.1397392549295, 1058.4474458558007, 1056.1490024064112, 1057.0817630753322, 1055.5869627463546, 1053.8332206281057, 1055.0836516494585, 1052.9846751347916, 1056.4591123701628, 1054.2142435042208, 1056.8873587377034, 1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2638077731440169, "mean_inference_ms": 2.2051513520312835, "mean_action_processing_ms": 0.09761630805751148, "mean_env_wait_ms": 1.924344528827661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006641864776611328, "StateBufferConnector_ms": 0.004011631011962891, "ViewRequirementAgentConnector_ms": 0.10298299789428711}, "num_episodes": 21, "episode_return_max": 1059.431868165344, "episode_return_min": 1052.9846751347916, "episode_return_mean": 1056.8998854975805, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254700, "num_agent_steps_trained": 254100, "num_env_steps_sampled": 254700, "num_env_steps_trained": 254100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 194.39401571367864, "num_env_steps_trained_throughput_per_sec": 164.48724406542038, "timesteps_total": 254700, "num_env_steps_sampled_lifetime": 254700, "num_agent_steps_sampled_lifetime": 254700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 254700, "timers": {"training_iteration_time_ms": 10508.69, "restore_workers_time_ms": 0.015, "training_step_time_ms": 769.723, "sample_time_ms": 750.848, "synch_weights_time_ms": 17.253}, "counters": {"num_env_steps_sampled": 254700, "num_env_steps_trained": 254100, "num_agent_steps_sampled": 254700, "num_agent_steps_trained": 254100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1698, "num_samples_added_to_queue": 254650}, "done": false, "training_iteration": 115, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-14", "timestamp": 1728775994, "time_this_iter_s": 10.046177864074707, "time_total_s": 1191.1417050361633, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e37ca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1191.1417050361633, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.685714285714283, "ram_util_percent": 64.49285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 33187.015625, "policy_loss": 9905.9677734375, "entropy": 2.2482528686523438, "entropy_coeff": 0.01, "var_gnorm": 17.286104202270508, "vf_loss": 2329341.5, "vf_explained_var": 0.24834144115447998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 466.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 256650, "num_env_steps_trained": 256300, "num_agent_steps_sampled": 256650, "num_agent_steps_trained": 256300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1711, "num_samples_added_to_queue": 256300, "learner_queue": {"size_count": 466, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.911, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2820.143, "learner_dequeue_time_ms": 22215.408}}, "env_runners": {"episode_reward_max": 1059.431868165344, "episode_reward_min": 1053.502872460327, "episode_reward_mean": 1057.1621598586635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1053.502872460327}, "policy_reward_max": {"default_policy": 1059.431868165344}, "policy_reward_mean": {"default_policy": 1057.1621598586635}, "custom_metrics": {"num_consolidated_mean": 2.9964, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0834, "num_moves_min": 0.0, "num_moves_max": 0.2, "mean_accuracy_mean": 42.365020000000015, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0052, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006623333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012000000000000001, "cpu_conserved_cost_mean": 7.985600000000001, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169037966250689, "mean_cluster_cpu_util_min": 0.5146969657795551, "mean_cluster_cpu_util_max": 0.51884323864681, "mean_cluster_mem_util_mean": 0.3357577215189873, "mean_cluster_mem_util_min": 0.33416350210970464, "mean_cluster_mem_util_max": 0.3362594936708861, "reward_consolidation_mean_mean": 3.9336149319199496, "reward_consolidation_mean_min": 3.911142739650918, "reward_consolidation_mean_max": 3.9406963355569773, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.664500000000023, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02649333333333334, "reward_sla_mean_min": -0.04800000000000001, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.3614931919949, "reward_consolidation_sum_min": 391.1142739650918, "reward_consolidation_sum_max": 394.06963355569775, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.4500000000023, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.649333333333333, "reward_sla_sum_min": -4.800000000000001, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5883.0, "global_timestep_min": 4200, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.8501568734982, 1057.1565262420445, 1057.7328185445815, 1056.558411770084, 1056.862606232297, 1057.7244022053694, 1056.2285783910584, 1058.6301410338444, 1058.1098540924208, 1055.8841420695137, 1054.4669438606134, 1055.5577355387024, 1056.735432087486, 1056.6266776325829, 1057.743510311008, 1057.5986475372404, 1057.3167412958076, 1058.3221907459892, 1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2640432950104818, "mean_inference_ms": 2.2085794573568376, "mean_action_processing_ms": 0.0977085954903571, "mean_env_wait_ms": 1.9262072560632029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006649494171142578, "StateBufferConnector_ms": 0.004052400588989258, "ViewRequirementAgentConnector_ms": 0.10361623764038086}, "num_episodes": 18, "episode_return_max": 1059.431868165344, "episode_return_min": 1053.502872460327, "episode_return_mean": 1057.1621598586635, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256650, "num_agent_steps_trained": 256300, "num_env_steps_sampled": 256650, "num_env_steps_trained": 256300, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 185.19329098338903, "num_env_steps_trained_throughput_per_sec": 208.93602059664406, "timesteps_total": 256650, "num_env_steps_sampled_lifetime": 256650, "num_agent_steps_sampled_lifetime": 256650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 256650, "timers": {"training_iteration_time_ms": 10488.07, "restore_workers_time_ms": 0.015, "training_step_time_ms": 769.762, "sample_time_ms": 752.529, "synch_weights_time_ms": 15.596}, "counters": {"num_env_steps_sampled": 256650, "num_env_steps_trained": 256300, "num_agent_steps_sampled": 256650, "num_agent_steps_trained": 256300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1711, "num_samples_added_to_queue": 256300}, "done": false, "training_iteration": 116, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-25", "timestamp": 1728776005, "time_this_iter_s": 10.541504144668579, "time_total_s": 1201.683209180832, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575ef0a290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1201.683209180832, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 24.0375, "ram_util_percent": 64.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 28121.70703125, "policy_loss": 6192.37109375, "entropy": 2.2516303062438965, "entropy_coeff": 0.01, "var_gnorm": 17.336849212646484, "vf_loss": 2194172.0, "vf_explained_var": 0.2865777015686035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 469.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 258450, "num_env_steps_trained": 257950, "num_agent_steps_sampled": 258450, "num_agent_steps_trained": 257950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1723, "num_samples_added_to_queue": 257950, "learner_queue": {"size_count": 469, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.019, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 2905.738, "learner_dequeue_time_ms": 22215.408}}, "env_runners": {"episode_reward_max": 1059.431868165344, "episode_reward_min": 1053.502872460327, "episode_reward_mean": 1057.2068159858684, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1053.502872460327}, "policy_reward_max": {"default_policy": 1059.431868165344}, "policy_reward_mean": {"default_policy": 1057.2068159858684}, "custom_metrics": {"num_consolidated_mean": 2.9968, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08220000000000001, "num_moves_min": 0.0, "num_moves_max": 0.2, "mean_accuracy_mean": 42.36527333333334, "mean_accuracy_min": 42.34766666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.005600000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.0006705000000000001, "num_slav_min": 0.0002, "num_slav_max": 0.0012, "cpu_conserved_cost_mean": 7.9872000000000005, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169765577599283, "mean_cluster_cpu_util_min": 0.5146969657795551, "mean_cluster_cpu_util_max": 0.51884323864681, "mean_cluster_mem_util_mean": 0.33577976793248937, "mean_cluster_mem_util_min": 0.33416350210970464, "mean_cluster_mem_util_max": 0.3362594936708861, "reward_consolidation_mean_mean": 3.934054826525328, "reward_consolidation_mean_min": 3.911142739650918, "reward_consolidation_mean_max": 3.9406963355569773, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.664833333333355, "reward_accuracy_mean_min": 6.641666666666688, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026820000000000004, "reward_sla_mean_min": -0.04800000000000001, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.4054826525328, "reward_consolidation_sum_min": 391.1142739650918, "reward_consolidation_sum_max": 394.06963355569775, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.4833333333355, "reward_accuracy_sum_min": 664.1666666666688, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.682, "reward_sla_sum_min": -4.800000000000001, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5781.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.8999847695654, 1057.8311249200422, 1058.1988729477014, 1057.4444941972058, 1055.6539126991397, 1054.4957385238683, 1058.8742148710005, 1058.0791495324277, 1053.502872460327, 1054.954735142711, 1058.2335282829222, 1057.456008407203, 1056.4311249200425, 1056.6454780834035, 1057.9736818057222, 1055.9673215754383, 1055.5552347010287, 1057.0762801181902, 1056.3520576319743, 1054.514273965094, 1057.5727161960485, 1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2642432010079063, "mean_inference_ms": 2.2106848491642865, "mean_action_processing_ms": 0.09778648233668463, "mean_env_wait_ms": 1.9277165785124175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066127777099609375, "StateBufferConnector_ms": 0.0040283203125, "ViewRequirementAgentConnector_ms": 0.10274076461791992}, "num_episodes": 18, "episode_return_max": 1059.431868165344, "episode_return_min": 1053.502872460327, "episode_return_mean": 1057.2068159858684, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258450, "num_agent_steps_trained": 257950, "num_env_steps_sampled": 258450, "num_env_steps_trained": 257950, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 179.1088847197165, "num_env_steps_trained_throughput_per_sec": 164.18314432640682, "timesteps_total": 258450, "num_env_steps_sampled_lifetime": 258450, "num_agent_steps_sampled_lifetime": 258450, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 258450, "timers": {"training_iteration_time_ms": 10426.853, "restore_workers_time_ms": 0.018, "training_step_time_ms": 865.815, "sample_time_ms": 847.334, "synch_weights_time_ms": 16.884}, "counters": {"num_env_steps_sampled": 258450, "num_env_steps_trained": 257950, "num_agent_steps_sampled": 258450, "num_agent_steps_trained": 257950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1723, "num_samples_added_to_queue": 257950}, "done": false, "training_iteration": 117, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-35", "timestamp": 1728776015, "time_this_iter_s": 10.063590049743652, "time_total_s": 1211.7467992305756, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761194dc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1211.7467992305756, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 25.46428571428571, "ram_util_percent": 65.13571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 28126.712890625, "policy_loss": 9575.8818359375, "entropy": 2.235278844833374, "entropy_coeff": 0.01, "var_gnorm": 17.40745735168457, "vf_loss": 1856312.5, "vf_explained_var": 0.29270023107528687}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 260400, "num_env_steps_trained": 260150, "num_agent_steps_sampled": 260400, "num_agent_steps_trained": 260150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1736, "num_samples_added_to_queue": 260150, "learner_queue": {"size_count": 473, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.171, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2963.939, "learner_dequeue_time_ms": 22342.444}}, "env_runners": {"episode_reward_max": 1059.4548965853382, "episode_reward_min": 1054.9710865393424, "episode_reward_mean": 1057.408911572088, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.9710865393424}, "policy_reward_max": {"default_policy": 1059.4548965853382}, "policy_reward_mean": {"default_policy": 1057.408911572088}, "custom_metrics": {"num_consolidated_mean": 2.9983000000000004, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08120000000000001, "num_moves_min": 0.0, "num_moves_max": 0.17, "mean_accuracy_mean": 42.36597000000002, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0034000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006686666666666665, "num_slav_min": 0.0002, "num_slav_max": 0.0010666666666666667, "cpu_conserved_cost_mean": 7.993199999999999, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169937803077312, "mean_cluster_cpu_util_min": 0.5148288977753264, "mean_cluster_cpu_util_max": 0.51884323864681, "mean_cluster_mem_util_mean": 0.33585271097046415, "mean_cluster_mem_util_min": 0.3343623417721519, "mean_cluster_mem_util_max": 0.3362594936708861, "reward_consolidation_mean_mean": 3.935085782387523, "reward_consolidation_mean_min": 3.912710865393403, "reward_consolidation_mean_max": 3.9406963355569773, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.665750000000023, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02674666666666667, "reward_sla_mean_min": -0.04266666666666667, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.5085782387523, "reward_consolidation_sum_min": 391.2710865393403, "reward_consolidation_sum_max": 394.06963355569775, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.5750000000023, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.674666666666667, "reward_sla_sum_min": -4.2666666666666675, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4843.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.3093728106267, 1057.35402540437, 1058.7111760943094, 1056.5669895519225, 1058.0683785677315, 1059.431868165344, 1056.1625879557728, 1056.3609430686306, 1058.2069024338257, 1057.1163057053236, 1056.9044686100729, 1057.4372536476917, 1057.62515763502, 1054.9710865393424, 1056.9592738127897, 1059.3995187182088, 1055.4259496177176, 1057.7180937585692, 1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26451204798251127, "mean_inference_ms": 2.2133775091154417, "mean_action_processing_ms": 0.09788289650733935, "mean_env_wait_ms": 1.9296255747163782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065038204193115234, "StateBufferConnector_ms": 0.0039632320404052734, "ViewRequirementAgentConnector_ms": 0.10169243812561035}, "num_episodes": 21, "episode_return_max": 1059.4548965853382, "episode_return_min": 1054.9710865393424, "episode_return_mean": 1057.408911572088, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260400, "num_agent_steps_trained": 260150, "num_env_steps_sampled": 260400, "num_env_steps_trained": 260150, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 186.5578250160922, "num_env_steps_trained_throughput_per_sec": 210.4754948899502, "timesteps_total": 260400, "num_env_steps_sampled_lifetime": 260400, "num_agent_steps_sampled_lifetime": 260400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 260400, "timers": {"training_iteration_time_ms": 10426.444, "restore_workers_time_ms": 0.02, "training_step_time_ms": 819.695, "sample_time_ms": 800.148, "synch_weights_time_ms": 17.47}, "counters": {"num_env_steps_sampled": 260400, "num_env_steps_trained": 260150, "num_agent_steps_sampled": 260400, "num_agent_steps_trained": 260150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1736, "num_samples_added_to_queue": 260150}, "done": false, "training_iteration": 118, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-46", "timestamp": 1728776026, "time_this_iter_s": 10.465172052383423, "time_total_s": 1222.211971282959, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419abc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1222.211971282959, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 25.253333333333334, "ram_util_percent": 66.13999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 27802.24609375, "policy_loss": 9601.623046875, "entropy": 2.262953281402588, "entropy_coeff": 0.01, "var_gnorm": 17.4610538482666, "vf_loss": 1821307.0, "vf_explained_var": 0.3389308452606201}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 476.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 262350, "num_env_steps_trained": 261800, "num_agent_steps_sampled": 262350, "num_agent_steps_trained": 261800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1749, "num_samples_added_to_queue": 262350, "learner_queue": {"size_count": 476, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.389, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2929.79, "learner_dequeue_time_ms": 22342.444}}, "env_runners": {"episode_reward_max": 1059.4548965853382, "episode_reward_min": 1054.5761369520867, "episode_reward_mean": 1057.4472930031397, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.5761369520867}, "policy_reward_max": {"default_policy": 1059.4548965853382}, "policy_reward_mean": {"default_policy": 1057.4472930031397}, "custom_metrics": {"num_consolidated_mean": 2.9990000000000006, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08639999999999999, "num_moves_min": 0.0, "num_moves_max": 0.26, "mean_accuracy_mean": 42.366160000000015, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0028000000000000004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.000678, "num_slav_min": 0.0002, "num_slav_max": 0.0013333333333333333, "cpu_conserved_cost_mean": 7.996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170173339825795, "mean_cluster_cpu_util_min": 0.5148288977753264, "mean_cluster_cpu_util_max": 0.5189628838021695, "mean_cluster_mem_util_mean": 0.3358710073839663, "mean_cluster_mem_util_min": 0.33516350210970464, "mean_cluster_mem_util_max": 0.3362594936708861, "reward_consolidation_mean_mean": 3.9355929300313743, "reward_consolidation_mean_min": 3.9258931127966132, "reward_consolidation_mean_max": 3.9409540345426297, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666000000000022, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02712, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.5592930031375, "reward_consolidation_sum_min": 392.58931127966133, "reward_consolidation_sum_max": 394.09540345426296, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6000000000023, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7120000000000006, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4034.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.9194005300214, 1057.7346248743513, 1056.7758140668336, 1056.5208200067038, 1056.3895366901238, 1056.8965274604795, 1056.4710378019454, 1058.8226750738695, 1057.505242316247, 1057.9503000396012, 1057.2857290809973, 1057.9716592037548, 1059.2112583386663, 1055.9297572268442, 1057.529915623384, 1057.0985652928832, 1057.1817478448954, 1057.9738767553101, 1057.8866977367597, 1055.7631301593124, 1057.2793993115868, 1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26475006522275063, "mean_inference_ms": 2.2146318230475983, "mean_action_processing_ms": 0.09795451461459645, "mean_env_wait_ms": 1.9312255254593447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006548881530761719, "StateBufferConnector_ms": 0.004027605056762695, "ViewRequirementAgentConnector_ms": 0.10346865653991699}, "num_episodes": 18, "episode_return_max": 1059.4548965853382, "episode_return_min": 1054.5761369520867, "episode_return_mean": 1057.4472930031397, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262350, "num_agent_steps_trained": 261800, "num_env_steps_sampled": 262350, "num_env_steps_trained": 261800, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 178.86776206728618, "num_env_steps_trained_throughput_per_sec": 151.34964482616522, "timesteps_total": 262350, "num_env_steps_sampled_lifetime": 262350, "num_agent_steps_sampled_lifetime": 262350, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 262350, "timers": {"training_iteration_time_ms": 10464.624, "restore_workers_time_ms": 0.017, "training_step_time_ms": 880.563, "sample_time_ms": 860.362, "synch_weights_time_ms": 18.174}, "counters": {"num_env_steps_sampled": 262350, "num_env_steps_trained": 261800, "num_agent_steps_sampled": 262350, "num_agent_steps_trained": 261800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1749, "num_samples_added_to_queue": 262350}, "done": false, "training_iteration": 119, "trial_id": "90ffb_00000", "date": "2024-10-13_00-33-56", "timestamp": 1728776036, "time_this_iter_s": 10.925740242004395, "time_total_s": 1233.1377115249634, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761196b30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1233.1377115249634, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 27.12666666666667, "ram_util_percent": 66.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 25440.923828125, "policy_loss": 10665.51171875, "entropy": 2.374333620071411, "entropy_coeff": 0.01, "var_gnorm": 17.5319881439209, "vf_loss": 1478847.125, "vf_explained_var": 0.34916746616363525}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 480.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 264450, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264450, "num_agent_steps_trained": 264000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1763, "num_samples_added_to_queue": 264000, "learner_queue": {"size_count": 480, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.659, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2783.497, "learner_dequeue_time_ms": 22342.444}}, "env_runners": {"episode_reward_max": 1059.4548965853382, "episode_reward_min": 1054.5761369520867, "episode_reward_mean": 1057.451025708979, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.5761369520867}, "policy_reward_max": {"default_policy": 1059.4548965853382}, "policy_reward_mean": {"default_policy": 1057.451025708979}, "custom_metrics": {"num_consolidated_mean": 2.9991000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.10220000000000001, "num_moves_min": 0.02, "num_moves_max": 0.27, "mean_accuracy_mean": 42.36635000000001, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0022, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006853333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0013333333333333333, "cpu_conserved_cost_mean": 7.996400000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170300422297298, "mean_cluster_cpu_util_min": 0.5148288977753264, "mean_cluster_cpu_util_max": 0.5189628838021695, "mean_cluster_mem_util_mean": 0.33586898470464144, "mean_cluster_mem_util_min": 0.33516350210970464, "mean_cluster_mem_util_max": 0.3362594936708861, "reward_consolidation_mean_mean": 3.9356735904231015, "reward_consolidation_mean_min": 3.9258931127966132, "reward_consolidation_mean_max": 3.9409540345426297, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666250000000022, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027413333333333338, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.5673590423101, "reward_consolidation_sum_min": 392.58931127966133, "reward_consolidation_sum_max": 394.09540345426296, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6250000000022, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.741333333333334, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3096.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.1930671053049, 1057.995065338575, 1057.5388833043978, 1057.14281884919, 1057.4849553748231, 1057.3414968473019, 1056.672103932501, 1057.3034694934377, 1057.4182582472833, 1057.9245301410363, 1057.1078863200244, 1058.140123061929, 1057.3985196015738, 1058.2690547991124, 1057.2168387706015, 1057.7691675043432, 1057.7483322672051, 1056.7511377136086, 1056.4751530658891, 1057.6438027353881, 1057.2696335557, 1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26504060255668477, "mean_inference_ms": 2.2173617457448755, "mean_action_processing_ms": 0.09805251945091037, "mean_env_wait_ms": 1.9333169239654973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00650334358215332, "StateBufferConnector_ms": 0.004041910171508789, "ViewRequirementAgentConnector_ms": 0.10273241996765137}, "num_episodes": 21, "episode_return_max": 1059.4548965853382, "episode_return_min": 1054.5761369520867, "episode_return_mean": 1057.451025708979, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264450, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264450, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.92482509500076, "num_env_steps_trained_throughput_per_sec": 215.73076914714366, "timesteps_total": 264450, "num_env_steps_sampled_lifetime": 264450, "num_agent_steps_sampled_lifetime": 264450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 264450, "timers": {"training_iteration_time_ms": 10413.562, "restore_workers_time_ms": 0.014, "training_step_time_ms": 731.933, "sample_time_ms": 716.52, "synch_weights_time_ms": 13.977}, "counters": {"num_env_steps_sampled": 264450, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264450, "num_agent_steps_trained": 264000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1763, "num_samples_added_to_queue": 264000}, "done": false, "training_iteration": 120, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-07", "timestamp": 1728776047, "time_this_iter_s": 10.208815097808838, "time_total_s": 1243.3465266227722, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754199270>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1243.3465266227722, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.560000000000002, "ram_util_percent": 66.22666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 22838.0703125, "policy_loss": 8004.4931640625, "entropy": 2.3361399173736572, "entropy_coeff": 0.01, "var_gnorm": 17.600055694580078, "vf_loss": 1484642.5, "vf_explained_var": 0.3247007131576538}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 484.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1777, "num_samples_added_to_queue": 266200, "learner_queue": {"size_count": 484, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.017, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2778.699, "learner_dequeue_time_ms": 22288.509}}, "env_runners": {"episode_reward_max": 1059.4548965853382, "episode_reward_min": 1054.5761369520867, "episode_reward_mean": 1057.4483985805255, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.5761369520867}, "policy_reward_max": {"default_policy": 1059.4548965853382}, "policy_reward_mean": {"default_policy": 1057.4483985805255}, "custom_metrics": {"num_consolidated_mean": 2.9990000000000006, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.12129999999999999, "num_moves_min": 0.02, "num_moves_max": 0.27, "mean_accuracy_mean": 42.36641333333335, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006846666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0013333333333333333, "cpu_conserved_cost_mean": 7.996000000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169959175629711, "mean_cluster_cpu_util_min": 0.5148288977753264, "mean_cluster_cpu_util_max": 0.5189628838021695, "mean_cluster_mem_util_mean": 0.33586592563291134, "mean_cluster_mem_util_min": 0.33516350210970464, "mean_cluster_mem_util_max": 0.33624894514767933, "reward_consolidation_mean_mean": 3.9355373191385663, "reward_consolidation_mean_min": 3.9258931127966132, "reward_consolidation_mean_max": 3.9409540345426297, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666333333333356, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02738666666666667, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.5537319138568, "reward_consolidation_sum_min": 392.58931127966133, "reward_consolidation_sum_max": 394.09540345426296, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6333333333356, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7386666666666675, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2163.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.7662980901055, 1057.2761674129604, 1058.3145633433876, 1057.4950196472653, 1057.7708123914856, 1056.5027262481372, 1057.147317920134, 1058.0616040695743, 1058.8966949952805, 1056.4563160620207, 1055.8807639586973, 1056.5423984891431, 1057.8380121234297, 1057.661506594782, 1056.7769106582614, 1058.503920314358, 1056.8913095129328, 1057.68492491395, 1055.8701605288027, 1058.174199640563, 1056.806871972953, 1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2653189398585108, "mean_inference_ms": 2.220987047347172, "mean_action_processing_ms": 0.0981553387485818, "mean_env_wait_ms": 1.9354038993860616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006310939788818359, "StateBufferConnector_ms": 0.003917694091796875, "ViewRequirementAgentConnector_ms": 0.10052919387817383}, "num_episodes": 21, "episode_return_max": 1059.4548965853382, "episode_return_min": 1054.5761369520867, "episode_return_mean": 1057.4483985805255, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.93252805217577, "num_env_steps_trained_throughput_per_sec": 211.54836272132698, "timesteps_total": 266550, "num_env_steps_sampled_lifetime": 266550, "num_agent_steps_sampled_lifetime": 266550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 266550, "timers": {"training_iteration_time_ms": 10383.57, "restore_workers_time_ms": 0.015, "training_step_time_ms": 734.556, "sample_time_ms": 717.784, "synch_weights_time_ms": 15.154}, "counters": {"num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1777, "num_samples_added_to_queue": 266200}, "done": false, "training_iteration": 121, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-17", "timestamp": 1728776057, "time_this_iter_s": 10.409587621688843, "time_total_s": 1253.756114244461, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761197280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1253.756114244461, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 18.006666666666668, "ram_util_percent": 66.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 19970.0078125, "policy_loss": 6401.3251953125, "entropy": 2.200669288635254, "entropy_coeff": 0.01, "var_gnorm": 17.663164138793945, "vf_loss": 1358078.625, "vf_explained_var": 0.3789548873901367}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 488.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1791, "num_samples_added_to_queue": 268400, "learner_queue": {"size_count": 488, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.52, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2631.853, "learner_dequeue_time_ms": 22288.509}}, "env_runners": {"episode_reward_max": 1059.4548965853382, "episode_reward_min": 1054.5761369520867, "episode_reward_mean": 1057.5284188979278, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.5761369520867}, "policy_reward_max": {"default_policy": 1059.4548965853382}, "policy_reward_mean": {"default_policy": 1057.5284188979278}, "custom_metrics": {"num_consolidated_mean": 2.9992000000000005, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.12460000000000003, "num_moves_min": 0.02, "num_moves_max": 0.27, "mean_accuracy_mean": 42.366540000000015, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.0006693333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0013333333333333333, "cpu_conserved_cost_mean": 7.9968, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169504216078323, "mean_cluster_cpu_util_min": 0.5146290965710609, "mean_cluster_cpu_util_max": 0.5189628838021695, "mean_cluster_mem_util_mean": 0.33586799314345994, "mean_cluster_mem_util_min": 0.33516350210970464, "mean_cluster_mem_util_max": 0.33624894514767933, "reward_consolidation_mean_mean": 3.935557522312589, "reward_consolidation_mean_min": 3.924165981297024, "reward_consolidation_mean_max": 3.9409540345426297, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666500000000022, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026773333333333333, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.55575223125896, "reward_consolidation_sum_min": 392.4165981297024, "reward_consolidation_sum_max": 394.09540345426296, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6500000000024, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6773333333333342, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2082.0, "global_timestep_min": 400, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.2551890097193, 1059.4548965853382, 1058.4512839257993, 1056.8631880349708, 1058.0897621005836, 1056.7898748058137, 1056.1143379329274, 1056.3824088458393, 1056.9309817539392, 1056.9521703372043, 1057.1868409028627, 1058.457120229068, 1059.168491272962, 1058.9541076487271, 1058.7859392610214, 1056.113241341499, 1056.5182734777202, 1059.2638947272253, 1058.2092905662694, 1057.331980870574, 1057.8892442657425, 1058.9997745895423, 1058.2866002619653, 1058.9602972981227, 1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2654812969442638, "mean_inference_ms": 2.2209488103639643, "mean_action_processing_ms": 0.09819751898758178, "mean_env_wait_ms": 1.9362741766235163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006178140640258789, "StateBufferConnector_ms": 0.0038259029388427734, "ViewRequirementAgentConnector_ms": 0.09842824935913086}, "num_episodes": 21, "episode_return_max": 1059.4548965853382, "episode_return_min": 1054.5761369520867, "episode_return_mean": 1057.5284188979278, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.0753482719191, "num_env_steps_trained_throughput_per_sec": 217.9836981896295, "timesteps_total": 268650, "num_env_steps_sampled_lifetime": 268650, "num_agent_steps_sampled_lifetime": 268650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 268650, "timers": {"training_iteration_time_ms": 10391.629, "restore_workers_time_ms": 0.017, "training_step_time_ms": 722.555, "sample_time_ms": 704.402, "synch_weights_time_ms": 16.379}, "counters": {"num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1791, "num_samples_added_to_queue": 268400}, "done": false, "training_iteration": 122, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-27", "timestamp": 1728776067, "time_this_iter_s": 10.103884935379028, "time_total_s": 1263.85999917984, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611975e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1263.85999917984, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 16.79285714285714, "ram_util_percent": 66.47857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 16677.8046875, "policy_loss": 4255.2294921875, "entropy": 2.1830737590789795, "entropy_coeff": 0.01, "var_gnorm": 17.72703742980957, "vf_loss": 1243458.25, "vf_explained_var": 0.36980903148651123}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 492.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 270600, "learner_queue": {"size_count": 492, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.548, "learner_load_time_ms": 0.369, "learner_load_wait_time_ms": 2507.455, "learner_dequeue_time_ms": 22382.226}}, "env_runners": {"episode_reward_max": 1059.4287367875982, "episode_reward_min": 1054.4770538243647, "episode_reward_mean": 1057.4576792165485, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.4770538243647}, "policy_reward_max": {"default_policy": 1059.4287367875982}, "policy_reward_mean": {"default_policy": 1057.4576792165485}, "custom_metrics": {"num_consolidated_mean": 2.9993000000000007, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11630000000000003, "num_moves_min": 0.0, "num_moves_max": 0.27, "mean_accuracy_mean": 42.366540000000015, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.0006873333333333335, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 7.9972, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169257816809156, "mean_cluster_cpu_util_min": 0.5146290965710609, "mean_cluster_cpu_util_max": 0.5189628838021695, "mean_cluster_mem_util_mean": 0.3358732252109705, "mean_cluster_mem_util_min": 0.33516350210970464, "mean_cluster_mem_util_max": 0.33624894514767933, "reward_consolidation_mean_mean": 3.935570125498797, "reward_consolidation_mean_min": 3.924165981297024, "reward_consolidation_mean_max": 3.9409540345426297, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666500000000021, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02749333333333334, "reward_sla_mean_min": -0.058666666666666666, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.55701254987974, "reward_consolidation_sum_min": 392.4165981297024, "reward_consolidation_sum_max": 394.09540345426296, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6500000000024, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.749333333333333, "reward_sla_sum_min": -5.866666666666666, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2875.0, "global_timestep_min": 1100, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.0134515215227, 1059.4287367875982, 1057.9314630357326, 1057.650540680498, 1054.5761369520867, 1057.0241920253457, 1057.8176124767751, 1057.993067105305, 1057.1061378659135, 1058.0250632063137, 1057.7518169910772, 1056.2587346553373, 1055.5226446129968, 1057.4883578543386, 1056.8754089372223, 1057.7874562124975, 1056.8929544000753, 1057.4414450638178, 1056.9527186329187, 1057.616741295808, 1058.9032745438506, 1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2655647218331138, "mean_inference_ms": 2.2189249511702642, "mean_action_processing_ms": 0.09820741272419992, "mean_env_wait_ms": 1.9365084338359333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006344795227050781, "StateBufferConnector_ms": 0.003805398941040039, "ViewRequirementAgentConnector_ms": 0.09822225570678711}, "num_episodes": 24, "episode_return_max": 1059.4287367875982, "episode_return_min": 1054.4770538243647, "episode_return_mean": 1057.4576792165485, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.14300849115648, "num_env_steps_trained_throughput_per_sec": 208.406497191353, "timesteps_total": 270900, "num_env_steps_sampled_lifetime": 270900, "num_agent_steps_sampled_lifetime": 270900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 270900, "timers": {"training_iteration_time_ms": 10396.001, "restore_workers_time_ms": 0.013, "training_step_time_ms": 718.826, "sample_time_ms": 703.665, "synch_weights_time_ms": 13.503}, "counters": {"num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 270600}, "done": false, "training_iteration": 123, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-38", "timestamp": 1728776078, "time_this_iter_s": 10.566336393356323, "time_total_s": 1274.4263355731964, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e379a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1274.4263355731964, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.279999999999998, "ram_util_percent": 66.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 14836.615234375, "policy_loss": 3624.45068359375, "entropy": 2.191223382949829, "entropy_coeff": 0.01, "var_gnorm": 17.791610717773438, "vf_loss": 1122421.75, "vf_explained_var": 0.3551411032676697}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 496.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 273000, "num_env_steps_trained": 272800, "num_agent_steps_sampled": 273000, "num_agent_steps_trained": 272800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1820, "num_samples_added_to_queue": 272800, "learner_queue": {"size_count": 496, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.923, "learner_load_time_ms": 0.369, "learner_load_wait_time_ms": 2580.853, "learner_dequeue_time_ms": 22382.226}}, "env_runners": {"episode_reward_max": 1059.222224252949, "episode_reward_min": 1054.4770538243647, "episode_reward_mean": 1057.5458831825542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.4770538243647}, "policy_reward_max": {"default_policy": 1059.222224252949}, "policy_reward_mean": {"default_policy": 1057.5458831825542}, "custom_metrics": {"num_consolidated_mean": 2.9995000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.09970000000000002, "num_moves_min": 0.0, "num_moves_max": 0.27, "mean_accuracy_mean": 42.36660333333335, "mean_accuracy_min": 42.360333333333344, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.0006693333333333333, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 7.997999999999999, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5168950485498255, "mean_cluster_cpu_util_min": 0.5146290965710609, "mean_cluster_cpu_util_max": 0.518884009009009, "mean_cluster_mem_util_mean": 0.33589057753164553, "mean_cluster_mem_util_min": 0.3351835443037974, "mean_cluster_mem_util_max": 0.3362869198312236, "reward_consolidation_mean_mean": 3.935648831825521, "reward_consolidation_mean_min": 3.924165981297024, "reward_consolidation_mean_max": 3.94049346614274, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666583333333356, "reward_accuracy_mean_min": 6.658333333333355, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02677333333333333, "reward_sla_mean_min": -0.058666666666666666, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.564883182552, "reward_consolidation_sum_min": 392.4165981297024, "reward_consolidation_sum_max": 394.049346614274, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6583333333356, "reward_accuracy_sum_min": 665.8333333333355, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.677333333333333, "reward_sla_sum_min": -5.866666666666666, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3569.0, "global_timestep_min": 1700, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.5800054829595, 1057.6019373115257, 1058.4180328368234, 1057.1590727710277, 1057.88485790003, 1058.2295775076932, 1056.3585244753137, 1058.0546711748782, 1057.3363672362868, 1057.5688446190888, 1055.6192269030453, 1056.0423253830477, 1056.6591854762578, 1057.639221420088, 1058.7128209814514, 1058.0502848091649, 1056.3747327058418, 1056.8721191629375, 1057.801516951478, 1056.933528282923, 1056.9942307106546, 1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26563559621623595, "mean_inference_ms": 2.2178973587919866, "mean_action_processing_ms": 0.0982171347438257, "mean_env_wait_ms": 1.9367499917477995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006574869155883789, "StateBufferConnector_ms": 0.0036954879760742188, "ViewRequirementAgentConnector_ms": 0.09527325630187988}, "num_episodes": 21, "episode_return_max": 1059.222224252949, "episode_return_min": 1054.4770538243647, "episode_return_mean": 1057.5458831825542, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273000, "num_agent_steps_trained": 272800, "num_env_steps_sampled": 273000, "num_env_steps_trained": 272800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 207.41390323618438, "num_env_steps_trained_throughput_per_sec": 217.29075577124078, "timesteps_total": 273000, "num_env_steps_sampled_lifetime": 273000, "num_agent_steps_sampled_lifetime": 273000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 273000, "timers": {"training_iteration_time_ms": 10333.589, "restore_workers_time_ms": 0.015, "training_step_time_ms": 728.509, "sample_time_ms": 710.852, "synch_weights_time_ms": 15.895}, "counters": {"num_env_steps_sampled": 273000, "num_env_steps_trained": 272800, "num_agent_steps_sampled": 273000, "num_agent_steps_trained": 272800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1820, "num_samples_added_to_queue": 272800}, "done": false, "training_iteration": 124, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-48", "timestamp": 1728776088, "time_this_iter_s": 10.140297412872314, "time_total_s": 1284.5666329860687, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611964d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1284.5666329860687, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 66.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 14018.052734375, "policy_loss": 3697.856689453125, "entropy": 2.211090564727783, "entropy_coeff": 0.01, "var_gnorm": 17.859275817871094, "vf_loss": 1033235.6875, "vf_explained_var": 0.4220726490020752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 275250, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1835, "num_samples_added_to_queue": 275000, "learner_queue": {"size_count": 500, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.963, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 2578.164, "learner_dequeue_time_ms": 22485.435}}, "env_runners": {"episode_reward_max": 1059.222224252949, "episode_reward_min": 1054.4770538243647, "episode_reward_mean": 1057.604400590943, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.4770538243647}, "policy_reward_max": {"default_policy": 1059.222224252949}, "policy_reward_mean": {"default_policy": 1057.604400590943}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0822, "num_moves_min": 0.0, "num_moves_max": 0.24, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006613333333333333, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 7.998800000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5169186304352822, "mean_cluster_cpu_util_min": 0.5146290965710609, "mean_cluster_cpu_util_max": 0.518884009009009, "mean_cluster_mem_util_mean": 0.3359040611814345, "mean_cluster_mem_util_min": 0.3351835443037974, "mean_cluster_mem_util_max": 0.3362869198312236, "reward_consolidation_mean_mean": 3.935830672576076, "reward_consolidation_mean_min": 3.924165981297024, "reward_consolidation_mean_max": 3.94049346614274, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026453333333333332, "reward_sla_mean_min": -0.058666666666666666, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.5830672576075, "reward_consolidation_sum_min": 392.4165981297024, "reward_consolidation_sum_max": 394.049346614274, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.645333333333333, "reward_sla_sum_min": -5.866666666666666, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4269.0, "global_timestep_min": 2400, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.846672149626, 1058.6828596667604, 1057.392841694845, 1057.6732157543654, 1056.1103414663883, 1056.8792470072215, 1056.2302232782015, 1058.0193852995847, 1057.7940357610673, 1056.6178226567995, 1056.3125803405546, 1058.7327545767484, 1057.8711505071758, 1056.9651710378039, 1056.3875841481633, 1056.2552499314652, 1057.6032288525412, 1057.476925888698, 1058.1996161930026, 1057.4758292972697, 1057.2552194705927, 1057.8000670139227, 1056.6832647963713, 1056.7871333272435, 1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26571658122766734, "mean_inference_ms": 2.217991725471056, "mean_action_processing_ms": 0.09823794469966768, "mean_env_wait_ms": 1.937193834422227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006567955017089844, "StateBufferConnector_ms": 0.003689289093017578, "ViewRequirementAgentConnector_ms": 0.09548735618591309}, "num_episodes": 21, "episode_return_max": 1059.222224252949, "episode_return_min": 1054.4770538243647, "episode_return_mean": 1057.604400590943, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275000, "num_env_steps_sampled": 275250, "num_env_steps_trained": 275000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.03191726993592, "num_env_steps_trained_throughput_per_sec": 207.32009688615958, "timesteps_total": 275250, "num_env_steps_sampled_lifetime": 275250, "num_agent_steps_sampled_lifetime": 275250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 275250, "timers": {"training_iteration_time_ms": 10391.632, "restore_workers_time_ms": 0.016, "training_step_time_ms": 701.773, "sample_time_ms": 684.784, "synch_weights_time_ms": 15.508}, "counters": {"num_env_steps_sampled": 275250, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1835, "num_samples_added_to_queue": 275000}, "done": false, "training_iteration": 125, "trial_id": "90ffb_00000", "date": "2024-10-13_00-34-59", "timestamp": 1728776099, "time_this_iter_s": 10.63020920753479, "time_total_s": 1295.1968421936035, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35540>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1295.1968421936035, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 16.84, "ram_util_percent": 65.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 15027.888671875, "policy_loss": 5647.3271484375, "entropy": 2.2898571491241455, "entropy_coeff": 0.01, "var_gnorm": 17.924890518188477, "vf_loss": 939315.5, "vf_explained_var": 0.3965578079223633}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 504.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 277500, "num_env_steps_trained": 277200, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1850, "num_samples_added_to_queue": 277200, "learner_queue": {"size_count": 504, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.347, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 2492.661, "learner_dequeue_time_ms": 22485.435}}, "env_runners": {"episode_reward_max": 1059.222224252949, "episode_reward_min": 1054.4770538243647, "episode_reward_mean": 1057.6698377653925, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.4770538243647}, "policy_reward_max": {"default_policy": 1059.222224252949}, "policy_reward_mean": {"default_policy": 1057.6698377653925}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0708, "num_moves_min": 0.0, "num_moves_max": 0.18, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006593333333333334, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170817836458909, "mean_cluster_cpu_util_min": 0.5154126447876448, "mean_cluster_cpu_util_max": 0.518884009009009, "mean_cluster_mem_util_mean": 0.33593289029535867, "mean_cluster_mem_util_min": 0.3356772151898734, "mean_cluster_mem_util_max": 0.3362869198312236, "reward_consolidation_mean_mean": 3.936405044320571, "reward_consolidation_mean_min": 3.932395138444668, "reward_consolidation_mean_max": 3.94049346614274, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026373333333333332, "reward_sla_mean_min": -0.058666666666666666, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.64050443205707, "reward_consolidation_sum_min": 393.2395138444668, "reward_consolidation_sum_max": 394.049346614274, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.637333333333333, "reward_sla_sum_min": -5.866666666666666, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5071.0, "global_timestep_min": 3100, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.0733132291593, 1058.6649608577802, 1059.0703463401285, 1057.4010661305574, 1057.4445764415632, 1058.6475737914673, 1057.8678607328907, 1058.5965822900507, 1058.496792470074, 1058.1681683877082, 1056.6599287215595, 1057.0086447957622, 1059.1160132809425, 1057.6068719729526, 1057.4593804258454, 1057.0647659081926, 1057.9327545767483, 1057.6863748515052, 1057.5671997319462, 1058.14259343873, 1056.4395138444688, 1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2658483173332553, "mean_inference_ms": 2.2196780059089125, "mean_action_processing_ms": 0.09827824865354833, "mean_env_wait_ms": 1.9381985554072156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006577968597412109, "StateBufferConnector_ms": 0.0037026405334472656, "ViewRequirementAgentConnector_ms": 0.09511303901672363}, "num_episodes": 24, "episode_return_max": 1059.222224252949, "episode_return_min": 1054.4770538243647, "episode_return_mean": 1057.6698377653925, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277200, "num_env_steps_sampled": 277500, "num_env_steps_trained": 277200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 211.18443356927853, "num_env_steps_trained_throughput_per_sec": 206.4914461566279, "timesteps_total": 277500, "num_env_steps_sampled_lifetime": 277500, "num_agent_steps_sampled_lifetime": 277500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 277500, "timers": {"training_iteration_time_ms": 10404.098, "restore_workers_time_ms": 0.013, "training_step_time_ms": 700.842, "sample_time_ms": 686.551, "synch_weights_time_ms": 12.651}, "counters": {"num_env_steps_sampled": 277500, "num_env_steps_trained": 277200, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1850, "num_samples_added_to_queue": 277200}, "done": false, "training_iteration": 126, "trial_id": "90ffb_00000", "date": "2024-10-13_00-35-10", "timestamp": 1728776110, "time_this_iter_s": 10.665918111801147, "time_total_s": 1305.8627603054047, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e375e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1305.8627603054047, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 16.753333333333334, "ram_util_percent": 66.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 12140.947265625, "policy_loss": 3982.21044921875, "entropy": 2.3467462062835693, "entropy_coeff": 0.01, "var_gnorm": 17.981475830078125, "vf_loss": 817164.4375, "vf_explained_var": 0.39016127586364746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 508.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 279600, "num_env_steps_trained": 279400, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1864, "num_samples_added_to_queue": 279400, "learner_queue": {"size_count": 508, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.449, "learner_load_time_ms": 0.414, "learner_load_wait_time_ms": 2546.945, "learner_dequeue_time_ms": 22436.893}}, "env_runners": {"episode_reward_max": 1059.2971458162008, "episode_reward_min": 1054.4770538243647, "episode_reward_mean": 1057.6785047366677, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.4770538243647}, "policy_reward_max": {"default_policy": 1059.2971458162008}, "policy_reward_mean": {"default_policy": 1057.6785047366677}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0846, "num_moves_min": 0.0, "num_moves_max": 0.24, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.000658, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170941501195072, "mean_cluster_cpu_util_min": 0.5156666896488326, "mean_cluster_cpu_util_max": 0.5187468744254459, "mean_cluster_mem_util_mean": 0.33593354430379757, "mean_cluster_mem_util_min": 0.3356814345991561, "mean_cluster_mem_util_max": 0.3362869198312236, "reward_consolidation_mean_mean": 3.9364383806999905, "reward_consolidation_mean_min": 3.933206616101617, "reward_consolidation_mean_max": 3.940334460385635, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02632, "reward_sla_mean_min": -0.058666666666666666, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.64383806999905, "reward_consolidation_sum_min": 393.3206616101617, "reward_consolidation_sum_max": 394.0334460385635, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6319999999999997, "reward_sla_sum_min": -5.866666666666666, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5767.0, "global_timestep_min": 3800, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.3251759115437, 1056.4228700234569, 1057.9663955648984, 1057.910274452468, 1058.057960949163, 1058.1089524505792, 1058.6033567882077, 1057.7571049986316, 1056.3278199153208, 1058.1465899052687, 1058.7793597124517, 1057.7682658625017, 1054.4770538243647, 1056.7174997715456, 1057.288117213441, 1056.1446891467933, 1057.7912942824964, 1058.205452496271, 1058.0424137195798, 1057.664089676812, 1058.3301105729709, 1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2658666863525674, "mean_inference_ms": 2.2181368056289603, "mean_action_processing_ms": 0.09827468861621264, "mean_env_wait_ms": 1.9380959357629854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066356658935546875, "StateBufferConnector_ms": 0.0038204193115234375, "ViewRequirementAgentConnector_ms": 0.09852099418640137}, "num_episodes": 21, "episode_return_max": 1059.2971458162008, "episode_return_min": 1054.4770538243647, "episode_return_mean": 1057.6785047366677, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279400, "num_env_steps_sampled": 279600, "num_env_steps_trained": 279400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.44021894122105, "num_env_steps_trained_throughput_per_sec": 215.22308650985062, "timesteps_total": 279600, "num_env_steps_sampled_lifetime": 279600, "num_agent_steps_sampled_lifetime": 279600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 279600, "timers": {"training_iteration_time_ms": 10421.318, "restore_workers_time_ms": 0.013, "training_step_time_ms": 747.608, "sample_time_ms": 731.127, "synch_weights_time_ms": 14.984}, "counters": {"num_env_steps_sampled": 279600, "num_env_steps_trained": 279400, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1864, "num_samples_added_to_queue": 279400}, "done": false, "training_iteration": 127, "trial_id": "90ffb_00000", "date": "2024-10-13_00-35-20", "timestamp": 1728776120, "time_this_iter_s": 10.248770236968994, "time_total_s": 1316.1115305423737, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611963e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1316.1115305423737, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.706666666666667, "ram_util_percent": 66.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 13633.984375, "policy_loss": 6510.46484375, "entropy": 2.4288129806518555, "entropy_coeff": 0.01, "var_gnorm": 18.02145004272461, "vf_loss": 713687.875, "vf_explained_var": 0.45812565088272095}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 511.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 281700, "num_env_steps_trained": 281050, "num_agent_steps_sampled": 281700, "num_agent_steps_trained": 281050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1878, "num_samples_added_to_queue": 281600, "learner_queue": {"size_count": 511, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.091, "learner_load_time_ms": 0.414, "learner_load_wait_time_ms": 2646.045, "learner_dequeue_time_ms": 22436.893}}, "env_runners": {"episode_reward_max": 1059.2971458162008, "episode_reward_min": 1055.7566541777112, "episode_reward_mean": 1057.6703649821825, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.7566541777112}, "policy_reward_max": {"default_policy": 1059.2971458162008}, "policy_reward_mean": {"default_policy": 1057.6703649821825}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1233, "num_moves_min": 0.02, "num_moves_max": 0.39, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006646666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171800728534657, "mean_cluster_cpu_util_min": 0.5156666896488326, "mean_cluster_cpu_util_max": 0.5187468744254459, "mean_cluster_mem_util_mean": 0.3359379113924051, "mean_cluster_mem_util_min": 0.3356814345991561, "mean_cluster_mem_util_max": 0.3362869198312236, "reward_consolidation_mean_mean": 3.9366236498218035, "reward_consolidation_mean_min": 3.933206616101617, "reward_consolidation_mean_max": 3.940334460385635, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026586666666666668, "reward_sla_mean_min": -0.04533333333333333, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.66236498218035, "reward_consolidation_sum_min": 393.3206616101617, "reward_consolidation_sum_max": 394.0334460385635, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.658666666666666, "reward_sla_sum_min": -4.533333333333333, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5767.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.560297298123, 1057.9875841481637, 1057.7017271315017, 1058.179487648118, 1057.3325291662877, 1056.6188065429974, 1059.222224252949, 1058.2747327058412, 1057.752365286791, 1057.2014864906052, 1058.5086600261982, 1057.844478966769, 1058.5103049133409, 1058.632964756772, 1056.924755551496, 1056.354686405314, 1058.4847299643632, 1057.3752962319925, 1056.9967772396376, 1057.3561058819976, 1056.9867129671954, 1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2659330568412839, "mean_inference_ms": 2.2182221469950623, "mean_action_processing_ms": 0.09829395315890652, "mean_env_wait_ms": 1.9384670974708627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064618587493896484, "StateBufferConnector_ms": 0.003856658935546875, "ViewRequirementAgentConnector_ms": 0.0998077392578125}, "num_episodes": 21, "episode_return_max": 1059.2971458162008, "episode_return_min": 1055.7566541777112, "episode_return_mean": 1057.6703649821825, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281700, "num_agent_steps_trained": 281050, "num_env_steps_sampled": 281700, "num_env_steps_trained": 281050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 199.72576828270215, "num_env_steps_trained_throughput_per_sec": 156.92738936498026, "timesteps_total": 281700, "num_env_steps_sampled_lifetime": 281700, "num_agent_steps_sampled_lifetime": 281700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 281700, "timers": {"training_iteration_time_ms": 10427.508, "restore_workers_time_ms": 0.015, "training_step_time_ms": 727.402, "sample_time_ms": 710.32, "synch_weights_time_ms": 15.491}, "counters": {"num_env_steps_sampled": 281700, "num_env_steps_trained": 281050, "num_agent_steps_sampled": 281700, "num_agent_steps_trained": 281050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1878, "num_samples_added_to_queue": 281600}, "done": false, "training_iteration": 128, "trial_id": "90ffb_00000", "date": "2024-10-13_00-35-30", "timestamp": 1728776130, "time_this_iter_s": 10.526410818099976, "time_total_s": 1326.6379413604736, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5761197bb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1326.6379413604736, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.566666666666666, "ram_util_percent": 67.24666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 11130.3740234375, "policy_loss": 6343.9228515625, "entropy": 2.6996254920959473, "entropy_coeff": 0.01, "var_gnorm": 18.084688186645508, "vf_loss": 480129.9375, "vf_explained_var": 0.5041508674621582}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 516.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 283950, "num_env_steps_trained": 283800, "num_agent_steps_sampled": 283950, "num_agent_steps_trained": 283800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1893, "num_samples_added_to_queue": 283800, "learner_queue": {"size_count": 516, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.68, "learner_load_time_ms": 0.404, "learner_load_wait_time_ms": 2572.414, "learner_dequeue_time_ms": 22321.843}}, "env_runners": {"episode_reward_max": 1059.2971458162008, "episode_reward_min": 1055.7566541777112, "episode_reward_mean": 1057.6740389289978, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.7566541777112}, "policy_reward_max": {"default_policy": 1059.2971458162008}, "policy_reward_mean": {"default_policy": 1057.6740389289978}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.19820000000000002, "num_moves_min": 0.02, "num_moves_max": 0.57, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006626666666666665, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171593953392167, "mean_cluster_cpu_util_min": 0.5156666896488326, "mean_cluster_cpu_util_max": 0.5187468744254459, "mean_cluster_mem_util_mean": 0.33592860759493676, "mean_cluster_mem_util_min": 0.3356814345991561, "mean_cluster_mem_util_max": 0.33625527426160323, "reward_consolidation_mean_mean": 3.9365803892899573, "reward_consolidation_mean_min": 3.933206616101617, "reward_consolidation_mean_max": 3.940334460385635, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026506666666666668, "reward_sla_mean_min": -0.04533333333333333, "reward_sla_mean_max": -0.013333333333333332, "reward_consolidation_sum_mean": 393.65803892899567, "reward_consolidation_sum_min": 393.3206616101617, "reward_consolidation_sum_max": 394.0334460385635, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6506666666666665, "reward_sla_sum_min": -4.533333333333333, "reward_sla_sum_max": -1.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4829.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.8209022510605, 1057.8258369124876, 1058.8352858752953, 1057.5081787444049, 1057.4533491729896, 1058.0334460385654, 1057.113015931039, 1056.9430442596504, 1058.3509458101096, 1057.6953425325191, 1056.8545737000845, 1057.3385604191437, 1058.8583142952896, 1058.0062262024446, 1056.6862469158389, 1057.5602668372496, 1057.1302080477649, 1057.437058698104, 1057.97203691858, 1056.2735386396191, 1057.9148557677684, 1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2660185249501505, "mean_inference_ms": 2.2184564942266354, "mean_action_processing_ms": 0.09831385647045508, "mean_env_wait_ms": 1.9389419048396999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062253475189208984, "StateBufferConnector_ms": 0.0038263797760009766, "ViewRequirementAgentConnector_ms": 0.09910058975219727}, "num_episodes": 21, "episode_return_max": 1059.2971458162008, "episode_return_min": 1055.7566541777112, "episode_return_mean": 1057.6740389289978, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283950, "num_agent_steps_trained": 283800, "num_env_steps_sampled": 283950, "num_env_steps_trained": 283800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 212.9124158525037, "num_env_steps_trained_throughput_per_sec": 260.2262860419489, "timesteps_total": 283950, "num_env_steps_sampled_lifetime": 283950, "num_agent_steps_sampled_lifetime": 283950, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 283950, "timers": {"training_iteration_time_ms": 10394.09, "restore_workers_time_ms": 0.013, "training_step_time_ms": 700.879, "sample_time_ms": 683.608, "synch_weights_time_ms": 15.646}, "counters": {"num_env_steps_sampled": 283950, "num_env_steps_trained": 283800, "num_agent_steps_sampled": 283950, "num_agent_steps_trained": 283800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1893, "num_samples_added_to_queue": 283800}, "done": false, "training_iteration": 129, "trial_id": "90ffb_00000", "date": "2024-10-13_00-35-41", "timestamp": 1728776141, "time_this_iter_s": 10.581150531768799, "time_total_s": 1337.2190918922424, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d575419a620>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1337.2190918922424, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 16.96666666666667, "ram_util_percent": 66.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 9366.27734375, "policy_loss": 4264.20654296875, "entropy": 2.5897295475006104, "entropy_coeff": 0.01, "var_gnorm": 18.119752883911133, "vf_loss": 511631.40625, "vf_explained_var": 0.476524293422699}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 519.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 286050, "num_env_steps_trained": 285450, "num_agent_steps_sampled": 286050, "num_agent_steps_trained": 285450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1907, "num_samples_added_to_queue": 286000, "learner_queue": {"size_count": 519, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.58, "learner_load_time_ms": 0.404, "learner_load_wait_time_ms": 2572.125, "learner_dequeue_time_ms": 22321.843}}, "env_runners": {"episode_reward_max": 1059.5793597124516, "episode_reward_min": 1055.2584117700835, "episode_reward_mean": 1057.6697818392295, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.2584117700835}, "policy_reward_max": {"default_policy": 1059.5793597124516}, "policy_reward_mean": {"default_policy": 1057.6697818392295}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2685, "num_moves_min": 0.04, "num_moves_max": 0.57, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006653333333333332, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171822136422137, "mean_cluster_cpu_util_min": 0.515176893730465, "mean_cluster_cpu_util_max": 0.5197555846662989, "mean_cluster_mem_util_mean": 0.3359277004219408, "mean_cluster_mem_util_min": 0.33560970464135026, "mean_cluster_mem_util_max": 0.33625527426160323, "reward_consolidation_mean_mean": 3.9366444850589413, "reward_consolidation_mean_min": 3.932279996344695, "reward_consolidation_mean_max": 3.9426208535136618, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026613333333333336, "reward_sla_mean_min": -0.05066666666666667, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.6644485058942, "reward_consolidation_sum_min": 393.2279996344695, "reward_consolidation_sum_max": 394.2620853513662, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6613333333333338, "reward_sla_sum_min": -5.066666666666667, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3884.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.7074050382305, 1058.0308995095822, 1058.5324316914948, 1057.1303664443046, 1058.212580340554, 1058.098888178138, 1058.2295775076932, 1057.737914648636, 1055.7566541777112, 1057.9413323585875, 1057.8658624996212, 1057.640512961104, 1057.4145785738242, 1056.9664260257716, 1056.4199335952992, 1058.9303359834314, 1056.239544305342, 1059.0515093362599, 1058.0879222638541, 1058.38732827683, 1057.2972432909949, 1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2660743863996639, "mean_inference_ms": 2.217209247040837, "mean_action_processing_ms": 0.09831761294821248, "mean_env_wait_ms": 1.9390012842039277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159543991088867, "StateBufferConnector_ms": 0.003792285919189453, "ViewRequirementAgentConnector_ms": 0.09851717948913574}, "num_episodes": 21, "episode_return_max": 1059.5793597124516, "episode_return_min": 1055.2584117700835, "episode_return_mean": 1057.6697818392295, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286050, "num_agent_steps_trained": 285450, "num_env_steps_sampled": 286050, "num_env_steps_trained": 285450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 208.06155647223815, "num_env_steps_trained_throughput_per_sec": 163.47693722818713, "timesteps_total": 286050, "num_env_steps_sampled_lifetime": 286050, "num_agent_steps_sampled_lifetime": 286050, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 286050, "timers": {"training_iteration_time_ms": 10383.617, "restore_workers_time_ms": 0.013, "training_step_time_ms": 717.162, "sample_time_ms": 700.399, "synch_weights_time_ms": 15.288}, "counters": {"num_env_steps_sampled": 286050, "num_env_steps_trained": 285450, "num_agent_steps_sampled": 286050, "num_agent_steps_trained": 285450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1907, "num_samples_added_to_queue": 286000}, "done": false, "training_iteration": 130, "trial_id": "90ffb_00000", "date": "2024-10-13_00-35-51", "timestamp": 1728776151, "time_this_iter_s": 10.106095552444458, "time_total_s": 1347.325187444687, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57541990c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1347.325187444687, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.59333333333333, "ram_util_percent": 66.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 10415.8916015625, "policy_loss": 4312.55908203125, "entropy": 2.352898597717285, "entropy_coeff": 0.01, "var_gnorm": 18.1707706451416, "vf_loss": 611627.375, "vf_explained_var": 0.475628137588501}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 288150, "num_env_steps_trained": 287650, "num_agent_steps_sampled": 288150, "num_agent_steps_trained": 287650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1921, "num_samples_added_to_queue": 287650, "learner_queue": {"size_count": 523, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.824, "learner_load_time_ms": 0.43, "learner_load_wait_time_ms": 2565.665, "learner_dequeue_time_ms": 22274.491}}, "env_runners": {"episode_reward_max": 1059.5793597124516, "episode_reward_min": 1055.2584117700835, "episode_reward_mean": 1057.6732842304082, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.2584117700835}, "policy_reward_max": {"default_policy": 1059.5793597124516}, "policy_reward_mean": {"default_policy": 1057.6732842304082}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2993, "num_moves_min": 0.08, "num_moves_max": 0.57, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.000662, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171346603235889, "mean_cluster_cpu_util_min": 0.515176893730465, "mean_cluster_cpu_util_max": 0.5197555846662989, "mean_cluster_mem_util_mean": 0.33592552742616044, "mean_cluster_mem_util_min": 0.33560970464135026, "mean_cluster_mem_util_max": 0.33625949367088614, "reward_consolidation_mean_mean": 3.9365461756373934, "reward_consolidation_mean_min": 3.932279996344695, "reward_consolidation_mean_max": 3.9426208535136618, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026480000000000007, "reward_sla_mean_min": -0.05066666666666667, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.6546175637393, "reward_consolidation_sum_min": 393.2279996344695, "reward_consolidation_sum_max": 394.2620853513662, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6479999999999997, "reward_sla_sum_min": -5.066666666666667, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2959.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.7538152243465, 1057.9570745377587, 1058.0990831277252, 1056.6692497487002, 1058.4467026104987, 1058.2796673672692, 1057.8702488653344, 1058.4149014590778, 1059.094824697678, 1059.2971458162008, 1057.73372323251, 1057.4445764415632, 1058.4035821986681, 1057.1305613938916, 1056.1024703768028, 1058.220804776267, 1056.7224344329727, 1057.236029120597, 1058.0199335952996, 1058.1431417344443, 1056.8631514819238, 1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26628746081284016, "mean_inference_ms": 2.221011871053725, "mean_action_processing_ms": 0.09839207461346917, "mean_env_wait_ms": 1.9406372068372837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006155967712402344, "StateBufferConnector_ms": 0.0037882328033447266, "ViewRequirementAgentConnector_ms": 0.09833502769470215}, "num_episodes": 21, "episode_return_max": 1059.5793597124516, "episode_return_min": 1055.2584117700835, "episode_return_mean": 1057.6732842304082, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288150, "num_agent_steps_trained": 287650, "num_env_steps_sampled": 288150, "num_env_steps_trained": 287650, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 183.65342747657226, "num_env_steps_trained_throughput_per_sec": 192.39882878498045, "timesteps_total": 288150, "num_env_steps_sampled_lifetime": 288150, "num_agent_steps_sampled_lifetime": 288150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 288150, "timers": {"training_iteration_time_ms": 10487.123, "restore_workers_time_ms": 0.018, "training_step_time_ms": 859.854, "sample_time_ms": 843.636, "synch_weights_time_ms": 14.713}, "counters": {"num_env_steps_sampled": 288150, "num_env_steps_trained": 287650, "num_agent_steps_sampled": 288150, "num_agent_steps_trained": 287650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1921, "num_samples_added_to_queue": 287650}, "done": false, "training_iteration": 131, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-03", "timestamp": 1728776163, "time_this_iter_s": 11.446501731872559, "time_total_s": 1358.7716891765594, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5754199a50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1358.7716891765594, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 25.9375, "ram_util_percent": 66.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 7358.607421875, "policy_loss": 792.0355834960938, "entropy": 2.289623260498047, "entropy_coeff": 0.01, "var_gnorm": 18.218839645385742, "vf_loss": 657916.5, "vf_explained_var": 0.3981398344039917}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 290250, "num_env_steps_trained": 289850, "num_agent_steps_sampled": 290250, "num_agent_steps_trained": 289850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1935, "num_samples_added_to_queue": 289850, "learner_queue": {"size_count": 527, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.332, "learner_load_time_ms": 0.43, "learner_load_wait_time_ms": 2757.687, "learner_dequeue_time_ms": 22274.491}}, "env_runners": {"episode_reward_max": 1059.5793597124516, "episode_reward_min": 1055.2584117700835, "episode_reward_mean": 1057.6909561668058, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.2584117700835}, "policy_reward_max": {"default_policy": 1059.5793597124516}, "policy_reward_mean": {"default_policy": 1057.6909561668058}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2937, "num_moves_min": 0.06, "num_moves_max": 0.57, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006599999999999998, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012666666666666666, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171777282129068, "mean_cluster_cpu_util_min": 0.515176893730465, "mean_cluster_cpu_util_max": 0.5197555846662989, "mean_cluster_mem_util_mean": 0.3359320464135021, "mean_cluster_mem_util_min": 0.33560970464135026, "mean_cluster_mem_util_max": 0.33625949367088614, "reward_consolidation_mean_mean": 3.9366428950013703, "reward_consolidation_mean_min": 3.932279996344695, "reward_consolidation_mean_max": 3.9426208535136618, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.0264, "reward_sla_mean_min": -0.05066666666666667, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.6642895001371, "reward_consolidation_sum_min": 393.2279996344695, "reward_consolidation_sum_max": 394.2620853513662, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6400000000000006, "reward_sla_sum_min": -5.066666666666667, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2099.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.913369277165, 1057.1658472691845, 1057.7435925553652, 1057.595162813369, 1056.1713606871992, 1058.5095982210871, 1057.1232386000202, 1057.5759724633726, 1058.6080965000478, 1058.4320935758042, 1057.8362545310567, 1056.4738615248737, 1058.5949374029083, 1057.0148709982045, 1056.9351731700651, 1057.3427518352698, 1057.42244966341, 1058.3684912729625, 1058.0665387310025, 1057.7329799872082, 1055.9706844558189, 1057.966943860613, 1056.4648938438593, 1056.5275945048606, 1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2664234025919744, "mean_inference_ms": 2.2219620696092317, "mean_action_processing_ms": 0.09843136877099941, "mean_env_wait_ms": 1.941481518499437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006156206130981445, "StateBufferConnector_ms": 0.0037529468536376953, "ViewRequirementAgentConnector_ms": 0.09620523452758789}, "num_episodes": 21, "episode_return_max": 1059.5793597124516, "episode_return_min": 1055.2584117700835, "episode_return_mean": 1057.6909561668058, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290250, "num_agent_steps_trained": 289850, "num_env_steps_sampled": 290250, "num_env_steps_trained": 289850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.09593310782267, "num_env_steps_trained_throughput_per_sec": 211.71954897009994, "timesteps_total": 290250, "num_env_steps_sampled_lifetime": 290250, "num_agent_steps_sampled_lifetime": 290250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 290250, "timers": {"training_iteration_time_ms": 10516.983, "restore_workers_time_ms": 0.015, "training_step_time_ms": 719.993, "sample_time_ms": 704.342, "synch_weights_time_ms": 14.088}, "counters": {"num_env_steps_sampled": 290250, "num_env_steps_trained": 289850, "num_agent_steps_sampled": 290250, "num_agent_steps_trained": 289850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1935, "num_samples_added_to_queue": 289850}, "done": false, "training_iteration": 132, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-13", "timestamp": 1728776173, "time_this_iter_s": 10.402736902236938, "time_total_s": 1369.1744260787964, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760e35240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1369.1744260787964, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 18.56, "ram_util_percent": 68.74666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 7690.7548828125, "policy_loss": 1351.229248046875, "entropy": 2.18255877494812, "entropy_coeff": 0.01, "var_gnorm": 18.26449966430664, "vf_loss": 635153.0, "vf_explained_var": 0.42172253131866455}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 531.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 292500, "num_env_steps_trained": 292050, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1950, "num_samples_added_to_queue": 292050, "learner_queue": {"size_count": 531, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.308, "learner_load_time_ms": 0.418, "learner_load_wait_time_ms": 2895.412, "learner_dequeue_time_ms": 22384.478}}, "env_runners": {"episode_reward_max": 1059.5793597124516, "episode_reward_min": 1055.2584117700835, "episode_reward_mean": 1057.6888608242732, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.2584117700835}, "policy_reward_max": {"default_policy": 1059.5793597124516}, "policy_reward_mean": {"default_policy": 1057.6888608242732}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.24240000000000006, "num_moves_min": 0.0, "num_moves_max": 0.55, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006546666666666669, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012666666666666666, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170765368174297, "mean_cluster_cpu_util_min": 0.515176893730465, "mean_cluster_cpu_util_max": 0.5197555846662989, "mean_cluster_mem_util_mean": 0.33591660337552737, "mean_cluster_mem_util_min": 0.33560970464135026, "mean_cluster_mem_util_max": 0.33625949367088614, "reward_consolidation_mean_mean": 3.9364086082427128, "reward_consolidation_mean_min": 3.932279996344695, "reward_consolidation_mean_max": 3.9426208535136618, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026186666666666674, "reward_sla_mean_min": -0.05066666666666667, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.6408608242712, "reward_consolidation_sum_min": 393.2279996344695, "reward_consolidation_sum_max": 394.2620853513662, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.618666666666667, "reward_sla_sum_min": -5.066666666666667, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2269.0, "global_timestep_min": 400, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.4087118096825, 1057.2210301867274, 1058.1082092052782, 1057.8958238143125, 1057.7565567029176, 1057.2179353620295, 1057.0905358067582, 1057.640318011516, 1058.0100642724442, 1058.8396722410087, 1057.9362393006206, 1057.7450424929195, 1058.7833927320378, 1058.610837978619, 1058.2284809162652, 1057.7287520180348, 1058.5554601114884, 1056.5741996405636, 1058.0955984038528, 1056.1719089829141, 1057.3659752048513, 1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2665206372472701, "mean_inference_ms": 2.2214818488597166, "mean_action_processing_ms": 0.09845245279631216, "mean_env_wait_ms": 1.941953982443777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006011009216308594, "StateBufferConnector_ms": 0.0037016868591308594, "ViewRequirementAgentConnector_ms": 0.09454560279846191}, "num_episodes": 24, "episode_return_max": 1059.5793597124516, "episode_return_min": 1055.2584117700835, "episode_return_mean": 1057.6888608242732, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292050, "num_env_steps_sampled": 292500, "num_env_steps_trained": 292050, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.0883025947539, "num_env_steps_trained_throughput_per_sec": 208.35300698153716, "timesteps_total": 292500, "num_env_steps_sampled_lifetime": 292500, "num_agent_steps_sampled_lifetime": 292500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 292500, "timers": {"training_iteration_time_ms": 10517.254, "restore_workers_time_ms": 0.015, "training_step_time_ms": 709.618, "sample_time_ms": 693.516, "synch_weights_time_ms": 14.55}, "counters": {"num_env_steps_sampled": 292500, "num_env_steps_trained": 292050, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1950, "num_samples_added_to_queue": 292050}, "done": false, "training_iteration": 133, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-26", "timestamp": 1728776186, "time_this_iter_s": 10.56921935081482, "time_total_s": 1379.7436454296112, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1379.7436454296112, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 14.61578947368421, "ram_util_percent": 68.17368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 8151.0107421875, "policy_loss": 2354.748291015625, "entropy": 2.2375800609588623, "entropy_coeff": 0.01, "var_gnorm": 18.312944412231445, "vf_loss": 580856.9375, "vf_explained_var": 0.4650372266769409}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 535.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 294600, "num_env_steps_trained": 294250, "num_agent_steps_sampled": 294600, "num_agent_steps_trained": 294250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1964, "num_samples_added_to_queue": 294250, "learner_queue": {"size_count": 535, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.074, "learner_load_time_ms": 0.418, "learner_load_wait_time_ms": 2809.015, "learner_dequeue_time_ms": 22384.478}}, "env_runners": {"episode_reward_max": 1059.5793597124516, "episode_reward_min": 1055.2584117700835, "episode_reward_mean": 1057.6666109841929, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.2584117700835}, "policy_reward_max": {"default_policy": 1059.5793597124516}, "policy_reward_mean": {"default_policy": 1057.6666109841929}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1693, "num_moves_min": 0.0, "num_moves_max": 0.55, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006546666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012666666666666666, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.516983026061776, "mean_cluster_cpu_util_min": 0.5151421906600477, "mean_cluster_cpu_util_max": 0.5194618725868725, "mean_cluster_mem_util_mean": 0.33591128691983113, "mean_cluster_mem_util_min": 0.33560970464135026, "mean_cluster_mem_util_max": 0.33625949367088614, "reward_consolidation_mean_mean": 3.9361861098419073, "reward_consolidation_mean_min": 3.9317591154162477, "reward_consolidation_mean_max": 3.9420177282280906, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026186666666666674, "reward_sla_mean_min": -0.05066666666666667, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.61861098419075, "reward_consolidation_sum_min": 393.17591154162477, "reward_consolidation_sum_max": 394.20177282280906, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.618666666666667, "reward_sla_sum_min": -5.066666666666667, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2969.0, "global_timestep_min": 1100, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1059.5793597124516, 1057.7324316914946, 1056.3126625849115, 1058.2361570562632, 1058.1475281001572, 1058.3646532029632, 1056.3892290353067, 1057.1141125224674, 1055.2584117700835, 1058.0908586920123, 1057.4615736087019, 1058.0279996344716, 1057.1393341253176, 1058.4394163696752, 1057.8525084528949, 1057.0492186786098, 1055.8262877334091, 1058.5735538700555, 1058.425514027234, 1058.4684394894782, 1057.41203204484, 1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2666242466533448, "mean_inference_ms": 2.2223546741006004, "mean_action_processing_ms": 0.09848752643024943, "mean_env_wait_ms": 1.9426889475067128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006074190139770508, "StateBufferConnector_ms": 0.003727436065673828, "ViewRequirementAgentConnector_ms": 0.09560060501098633}, "num_episodes": 21, "episode_return_max": 1059.5793597124516, "episode_return_min": 1055.2584117700835, "episode_return_mean": 1057.6666109841929, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294600, "num_agent_steps_trained": 294250, "num_env_steps_sampled": 294600, "num_env_steps_trained": 294250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.70199809614383, "num_env_steps_trained_throughput_per_sec": 215.49733133881733, "timesteps_total": 294600, "num_env_steps_sampled_lifetime": 294600, "num_agent_steps_sampled_lifetime": 294600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 294600, "timers": {"training_iteration_time_ms": 10525.68, "restore_workers_time_ms": 0.015, "training_step_time_ms": 729.215, "sample_time_ms": 710.498, "synch_weights_time_ms": 17.154}, "counters": {"num_env_steps_sampled": 294600, "num_env_steps_trained": 294250, "num_agent_steps_sampled": 294600, "num_agent_steps_trained": 294250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1964, "num_samples_added_to_queue": 294250}, "done": false, "training_iteration": 134, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-36", "timestamp": 1728776196, "time_this_iter_s": 10.218782901763916, "time_total_s": 1389.9624283313751, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760fae890>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1389.9624283313751, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.364285714285714, "ram_util_percent": 67.47857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6302.203125, "policy_loss": -406.6602478027344, "entropy": 2.3126730918884277, "entropy_coeff": 0.01, "var_gnorm": 18.35398292541504, "vf_loss": 672158.3125, "vf_explained_var": 0.3898457884788513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 296850, "num_env_steps_trained": 296450, "num_agent_steps_sampled": 296850, "num_agent_steps_trained": 296450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1979, "num_samples_added_to_queue": 296450, "learner_queue": {"size_count": 539, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.09, "learner_load_time_ms": 0.39, "learner_load_wait_time_ms": 2549.851, "learner_dequeue_time_ms": 22248.595}}, "env_runners": {"episode_reward_max": 1059.4622193792095, "episode_reward_min": 1056.10924487496, "episode_reward_mean": 1057.691676261844, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1056.10924487496}, "policy_reward_max": {"default_policy": 1059.4622193792095}, "policy_reward_mean": {"default_policy": 1057.691676261844}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.12619999999999998, "num_moves_min": 0.0, "num_moves_max": 0.32, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.00065, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0010666666666666665, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.517018531439603, "mean_cluster_cpu_util_min": 0.5151421906600477, "mean_cluster_cpu_util_max": 0.5185516868909726, "mean_cluster_mem_util_mean": 0.3359135443037974, "mean_cluster_mem_util_min": 0.33555907172995775, "mean_cluster_mem_util_max": 0.33619409282700424, "reward_consolidation_mean_mean": 3.9362500959517495, "reward_consolidation_mean_min": 3.9317591154162477, "reward_consolidation_mean_max": 3.9399725852142926, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026000000000000002, "reward_sla_mean_min": -0.04266666666666667, "reward_sla_mean_max": -0.005333333333333333, "reward_consolidation_sum_mean": 393.625009595175, "reward_consolidation_sum_min": 393.17591154162477, "reward_consolidation_sum_max": 393.9972585214293, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.6000000000000005, "reward_sla_sum_min": -4.2666666666666675, "reward_sla_sum_max": -0.5333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3669.0, "global_timestep_min": 1800, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.144591671999, 1057.829869932074, 1057.091827347774, 1058.1959365195423, 1059.0504127448312, 1058.1654269091375, 1056.4245149105996, 1056.638545188707, 1058.2630235462573, 1056.9872612629092, 1057.661896493956, 1057.9618142495985, 1057.5673946815334, 1058.1279478509875, 1056.8872764933465, 1056.461604069575, 1059.1026957872637, 1059.4622193792095, 1058.2484145115623, 1057.2135489963166, 1056.9305918547648, 1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.266692799275643, "mean_inference_ms": 2.222864022911787, "mean_action_processing_ms": 0.09851150381670117, "mean_env_wait_ms": 1.9431920201882327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006048440933227539, "StateBufferConnector_ms": 0.003721475601196289, "ViewRequirementAgentConnector_ms": 0.09563016891479492}, "num_episodes": 21, "episode_return_max": 1059.4622193792095, "episode_return_min": 1056.10924487496, "episode_return_mean": 1057.691676261844, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296850, "num_agent_steps_trained": 296450, "num_env_steps_sampled": 296850, "num_env_steps_trained": 296450, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 217.9912977500951, "num_env_steps_trained_throughput_per_sec": 213.14704668898187, "timesteps_total": 296850, "num_env_steps_sampled_lifetime": 296850, "num_agent_steps_sampled_lifetime": 296850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 296850, "timers": {"training_iteration_time_ms": 10496.67, "restore_workers_time_ms": 0.013, "training_step_time_ms": 687.032, "sample_time_ms": 670.869, "synch_weights_time_ms": 14.523}, "counters": {"num_env_steps_sampled": 296850, "num_env_steps_trained": 296450, "num_agent_steps_sampled": 296850, "num_agent_steps_trained": 296450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1979, "num_samples_added_to_queue": 296450}, "done": false, "training_iteration": 135, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-47", "timestamp": 1728776207, "time_this_iter_s": 10.335490465164185, "time_total_s": 1400.2979187965393, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef5b10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1400.2979187965393, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 16.80666666666667, "ram_util_percent": 66.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5931.25390625, "policy_loss": 377.16143798828125, "entropy": 2.4023826122283936, "entropy_coeff": 0.01, "var_gnorm": 18.37802505493164, "vf_loss": 556730.5625, "vf_explained_var": 0.4523400068283081}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 543.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 298950, "num_env_steps_trained": 298650, "num_agent_steps_sampled": 298950, "num_agent_steps_trained": 298650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1993, "num_samples_added_to_queue": 298650, "learner_queue": {"size_count": 543, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.769, "learner_load_time_ms": 0.39, "learner_load_wait_time_ms": 2505.246, "learner_dequeue_time_ms": 22248.595}}, "env_runners": {"episode_reward_max": 1059.3691675043424, "episode_reward_min": 1055.8367053519773, "episode_reward_mean": 1057.6161025922222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.8367053519773}, "policy_reward_max": {"default_policy": 1059.3691675043424}, "policy_reward_mean": {"default_policy": 1057.6161025922222}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11839999999999998, "num_moves_min": 0.0, "num_moves_max": 0.29, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006713333333333334, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170625227523442, "mean_cluster_cpu_util_min": 0.5151421906600477, "mean_cluster_cpu_util_max": 0.5186216446037875, "mean_cluster_mem_util_mean": 0.3359150843881856, "mean_cluster_mem_util_min": 0.33555907172995775, "mean_cluster_mem_util_max": 0.3362616033755274, "reward_consolidation_mean_mean": 3.9363476925888694, "reward_consolidation_mean_min": 3.9317591154162477, "reward_consolidation_mean_max": 3.940038380699991, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.026853333333333337, "reward_sla_mean_min": -0.04533333333333333, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.63476925888693, "reward_consolidation_sum_min": 393.17591154162477, "reward_consolidation_sum_max": 394.0038380699991, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.685333333333333, "reward_sla_sum_min": -4.533333333333333, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4369.0, "global_timestep_min": 2500, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.770586981025, 1056.8743123457941, 1057.4878918029808, 1058.2526059276884, 1058.24019007585, 1057.8020652471923, 1057.9349477596052, 1058.0424137195798, 1057.871345456763, 1058.1177251820056, 1057.7428493100633, 1058.1955831734158, 1057.9034999543103, 1058.3334003472564, 1058.0130007006023, 1057.807743153921, 1057.4876968533943, 1056.8041304943822, 1056.2718937524776, 1057.908081269611, 1056.1927442200517, 1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.266737027974097, "mean_inference_ms": 2.222959471036136, "mean_action_processing_ms": 0.09852588848019302, "mean_env_wait_ms": 1.943523357838032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005990028381347656, "StateBufferConnector_ms": 0.003664731979370117, "ViewRequirementAgentConnector_ms": 0.09499025344848633}, "num_episodes": 21, "episode_return_max": 1059.3691675043424, "episode_return_min": 1055.8367053519773, "episode_return_mean": 1057.6161025922222, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298950, "num_agent_steps_trained": 298650, "num_env_steps_sampled": 298950, "num_env_steps_trained": 298650, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.14377659071062, "num_env_steps_trained_throughput_per_sec": 209.6744326188397, "timesteps_total": 298950, "num_env_steps_sampled_lifetime": 298950, "num_agent_steps_sampled_lifetime": 298950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 298950, "timers": {"training_iteration_time_ms": 10480.497, "restore_workers_time_ms": 0.012, "training_step_time_ms": 752.772, "sample_time_ms": 735.799, "synch_weights_time_ms": 15.382}, "counters": {"num_env_steps_sampled": 298950, "num_env_steps_trained": 298650, "num_agent_steps_sampled": 298950, "num_agent_steps_trained": 298650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1993, "num_samples_added_to_queue": 298650}, "done": false, "training_iteration": 136, "trial_id": "90ffb_00000", "date": "2024-10-13_00-36-57", "timestamp": 1728776217, "time_this_iter_s": 10.505005598068237, "time_total_s": 1410.8029243946075, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef7eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1410.8029243946075, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 16.853333333333328, "ram_util_percent": 66.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5092.6767578125, "policy_loss": -83.20307922363281, "entropy": 2.6753365993499756, "entropy_coeff": 0.01, "var_gnorm": 18.39549446105957, "vf_loss": 519059.4375, "vf_explained_var": 0.47471684217453003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 547.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 301050, "num_env_steps_trained": 300850, "num_agent_steps_sampled": 301050, "num_agent_steps_trained": 300850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2007, "num_samples_added_to_queue": 300850, "learner_queue": {"size_count": 547, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.14, "learner_load_time_ms": 0.36, "learner_load_wait_time_ms": 2610.039, "learner_dequeue_time_ms": 22165.736}}, "env_runners": {"episode_reward_max": 1059.3691675043424, "episode_reward_min": 1055.8367053519773, "episode_reward_mean": 1057.582287367878, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.8367053519773}, "policy_reward_max": {"default_policy": 1059.3691675043424}, "policy_reward_mean": {"default_policy": 1057.582287367878}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1736, "num_moves_min": 0.02, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006813333333333334, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170878419746276, "mean_cluster_cpu_util_min": 0.5151421906600477, "mean_cluster_cpu_util_max": 0.5186216446037875, "mean_cluster_mem_util_mean": 0.3359129113924051, "mean_cluster_mem_util_min": 0.33555907172995775, "mean_cluster_mem_util_max": 0.3362616033755274, "reward_consolidation_mean_mean": 3.9364095403454264, "reward_consolidation_mean_min": 3.9317591154162477, "reward_consolidation_mean_max": 3.940038380699991, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027253333333333338, "reward_sla_mean_min": -0.04533333333333333, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.6409540345427, "reward_consolidation_sum_min": 393.17591154162477, "reward_consolidation_sum_max": 394.0038380699991, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.725333333333333, "reward_sla_sum_min": -4.533333333333333, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5062.0, "global_timestep_min": 3200, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.603033902954, 1057.494471351551, 1056.398745012034, 1057.8483170367679, 1057.7671692710733, 1056.4588625910044, 1057.19161716775, 1057.0620244296226, 1057.3374638277155, 1057.6739589996673, 1057.6061287276511, 1057.3259496177182, 1058.2977611258364, 1057.945365378174, 1058.3717810472465, 1058.1458832130152, 1057.746334033936, 1058.2416400134048, 1058.2087422705556, 1058.2345121691212, 1058.1248530262899, 1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26675231401523525, "mean_inference_ms": 2.2216127543867246, "mean_action_processing_ms": 0.09852465925186957, "mean_env_wait_ms": 1.9434918857338515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006155252456665039, "StateBufferConnector_ms": 0.0036864280700683594, "ViewRequirementAgentConnector_ms": 0.09530138969421387}, "num_episodes": 21, "episode_return_max": 1059.3691675043424, "episode_return_min": 1055.8367053519773, "episode_return_mean": 1057.582287367878, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301050, "num_agent_steps_trained": 300850, "num_env_steps_sampled": 301050, "num_env_steps_trained": 300850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.3616734809356, "num_env_steps_trained_throughput_per_sec": 214.0931817419325, "timesteps_total": 301050, "num_env_steps_sampled_lifetime": 301050, "num_agent_steps_sampled_lifetime": 301050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 301050, "timers": {"training_iteration_time_ms": 10485.891, "restore_workers_time_ms": 0.013, "training_step_time_ms": 723.615, "sample_time_ms": 706.553, "synch_weights_time_ms": 15.531}, "counters": {"num_env_steps_sampled": 301050, "num_env_steps_trained": 300850, "num_agent_steps_sampled": 301050, "num_agent_steps_trained": 300850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2007, "num_samples_added_to_queue": 300850}, "done": false, "training_iteration": 137, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-07", "timestamp": 1728776227, "time_this_iter_s": 10.294181823730469, "time_total_s": 1421.097106218338, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef64a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1421.097106218338, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.02, "ram_util_percent": 67.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4969.2265625, "policy_loss": -1396.8665771484375, "entropy": 2.6618223190307617, "entropy_coeff": 0.01, "var_gnorm": 18.404308319091797, "vf_loss": 638073.3125, "vf_explained_var": 0.41756904125213623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 550.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 303150, "num_env_steps_trained": 302500, "num_agent_steps_sampled": 303150, "num_agent_steps_trained": 302500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2021, "num_samples_added_to_queue": 303050, "learner_queue": {"size_count": 550, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.959, "learner_load_time_ms": 0.36, "learner_load_wait_time_ms": 2701.228, "learner_dequeue_time_ms": 22165.736}}, "env_runners": {"episode_reward_max": 1059.3691675043424, "episode_reward_min": 1055.8054524962706, "episode_reward_mean": 1057.553819610712, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.8054524962706}, "policy_reward_max": {"default_policy": 1059.3691675043424}, "policy_reward_mean": {"default_policy": 1057.553819610712}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.25490000000000007, "num_moves_min": 0.02, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0006926666666666665, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171597124931053, "mean_cluster_cpu_util_min": 0.5150578461114176, "mean_cluster_cpu_util_max": 0.5186216446037875, "mean_cluster_mem_util_mean": 0.33591605485232057, "mean_cluster_mem_util_min": 0.33555907172995775, "mean_cluster_mem_util_max": 0.3362616033755274, "reward_consolidation_mean_mean": 3.9365781961071007, "reward_consolidation_mean_min": 3.9317591154162477, "reward_consolidation_mean_max": 3.940038380699991, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027706666666666668, "reward_sla_mean_min": -0.045333333333333344, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.6578196107101, "reward_consolidation_sum_min": 393.17591154162477, "reward_consolidation_sum_max": 394.0038380699991, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.770666666666667, "reward_sla_sum_min": -4.533333333333334, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5775.0, "global_timestep_min": 4000, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.10924487496, 1057.4538974687036, 1058.0040330195884, 1057.4798623168558, 1057.5503975143952, 1058.3991958329548, 1058.1434950805713, 1057.4065490876992, 1057.9925188095913, 1056.9315300496537, 1058.5094032714994, 1057.1128209814513, 1058.4765055286505, 1056.7827469615304, 1057.2566694081472, 1057.5948094672412, 1056.256541472481, 1058.28056900911, 1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26689819580719343, "mean_inference_ms": 2.2249361020725376, "mean_action_processing_ms": 0.09858297739613141, "mean_env_wait_ms": 1.9447903271486493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006712913513183594, "StateBufferConnector_ms": 0.0037567615509033203, "ViewRequirementAgentConnector_ms": 0.0969698429107666}, "num_episodes": 21, "episode_return_max": 1059.3691675043424, "episode_return_min": 1055.8054524962706, "episode_return_mean": 1057.553819610712, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303150, "num_agent_steps_trained": 302500, "num_env_steps_sampled": 303150, "num_env_steps_trained": 302500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 198.0294091276051, "num_env_steps_trained_throughput_per_sec": 155.5945357431183, "timesteps_total": 303150, "num_env_steps_sampled_lifetime": 303150, "num_agent_steps_sampled_lifetime": 303150, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 303150, "timers": {"training_iteration_time_ms": 10494.897, "restore_workers_time_ms": 0.013, "training_step_time_ms": 764.044, "sample_time_ms": 746.975, "synch_weights_time_ms": 15.565}, "counters": {"num_env_steps_sampled": 303150, "num_env_steps_trained": 302500, "num_agent_steps_sampled": 303150, "num_agent_steps_trained": 302500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2021, "num_samples_added_to_queue": 303050}, "done": false, "training_iteration": 138, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-18", "timestamp": 1728776238, "time_this_iter_s": 10.625535011291504, "time_total_s": 1431.7226412296295, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6650>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1431.7226412296295, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.86, "ram_util_percent": 67.12666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4620.068359375, "policy_loss": -352.88677978515625, "entropy": 2.4979918003082275, "entropy_coeff": 0.01, "var_gnorm": 18.41071128845215, "vf_loss": 498669.375, "vf_explained_var": 0.500931978225708}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 304950, "num_env_steps_trained": 304700, "num_agent_steps_sampled": 304950, "num_agent_steps_trained": 304700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2033, "num_samples_added_to_queue": 304700, "learner_queue": {"size_count": 554, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.32, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2836.522, "learner_dequeue_time_ms": 22016.625}}, "env_runners": {"episode_reward_max": 1059.3691675043424, "episode_reward_min": 1055.7939382862733, "episode_reward_mean": 1057.5669477596048, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.7939382862733}, "policy_reward_max": {"default_policy": 1059.3691675043424}, "policy_reward_mean": {"default_policy": 1057.5669477596048}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.31210000000000004, "num_moves_min": 0.06, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.000692, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5172061442820372, "mean_cluster_cpu_util_min": 0.5150578461114176, "mean_cluster_cpu_util_max": 0.5186216446037875, "mean_cluster_mem_util_mean": 0.33591976793248945, "mean_cluster_mem_util_min": 0.33555907172995775, "mean_cluster_mem_util_max": 0.3362616033755274, "reward_consolidation_mean_mean": 3.9366828109293612, "reward_consolidation_mean_min": 3.9318139449876632, "reward_consolidation_mean_max": 3.940038380699991, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027680000000000003, "reward_sla_mean_min": -0.045333333333333344, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.668281092936, "reward_consolidation_sum_min": 393.18139449876634, "reward_consolidation_sum_max": 394.0038380699991, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7679999999999993, "reward_sla_sum_min": -4.533333333333334, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5914.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.2752810015554, 1056.6184166438234, 1057.367266745867, 1058.2558957019728, 1058.6329647567718, 1058.9712632124058, 1056.8730208047784, 1057.241865423865, 1057.6944043376302, 1058.6426391300397, 1057.9011483749148, 1058.246574674832, 1058.9241097809884, 1057.0205489049335, 1056.6060007919848, 1056.7164031801171, 1057.7781351853573, 1058.6143227024909, 1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670842097607044, "mean_inference_ms": 2.228752697871836, "mean_action_processing_ms": 0.09865477936483018, "mean_env_wait_ms": 1.9463533681647598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069882869720458984, "StateBufferConnector_ms": 0.003907918930053711, "ViewRequirementAgentConnector_ms": 0.10223650932312012}, "num_episodes": 18, "episode_return_max": 1059.3691675043424, "episode_return_min": 1055.7939382862733, "episode_return_mean": 1057.5669477596048, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304950, "num_agent_steps_trained": 304700, "num_env_steps_sampled": 304950, "num_env_steps_trained": 304700, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 172.9073745403344, "num_env_steps_trained_throughput_per_sec": 211.3312355492976, "timesteps_total": 304950, "num_env_steps_sampled_lifetime": 304950, "num_agent_steps_sampled_lifetime": 304950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 304950, "timers": {"training_iteration_time_ms": 10479.144, "restore_workers_time_ms": 0.013, "training_step_time_ms": 785.318, "sample_time_ms": 768.991, "synch_weights_time_ms": 14.746}, "counters": {"num_env_steps_sampled": 304950, "num_env_steps_trained": 304700, "num_agent_steps_sampled": 304950, "num_agent_steps_trained": 304700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2033, "num_samples_added_to_queue": 304700}, "done": false, "training_iteration": 139, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-29", "timestamp": 1728776249, "time_this_iter_s": 10.42085576057434, "time_total_s": 1442.1434969902039, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d57611946a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1442.1434969902039, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 28.00666666666667, "ram_util_percent": 69.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6453.76904296875, "policy_loss": -581.37744140625, "entropy": 2.2137792110443115, "entropy_coeff": 0.01, "var_gnorm": 18.413068771362305, "vf_loss": 704732.25, "vf_explained_var": 0.40825968980789185}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 557.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 306750, "num_env_steps_trained": 306350, "num_agent_steps_sampled": 306750, "num_agent_steps_trained": 306350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2045, "num_samples_added_to_queue": 306350, "learner_queue": {"size_count": 557, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.787, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2979.438, "learner_dequeue_time_ms": 22016.625}}, "env_runners": {"episode_reward_max": 1059.3691675043424, "episode_reward_min": 1055.7939382862733, "episode_reward_mean": 1057.5686807395923, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.7939382862733}, "policy_reward_max": {"default_policy": 1059.3691675043424}, "policy_reward_mean": {"default_policy": 1057.5686807395923}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3148, "num_moves_min": 0.02, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.00069, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5171784188269902, "mean_cluster_cpu_util_min": 0.5150578461114176, "mean_cluster_cpu_util_max": 0.5186216446037875, "mean_cluster_mem_util_mean": 0.3359099789029536, "mean_cluster_mem_util_min": 0.33556540084388187, "mean_cluster_mem_util_max": 0.3362616033755274, "reward_consolidation_mean_mean": 3.9366201407292336, "reward_consolidation_mean_min": 3.9318139449876632, "reward_consolidation_mean_max": 3.940038380699991, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027600000000000003, "reward_sla_mean_min": -0.045333333333333344, "reward_sla_mean_max": -0.010666666666666666, "reward_consolidation_sum_mean": 393.66201407292334, "reward_consolidation_sum_min": 393.18139449876634, "reward_consolidation_sum_max": 394.0038380699991, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.7600000000000007, "reward_sla_sum_min": -4.533333333333334, "reward_sla_sum_max": -1.0666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5111.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1057.4904383319647, 1057.6995339486448, 1058.0193852995837, 1057.4992110633912, 1057.120887020624, 1057.954881354902, 1057.6129032258093, 1056.0255140272338, 1055.8367053519773, 1057.5224344329733, 1058.2705047366676, 1057.9989034085738, 1059.3691675043424, 1056.5376587773026, 1057.1879374942907, 1058.1582990648535, 1057.1358494014462, 1056.6473179201334, 1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2672984298802561, "mean_inference_ms": 2.231905018584377, "mean_action_processing_ms": 0.09873091174102402, "mean_env_wait_ms": 1.948049744525039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007146120071411133, "StateBufferConnector_ms": 0.004010677337646484, "ViewRequirementAgentConnector_ms": 0.10447525978088379}, "num_episodes": 18, "episode_return_max": 1059.3691675043424, "episode_return_min": 1055.7939382862733, "episode_return_mean": 1057.5686807395923, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306750, "num_agent_steps_trained": 306350, "num_env_steps_sampled": 306750, "num_env_steps_trained": 306350, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 174.4367082575442, "num_env_steps_trained_throughput_per_sec": 159.90031590274884, "timesteps_total": 306750, "num_env_steps_sampled_lifetime": 306750, "num_agent_steps_sampled_lifetime": 306750, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 306750, "timers": {"training_iteration_time_ms": 10501.72, "restore_workers_time_ms": 0.021, "training_step_time_ms": 878.586, "sample_time_ms": 860.649, "synch_weights_time_ms": 16.251}, "counters": {"num_env_steps_sampled": 306750, "num_env_steps_trained": 306350, "num_agent_steps_sampled": 306750, "num_agent_steps_trained": 306350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2045, "num_samples_added_to_queue": 306350}, "done": false, "training_iteration": 140, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-39", "timestamp": 1728776259, "time_this_iter_s": 10.330087184906006, "time_total_s": 1452.4735841751099, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef6080>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1452.4735841751099, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 27.385714285714283, "ram_util_percent": 69.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6527.0283203125, "policy_loss": 577.8009033203125, "entropy": 2.1164817810058594, "entropy_coeff": 0.01, "var_gnorm": 18.40852165222168, "vf_loss": 596086.8125, "vf_explained_var": 0.4517556428909302}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 560.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 308550, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308550, "num_agent_steps_trained": 308000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2057, "num_samples_added_to_queue": 308550, "learner_queue": {"size_count": 560, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.87, "learner_load_time_ms": 0.373, "learner_load_wait_time_ms": 3011.756, "learner_dequeue_time_ms": 22166.183}}, "env_runners": {"episode_reward_max": 1059.7548143409808, "episode_reward_min": 1055.7939382862733, "episode_reward_mean": 1057.600612141706, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1055.7939382862733}, "policy_reward_max": {"default_policy": 1059.7548143409808}, "policy_reward_mean": {"default_policy": 1057.600612141706}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.29000000000000004, "num_moves_min": 0.0, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006773333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170924043941901, "mean_cluster_cpu_util_min": 0.5149427284427284, "mean_cluster_cpu_util_max": 0.5185460332781762, "mean_cluster_mem_util_mean": 0.3359022784810126, "mean_cluster_mem_util_min": 0.33556540084388187, "mean_cluster_mem_util_max": 0.3361561181434599, "reward_consolidation_mean_mean": 3.9364327880837062, "reward_consolidation_mean_min": 3.931770081330531, "reward_consolidation_mean_max": 3.9398245453714704, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.027093333333333337, "reward_sla_mean_min": -0.045333333333333344, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.6432788083706, "reward_consolidation_sum_min": 393.1770081330531, "reward_consolidation_sum_max": 393.982454537147, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.709333333333333, "reward_sla_sum_min": -4.533333333333334, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4302.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168, 1057.177008133055, 1057.806646562493, 1058.4178378872361, 1057.4884400986955, 1057.3648786134236, 1059.7548143409808, 1057.7373663529215, 1057.7017271315015, 1057.649090742943, 1057.4997593591052, 1057.2504797587526, 1057.6320935758042, 1056.5453349173008, 1058.2281275701384, 1056.9505254500616, 1056.816741295808, 1057.0609278381937, 1058.1988729477007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1058.1758445277062, 1056.0161930000936, 1057.5063389076747, 1056.5639769715817, 1057.4465746748322, 1058.2807639586972, 1057.4849553748234, 1056.6273843248368, 1057.9678455024546, 1057.7000822443595, 1058.3929696305117, 1056.8688293886526, 1057.5010509001213, 1056.4966949952807, 1058.5485272167923, 1057.4131286362688, 1058.1065643181355, 1056.856766882941, 1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168, 1057.177008133055, 1057.806646562493, 1058.4178378872361, 1057.4884400986955, 1057.3648786134236, 1059.7548143409808, 1057.7373663529215, 1057.7017271315015, 1057.649090742943, 1057.4997593591052, 1057.2504797587526, 1057.6320935758042, 1056.5453349173008, 1058.2281275701384, 1056.9505254500616, 1056.816741295808, 1057.0609278381937, 1058.1988729477007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26749268066685716, "mean_inference_ms": 2.2327628225996548, "mean_action_processing_ms": 0.09878897463284197, "mean_env_wait_ms": 1.9493853268694847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007211446762084961, "StateBufferConnector_ms": 0.0040760040283203125, "ViewRequirementAgentConnector_ms": 0.10594773292541504}, "num_episodes": 18, "episode_return_max": 1059.7548143409808, "episode_return_min": 1055.7939382862733, "episode_return_mean": 1057.600612141706, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308550, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308550, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 177.27866123688952, "num_env_steps_trained_throughput_per_sec": 162.5054394671487, "timesteps_total": 308550, "num_env_steps_sampled_lifetime": 308550, "num_agent_steps_sampled_lifetime": 308550, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 308550, "timers": {"training_iteration_time_ms": 10373.614, "restore_workers_time_ms": 0.015, "training_step_time_ms": 856.486, "sample_time_ms": 836.59, "synch_weights_time_ms": 18.151}, "counters": {"num_env_steps_sampled": 308550, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308550, "num_agent_steps_trained": 308000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2057, "num_samples_added_to_queue": 308550}, "done": false, "training_iteration": 141, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-49", "timestamp": 1728776269, "time_this_iter_s": 10.164875030517578, "time_total_s": 1462.6384592056274, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef4880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1462.6384592056274, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 24.060000000000006, "ram_util_percent": 70.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6367.935546875, "policy_loss": -442.2814636230469, "entropy": 2.1153564453125, "entropy_coeff": 0.01, "var_gnorm": 18.39380645751953, "vf_loss": 682185.1875, "vf_explained_var": 0.40445345640182495}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 564.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2069, "num_samples_added_to_queue": 310200, "learner_queue": {"size_count": 564, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.406, "learner_load_time_ms": 0.373, "learner_load_wait_time_ms": 2979.512, "learner_dequeue_time_ms": 22166.183}}, "env_runners": {"episode_reward_max": 1059.7548143409808, "episode_reward_min": 1054.9992262938279, "episode_reward_mean": 1057.670243504221, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1054.9992262938279}, "policy_reward_max": {"default_policy": 1059.7548143409808}, "policy_reward_mean": {"default_policy": 1057.670243504221}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.23280000000000003, "num_moves_min": 0.0, "num_moves_max": 0.58, "mean_accuracy_mean": 42.36666666666668, "mean_accuracy_min": 42.36666666666668, "mean_accuracy_max": 42.36666666666668, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.0006593333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0013999999999999996, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5170832492186064, "mean_cluster_cpu_util_min": 0.5149427284427284, "mean_cluster_cpu_util_max": 0.5185460332781762, "mean_cluster_mem_util_mean": 0.33590989451476794, "mean_cluster_mem_util_min": 0.33556540084388187, "mean_cluster_mem_util_max": 0.3361561181434599, "reward_consolidation_mean_mean": 3.9364091017088545, "reward_consolidation_mean_min": 3.931770081330531, "reward_consolidation_mean_max": 3.9398245453714704, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.666666666666689, "reward_accuracy_mean_min": 6.666666666666689, "reward_accuracy_mean_max": 6.666666666666689, "reward_sla_mean_mean": -0.02637333333333334, "reward_sla_mean_min": -0.055999999999999994, "reward_sla_mean_max": -0.008, "reward_consolidation_sum_mean": 393.64091017088555, "reward_consolidation_sum_min": 393.1770081330531, "reward_consolidation_sum_max": 393.982454537147, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 666.6666666666689, "reward_accuracy_sum_min": 666.6666666666689, "reward_accuracy_sum_max": 666.6666666666689, "reward_sla_sum_mean": -2.637333333333334, "reward_sla_sum_min": -5.6, "reward_sla_sum_max": -0.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3487.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168, 1057.177008133055, 1057.806646562493, 1058.4178378872361, 1057.4884400986955, 1057.3648786134236, 1059.7548143409808, 1057.7373663529215, 1057.7017271315015, 1057.649090742943, 1057.4997593591052, 1057.2504797587526, 1057.6320935758042, 1056.5453349173008, 1058.2281275701384, 1056.9505254500616, 1056.816741295808, 1057.0609278381937, 1058.1988729477007, 1056.7425264248095, 1057.6754089372223, 1058.2153218191256, 1058.0449968016105, 1059.007645679127, 1058.4781504157938, 1058.319144658688, 1058.5139845868002, 1057.8108379786186, 1058.583971488625, 1058.6554448810525, 1057.1826494867366, 1058.1657802552645, 1054.9992262938279, 1057.1396874714446, 1057.1775564287686, 1057.424289500139, 1058.781004599594], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1056.9571049986314, 1057.3745529866903, 1056.7048889701202, 1058.4830850772198, 1058.0742148709999, 1057.9025983124695, 1057.484602028697, 1056.959298181488, 1055.8054524962706, 1057.9380425843026, 1059.0197081848385, 1057.6225775990756, 1058.9413018977148, 1058.010064272444, 1056.4303512138677, 1058.0206768406003, 1057.7264004386388, 1056.7015991958347, 1057.6617015443683, 1057.8020652471916, 1058.4743123457936, 1058.0182887081562, 1057.5174997715462, 1055.8204514301399, 1058.2950196472655, 1056.7019525419619, 1057.589679856227, 1057.1813944987687, 1058.4194827743788, 1058.3153065886893, 1056.8041304943818, 1058.119723415275, 1058.5157878704827, 1057.9152091138958, 1057.2751530658895, 1057.2612507234478, 1058.3491059733792, 1057.5580736543932, 1057.531012214812, 1058.347656035824, 1057.646349264372, 1058.046251789578, 1056.0129032258085, 1057.9393341253185, 1055.7939382862733, 1057.2029364281598, 1058.3509458101091, 1058.8089676810155, 1056.4106125681583, 1057.4692497486997, 1057.9188522343075, 1057.4685065033984, 1058.6570897681947, 1056.5561058819972, 1057.1154040634826, 1058.827061439583, 1058.4227725486633, 1058.8051296110168, 1057.8516068110532, 1057.5509458101092, 1057.7242072557817, 1058.219354838712, 1056.6317706905497, 1057.7649760882168, 1057.177008133055, 1057.806646562493, 1058.4178378872361, 1057.4884400986955, 1057.3648786134236, 1059.7548143409808, 1057.7373663529215, 1057.7017271315015, 1057.649090742943, 1057.4997593591052, 1057.2504797587526, 1057.6320935758042, 1056.5453349173008, 1058.2281275701384, 1056.9505254500616, 1056.816741295808, 1057.0609278381937, 1058.1988729477007, 1056.7425264248095, 1057.6754089372223, 1058.2153218191256, 1058.0449968016105, 1059.007645679127, 1058.4781504157938, 1058.319144658688, 1058.5139845868002, 1057.8108379786186, 1058.583971488625, 1058.6554448810525, 1057.1826494867366, 1058.1657802552645, 1054.9992262938279, 1057.1396874714446, 1057.1775564287686, 1057.424289500139, 1058.781004599594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26771236380547214, "mean_inference_ms": 2.2340358392423205, "mean_action_processing_ms": 0.09886009604294518, "mean_env_wait_ms": 1.950957579515365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265329360961914, "StateBufferConnector_ms": 0.004174947738647461, "ViewRequirementAgentConnector_ms": 0.10914087295532227}, "num_episodes": 18, "episode_return_max": 1059.7548143409808, "episode_return_min": 1054.9992262938279, "episode_return_mean": 1057.670243504221, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 177.69891918250863, "num_env_steps_trained_throughput_per_sec": 217.18756788973278, "timesteps_total": 310350, "num_env_steps_sampled_lifetime": 310350, "num_agent_steps_sampled_lifetime": 310350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 310350, "timers": {"training_iteration_time_ms": 10347.453, "restore_workers_time_ms": 0.014, "training_step_time_ms": 854.157, "sample_time_ms": 837.916, "synch_weights_time_ms": 14.668}, "counters": {"num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2069, "num_samples_added_to_queue": 310200}, "done": false, "training_iteration": 142, "trial_id": "90ffb_00000", "date": "2024-10-13_00-37-59", "timestamp": 1728776279, "time_this_iter_s": 10.141234874725342, "time_total_s": 1472.7796940803528, "pid": 527754, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7d5760ef4a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7d575a759c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1472.7796940803528, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.914285714285715, "ram_util_percent": 70.72857142857143}}
