{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -337105.34375, "policy_loss": -337336.34375, "entropy": 29.791093826293945, "entropy_coeff": 0.01, "var_gnorm": 16.015676498413086, "vf_loss": 320379.75, "vf_explained_var": 0.0032048821449279785}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333339}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 3000, "learner_queue": {"size_count": 10, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 39.767, "learner_load_time_ms": 0.177, "learner_load_wait_time_ms": 923.079, "learner_dequeue_time_ms": 4336.919}}, "env_runners": {"episode_reward_max": -192.17999999999998, "episode_reward_min": -228.31666666666663, "episode_reward_mean": -209.4556249999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 3200, "policy_reward_min": {"default_policy": -228.31666666666663}, "policy_reward_max": {"default_policy": -192.17999999999998}, "policy_reward_mean": {"default_policy": -209.4556249999999}, "custom_metrics": {"num_consolidated_mean": 0.659375, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0368750000000002, "num_overloaded_min": 0.92, "num_overloaded_max": 1.21, "num_moves_mean": 10.023125, "num_moves_min": 9.73, "num_moves_max": 10.24, "mean_accuracy_mean": 41.09920833333334, "mean_accuracy_min": 40.903666666666666, "mean_accuracy_max": 41.28366666666667, "num_model_switches_mean": 6.0, "num_model_switches_min": 5.64, "num_model_switches_max": 6.34, "num_slav_mean": 0.16137239583333335, "num_slav_min": 0.14966666666666667, "num_slav_max": 0.1762166666666667, "mean_cluster_cpu_util_mean": 0.5683480396268358, "mean_cluster_cpu_util_min": 0.5506162976451259, "mean_cluster_cpu_util_max": 0.5856829344617696, "mean_cluster_mem_util_mean": 0.3648225748711932, "mean_cluster_mem_util_min": 0.35530940594592264, "mean_cluster_mem_util_max": 0.37199235411464165, "reward_consolidation_mean_mean": -0.05039062500000001, "reward_consolidation_mean_min": -0.09416666666666668, "reward_consolidation_mean_max": -0.010000000000000007, "reward_illegal_mean_mean": -1.7281249999999997, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.018464583333333312, "reward_accuracy_mean_min": 0.0049333333333332246, "reward_accuracy_mean_max": 0.03396666666666671, "reward_sla_mean_mean": -0.3345052083333333, "reward_sla_mean_min": -0.5365, "reward_sla_mean_max": -0.17866666666666667, "reward_consolidation_sum_mean": -5.039062500000001, "reward_consolidation_sum_min": -9.416666666666668, "reward_consolidation_sum_max": -1.0000000000000007, "reward_illegal_sum_mean": -172.8125, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 1.8464583333333313, "reward_accuracy_sum_min": 0.49333333333332247, "reward_accuracy_sum_max": 3.396666666666671, "reward_sla_sum_mean": -33.450520833333336, "reward_sla_sum_min": -53.65, "reward_sla_sum_max": -17.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 850.0, "global_timestep_min": 100, "global_timestep_max": 1600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.182208011181633, "mean_inference_ms": 1.693335270449789, "mean_action_processing_ms": 0.07087115121587673, "mean_env_wait_ms": 1.1398242757441028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049211084842681885, "StateBufferConnector_ms": 0.0028051435947418213, "ViewRequirementAgentConnector_ms": 0.061164796352386475}, "num_episodes": 32, "episode_return_max": -192.17999999999998, "episode_return_min": -228.31666666666663, "episode_return_mean": -209.4556249999999, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3000, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3000, "num_env_steps_sampled_this_iter": 3200, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 312.3560021320252, "num_env_steps_trained_throughput_per_sec": 292.83375199877366, "timesteps_total": 3200, "num_env_steps_sampled_lifetime": 3200, "num_agent_steps_sampled_lifetime": 3200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 10244.727, "restore_workers_time_ms": 0.011, "training_step_time_ms": 309.899, "sample_time_ms": 301.647, "synch_weights_time_ms": 7.465}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 3000}, "done": false, "training_iteration": 1, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-24-28", "timestamp": 1728591868, "time_this_iter_s": 10.24911379814148, "time_total_s": 10.24911379814148, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b604c8ca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.24911379814148, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.186666666666667, "ram_util_percent": 47.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -321350.28125, "policy_loss": -321554.28125, "entropy": 29.748872756958008, "entropy_coeff": 0.01, "var_gnorm": 16.037899017333984, "vf_loss": 293251.0, "vf_explained_var": 0.007599174976348877}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333333215}}, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6200, "num_agent_steps_trained": 6000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 62, "num_samples_added_to_queue": 6000, "learner_queue": {"size_count": 20, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.984, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 953.762, "learner_dequeue_time_ms": 5532.552}}, "env_runners": {"episode_reward_max": -192.17999999999998, "episode_reward_min": -230.01999999999995, "episode_reward_mean": -209.8529569892472, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6200, "policy_reward_min": {"default_policy": -230.01999999999995}, "policy_reward_max": {"default_policy": -192.17999999999998}, "policy_reward_mean": {"default_policy": -209.8529569892472}, "custom_metrics": {"num_consolidated_mean": 0.6625806451612904, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0390322580645162, "num_overloaded_min": 0.92, "num_overloaded_max": 1.21, "num_moves_mean": 10.019516129032258, "num_moves_min": 9.73, "num_moves_max": 10.38, "mean_accuracy_mean": 41.088354838709684, "mean_accuracy_min": 40.89099999999999, "mean_accuracy_max": 41.28366666666667, "num_model_switches_mean": 6.018225806451613, "num_model_switches_min": 5.64, "num_model_switches_max": 6.39, "num_slav_mean": 0.1616040322580645, "num_slav_min": 0.14086666666666667, "num_slav_max": 0.17650000000000002, "mean_cluster_cpu_util_mean": 0.5682103802906094, "mean_cluster_cpu_util_min": 0.548855262266999, "mean_cluster_cpu_util_max": 0.5856829344617696, "mean_cluster_mem_util_mean": 0.364736051146333, "mean_cluster_mem_util_min": 0.35530940594592264, "mean_cluster_mem_util_max": 0.37199235411464165, "reward_consolidation_mean_mean": -0.0486962365591398, "reward_consolidation_mean_min": -0.09416666666666668, "reward_consolidation_mean_max": -0.010000000000000007, "reward_illegal_mean_mean": -1.7317204301075266, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.018655913978494598, "reward_accuracy_mean_min": 0.0049333333333332246, "reward_accuracy_mean_max": 0.035400000000000056, "reward_sla_mean_mean": -0.3367688172043011, "reward_sla_mean_min": -0.5365, "reward_sla_mean_max": -0.17866666666666667, "reward_consolidation_sum_mean": -4.86962365591398, "reward_consolidation_sum_min": -9.416666666666668, "reward_consolidation_sum_max": -1.0000000000000007, "reward_illegal_sum_mean": -173.17204301075265, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 1.8655913978494598, "reward_accuracy_sum_min": 0.49333333333332247, "reward_accuracy_sum_max": 3.540000000000006, "reward_sla_sum_mean": -33.67688172043011, "reward_sla_sum_min": -53.65, "reward_sla_sum_max": -17.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1600.0, "global_timestep_min": 100, "global_timestep_max": 3100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18459327514527926, "mean_inference_ms": 1.7118521564777385, "mean_action_processing_ms": 0.07137417137947002, "mean_env_wait_ms": 1.1465417437546763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044580428831038936, "StateBufferConnector_ms": 0.0027806528152958037, "ViewRequirementAgentConnector_ms": 0.06261640979397681}, "num_episodes": 30, "episode_return_max": -192.17999999999998, "episode_return_min": -230.01999999999995, "episode_return_mean": -209.8529569892472, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6200, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.48491471344, "num_env_steps_trained_throughput_per_sec": 299.48491471344, "timesteps_total": 6200, "num_env_steps_sampled_lifetime": 6200, "num_agent_steps_sampled_lifetime": 6200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 6200, "timers": {"training_iteration_time_ms": 10130.967, "restore_workers_time_ms": 0.012, "training_step_time_ms": 337.636, "sample_time_ms": 329.121, "synch_weights_time_ms": 7.653}, "counters": {"num_env_steps_sampled": 6200, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6200, "num_agent_steps_trained": 6000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 62, "num_samples_added_to_queue": 6000}, "done": false, "training_iteration": 2, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-24-38", "timestamp": 1728591878, "time_this_iter_s": 10.023722648620605, "time_total_s": 20.272836446762085, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81d6f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.272836446762085, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.971428571428573, "ram_util_percent": 46.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -303476.71875, "policy_loss": -303650.53125, "entropy": 29.695690155029297, "entropy_coeff": 0.01, "var_gnorm": 16.05849838256836, "vf_loss": 262920.375, "vf_explained_var": 0.013299763202667236}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333333215}}, "num_env_steps_sampled": 9100, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9100, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 91, "num_samples_added_to_queue": 9000, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.778, "learner_load_time_ms": 0.216, "learner_load_wait_time_ms": 1002.296, "learner_dequeue_time_ms": 6233.402}}, "env_runners": {"episode_reward_max": -192.17999999999998, "episode_reward_min": -230.01999999999995, "episode_reward_mean": -209.72677777777764, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9000, "policy_reward_min": {"default_policy": -230.01999999999995}, "policy_reward_max": {"default_policy": -192.17999999999998}, "policy_reward_mean": {"default_policy": -209.72677777777764}, "custom_metrics": {"num_consolidated_mean": 0.6697777777777778, "num_consolidated_min": 0.5, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0387777777777778, "num_overloaded_min": 0.9, "num_overloaded_max": 1.21, "num_moves_mean": 10.003333333333332, "num_moves_min": 9.73, "num_moves_max": 10.38, "mean_accuracy_mean": 41.08142222222222, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 6.010111111111111, "num_model_switches_min": 5.54, "num_model_switches_max": 6.39, "num_slav_mean": 0.1612301851851852, "num_slav_min": 0.14086666666666667, "num_slav_max": 0.1805, "mean_cluster_cpu_util_mean": 0.5689767813887564, "mean_cluster_cpu_util_min": 0.548855262266999, "mean_cluster_cpu_util_max": 0.5935359200534996, "mean_cluster_mem_util_mean": 0.3649507706461628, "mean_cluster_mem_util_min": 0.35530940594592264, "mean_cluster_mem_util_max": 0.37602995583254395, "reward_consolidation_mean_mean": -0.04910185185185187, "reward_consolidation_mean_min": -0.09416666666666668, "reward_consolidation_mean_max": -0.010000000000000007, "reward_illegal_mean_mean": -1.731296296296296, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.5, "reward_accuracy_mean_mean": 0.0181933333333333, "reward_accuracy_mean_min": 0.0049333333333332246, "reward_accuracy_mean_max": 0.035400000000000056, "reward_sla_mean_mean": -0.33506296296296295, "reward_sla_mean_min": -0.5365, "reward_sla_mean_max": -0.163, "reward_consolidation_sum_mean": -4.910185185185186, "reward_consolidation_sum_min": -9.416666666666668, "reward_consolidation_sum_max": -1.0000000000000007, "reward_illegal_sum_mean": -173.12962962962962, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -150.0, "reward_accuracy_sum_mean": 1.8193333333333306, "reward_accuracy_sum_min": 0.49333333333332247, "reward_accuracy_sum_max": 3.540000000000006, "reward_sla_sum_mean": -33.5062962962963, "reward_sla_sum_min": -53.65, "reward_sla_sum_max": -16.3, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2300.0, "global_timestep_min": 100, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-216.65999999999988, -209.8999999999999, -192.17999999999998, -211.40666666666655, -203.15333333333314, -209.25333333333333, -214.4699999999999, -211.92666666666656, -207.41333333333324, -197.96999999999997, -207.5233333333333, -200.19333333333327, -216.02999999999994, -217.93999999999997, -217.59333333333316, -208.26999999999998, -203.80333333333311, -208.08999999999992, -228.31666666666663, -223.01666666666645, -209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18693063841355845, "mean_inference_ms": 1.730160619326327, "mean_action_processing_ms": 0.07210774451517149, "mean_env_wait_ms": 1.156886763509698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004472997453477647, "StateBufferConnector_ms": 0.0028485722011990016, "ViewRequirementAgentConnector_ms": 0.06427658928765191}, "num_episodes": 28, "episode_return_max": -192.17999999999998, "episode_return_min": -230.01999999999995, "episode_return_mean": -209.72677777777764, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9100, "num_agent_steps_trained": 9000, "num_env_steps_sampled": 9100, "num_env_steps_trained": 9000, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.1063218364536, "num_env_steps_trained_throughput_per_sec": 294.9375743135727, "timesteps_total": 9100, "num_env_steps_sampled_lifetime": 9100, "num_agent_steps_sampled_lifetime": 9100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 9100, "timers": {"training_iteration_time_ms": 10144.529, "restore_workers_time_ms": 0.013, "training_step_time_ms": 341.426, "sample_time_ms": 331.755, "synch_weights_time_ms": 8.778}, "counters": {"num_env_steps_sampled": 9100, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9100, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 91, "num_samples_added_to_queue": 9000}, "done": false, "training_iteration": 3, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-24-48", "timestamp": 1728591888, "time_this_iter_s": 10.184679985046387, "time_total_s": 30.45751643180847, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81d4e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.45751643180847, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.193333333333332, "ram_util_percent": 46.36000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -315886.03125, "policy_loss": -316087.75, "entropy": 29.599637985229492, "entropy_coeff": 0.01, "var_gnorm": 16.076194763183594, "vf_loss": 290532.5, "vf_explained_var": 0.018796205520629883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333357}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 12000, "learner_queue": {"size_count": 39, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.839, "learner_load_time_ms": 0.195, "learner_load_wait_time_ms": 1010.251, "learner_dequeue_time_ms": 6665.976}}, "env_runners": {"episode_reward_max": -191.9933333333332, "episode_reward_min": -230.01999999999995, "episode_reward_mean": -209.0687999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -230.01999999999995}, "policy_reward_max": {"default_policy": -191.9933333333332}, "policy_reward_mean": {"default_policy": -209.0687999999999}, "custom_metrics": {"num_consolidated_mean": 0.6726999999999999, "num_consolidated_min": 0.43, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0369, "num_overloaded_min": 0.9, "num_overloaded_max": 1.21, "num_moves_mean": 9.999500000000001, "num_moves_min": 9.75, "num_moves_max": 10.38, "mean_accuracy_mean": 41.07302000000001, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 5.9984, "num_model_switches_min": 5.54, "num_model_switches_max": 6.39, "num_slav_mean": 0.16149216666666663, "num_slav_min": 0.14086666666666667, "num_slav_max": 0.1805, "mean_cluster_cpu_util_mean": 0.5681973845282512, "mean_cluster_cpu_util_min": 0.548855262266999, "mean_cluster_cpu_util_max": 0.5935359200534996, "mean_cluster_mem_util_mean": 0.36441447858721543, "mean_cluster_mem_util_min": 0.35530940594592264, "mean_cluster_mem_util_max": 0.37602995583254395, "reward_consolidation_mean_mean": -0.04864166666666669, "reward_consolidation_mean_min": -0.08916666666666667, "reward_consolidation_mean_max": -0.010000000000000007, "reward_illegal_mean_mean": -1.7281666666666666, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.5, "reward_accuracy_mean_mean": 0.0175853333333333, "reward_accuracy_mean_min": 0.005233333333333206, "reward_accuracy_mean_max": 0.035400000000000056, "reward_sla_mean_mean": -0.331465, "reward_sla_mean_min": -0.6085, "reward_sla_mean_max": -0.163, "reward_consolidation_sum_mean": -4.864166666666668, "reward_consolidation_sum_min": -8.916666666666668, "reward_consolidation_sum_max": -1.0000000000000007, "reward_illegal_sum_mean": -172.8166666666667, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -150.0, "reward_accuracy_sum_mean": 1.7585333333333302, "reward_accuracy_sum_min": 0.5233333333333207, "reward_accuracy_sum_max": 3.540000000000006, "reward_sla_sum_mean": -33.146499999999996, "reward_sla_sum_min": -60.85, "reward_sla_sum_max": -16.3, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3514.0, "global_timestep_min": 500, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-209.2233333333333, -207.03666666666652, -203.16666666666646, -209.92333333333326, -210.6366666666666, -212.42333333333312, -211.35000000000002, -217.6933333333332, -198.04666666666657, -213.59333333333328, -207.46333333333322, -196.9133333333333, -193.11333333333323, -207.2633333333333, -218.14, -216.39333333333323, -209.80666666666656, -209.54333333333318, -206.37333333333336, -230.01999999999995, -207.78333333333322, -218.39, -205.20333333333323, -212.05666666666673, -209.7566666666667, -196.58333333333317, -207.28333333333327, -207.00666666666655, -209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19033323546137157, "mean_inference_ms": 1.7518458241329469, "mean_action_processing_ms": 0.07308614747161078, "mean_env_wait_ms": 1.1706466621866476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004341840744018555, "StateBufferConnector_ms": 0.0028839111328125, "ViewRequirementAgentConnector_ms": 0.06598639488220215}, "num_episodes": 30, "episode_return_max": -191.9933333333332, "episode_return_min": -230.01999999999995, "episode_return_mean": -209.0687999999999, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.6126526386206, "num_env_steps_trained_throughput_per_sec": 264.0531593531985, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10164.702, "restore_workers_time_ms": 0.012, "training_step_time_ms": 360.181, "sample_time_ms": 350.519, "synch_weights_time_ms": 8.578}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 12000}, "done": false, "training_iteration": 4, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-24-59", "timestamp": 1728591899, "time_this_iter_s": 10.23533821105957, "time_total_s": 40.69285464286804, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6fb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.69285464286804, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.513333333333334, "ram_util_percent": 46.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -300909.0, "policy_loss": -301081.25, "entropy": 29.440921783447266, "entropy_coeff": 0.01, "var_gnorm": 16.0982608795166, "vf_loss": 260571.09375, "vf_explained_var": 0.031793951988220215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333357}}, "num_env_steps_sampled": 14900, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 149, "num_samples_added_to_queue": 14700, "learner_queue": {"size_count": 49, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.785, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 999.29, "learner_dequeue_time_ms": 7192.514}}, "env_runners": {"episode_reward_max": -187.25666666666666, "episode_reward_min": -225.63333333333318, "episode_reward_mean": -208.67506666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -225.63333333333318}, "policy_reward_max": {"default_policy": -187.25666666666666}, "policy_reward_mean": {"default_policy": -208.67506666666657}, "custom_metrics": {"num_consolidated_mean": 0.6834, "num_consolidated_min": 0.43, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0437, "num_overloaded_min": 0.9, "num_overloaded_max": 1.19, "num_moves_mean": 9.9877, "num_moves_min": 9.75, "num_moves_max": 10.32, "mean_accuracy_mean": 41.08397666666666, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 5.987, "num_model_switches_min": 5.54, "num_model_switches_max": 6.4, "num_slav_mean": 0.16173883333333333, "num_slav_min": 0.14086666666666667, "num_slav_max": 0.18655000000000005, "mean_cluster_cpu_util_mean": 0.5705743041926318, "mean_cluster_cpu_util_min": 0.5503342594788931, "mean_cluster_cpu_util_max": 0.5974250947359409, "mean_cluster_mem_util_mean": 0.3654355341678866, "mean_cluster_mem_util_min": 0.3557038688682224, "mean_cluster_mem_util_max": 0.37760643980165903, "reward_consolidation_mean_mean": -0.046966666666666684, "reward_consolidation_mean_min": -0.08416666666666668, "reward_consolidation_mean_max": -0.010000000000000009, "reward_illegal_mean_mean": -1.7394999999999998, "reward_illegal_mean_min": -1.983333333333333, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.01677266666666663, "reward_accuracy_mean_min": 0.002766666666666588, "reward_accuracy_mean_max": 0.03066666666666672, "reward_sla_mean_mean": -0.31705666666666665, "reward_sla_mean_min": -0.6085, "reward_sla_mean_max": -0.12166666666666666, "reward_consolidation_sum_mean": -4.696666666666667, "reward_consolidation_sum_min": -8.416666666666668, "reward_consolidation_sum_max": -1.0000000000000009, "reward_illegal_sum_mean": -173.94999999999996, "reward_illegal_sum_min": -198.3333333333333, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 1.6772666666666631, "reward_accuracy_sum_min": 0.2766666666666588, "reward_accuracy_sum_max": 3.066666666666672, "reward_sla_sum_mean": -31.705666666666666, "reward_sla_sum_min": -60.85, "reward_sla_sum_max": -12.166666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4901.0, "global_timestep_min": 1800, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-209.63333333333324, -195.86999999999995, -215.06666666666646, -224.5766666666667, -209.96333333333334, -212.0699999999999, -208.48333333333318, -200.31333333333336, -208.43666666666655, -219.25333333333336, -221.28333333333325, -196.7733333333332, -220.30999999999986, -211.55333333333326, -201.85999999999987, -192.20999999999992, -223.95999999999992, -221.66333333333327, -205.34999999999994, -206.06999999999982, -207.1733333333332, -206.55999999999997, -206.40333333333322, -204.05666666666653, -197.34666666666655, -208.66, -200.26000000000005, -213.42999999999995, -214.1133333333332, -215.02999999999997, -215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19420490935437457, "mean_inference_ms": 1.7706327215377242, "mean_action_processing_ms": 0.07416000774013211, "mean_env_wait_ms": 1.1861242194078145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004487037658691406, "StateBufferConnector_ms": 0.0029816627502441406, "ViewRequirementAgentConnector_ms": 0.06893754005432129}, "num_episodes": 28, "episode_return_max": -187.25666666666666, "episode_return_min": -225.63333333333318, "episode_return_mean": -208.67506666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14700, "num_env_steps_sampled": 14900, "num_env_steps_trained": 14700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.6751915891992, "num_env_steps_trained_throughput_per_sec": 293.4570947474474, "timesteps_total": 14900, "num_env_steps_sampled_lifetime": 14900, "num_agent_steps_sampled_lifetime": 14900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 14900, "timers": {"training_iteration_time_ms": 10176.355, "restore_workers_time_ms": 0.013, "training_step_time_ms": 353.843, "sample_time_ms": 343.817, "synch_weights_time_ms": 9.136}, "counters": {"num_env_steps_sampled": 14900, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 149, "num_samples_added_to_queue": 14700}, "done": false, "training_iteration": 5, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-25-09", "timestamp": 1728591909, "time_this_iter_s": 10.232266426086426, "time_total_s": 50.92512106895447, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5da2c160>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.92512106895447, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.285714285714286, "ram_util_percent": 46.57857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -273008.78125, "policy_loss": -273148.6875, "entropy": 28.89582061767578, "entropy_coeff": 0.01, "var_gnorm": 16.129695892333984, "vf_loss": 226606.828125, "vf_explained_var": 0.05707627534866333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333357}}, "num_env_steps_sampled": 17800, "num_env_steps_trained": 17700, "num_agent_steps_sampled": 17800, "num_agent_steps_trained": 17700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 178, "num_samples_added_to_queue": 17700, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.673, "learner_load_time_ms": 0.249, "learner_load_wait_time_ms": 1021.42, "learner_dequeue_time_ms": 7363.953}}, "env_runners": {"episode_reward_max": -187.25666666666666, "episode_reward_min": -229.63000000000005, "episode_reward_mean": -208.74656666666658, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -229.63000000000005}, "policy_reward_max": {"default_policy": -187.25666666666666}, "policy_reward_mean": {"default_policy": -208.74656666666658}, "custom_metrics": {"num_consolidated_mean": 0.6847, "num_consolidated_min": 0.43, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0489, "num_overloaded_min": 0.88, "num_overloaded_max": 1.24, "num_moves_mean": 9.9613, "num_moves_min": 9.56, "num_moves_max": 10.32, "mean_accuracy_mean": 41.09797333333333, "mean_accuracy_min": 40.87833333333332, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 5.978000000000001, "num_model_switches_min": 5.6, "num_model_switches_max": 6.4, "num_slav_mean": 0.163297, "num_slav_min": 0.14251666666666668, "num_slav_max": 0.18655000000000005, "mean_cluster_cpu_util_mean": 0.5719584285412123, "mean_cluster_cpu_util_min": 0.5503342594788931, "mean_cluster_cpu_util_max": 0.5977236759920675, "mean_cluster_mem_util_mean": 0.3656263519224145, "mean_cluster_mem_util_min": 0.3557038688682224, "mean_cluster_mem_util_max": 0.37760643980165903, "reward_consolidation_mean_mean": -0.04494166666666668, "reward_consolidation_mean_min": -0.08416666666666668, "reward_consolidation_mean_max": -0.010000000000000009, "reward_illegal_mean_mean": -1.7481666666666664, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4666666666666663, "reward_accuracy_mean_mean": 0.01691099999999997, "reward_accuracy_mean_min": 0.002766666666666588, "reward_accuracy_mean_max": 0.03066666666666672, "reward_sla_mean_mean": -0.3112683333333333, "reward_sla_mean_min": -0.6085, "reward_sla_mean_max": -0.12166666666666666, "reward_consolidation_sum_mean": -4.4941666666666675, "reward_consolidation_sum_min": -8.416666666666668, "reward_consolidation_sum_max": -1.0000000000000009, "reward_illegal_sum_mean": -174.81666666666663, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -146.66666666666663, "reward_accuracy_sum_mean": 1.6910999999999976, "reward_accuracy_sum_min": 0.2766666666666588, "reward_accuracy_sum_max": 3.066666666666672, "reward_sla_sum_mean": -31.12683333333333, "reward_sla_sum_min": -60.85, "reward_sla_sum_max": -12.166666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4698.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-215.4499999999998, -204.94333333333313, -218.66999999999982, -202.96333333333334, -223.51999999999992, -207.64333333333317, -214.22333333333322, -214.43666666666655, -222.55999999999995, -204.13333333333333, -212.48666666666657, -199.35, -204.1, -198.95999999999984, -206.90666666666652, -207.95666666666654, -210.50333333333325, -204.52333333333326, -206.20999999999987, -203.86666666666645, -206.36999999999986, -202.7533333333331, -213.96333333333328, -202.43999999999994, -206.4466666666667, -191.9933333333332, -212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974732198420361, "mean_inference_ms": 1.7931097644743614, "mean_action_processing_ms": 0.07514391487735533, "mean_env_wait_ms": 1.1994463011689758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004563570022583008, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.06915855407714844}, "num_episodes": 30, "episode_return_max": -187.25666666666666, "episode_return_min": -229.63000000000005, "episode_return_mean": -208.74656666666658, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17800, "num_agent_steps_trained": 17700, "num_env_steps_sampled": 17800, "num_env_steps_trained": 17700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 278.15782790732084, "num_env_steps_trained_throughput_per_sec": 287.74947714550433, "timesteps_total": 17800, "num_env_steps_sampled_lifetime": 17800, "num_agent_steps_sampled_lifetime": 17800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 17800, "timers": {"training_iteration_time_ms": 10217.92, "restore_workers_time_ms": 0.012, "training_step_time_ms": 358.583, "sample_time_ms": 349.016, "synch_weights_time_ms": 8.674}, "counters": {"num_env_steps_sampled": 17800, "num_env_steps_trained": 17700, "num_agent_steps_sampled": 17800, "num_agent_steps_trained": 17700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 178, "num_samples_added_to_queue": 17700}, "done": false, "training_iteration": 6, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-25-19", "timestamp": 1728591919, "time_this_iter_s": 10.441560506820679, "time_total_s": 61.36668157577515, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5da2e140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.36668157577515, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.286666666666664, "ram_util_percent": 47.040000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -289333.34375, "policy_loss": -289507.59375, "entropy": 28.768627166748047, "entropy_coeff": 0.01, "var_gnorm": 16.14073371887207, "vf_loss": 260577.8125, "vf_explained_var": 0.057901859283447266}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 20500, "num_env_steps_trained": 20400, "num_agent_steps_sampled": 20500, "num_agent_steps_trained": 20400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 20400, "learner_queue": {"size_count": 68, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.802, "learner_load_time_ms": 0.274, "learner_load_wait_time_ms": 1080.194, "learner_dequeue_time_ms": 7548.233}}, "env_runners": {"episode_reward_max": -187.25666666666666, "episode_reward_min": -229.63000000000005, "episode_reward_mean": -209.04439999999988, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -229.63000000000005}, "policy_reward_max": {"default_policy": -187.25666666666666}, "policy_reward_mean": {"default_policy": -209.04439999999988}, "custom_metrics": {"num_consolidated_mean": 0.6814, "num_consolidated_min": 0.43, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0498, "num_overloaded_min": 0.81, "num_overloaded_max": 1.24, "num_moves_mean": 9.926900000000003, "num_moves_min": 9.56, "num_moves_max": 10.22, "mean_accuracy_mean": 41.105003333333336, "mean_accuracy_min": 40.833999999999996, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 5.943799999999999, "num_model_switches_min": 5.39, "num_model_switches_max": 6.4, "num_slav_mean": 0.16535700000000003, "num_slav_min": 0.14251666666666668, "num_slav_max": 0.18655000000000005, "mean_cluster_cpu_util_mean": 0.5721935549125213, "mean_cluster_cpu_util_min": 0.5494883266167061, "mean_cluster_cpu_util_max": 0.5977236759920675, "mean_cluster_mem_util_mean": 0.36566283959607043, "mean_cluster_mem_util_min": 0.35436991482246905, "mean_cluster_mem_util_max": 0.37760643980165903, "reward_consolidation_mean_mean": -0.04543333333333334, "reward_consolidation_mean_min": -0.08416666666666668, "reward_consolidation_mean_max": -0.012500000000000004, "reward_illegal_mean_mean": -1.7496666666666665, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 0.016612666666666637, "reward_accuracy_mean_min": 0.002766666666666588, "reward_accuracy_mean_max": 0.03066666666666672, "reward_sla_mean_mean": -0.31195666666666666, "reward_sla_mean_min": -0.6085, "reward_sla_mean_max": -0.12166666666666666, "reward_consolidation_sum_mean": -4.543333333333334, "reward_consolidation_sum_min": -8.416666666666668, "reward_consolidation_sum_max": -1.2500000000000004, "reward_illegal_sum_mean": -174.96666666666667, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 1.6612666666666636, "reward_accuracy_sum_min": 0.2766666666666588, "reward_accuracy_sum_max": 3.066666666666672, "reward_sla_sum_mean": -31.195666666666668, "reward_sla_sum_min": -60.85, "reward_sla_sum_max": -12.166666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3957.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-212.97333333333324, -211.1966666666666, -216.1733333333333, -216.05333333333328, -205.58333333333326, -218.1999999999999, -205.73666666666662, -197.11666666666662, -215.14666666666656, -209.18666666666667, -211.86666666666653, -220.17666666666662, -205.66333333333318, -221.75000000000009, -201.93666666666644, -200.82666666666668, -210.69999999999996, -208.12999999999985, -216.17999999999986, -187.25666666666666, -198.56999999999985, -204.37333333333325, -209.16999999999985, -225.63333333333318, -198.83333333333317, -212.36666666666653, -202.01666666666665, -207.61333333333337, -213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1995943897105034, "mean_inference_ms": 1.8078409152334922, "mean_action_processing_ms": 0.07583284832340449, "mean_env_wait_ms": 1.2088010038700014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004746198654174805, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.07089877128601074}, "num_episodes": 26, "episode_return_max": -187.25666666666666, "episode_return_min": -229.63000000000005, "episode_return_mean": -209.04439999999988, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20500, "num_agent_steps_trained": 20400, "num_env_steps_sampled": 20500, "num_env_steps_trained": 20400, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.3164040986751, "num_env_steps_trained_throughput_per_sec": 263.3164040986751, "timesteps_total": 20500, "num_env_steps_sampled_lifetime": 20500, "num_agent_steps_sampled_lifetime": 20500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 20500, "timers": {"training_iteration_time_ms": 10223.05, "restore_workers_time_ms": 0.013, "training_step_time_ms": 386.555, "sample_time_ms": 376.948, "synch_weights_time_ms": 8.666}, "counters": {"num_env_steps_sampled": 20500, "num_env_steps_trained": 20400, "num_agent_steps_sampled": 20500, "num_agent_steps_trained": 20400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 20400}, "done": false, "training_iteration": 7, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-25-30", "timestamp": 1728591930, "time_this_iter_s": 10.26415491104126, "time_total_s": 71.6308364868164, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa784f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.6308364868164, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 15.913333333333332, "ram_util_percent": 47.213333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -272957.5625, "policy_loss": -273099.03125, "entropy": 28.777347564697266, "entropy_coeff": 0.01, "var_gnorm": 16.147417068481445, "vf_loss": 227820.9375, "vf_explained_var": 0.070121169090271}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23100, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 23100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 232, "num_samples_added_to_queue": 23100, "learner_queue": {"size_count": 77, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.748, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 1099.97, "learner_dequeue_time_ms": 7732.522}}, "env_runners": {"episode_reward_max": -187.92333333333332, "episode_reward_min": -233.01999999999992, "episode_reward_mean": -209.56639999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -233.01999999999992}, "policy_reward_max": {"default_policy": -187.92333333333332}, "policy_reward_mean": {"default_policy": -209.56639999999996}, "custom_metrics": {"num_consolidated_mean": 0.6794, "num_consolidated_min": 0.54, "num_consolidated_max": 0.81, "num_overloaded_mean": 1.0537999999999998, "num_overloaded_min": 0.81, "num_overloaded_max": 1.24, "num_moves_mean": 9.8947, "num_moves_min": 9.54, "num_moves_max": 10.22, "mean_accuracy_mean": 41.10018999999999, "mean_accuracy_min": 40.833999999999996, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 5.930700000000001, "num_model_switches_min": 5.39, "num_model_switches_max": 6.4, "num_slav_mean": 0.16516750000000005, "num_slav_min": 0.14821666666666666, "num_slav_max": 0.18655000000000005, "mean_cluster_cpu_util_mean": 0.5726558336790185, "mean_cluster_cpu_util_min": 0.5494883266167061, "mean_cluster_cpu_util_max": 0.5977236759920675, "mean_cluster_mem_util_mean": 0.36581959342439513, "mean_cluster_mem_util_min": 0.35436991482246905, "mean_cluster_mem_util_max": 0.3768813470535893, "reward_consolidation_mean_mean": -0.044816666666666664, "reward_consolidation_mean_min": -0.09666666666666668, "reward_consolidation_mean_max": -0.012500000000000004, "reward_illegal_mean_mean": -1.756333333333333, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 0.016754333333333305, "reward_accuracy_mean_min": 0.0022666666666665597, "reward_accuracy_mean_max": 0.03350000000000006, "reward_sla_mean_mean": -0.3112683333333333, "reward_sla_mean_min": -0.4871666666666667, "reward_sla_mean_max": -0.12166666666666666, "reward_consolidation_sum_mean": -4.4816666666666665, "reward_consolidation_sum_min": -9.666666666666668, "reward_consolidation_sum_max": -1.2500000000000004, "reward_illegal_sum_mean": -175.6333333333333, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 1.67543333333333, "reward_accuracy_sum_min": 0.22666666666665597, "reward_accuracy_sum_max": 3.3500000000000054, "reward_sla_sum_mean": -31.12683333333333, "reward_sla_sum_min": -48.71666666666667, "reward_sla_sum_max": -12.166666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3186.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.87333333333322, -207.51999999999987, -208.38999999999982, -207.20999999999992, -201.6866666666665, -207.90999999999985, -202.90333333333334, -204.50333333333336, -219.26999999999998, -208.41333333333333, -218.4266666666665, -199.8066666666666, -205.7099999999999, -210.34333333333325, -209.76666666666648, -206.2366666666666, -221.29666666666654, -224.01999999999992, -208.54666666666662, -205.57999999999987, -202.54999999999998, -210.3433333333333, -194.35666666666663, -229.63000000000005, -197.57999999999993, -208.18333333333317, -215.9366666666665, -218.04999999999993, -207.15333333333322, -212.41333333333307, -208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2018288578870844, "mean_inference_ms": 1.8294565394379327, "mean_action_processing_ms": 0.07665572393676977, "mean_env_wait_ms": 1.2204171531457504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005113840103149414, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.07284927368164062}, "num_episodes": 28, "episode_return_max": -187.92333333333332, "episode_return_min": -233.01999999999992, "episode_return_mean": -209.56639999999996, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 23100, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23100, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 262.71158473003726, "num_env_steps_trained_throughput_per_sec": 262.71158473003726, "timesteps_total": 23200, "num_env_steps_sampled_lifetime": 23200, "num_agent_steps_sampled_lifetime": 23200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 23200, "timers": {"training_iteration_time_ms": 10229.849, "restore_workers_time_ms": 0.013, "training_step_time_ms": 367.981, "sample_time_ms": 359.018, "synch_weights_time_ms": 8.038}, "counters": {"num_env_steps_sampled": 23200, "num_env_steps_trained": 23100, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 23100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 232, "num_samples_added_to_queue": 23100}, "done": false, "training_iteration": 8, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-25-40", "timestamp": 1728591940, "time_this_iter_s": 10.295594930648804, "time_total_s": 81.92643141746521, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81f100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.92643141746521, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.92666666666667, "ram_util_percent": 47.353333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -253038.046875, "policy_loss": -253171.8125, "entropy": 28.01251983642578, "entropy_coeff": 0.01, "var_gnorm": 16.175302505493164, "vf_loss": 217796.6875, "vf_explained_var": 0.09194201231002808}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 26200, "num_env_steps_trained": 26100, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 262, "num_samples_added_to_queue": 26100, "learner_queue": {"size_count": 87, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.674, "learner_load_time_ms": 0.272, "learner_load_wait_time_ms": 964.719, "learner_dequeue_time_ms": 8479.336}}, "env_runners": {"episode_reward_max": -187.92333333333332, "episode_reward_min": -233.01999999999992, "episode_reward_mean": -207.7433999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -233.01999999999992}, "policy_reward_max": {"default_policy": -187.92333333333332}, "policy_reward_mean": {"default_policy": -207.7433999999999}, "custom_metrics": {"num_consolidated_mean": 0.6752000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.81, "num_overloaded_mean": 1.0313, "num_overloaded_min": 0.81, "num_overloaded_max": 1.2, "num_moves_mean": 9.8568, "num_moves_min": 9.53, "num_moves_max": 10.22, "mean_accuracy_mean": 41.109183333333334, "mean_accuracy_min": 40.833999999999996, "mean_accuracy_max": 41.391333333333336, "num_model_switches_mean": 5.8891, "num_model_switches_min": 5.39, "num_model_switches_max": 6.25, "num_slav_mean": 0.16521333333333335, "num_slav_min": 0.1507333333333333, "num_slav_max": 0.1863333333333333, "mean_cluster_cpu_util_mean": 0.5685572637254734, "mean_cluster_cpu_util_min": 0.5460518851657383, "mean_cluster_cpu_util_max": 0.5977236759920675, "mean_cluster_mem_util_mean": 0.3639844936027154, "mean_cluster_mem_util_min": 0.35436991482246905, "mean_cluster_mem_util_max": 0.3768813470535893, "reward_consolidation_mean_mean": -0.04779166666666668, "reward_consolidation_mean_min": -0.09666666666666668, "reward_consolidation_mean_max": -0.016666666666666673, "reward_illegal_mean_mean": -1.718833333333333, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.3499999999999996, "reward_accuracy_mean_mean": 0.01853766666666664, "reward_accuracy_mean_min": 0.0022666666666665597, "reward_accuracy_mean_max": 0.04280000000000007, "reward_sla_mean_mean": -0.3293466666666667, "reward_sla_mean_min": -0.5774999999999999, "reward_sla_mean_max": -0.15449999999999997, "reward_consolidation_sum_mean": -4.779166666666668, "reward_consolidation_sum_min": -9.666666666666668, "reward_consolidation_sum_max": -1.6666666666666674, "reward_illegal_sum_mean": -171.88333333333324, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -134.99999999999997, "reward_accuracy_sum_mean": 1.8537666666666641, "reward_accuracy_sum_min": 0.22666666666665597, "reward_accuracy_sum_max": 4.2800000000000065, "reward_sla_sum_mean": -32.934666666666665, "reward_sla_sum_min": -57.74999999999999, "reward_sla_sum_max": -15.449999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3113.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-208.94000000000008, -196.10666666666646, -193.5933333333334, -207.88666666666663, -217.06999999999985, -215.72333333333324, -218.94333333333327, -198.78666666666658, -210.0699999999999, -209.1766666666665, -201.62333333333325, -212.58333333333331, -210.27999999999986, -212.08333333333326, -210.86333333333323, -205.51333333333318, -194.4933333333334, -216.48999999999998, -187.92333333333332, -217.13666666666668, -193.93333333333325, -211.10999999999999, -216.60666666666657, -205.0233333333332, -223.65666666666658, -224.35, -209.6999999999998, -216.0233333333333, -219.9866666666666, -203.01999999999992, -211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20313041313632496, "mean_inference_ms": 1.8406283452612513, "mean_action_processing_ms": 0.07711450739658553, "mean_env_wait_ms": 1.2276722748063478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00492548942565918, "StateBufferConnector_ms": 0.003018617630004883, "ViewRequirementAgentConnector_ms": 0.07120919227600098}, "num_episodes": 30, "episode_return_max": -187.92333333333332, "episode_return_min": -233.01999999999992, "episode_return_mean": -207.7433999999999, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26100, "num_env_steps_sampled": 26200, "num_env_steps_trained": 26100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.1205130220711, "num_env_steps_trained_throughput_per_sec": 297.1205130220711, "timesteps_total": 26200, "num_env_steps_sampled_lifetime": 26200, "num_agent_steps_sampled_lifetime": 26200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 26200, "timers": {"training_iteration_time_ms": 10215.079, "restore_workers_time_ms": 0.011, "training_step_time_ms": 331.057, "sample_time_ms": 322.793, "synch_weights_time_ms": 7.404}, "counters": {"num_env_steps_sampled": 26200, "num_env_steps_trained": 26100, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 262, "num_samples_added_to_queue": 26100}, "done": false, "training_iteration": 9, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-25-50", "timestamp": 1728591950, "time_this_iter_s": 10.105347871780396, "time_total_s": 92.0317792892456, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5da2f9d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.0317792892456, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.799999999999999, "ram_util_percent": 47.457142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -234083.21875, "policy_loss": -234195.65625, "entropy": 27.329566955566406, "entropy_coeff": 0.01, "var_gnorm": 16.194887161254883, "vf_loss": 194421.328125, "vf_explained_var": 0.12112683057785034}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 29300, "num_env_steps_trained": 29100, "num_agent_steps_sampled": 29300, "num_agent_steps_trained": 29100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 293, "num_samples_added_to_queue": 29100, "learner_queue": {"size_count": 97, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.287, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 926.987, "learner_dequeue_time_ms": 8515.81}}, "env_runners": {"episode_reward_max": -190.56666666666658, "episode_reward_min": -233.01999999999992, "episode_reward_mean": -206.10533333333322, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -233.01999999999992}, "policy_reward_max": {"default_policy": -190.56666666666658}, "policy_reward_mean": {"default_policy": -206.10533333333322}, "custom_metrics": {"num_consolidated_mean": 0.6792000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.95, "num_overloaded_mean": 1.0140999999999998, "num_overloaded_min": 0.83, "num_overloaded_max": 1.2, "num_moves_mean": 9.792300000000001, "num_moves_min": 9.36, "num_moves_max": 10.17, "mean_accuracy_mean": 41.122546666666665, "mean_accuracy_min": 40.777, "mean_accuracy_max": 41.67633333333334, "num_model_switches_mean": 5.8652, "num_model_switches_min": 5.39, "num_model_switches_max": 6.25, "num_slav_mean": 0.1642001666666667, "num_slav_min": 0.14616666666666667, "num_slav_max": 0.18005, "mean_cluster_cpu_util_mean": 0.5655026516645816, "mean_cluster_cpu_util_min": 0.5460518851657383, "mean_cluster_cpu_util_max": 0.5913212088416799, "mean_cluster_mem_util_mean": 0.3630704977270443, "mean_cluster_mem_util_min": 0.3552835019661873, "mean_cluster_mem_util_max": 0.37343841886965756, "reward_consolidation_mean_mean": -0.049458333333333326, "reward_consolidation_mean_min": -0.09666666666666668, "reward_consolidation_mean_max": -0.016666666666666673, "reward_illegal_mean_mean": -1.6901666666666662, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.383333333333333, "reward_accuracy_mean_mean": 0.02056833333333332, "reward_accuracy_mean_min": 0.0022666666666665597, "reward_accuracy_mean_max": 0.045200000000000136, "reward_sla_mean_mean": -0.34199666666666656, "reward_sla_mean_min": -0.5774999999999999, "reward_sla_mean_max": -0.15449999999999997, "reward_consolidation_sum_mean": -4.945833333333334, "reward_consolidation_sum_min": -9.666666666666668, "reward_consolidation_sum_max": -1.6666666666666674, "reward_illegal_sum_mean": -169.01666666666665, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -138.33333333333331, "reward_accuracy_sum_mean": 2.0568333333333317, "reward_accuracy_sum_min": 0.22666666666665597, "reward_accuracy_sum_max": 4.520000000000014, "reward_sla_sum_mean": -34.19966666666666, "reward_sla_sum_min": -57.74999999999999, "reward_sla_sum_max": -15.449999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4314.0, "global_timestep_min": 1300, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-211.38, -199.6233333333333, -224.7333333333333, -200.57333333333327, -221.79333333333324, -212.0699999999998, -206.94000000000005, -196.12, -212.91999999999996, -199.85999999999987, -204.24333333333317, -207.44666666666663, -207.5733333333332, -206.71999999999989, -206.36666666666662, -203.19999999999985, -198.87999999999988, -214.63999999999996, -204.32999999999998, -206.14666666666656, -215.6533333333333, -214.59333333333333, -230.2566666666666, -233.01999999999992, -215.1266666666666, -195.1933333333332, -211.10666666666654, -217.81666666666658, -213.45666666666645, -203.1999999999999, -202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20349314803301247, "mean_inference_ms": 1.8449569034617348, "mean_action_processing_ms": 0.07718867912057402, "mean_env_wait_ms": 1.2302562670350605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00453948974609375, "StateBufferConnector_ms": 0.002934694290161133, "ViewRequirementAgentConnector_ms": 0.06792020797729492}, "num_episodes": 30, "episode_return_max": -190.56666666666658, "episode_return_min": -233.01999999999992, "episode_return_mean": -206.10533333333322, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29300, "num_agent_steps_trained": 29100, "num_env_steps_sampled": 29300, "num_env_steps_trained": 29100, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 305.55056932028305, "num_env_steps_trained_throughput_per_sec": 295.69409934220937, "timesteps_total": 29300, "num_env_steps_sampled_lifetime": 29300, "num_agent_steps_sampled_lifetime": 29300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 29300, "timers": {"training_iteration_time_ms": 10208.134, "restore_workers_time_ms": 0.012, "training_step_time_ms": 336.466, "sample_time_ms": 327.736, "synch_weights_time_ms": 7.895}, "counters": {"num_env_steps_sampled": 29300, "num_env_steps_trained": 29100, "num_agent_steps_sampled": 29300, "num_agent_steps_trained": 29100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 293, "num_samples_added_to_queue": 29100}, "done": false, "training_iteration": 10, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-00", "timestamp": 1728591960, "time_this_iter_s": 10.158679246902466, "time_total_s": 102.19045853614807, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.19045853614807, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.366666666666669, "ram_util_percent": 47.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -197454.84375, "policy_loss": -197552.40625, "entropy": 25.299556732177734, "entropy_coeff": 0.01, "var_gnorm": 16.22890281677246, "vf_loss": 173470.75, "vf_explained_var": 0.17373448610305786}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 32200, "num_env_steps_trained": 32100, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 322, "num_samples_added_to_queue": 32100, "learner_queue": {"size_count": 107, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.077, "learner_load_time_ms": 0.314, "learner_load_wait_time_ms": 1000.238, "learner_dequeue_time_ms": 8531.484}}, "env_runners": {"episode_reward_max": -182.08333333333323, "episode_reward_min": -224.70333333333323, "episode_reward_mean": -205.04249999999993, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -224.70333333333323}, "policy_reward_max": {"default_policy": -182.08333333333323}, "policy_reward_mean": {"default_policy": -205.04249999999993}, "custom_metrics": {"num_consolidated_mean": 0.6791000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.95, "num_overloaded_mean": 1.0021, "num_overloaded_min": 0.83, "num_overloaded_max": 1.18, "num_moves_mean": 9.6288, "num_moves_min": 8.88, "num_moves_max": 10.17, "mean_accuracy_mean": 41.15073, "mean_accuracy_min": 40.777, "mean_accuracy_max": 41.67633333333334, "num_model_switches_mean": 5.7865, "num_model_switches_min": 5.16, "num_model_switches_max": 6.17, "num_slav_mean": 0.16382300000000005, "num_slav_min": 0.14616666666666667, "num_slav_max": 0.17993333333333336, "mean_cluster_cpu_util_mean": 0.5642218313118554, "mean_cluster_cpu_util_min": 0.5460518851657383, "mean_cluster_cpu_util_max": 0.5913212088416799, "mean_cluster_mem_util_mean": 0.36284128600490834, "mean_cluster_mem_util_min": 0.3552835019661873, "mean_cluster_mem_util_max": 0.37343841886965756, "reward_consolidation_mean_mean": -0.05123333333333334, "reward_consolidation_mean_min": -0.09666666666666668, "reward_consolidation_mean_max": -0.011666666666666674, "reward_illegal_mean_mean": -1.6701666666666661, "reward_illegal_mean_min": -1.9666666666666668, "reward_illegal_mean_max": -1.383333333333333, "reward_accuracy_mean_mean": 0.021894999999999987, "reward_accuracy_mean_min": 0.009799999999999885, "reward_accuracy_mean_max": 0.045200000000000136, "reward_sla_mean_mean": -0.35092, "reward_sla_mean_min": -0.5774999999999999, "reward_sla_mean_max": -0.2048333333333333, "reward_consolidation_sum_mean": -5.123333333333334, "reward_consolidation_sum_min": -9.666666666666668, "reward_consolidation_sum_max": -1.1666666666666674, "reward_illegal_sum_mean": -167.01666666666665, "reward_illegal_sum_min": -196.66666666666669, "reward_illegal_sum_max": -138.33333333333331, "reward_accuracy_sum_mean": 2.189499999999999, "reward_accuracy_sum_min": 0.9799999999999884, "reward_accuracy_sum_max": 4.520000000000014, "reward_sla_sum_mean": -35.09199999999999, "reward_sla_sum_min": -57.74999999999999, "reward_sla_sum_max": -20.48333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5045.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-202.2233333333333, -212.3066666666666, -206.9733333333332, -215.89000000000001, -204.19333333333327, -216.76999999999998, -224.70333333333323, -208.98999999999998, -197.4133333333332, -215.88666666666657, -215.10333333333327, -209.5966666666667, -203.1666666666666, -193.63333333333327, -202.6566666666666, -199.25999999999985, -209.32333333333327, -190.56666666666658, -199.34999999999985, -204.32666666666663, -206.80000000000004, -194.91333333333313, -202.18666666666658, -205.47, -201.88666666666657, -193.44999999999987, -221.41, -193.10000000000002, -203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2031502686449797, "mean_inference_ms": 1.8407714876406194, "mean_action_processing_ms": 0.07698489963036355, "mean_env_wait_ms": 1.2286576388597252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041027069091796875, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.06563615798950195}, "num_episodes": 30, "episode_return_max": -182.08333333333323, "episode_return_min": -224.70333333333323, "episode_return_mean": -205.04249999999993, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32100, "num_env_steps_sampled": 32200, "num_env_steps_trained": 32100, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.71686499979575, "num_env_steps_trained_throughput_per_sec": 296.60365344806456, "timesteps_total": 32200, "num_env_steps_sampled_lifetime": 32200, "num_agent_steps_sampled_lifetime": 32200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 32200, "timers": {"training_iteration_time_ms": 10195.113, "restore_workers_time_ms": 0.014, "training_step_time_ms": 363.989, "sample_time_ms": 355.153, "synch_weights_time_ms": 7.903}, "counters": {"num_env_steps_sampled": 32200, "num_env_steps_trained": 32100, "num_agent_steps_sampled": 32200, "num_agent_steps_trained": 32100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 322, "num_samples_added_to_queue": 32100}, "done": false, "training_iteration": 11, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-11", "timestamp": 1728591971, "time_this_iter_s": 10.12368893623352, "time_total_s": 112.31414747238159, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7b190>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.31414747238159, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.585714285714287, "ram_util_percent": 47.40714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -174485.453125, "policy_loss": -174574.328125, "entropy": 24.370410919189453, "entropy_coeff": 0.01, "var_gnorm": 16.247488021850586, "vf_loss": 161978.6875, "vf_explained_var": 0.180780291557312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 34800, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 34800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 350, "num_samples_added_to_queue": 34800, "learner_queue": {"size_count": 116, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.495, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 1022.036, "learner_dequeue_time_ms": 8532.193}}, "env_runners": {"episode_reward_max": -182.05333333333326, "episode_reward_min": -222.90999999999994, "episode_reward_mean": -204.8182666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -222.90999999999994}, "policy_reward_max": {"default_policy": -182.05333333333326}, "policy_reward_mean": {"default_policy": -204.8182666666666}, "custom_metrics": {"num_consolidated_mean": 0.6631999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.95, "num_overloaded_mean": 0.9824999999999998, "num_overloaded_min": 0.82, "num_overloaded_max": 1.18, "num_moves_mean": 9.3616, "num_moves_min": 8.41, "num_moves_max": 9.99, "mean_accuracy_mean": 41.19246666666667, "mean_accuracy_min": 40.777, "mean_accuracy_max": 41.67633333333334, "num_model_switches_mean": 5.596799999999999, "num_model_switches_min": 4.5, "num_model_switches_max": 6.17, "num_slav_mean": 0.16757383333333334, "num_slav_min": 0.14616666666666667, "num_slav_max": 0.20149999999999998, "mean_cluster_cpu_util_mean": 0.5605031561745637, "mean_cluster_cpu_util_min": 0.5329507160939224, "mean_cluster_cpu_util_max": 0.5852585501188643, "mean_cluster_mem_util_mean": 0.36164400653721407, "mean_cluster_mem_util_min": 0.34838888243060934, "mean_cluster_mem_util_max": 0.3720058128103563, "reward_consolidation_mean_mean": -0.05528333333333333, "reward_consolidation_mean_min": -0.09250000000000001, "reward_consolidation_mean_max": -0.011666666666666674, "reward_illegal_mean_mean": -1.6375000000000002, "reward_illegal_mean_min": -1.9666666666666668, "reward_illegal_mean_max": -1.3666666666666663, "reward_accuracy_mean_mean": 0.02478566666666667, "reward_accuracy_mean_min": 0.009799999999999885, "reward_accuracy_mean_max": 0.04773333333333346, "reward_sla_mean_mean": -0.38018500000000005, "reward_sla_mean_min": -0.6431666666666667, "reward_sla_mean_max": -0.2048333333333333, "reward_consolidation_sum_mean": -5.528333333333332, "reward_consolidation_sum_min": -9.250000000000002, "reward_consolidation_sum_max": -1.1666666666666674, "reward_illegal_sum_mean": -163.74999999999997, "reward_illegal_sum_min": -196.66666666666669, "reward_illegal_sum_max": -136.66666666666663, "reward_accuracy_sum_mean": 2.4785666666666675, "reward_accuracy_sum_min": 0.9799999999999884, "reward_accuracy_sum_max": 4.773333333333346, "reward_sla_sum_mean": -38.018499999999996, "reward_sla_sum_min": -64.31666666666666, "reward_sla_sum_max": -20.48333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4250.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-203.45333333333332, -208.74666666666653, -196.50666666666663, -207.62, -221.08333333333331, -200.96333333333337, -193.6299999999999, -214.83333333333323, -204.7266666666665, -207.64999999999998, -200.00999999999993, -199.88666666666663, -201.90333333333328, -198.76666666666645, -207.04999999999995, -199.00333333333325, -221.44999999999993, -209.72333333333316, -203.7366666666665, -195.36999999999983, -192.99666666666647, -199.63000000000002, -201.81999999999988, -199.7666666666665, -205.08666666666667, -196.89666666666668, -208.74666666666664, -197.4333333333333, -217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2028024208036366, "mean_inference_ms": 1.8351818536139404, "mean_action_processing_ms": 0.07681284851330669, "mean_env_wait_ms": 1.2271654030925176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004142045974731445, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.06653904914855957}, "num_episodes": 28, "episode_return_max": -182.05333333333326, "episode_return_min": -222.90999999999994, "episode_return_mean": -204.8182666666666, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 34800, "num_env_steps_sampled": 35000, "num_env_steps_trained": 34800, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.82722891767645, "num_env_steps_trained_throughput_per_sec": 268.869113599188, "timesteps_total": 35000, "num_env_steps_sampled_lifetime": 35000, "num_agent_steps_sampled_lifetime": 35000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 10197.599, "restore_workers_time_ms": 0.013, "training_step_time_ms": 364.778, "sample_time_ms": 355.128, "synch_weights_time_ms": 8.736}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 34800, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 34800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 350, "num_samples_added_to_queue": 34800}, "done": false, "training_iteration": 12, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-21", "timestamp": 1728591981, "time_this_iter_s": 10.050881624221802, "time_total_s": 122.3650290966034, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa78df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.3650290966034, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.835714285714285, "ram_util_percent": 47.94285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -167231.6875, "policy_loss": -167309.578125, "entropy": 23.764055252075195, "entropy_coeff": 0.01, "var_gnorm": 16.266891479492188, "vf_loss": 149190.140625, "vf_explained_var": 0.21740061044692993}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333286}}, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 378, "num_samples_added_to_queue": 37800, "learner_queue": {"size_count": 125, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.166, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 1019.792, "learner_dequeue_time_ms": 8556.361}}, "env_runners": {"episode_reward_max": -182.05333333333326, "episode_reward_min": -222.90999999999994, "episode_reward_mean": -203.11059999999986, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -222.90999999999994}, "policy_reward_max": {"default_policy": -182.05333333333326}, "policy_reward_mean": {"default_policy": -203.11059999999986}, "custom_metrics": {"num_consolidated_mean": 0.655, "num_consolidated_min": 0.45, "num_consolidated_max": 0.95, "num_overloaded_mean": 0.9486999999999999, "num_overloaded_min": 0.75, "num_overloaded_max": 1.18, "num_moves_mean": 9.0947, "num_moves_min": 8.39, "num_moves_max": 9.9, "mean_accuracy_mean": 41.23034, "mean_accuracy_min": 40.928999999999995, "mean_accuracy_max": 41.613000000000014, "num_model_switches_mean": 5.3565000000000005, "num_model_switches_min": 4.5, "num_model_switches_max": 6.05, "num_slav_mean": 0.17154166666666665, "num_slav_min": 0.14815, "num_slav_max": 0.20149999999999998, "mean_cluster_cpu_util_mean": 0.5545488434373295, "mean_cluster_cpu_util_min": 0.523252302062822, "mean_cluster_cpu_util_max": 0.5852585501188643, "mean_cluster_mem_util_mean": 0.3592672939826775, "mean_cluster_mem_util_min": 0.3458680413832201, "mean_cluster_mem_util_max": 0.3720058128103563, "reward_consolidation_mean_mean": -0.05811666666666668, "reward_consolidation_mean_min": -0.09250000000000001, "reward_consolidation_mean_max": -0.011666666666666674, "reward_illegal_mean_mean": -1.5811666666666664, "reward_illegal_mean_min": -1.9666666666666668, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.027802333333333346, "reward_accuracy_mean_min": 0.01113333333333332, "reward_accuracy_mean_max": 0.05150000000000016, "reward_sla_mean_mean": -0.4196250000000001, "reward_sla_mean_min": -0.6431666666666667, "reward_sla_mean_max": -0.2173333333333333, "reward_consolidation_sum_mean": -5.811666666666667, "reward_consolidation_sum_min": -9.250000000000002, "reward_consolidation_sum_max": -1.1666666666666674, "reward_illegal_sum_mean": -158.11666666666665, "reward_illegal_sum_min": -196.66666666666669, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 2.7802333333333342, "reward_accuracy_sum_min": 1.113333333333332, "reward_accuracy_sum_max": 5.1500000000000155, "reward_sla_sum_mean": -41.9625, "reward_sla_sum_min": -64.31666666666666, "reward_sla_sum_max": -21.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3453.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.77, -200.47999999999982, -193.6233333333333, -210.09666666666652, -193.00999999999988, -193.21333333333334, -202.40666666666658, -211.88999999999993, -210.2466666666664, -213.93333333333334, -193.85333333333327, -213.6366666666667, -211.8, -199.55, -212.92666666666662, -198.99, -202.05999999999986, -203.3266666666665, -202.53666666666675, -209.85333333333324, -208.63999999999996, -204.66333333333324, -214.88666666666646, -203.8966666666666, -205.92333333333315, -204.58999999999983, -182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20290378723871483, "mean_inference_ms": 1.8338618369518764, "mean_action_processing_ms": 0.07684075240968948, "mean_env_wait_ms": 1.2282103089201344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004329204559326172, "StateBufferConnector_ms": 0.002980470657348633, "ViewRequirementAgentConnector_ms": 0.06905221939086914}, "num_episodes": 28, "episode_return_max": -182.05333333333326, "episode_return_min": -222.90999999999994, "episode_return_mean": -203.11059999999986, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37500, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37500, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.70358503696184, "num_env_steps_trained_throughput_per_sec": 269.7141712856418, "timesteps_total": 37800, "num_env_steps_sampled_lifetime": 37800, "num_agent_steps_sampled_lifetime": 37800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 37800, "timers": {"training_iteration_time_ms": 10181.494, "restore_workers_time_ms": 0.013, "training_step_time_ms": 353.322, "sample_time_ms": 344.274, "synch_weights_time_ms": 8.141}, "counters": {"num_env_steps_sampled": 37800, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 378, "num_samples_added_to_queue": 37800}, "done": false, "training_iteration": 13, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-31", "timestamp": 1728591991, "time_this_iter_s": 10.022119522094727, "time_total_s": 132.38714861869812, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa78100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.38714861869812, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.506666666666666, "ram_util_percent": 48.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -128722.3203125, "policy_loss": -128788.234375, "entropy": 21.50347900390625, "entropy_coeff": 0.01, "var_gnorm": 16.300111770629883, "vf_loss": 130424.921875, "vf_explained_var": 0.24860364198684692}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 134.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 40400, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40400, "num_agent_steps_trained": 40200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 404, "num_samples_added_to_queue": 40200, "learner_queue": {"size_count": 134, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.27, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 1094.467, "learner_dequeue_time_ms": 8578.727}}, "env_runners": {"episode_reward_max": -176.49666666666658, "episode_reward_min": -222.90999999999994, "episode_reward_mean": -199.66523333333328, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -222.90999999999994}, "policy_reward_max": {"default_policy": -176.49666666666658}, "policy_reward_mean": {"default_policy": -199.66523333333328}, "custom_metrics": {"num_consolidated_mean": 0.6587000000000001, "num_consolidated_min": 0.45, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.8998999999999999, "num_overloaded_min": 0.67, "num_overloaded_max": 1.18, "num_moves_mean": 8.7365, "num_moves_min": 7.57, "num_moves_max": 9.56, "mean_accuracy_mean": 41.26568, "mean_accuracy_min": 40.94166666666666, "mean_accuracy_max": 41.613000000000014, "num_model_switches_mean": 5.0447, "num_model_switches_min": 4.12, "num_model_switches_max": 6.05, "num_slav_mean": 0.1749068333333333, "num_slav_min": 0.14815, "num_slav_max": 0.20149999999999998, "mean_cluster_cpu_util_mean": 0.5477443080366966, "mean_cluster_cpu_util_min": 0.523252302062822, "mean_cluster_cpu_util_max": 0.5824596939311364, "mean_cluster_mem_util_mean": 0.3568829162092051, "mean_cluster_mem_util_min": 0.3458680413832201, "mean_cluster_mem_util_max": 0.3720058128103563, "reward_consolidation_mean_mean": -0.06026666666666667, "reward_consolidation_mean_min": -0.09500000000000001, "reward_consolidation_mean_max": -0.011666666666666674, "reward_illegal_mean_mean": -1.499833333333333, "reward_illegal_mean_min": -1.9666666666666668, "reward_illegal_mean_max": -1.1166666666666665, "reward_accuracy_mean_mean": 0.031919333333333355, "reward_accuracy_mean_min": 0.01113333333333332, "reward_accuracy_mean_max": 0.05150000000000016, "reward_sla_mean_mean": -0.4684716666666666, "reward_sla_mean_min": -0.6861666666666666, "reward_sla_mean_max": -0.2173333333333333, "reward_consolidation_sum_mean": -6.026666666666666, "reward_consolidation_sum_min": -9.500000000000002, "reward_consolidation_sum_max": -1.1666666666666674, "reward_illegal_sum_mean": -149.98333333333332, "reward_illegal_sum_min": -196.66666666666669, "reward_illegal_sum_max": -111.66666666666666, "reward_accuracy_sum_mean": 3.1919333333333357, "reward_accuracy_sum_min": 1.113333333333332, "reward_accuracy_sum_max": 5.1500000000000155, "reward_sla_sum_mean": -46.84716666666668, "reward_sla_sum_min": -68.61666666666666, "reward_sla_sum_max": -21.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2894.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.08333333333323, -201.5966666666666, -191.9933333333333, -197.35333333333332, -207.78999999999985, -211.1866666666666, -210.5066666666666, -201.71999999999983, -211.14999999999992, -206.91333333333327, -211.28666666666658, -209.0366666666665, -211.60666666666665, -206.03, -222.90999999999994, -216.57333333333327, -217.4866666666665, -199.18333333333328, -212.52333333333323, -205.19333333333324, -202.5533333333333, -197.40999999999988, -210.31333333333328, -186.3366666666666, -213.79999999999987, -198.65333333333325, -206.8733333333332, -200.43666666666655, -213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20374644643688802, "mean_inference_ms": 1.8411409606944045, "mean_action_processing_ms": 0.07712366962638266, "mean_env_wait_ms": 1.2324428181347837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048105716705322266, "StateBufferConnector_ms": 0.0031516551971435547, "ViewRequirementAgentConnector_ms": 0.07380437850952148}, "num_episodes": 26, "episode_return_max": -176.49666666666658, "episode_return_min": -222.90999999999994, "episode_return_mean": -199.66523333333328, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40400, "num_agent_steps_trained": 40200, "num_env_steps_sampled": 40400, "num_env_steps_trained": 40200, "num_env_steps_sampled_this_iter": 2600, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 254.58845718189903, "num_env_steps_trained_throughput_per_sec": 264.38032091966437, "timesteps_total": 40400, "num_env_steps_sampled_lifetime": 40400, "num_agent_steps_sampled_lifetime": 40400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 40400, "timers": {"training_iteration_time_ms": 10180.229, "restore_workers_time_ms": 0.014, "training_step_time_ms": 399.38, "sample_time_ms": 388.659, "synch_weights_time_ms": 9.734}, "counters": {"num_env_steps_sampled": 40400, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40400, "num_agent_steps_trained": 40200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 404, "num_samples_added_to_queue": 40200}, "done": false, "training_iteration": 14, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-41", "timestamp": 1728592001, "time_this_iter_s": 10.221441507339478, "time_total_s": 142.6085901260376, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d70d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.6085901260376, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.657142857142855, "ram_util_percent": 48.87857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -132927.515625, "policy_loss": -132978.703125, "entropy": 22.333824157714844, "entropy_coeff": 0.01, "var_gnorm": 16.292343139648438, "vf_loss": 118185.90625, "vf_explained_var": 0.27219468355178833}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 43200, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 42900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 432, "num_samples_added_to_queue": 43200, "learner_queue": {"size_count": 143, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.183, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 1049.835, "learner_dequeue_time_ms": 8697.071}}, "env_runners": {"episode_reward_max": -176.49666666666658, "episode_reward_min": -219.83999999999992, "episode_reward_mean": -195.2501999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -219.83999999999992}, "policy_reward_max": {"default_policy": -176.49666666666658}, "policy_reward_mean": {"default_policy": -195.2501999999999}, "custom_metrics": {"num_consolidated_mean": 0.6966999999999999, "num_consolidated_min": 0.45, "num_consolidated_max": 0.98, "num_overloaded_mean": 0.8456, "num_overloaded_min": 0.66, "num_overloaded_max": 1.07, "num_moves_mean": 8.3964, "num_moves_min": 7.54, "num_moves_max": 9.22, "mean_accuracy_mean": 41.307226666666665, "mean_accuracy_min": 41.1, "mean_accuracy_max": 41.613000000000014, "num_model_switches_mean": 4.7609, "num_model_switches_min": 4.06, "num_model_switches_max": 5.58, "num_slav_mean": 0.1772348333333333, "num_slav_min": 0.16011666666666666, "num_slav_max": 0.20149999999999998, "mean_cluster_cpu_util_mean": 0.5412111389583911, "mean_cluster_cpu_util_min": 0.523252302062822, "mean_cluster_cpu_util_max": 0.5620403434684684, "mean_cluster_mem_util_mean": 0.3546143226610265, "mean_cluster_mem_util_min": 0.3458680413832201, "mean_cluster_mem_util_max": 0.3623568339361061, "reward_consolidation_mean_mean": -0.06043333333333334, "reward_consolidation_mean_min": -0.09500000000000001, "reward_consolidation_mean_max": -0.015000000000000013, "reward_illegal_mean_mean": -1.409333333333333, "reward_illegal_mean_min": -1.7833333333333334, "reward_illegal_mean_max": -1.0999999999999999, "reward_accuracy_mean_mean": 0.03755966666666671, "reward_accuracy_mean_min": 0.017266666666666618, "reward_accuracy_mean_max": 0.06033333333333351, "reward_sla_mean_mean": -0.520295, "reward_sla_mean_min": -0.7191666666666666, "reward_sla_mean_max": -0.30833333333333335, "reward_consolidation_sum_mean": -6.043333333333333, "reward_consolidation_sum_min": -9.500000000000002, "reward_consolidation_sum_max": -1.5000000000000013, "reward_illegal_sum_mean": -140.9333333333333, "reward_illegal_sum_min": -178.33333333333334, "reward_illegal_sum_max": -109.99999999999999, "reward_accuracy_sum_mean": 3.7559666666666716, "reward_accuracy_sum_min": 1.7266666666666617, "reward_accuracy_sum_max": 6.033333333333351, "reward_sla_sum_mean": -52.02949999999999, "reward_sla_sum_min": -71.91666666666666, "reward_sla_sum_max": -30.833333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3525.0, "global_timestep_min": 600, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.0099999999999, -197.08333333333317, -206.30999999999977, -194.0699999999999, -208.0233333333332, -208.72999999999985, -204.9199999999999, -213.58999999999997, -208.20999999999995, -202.29666666666657, -211.64333333333332, -203.8733333333333, -202.49999999999997, -213.50333333333313, -198.93999999999994, -206.43666666666653, -182.05333333333326, -219.83999999999992, -207.0566666666666, -200.80333333333314, -195.54999999999987, -196.7166666666666, -193.46666666666653, -200.39999999999998, -214.23666666666668, -197.26333333333332, -196.04999999999987, -190.6966666666667, -185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2046064508968486, "mean_inference_ms": 1.8496080944808417, "mean_action_processing_ms": 0.07743199644876574, "mean_env_wait_ms": 1.2374182313189563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005091190338134766, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.07421135902404785}, "num_episodes": 28, "episode_return_max": -176.49666666666658, "episode_return_min": -219.83999999999992, "episode_return_mean": -195.2501999999999, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 42900, "num_env_steps_sampled": 43200, "num_env_steps_trained": 42900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.5785386771953, "num_env_steps_trained_throughput_per_sec": 263.8078765815812, "timesteps_total": 43200, "num_env_steps_sampled_lifetime": 43200, "num_agent_steps_sampled_lifetime": 43200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 43200, "timers": {"training_iteration_time_ms": 10181.405, "restore_workers_time_ms": 0.013, "training_step_time_ms": 352.54, "sample_time_ms": 342.48, "synch_weights_time_ms": 9.127}, "counters": {"num_env_steps_sampled": 43200, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 42900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 432, "num_samples_added_to_queue": 43200}, "done": false, "training_iteration": 15, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-26-51", "timestamp": 1728592011, "time_this_iter_s": 10.245250940322876, "time_total_s": 152.85384106636047, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.85384106636047, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.620000000000001, "ram_util_percent": 49.473333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -156426.359375, "policy_loss": -156485.71875, "entropy": 24.056957244873047, "entropy_coeff": 0.01, "var_gnorm": 16.27973747253418, "vf_loss": 131525.078125, "vf_explained_var": 0.24250656366348267}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 46100, "num_env_steps_trained": 45900, "num_agent_steps_sampled": 46100, "num_agent_steps_trained": 45900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 461, "num_samples_added_to_queue": 45900, "learner_queue": {"size_count": 153, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.03, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 994.71, "learner_dequeue_time_ms": 8537.506}}, "env_runners": {"episode_reward_max": -176.49666666666658, "episode_reward_min": -215.52999999999986, "episode_reward_mean": -191.86816666666655, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.52999999999986}, "policy_reward_max": {"default_policy": -176.49666666666658}, "policy_reward_mean": {"default_policy": -191.86816666666655}, "custom_metrics": {"num_consolidated_mean": 0.7275999999999999, "num_consolidated_min": 0.45, "num_consolidated_max": 0.98, "num_overloaded_mean": 0.8167, "num_overloaded_min": 0.66, "num_overloaded_max": 0.99, "num_moves_mean": 8.2413, "num_moves_min": 7.54, "num_moves_max": 9.07, "mean_accuracy_mean": 41.303869999999996, "mean_accuracy_min": 41.011333333333326, "mean_accuracy_max": 41.613000000000014, "num_model_switches_mean": 4.6066, "num_model_switches_min": 3.94, "num_model_switches_max": 5.43, "num_slav_mean": 0.17652266666666666, "num_slav_min": 0.16011666666666666, "num_slav_max": 0.19793333333333332, "mean_cluster_cpu_util_mean": 0.539774513761971, "mean_cluster_cpu_util_min": 0.523252302062822, "mean_cluster_cpu_util_max": 0.5558234614630756, "mean_cluster_mem_util_mean": 0.3542815018962226, "mean_cluster_mem_util_min": 0.3458680413832201, "mean_cluster_mem_util_max": 0.361994711027871, "reward_consolidation_mean_mean": -0.05894166666666668, "reward_consolidation_mean_min": -0.10416666666666669, "reward_consolidation_mean_max": -0.021666666666666678, "reward_illegal_mean_mean": -1.3611666666666664, "reward_illegal_mean_min": -1.6499999999999997, "reward_illegal_mean_max": -1.0999999999999996, "reward_accuracy_mean_mean": 0.039496666666666715, "reward_accuracy_mean_min": 0.01769999999999991, "reward_accuracy_mean_max": 0.06220000000000015, "reward_sla_mean_mean": -0.53807, "reward_sla_mean_min": -0.7191666666666666, "reward_sla_mean_max": -0.32799999999999996, "reward_consolidation_sum_mean": -5.894166666666667, "reward_consolidation_sum_min": -10.416666666666668, "reward_consolidation_sum_max": -2.166666666666668, "reward_illegal_sum_mean": -136.11666666666662, "reward_illegal_sum_min": -164.99999999999997, "reward_illegal_sum_max": -109.99999999999997, "reward_accuracy_sum_mean": 3.949666666666671, "reward_accuracy_sum_min": 1.7699999999999911, "reward_accuracy_sum_max": 6.220000000000015, "reward_sla_sum_mean": -53.806999999999995, "reward_sla_sum_min": -71.91666666666666, "reward_sla_sum_max": -32.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4925.0, "global_timestep_min": 2000, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-185.95999999999992, -200.47999999999993, -195.42666666666642, -201.77999999999992, -195.0433333333333, -215.52999999999986, -195.98999999999995, -199.55333333333326, -201.01666666666657, -201.67333333333318, -194.55999999999995, -201.76333333333335, -183.65999999999988, -193.32, -188.5799999999999, -189.85999999999981, -190.58999999999983, -200.69666666666654, -188.2933333333333, -186.20333333333335, -186.3999999999999, -188.8399999999999, -199.2299999999998, -207.98999999999995, -204.7933333333333, -196.80666666666664, -191.73, -176.49666666666658, -182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2052358384398289, "mean_inference_ms": 1.8551540269313915, "mean_action_processing_ms": 0.07764152586385614, "mean_env_wait_ms": 1.241033805599726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005012989044189453, "StateBufferConnector_ms": 0.003174304962158203, "ViewRequirementAgentConnector_ms": 0.07368135452270508}, "num_episodes": 28, "episode_return_max": -176.49666666666658, "episode_return_min": -215.52999999999986, "episode_return_mean": -191.86816666666655, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46100, "num_agent_steps_trained": 45900, "num_env_steps_sampled": 46100, "num_env_steps_trained": 45900, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.3101875774256, "num_env_steps_trained_throughput_per_sec": 298.25191818354375, "timesteps_total": 46100, "num_env_steps_sampled_lifetime": 46100, "num_agent_steps_sampled_lifetime": 46100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 46100, "timers": {"training_iteration_time_ms": 10144.693, "restore_workers_time_ms": 0.011, "training_step_time_ms": 345.66, "sample_time_ms": 336.591, "synch_weights_time_ms": 8.203}, "counters": {"num_env_steps_sampled": 46100, "num_env_steps_trained": 45900, "num_agent_steps_sampled": 46100, "num_agent_steps_trained": 45900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 461, "num_samples_added_to_queue": 45900}, "done": false, "training_iteration": 16, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-01", "timestamp": 1728592021, "time_this_iter_s": 10.067335367202759, "time_total_s": 162.92117643356323, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79e70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.92117643356323, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.692857142857145, "ram_util_percent": 49.464285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -188804.40625, "policy_loss": -188899.390625, "entropy": 25.789892196655273, "entropy_coeff": 0.01, "var_gnorm": 16.27228546142578, "vf_loss": 172364.84375, "vf_explained_var": 0.16434019804000854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 162.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 48900, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48900, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 489, "num_samples_added_to_queue": 48900, "learner_queue": {"size_count": 162, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.27, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1059.987, "learner_dequeue_time_ms": 8569.417}}, "env_runners": {"episode_reward_max": -177.76666666666657, "episode_reward_min": -208.56999999999994, "episode_reward_mean": -191.9840333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -208.56999999999994}, "policy_reward_max": {"default_policy": -177.76666666666657}, "policy_reward_mean": {"default_policy": -191.9840333333333}, "custom_metrics": {"num_consolidated_mean": 0.7441, "num_consolidated_min": 0.55, "num_consolidated_max": 0.98, "num_overloaded_mean": 0.825, "num_overloaded_min": 0.66, "num_overloaded_max": 1.04, "num_moves_mean": 8.3525, "num_moves_min": 7.54, "num_moves_max": 9.24, "mean_accuracy_mean": 41.27492666666667, "mean_accuracy_min": 40.986, "mean_accuracy_max": 41.613000000000014, "num_model_switches_mean": 4.6763, "num_model_switches_min": 3.94, "num_model_switches_max": 5.46, "num_slav_mean": 0.17559516666666672, "num_slav_min": 0.15011666666666668, "num_slav_max": 0.19520000000000004, "mean_cluster_cpu_util_mean": 0.5419246816159107, "mean_cluster_cpu_util_min": 0.5272418907904151, "mean_cluster_cpu_util_max": 0.5656606425974325, "mean_cluster_mem_util_mean": 0.35511595296399157, "mean_cluster_mem_util_min": 0.34835004592554325, "mean_cluster_mem_util_max": 0.3652521473779386, "reward_consolidation_mean_mean": -0.057725, "reward_consolidation_mean_min": -0.11583333333333336, "reward_consolidation_mean_max": -0.01333333333333334, "reward_illegal_mean_mean": -1.375, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.0999999999999996, "reward_accuracy_mean_mean": 0.03835300000000005, "reward_accuracy_mean_min": 0.016333333333333314, "reward_accuracy_mean_max": 0.06220000000000015, "reward_sla_mean_mean": -0.5254683333333333, "reward_sla_mean_min": -0.7191666666666666, "reward_sla_mean_max": -0.2713333333333333, "reward_consolidation_sum_mean": -5.772500000000003, "reward_consolidation_sum_min": -11.583333333333336, "reward_consolidation_sum_max": -1.333333333333334, "reward_illegal_sum_mean": -137.49999999999997, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -109.99999999999997, "reward_accuracy_sum_mean": 3.835300000000004, "reward_accuracy_sum_min": 1.6333333333333315, "reward_accuracy_sum_max": 6.220000000000015, "reward_sla_sum_mean": -52.54683333333333, "reward_sla_sum_min": -71.91666666666666, "reward_sla_sum_max": -27.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4765.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.8266666666666, -180.64666666666665, -196.74999999999997, -188.09666666666658, -190.24666666666658, -205.35999999999996, -192.81333333333322, -181.42666666666662, -186.80666666666664, -183.90666666666658, -201.49000000000004, -204.5066666666667, -195.46999999999983, -195.43333333333322, -189.8866666666666, -190.81666666666655, -183.38999999999996, -178.9633333333333, -188.63333333333333, -189.46666666666655, -183.99666666666658, -189.16999999999993, -195.01999999999987, -194.01333333333318, -177.76666666666657, -193.39666666666653, -183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20565811918172833, "mean_inference_ms": 1.8600788184573087, "mean_action_processing_ms": 0.07779927614828401, "mean_env_wait_ms": 1.244107525411616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828214645385742, "StateBufferConnector_ms": 0.003116130828857422, "ViewRequirementAgentConnector_ms": 0.07191848754882812}, "num_episodes": 28, "episode_return_max": -177.76666666666657, "episode_return_min": -208.56999999999994, "episode_return_mean": -191.9840333333333, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48900, "num_agent_steps_trained": 48600, "num_env_steps_sampled": 48900, "num_env_steps_trained": 48600, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.24918550413093, "num_env_steps_trained_throughput_per_sec": 259.6331431646977, "timesteps_total": 48900, "num_env_steps_sampled_lifetime": 48900, "num_agent_steps_sampled_lifetime": 48900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 48900, "timers": {"training_iteration_time_ms": 10159.24, "restore_workers_time_ms": 0.012, "training_step_time_ms": 370.27, "sample_time_ms": 360.184, "synch_weights_time_ms": 9.031}, "counters": {"num_env_steps_sampled": 48900, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48900, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 489, "num_samples_added_to_queue": 48900}, "done": false, "training_iteration": 17, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-12", "timestamp": 1728592032, "time_this_iter_s": 10.410237312316895, "time_total_s": 173.33141374588013, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d5780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.33141374588013, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.860000000000001, "ram_util_percent": 49.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -211058.734375, "policy_loss": -211158.9375, "entropy": 26.42849349975586, "entropy_coeff": 0.01, "var_gnorm": 16.286130905151367, "vf_loss": 179490.390625, "vf_explained_var": 0.18349796533584595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 51500, "num_env_steps_trained": 51300, "num_agent_steps_sampled": 51500, "num_agent_steps_trained": 51300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 515, "num_samples_added_to_queue": 51300, "learner_queue": {"size_count": 171, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.67, "learner_load_time_ms": 0.335, "learner_load_wait_time_ms": 1123.064, "learner_dequeue_time_ms": 8723.862}}, "env_runners": {"episode_reward_max": -178.39666666666656, "episode_reward_min": -208.56999999999994, "episode_reward_mean": -193.5510666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -208.56999999999994}, "policy_reward_max": {"default_policy": -178.39666666666656}, "policy_reward_mean": {"default_policy": -193.5510666666666}, "custom_metrics": {"num_consolidated_mean": 0.7286, "num_consolidated_min": 0.55, "num_consolidated_max": 0.94, "num_overloaded_mean": 0.8445999999999999, "num_overloaded_min": 0.66, "num_overloaded_max": 1.04, "num_moves_mean": 8.6836, "num_moves_min": 7.57, "num_moves_max": 9.62, "mean_accuracy_mean": 41.212923333333336, "mean_accuracy_min": 40.891, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 4.883500000000001, "num_model_switches_min": 3.94, "num_model_switches_max": 5.85, "num_slav_mean": 0.17273033333333335, "num_slav_min": 0.15011666666666668, "num_slav_max": 0.19520000000000004, "mean_cluster_cpu_util_mean": 0.5437939819030329, "mean_cluster_cpu_util_min": 0.5285123317866217, "mean_cluster_cpu_util_max": 0.5656606425974325, "mean_cluster_mem_util_mean": 0.35548394501133784, "mean_cluster_mem_util_min": 0.349635382401906, "mean_cluster_mem_util_max": 0.3652521473779386, "reward_consolidation_mean_mean": -0.057050000000000003, "reward_consolidation_mean_min": -0.11583333333333336, "reward_consolidation_mean_max": -0.01333333333333334, "reward_illegal_mean_mean": -1.4076666666666662, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.0999999999999996, "reward_accuracy_mean_mean": 0.03566600000000002, "reward_accuracy_mean_min": 0.00979999999999987, "reward_accuracy_mean_max": 0.06220000000000015, "reward_sla_mean_mean": -0.5064599999999999, "reward_sla_mean_min": -0.7191666666666666, "reward_sla_mean_max": -0.2596666666666666, "reward_consolidation_sum_mean": -5.705000000000001, "reward_consolidation_sum_min": -11.583333333333336, "reward_consolidation_sum_max": -1.333333333333334, "reward_illegal_sum_mean": -140.76666666666665, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -109.99999999999997, "reward_accuracy_sum_mean": 3.566600000000002, "reward_accuracy_sum_min": 0.979999999999987, "reward_accuracy_sum_max": 6.220000000000015, "reward_sla_sum_mean": -50.646, "reward_sla_sum_min": -71.91666666666666, "reward_sla_sum_max": -25.96666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4037.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-183.12333333333328, -182.41, -188.0699999999999, -184.7666666666665, -193.2666666666666, -188.18333333333334, -193.92333333333335, -188.83333333333326, -194.39333333333317, -190.05999999999986, -197.90333333333328, -192.37333333333322, -199.8699999999999, -197.42333333333332, -194.24999999999986, -188.71999999999989, -192.00999999999996, -185.5999999999998, -178.39666666666656, -201.55666666666644, -188.86999999999995, -186.20333333333326, -185.40666666666664, -197.75, -203.62333333333322, -182.31999999999996, -206.29333333333346, -188.27999999999997, -194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20615833051803015, "mean_inference_ms": 1.8643354978973952, "mean_action_processing_ms": 0.07796236430155676, "mean_env_wait_ms": 1.2471124523078834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004645824432373047, "StateBufferConnector_ms": 0.0030765533447265625, "ViewRequirementAgentConnector_ms": 0.07212400436401367}, "num_episodes": 26, "episode_return_max": -178.39666666666656, "episode_return_min": -208.56999999999994, "episode_return_mean": -193.5510666666666, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51500, "num_agent_steps_trained": 51300, "num_env_steps_sampled": 51500, "num_env_steps_trained": 51300, "num_env_steps_sampled_this_iter": 2600, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 254.4120686405541, "num_env_steps_trained_throughput_per_sec": 264.1971482036524, "timesteps_total": 51500, "num_env_steps_sampled_lifetime": 51500, "num_agent_steps_sampled_lifetime": 51500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 51500, "timers": {"training_iteration_time_ms": 10153.461, "restore_workers_time_ms": 0.014, "training_step_time_ms": 371.153, "sample_time_ms": 361.426, "synch_weights_time_ms": 8.713}, "counters": {"num_env_steps_sampled": 51500, "num_env_steps_trained": 51300, "num_agent_steps_sampled": 51500, "num_agent_steps_trained": 51300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 515, "num_samples_added_to_queue": 51300}, "done": false, "training_iteration": 18, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-22", "timestamp": 1728592042, "time_this_iter_s": 10.229008674621582, "time_total_s": 183.5604224205017, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa792a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.5604224205017, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.58666666666667, "ram_util_percent": 49.75333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -225561.328125, "policy_loss": -225679.078125, "entropy": 27.247709274291992, "entropy_coeff": 0.01, "var_gnorm": 16.3042049407959, "vf_loss": 199505.640625, "vf_explained_var": 0.1457500457763672}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 180.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 54300, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54300, "num_agent_steps_trained": 54000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 543, "num_samples_added_to_queue": 54300, "learner_queue": {"size_count": 180, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.424, "learner_load_time_ms": 0.357, "learner_load_wait_time_ms": 1027.515, "learner_dequeue_time_ms": 8809.247}}, "env_runners": {"episode_reward_max": -181.01999999999998, "episode_reward_min": -211.6533333333332, "episode_reward_mean": -195.49366666666663, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -211.6533333333332}, "policy_reward_max": {"default_policy": -181.01999999999998}, "policy_reward_mean": {"default_policy": -195.49366666666663}, "custom_metrics": {"num_consolidated_mean": 0.7043, "num_consolidated_min": 0.54, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.8823000000000001, "num_overloaded_min": 0.67, "num_overloaded_max": 1.11, "num_moves_mean": 9.074300000000001, "num_moves_min": 7.91, "num_moves_max": 9.82, "mean_accuracy_mean": 41.10867666666667, "mean_accuracy_min": 40.66933333333333, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 5.1636, "num_model_switches_min": 3.94, "num_model_switches_max": 5.85, "num_slav_mean": 0.16887583333333336, "num_slav_min": 0.13941666666666666, "num_slav_max": 0.19520000000000004, "mean_cluster_cpu_util_mean": 0.5476568909836795, "mean_cluster_cpu_util_min": 0.5325744084890643, "mean_cluster_cpu_util_max": 0.5719346265594532, "mean_cluster_mem_util_mean": 0.3570141735142369, "mean_cluster_mem_util_min": 0.34981018004248116, "mean_cluster_mem_util_max": 0.36753110504750425, "reward_consolidation_mean_mean": -0.056625000000000016, "reward_consolidation_mean_min": -0.11583333333333336, "reward_consolidation_mean_max": -0.01333333333333334, "reward_illegal_mean_mean": -1.4704999999999995, "reward_illegal_mean_min": -1.8499999999999996, "reward_illegal_mean_max": -1.1166666666666667, "reward_accuracy_mean_mean": 0.029044999999999984, "reward_accuracy_mean_min": 0.00979999999999987, "reward_accuracy_mean_max": 0.05150000000000016, "reward_sla_mean_mean": -0.4568566666666667, "reward_sla_mean_min": -0.6438333333333333, "reward_sla_mean_max": -0.22833333333333336, "reward_consolidation_sum_mean": -5.662500000000001, "reward_consolidation_sum_min": -11.583333333333336, "reward_consolidation_sum_max": -1.333333333333334, "reward_illegal_sum_mean": -147.05, "reward_illegal_sum_min": -184.99999999999997, "reward_illegal_sum_max": -111.66666666666667, "reward_accuracy_sum_mean": 2.9044999999999983, "reward_accuracy_sum_min": 0.979999999999987, "reward_accuracy_sum_max": 5.1500000000000155, "reward_sla_sum_mean": -45.68566666666666, "reward_sla_sum_min": -64.38333333333333, "reward_sla_sum_max": -22.833333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3253.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-194.25666666666658, -193.91, -185.73333333333323, -188.8066666666665, -181.63666666666666, -203.7066666666666, -196.82666666666657, -198.66999999999996, -181.66333333333333, -200.7699999999999, -187.4466666666665, -183.68999999999988, -192.73333333333323, -189.14666666666653, -190.5899999999999, -192.9033333333333, -186.30333333333328, -181.57666666666654, -199.00999999999996, -181.01999999999998, -200.16666666666663, -191.10666666666668, -203.30999999999995, -192.40999999999983, -185.9066666666666, -197.90666666666658, -203.68666666666655, -198.29666666666662, -194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20673660225344725, "mean_inference_ms": 1.8682405870694858, "mean_action_processing_ms": 0.07815127159947237, "mean_env_wait_ms": 1.249941758660585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004586219787597656, "StateBufferConnector_ms": 0.0030727386474609375, "ViewRequirementAgentConnector_ms": 0.07256078720092773}, "num_episodes": 28, "episode_return_max": -181.01999999999998, "episode_return_min": -211.6533333333332, "episode_return_mean": -195.49366666666663, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54300, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54300, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.78082755444154, "num_env_steps_trained_throughput_per_sec": 269.7886551417829, "timesteps_total": 54300, "num_env_steps_sampled_lifetime": 54300, "num_agent_steps_sampled_lifetime": 54300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 54300, "timers": {"training_iteration_time_ms": 10144.553, "restore_workers_time_ms": 0.015, "training_step_time_ms": 357.744, "sample_time_ms": 347.442, "synch_weights_time_ms": 9.299}, "counters": {"num_env_steps_sampled": 54300, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54300, "num_agent_steps_trained": 54000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 543, "num_samples_added_to_queue": 54300}, "done": false, "training_iteration": 19, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-32", "timestamp": 1728592052, "time_this_iter_s": 10.021588563919067, "time_total_s": 193.58201098442078, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81e800>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.58201098442078, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.05, "ram_util_percent": 49.62142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -215622.5625, "policy_loss": -215729.28125, "entropy": 26.76353645324707, "entropy_coeff": 0.01, "var_gnorm": 16.33587074279785, "vf_loss": 187017.4375, "vf_explained_var": 0.16930317878723145}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 190.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 57100, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57100, "num_agent_steps_trained": 57000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 571, "num_samples_added_to_queue": 57000, "learner_queue": {"size_count": 190, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.045, "learner_load_time_ms": 0.321, "learner_load_wait_time_ms": 1017.784, "learner_dequeue_time_ms": 8825.885}}, "env_runners": {"episode_reward_max": -184.07666666666665, "episode_reward_min": -215.02333333333314, "episode_reward_mean": -196.81173333333334, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.02333333333314}, "policy_reward_max": {"default_policy": -184.07666666666665}, "policy_reward_mean": {"default_policy": -196.81173333333334}, "custom_metrics": {"num_consolidated_mean": 0.6936000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9029999999999998, "num_overloaded_min": 0.74, "num_overloaded_max": 1.11, "num_moves_mean": 9.2921, "num_moves_min": 8.72, "num_moves_max": 9.82, "mean_accuracy_mean": 41.001009999999994, "mean_accuracy_min": 40.510999999999996, "mean_accuracy_max": 41.37866666666667, "num_model_switches_mean": 5.397, "num_model_switches_min": 4.74, "num_model_switches_max": 5.88, "num_slav_mean": 0.16276066666666666, "num_slav_min": 0.13301666666666667, "num_slav_max": 0.18765000000000004, "mean_cluster_cpu_util_mean": 0.5501013949239897, "mean_cluster_cpu_util_min": 0.5341811036702877, "mean_cluster_cpu_util_max": 0.5719346265594532, "mean_cluster_mem_util_mean": 0.3582754501833434, "mean_cluster_mem_util_min": 0.3506880753250668, "mean_cluster_mem_util_max": 0.36753110504750425, "reward_consolidation_mean_mean": -0.05845833333333332, "reward_consolidation_mean_min": -0.11583333333333336, "reward_consolidation_mean_max": -0.020000000000000007, "reward_illegal_mean_mean": -1.5049999999999997, "reward_illegal_mean_min": -1.8499999999999996, "reward_illegal_mean_max": -1.2333333333333334, "reward_accuracy_mean_mean": 0.025740999999999962, "reward_accuracy_mean_min": 0.00979999999999987, "reward_accuracy_mean_max": 0.05150000000000016, "reward_sla_mean_mean": -0.4304, "reward_sla_mean_min": -0.6438333333333333, "reward_sla_mean_max": -0.19649999999999998, "reward_consolidation_sum_mean": -5.845833333333335, "reward_consolidation_sum_min": -11.583333333333336, "reward_consolidation_sum_max": -2.000000000000001, "reward_illegal_sum_mean": -150.49999999999997, "reward_illegal_sum_min": -184.99999999999997, "reward_illegal_sum_max": -123.33333333333333, "reward_accuracy_sum_mean": 2.574099999999996, "reward_accuracy_sum_min": 0.979999999999987, "reward_accuracy_sum_max": 5.1500000000000155, "reward_sla_sum_mean": -43.04, "reward_sla_sum_min": -64.38333333333333, "reward_sla_sum_max": -19.65, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2937.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-194.00666666666658, -186.16666666666657, -197.33, -199.65333333333322, -191.9299999999999, -189.0933333333333, -202.51333333333332, -190.3699999999999, -196.58999999999986, -187.9233333333333, -208.56999999999994, -199.50333333333327, -197.72999999999993, -197.05666666666662, -190.45333333333332, -199.49999999999991, -202.51333333333318, -190.12999999999994, -193.8933333333333, -186.15333333333314, -199.40333333333325, -198.06, -194.5933333333333, -185.51666666666657, -201.05333333333326, -203.70666666666662, -190.31666666666658, -192.68333333333325, -194.65333333333328, -205.4999999999998, -196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20742228805063576, "mean_inference_ms": 1.8717022928343, "mean_action_processing_ms": 0.07836342570242272, "mean_env_wait_ms": 1.252826563611012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004724740982055664, "StateBufferConnector_ms": 0.003136873245239258, "ViewRequirementAgentConnector_ms": 0.07384991645812988}, "num_episodes": 28, "episode_return_max": -184.07666666666665, "episode_return_min": -215.02333333333314, "episode_return_mean": -196.81173333333334, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57100, "num_agent_steps_trained": 57000, "num_env_steps_sampled": 57100, "num_env_steps_trained": 57000, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.11581135694087, "num_env_steps_trained_throughput_per_sec": 299.0526550252938, "timesteps_total": 57100, "num_env_steps_sampled_lifetime": 57100, "num_agent_steps_sampled_lifetime": 57100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 57100, "timers": {"training_iteration_time_ms": 10133.159, "restore_workers_time_ms": 0.013, "training_step_time_ms": 361.039, "sample_time_ms": 351.584, "synch_weights_time_ms": 8.366}, "counters": {"num_env_steps_sampled": 57100, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57100, "num_agent_steps_trained": 57000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 571, "num_samples_added_to_queue": 57000}, "done": false, "training_iteration": 20, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-42", "timestamp": 1728592062, "time_this_iter_s": 10.042635917663574, "time_total_s": 203.62464690208435, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81f670>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.62464690208435, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.12, "ram_util_percent": 49.673333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -200626.140625, "policy_loss": -200718.921875, "entropy": 26.082244873046875, "entropy_coeff": 0.01, "var_gnorm": 16.3671875, "vf_loss": 171035.65625, "vf_explained_var": 0.19196152687072754}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 600, "num_samples_added_to_queue": 60000, "learner_queue": {"size_count": 199, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.619, "learner_load_time_ms": 0.314, "learner_load_wait_time_ms": 999.736, "learner_dequeue_time_ms": 8840.889}}, "env_runners": {"episode_reward_max": -174.0533333333332, "episode_reward_min": -215.02333333333314, "episode_reward_mean": -195.85103333333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.02333333333314}, "policy_reward_max": {"default_policy": -174.0533333333332}, "policy_reward_mean": {"default_policy": -195.85103333333325}, "custom_metrics": {"num_consolidated_mean": 0.7015, "num_consolidated_min": 0.54, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9262000000000001, "num_overloaded_min": 0.74, "num_overloaded_max": 1.11, "num_moves_mean": 9.3193, "num_moves_min": 8.75, "num_moves_max": 9.82, "mean_accuracy_mean": 40.88903666666667, "mean_accuracy_min": 40.46666666666666, "mean_accuracy_max": 41.35333333333334, "num_model_switches_mean": 5.462600000000001, "num_model_switches_min": 4.95, "num_model_switches_max": 5.88, "num_slav_mean": 0.15502366666666664, "num_slav_min": 0.11729999999999999, "num_slav_max": 0.1855, "mean_cluster_cpu_util_mean": 0.5540161715816946, "mean_cluster_cpu_util_min": 0.5341811036702877, "mean_cluster_cpu_util_max": 0.5737515086601088, "mean_cluster_mem_util_mean": 0.36032490312939525, "mean_cluster_mem_util_min": 0.35139633797611863, "mean_cluster_mem_util_max": 0.3702840893108298, "reward_consolidation_mean_mean": -0.055875, "reward_consolidation_mean_min": -0.10500000000000002, "reward_consolidation_mean_max": -0.020000000000000007, "reward_illegal_mean_mean": -1.543666666666666, "reward_illegal_mean_min": -1.8499999999999996, "reward_illegal_mean_max": -1.2333333333333334, "reward_accuracy_mean_mean": 0.021241333333333286, "reward_accuracy_mean_min": 0.0060999999999999666, "reward_accuracy_mean_max": 0.038833333333333345, "reward_sla_mean_mean": -0.38020999999999994, "reward_sla_mean_min": -0.6333333333333333, "reward_sla_mean_max": -0.14633333333333332, "reward_consolidation_sum_mean": -5.5875, "reward_consolidation_sum_min": -10.500000000000002, "reward_consolidation_sum_max": -2.000000000000001, "reward_illegal_sum_mean": -154.36666666666665, "reward_illegal_sum_min": -184.99999999999997, "reward_illegal_sum_max": -123.33333333333333, "reward_accuracy_sum_mean": 2.1241333333333277, "reward_accuracy_sum_min": 0.6099999999999967, "reward_accuracy_sum_max": 3.883333333333334, "reward_sla_sum_mean": -38.021, "reward_sla_sum_min": -63.33333333333333, "reward_sla_sum_max": -14.633333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4114.0, "global_timestep_min": 1100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-196.8499999999999, -207.33666666666653, -204.2566666666666, -192.9933333333332, -196.15999999999994, -196.13333333333324, -198.26333333333335, -184.67666666666668, -202.2666666666666, -190.16333333333324, -195.16666666666657, -192.76999999999992, -198.45666666666665, -195.97666666666657, -203.2599999999999, -198.88999999999984, -199.38333333333318, -210.29333333333327, -184.07666666666665, -194.21, -184.1666666666665, -202.39666666666656, -197.4666666666666, -193.4766666666666, -199.85666666666654, -196.16333333333324, -200.51333333333326, -195.57, -198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20785933393104927, "mean_inference_ms": 1.8711393073139708, "mean_action_processing_ms": 0.07848485394596255, "mean_env_wait_ms": 1.2541153095264337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004586696624755859, "StateBufferConnector_ms": 0.0030586719512939453, "ViewRequirementAgentConnector_ms": 0.0713191032409668}, "num_episodes": 30, "episode_return_max": -174.0533333333332, "episode_return_min": -215.02333333333314, "episode_return_mean": -195.85103333333325, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 286.6694148571931, "num_env_steps_trained_throughput_per_sec": 266.89911038428323, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10133.326, "restore_workers_time_ms": 0.013, "training_step_time_ms": 351.636, "sample_time_ms": 341.628, "synch_weights_time_ms": 9.079}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 59700, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 59700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 600, "num_samples_added_to_queue": 60000}, "done": false, "training_iteration": 21, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-27-52", "timestamp": 1728592072, "time_this_iter_s": 10.125938653945923, "time_total_s": 213.75058555603027, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7beb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.75058555603027, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.821428571428571, "ram_util_percent": 49.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -160993.890625, "policy_loss": -161053.171875, "entropy": 24.92595100402832, "entropy_coeff": 0.01, "var_gnorm": 16.415241241455078, "vf_loss": 134062.640625, "vf_explained_var": 0.2352069616317749}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 209.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 62800, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 62800, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 628, "num_samples_added_to_queue": 62700, "learner_queue": {"size_count": 209, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.042, "learner_load_time_ms": 0.267, "learner_load_wait_time_ms": 1009.907, "learner_dequeue_time_ms": 8794.015}}, "env_runners": {"episode_reward_max": -174.0533333333332, "episode_reward_min": -215.02333333333314, "episode_reward_mean": -193.98056666666656, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.02333333333314}, "policy_reward_max": {"default_policy": -174.0533333333332}, "policy_reward_mean": {"default_policy": -193.98056666666656}, "custom_metrics": {"num_consolidated_mean": 0.7234, "num_consolidated_min": 0.55, "num_consolidated_max": 0.89, "num_overloaded_mean": 0.9325999999999999, "num_overloaded_min": 0.74, "num_overloaded_max": 1.11, "num_moves_mean": 9.2033, "num_moves_min": 8.53, "num_moves_max": 9.82, "mean_accuracy_mean": 40.79112333333333, "mean_accuracy_min": 40.46666666666666, "mean_accuracy_max": 41.195, "num_model_switches_mean": 5.424300000000001, "num_model_switches_min": 4.86, "num_model_switches_max": 5.88, "num_slav_mean": 0.14926383333333335, "num_slav_min": 0.11729999999999999, "num_slav_max": 0.17043333333333335, "mean_cluster_cpu_util_mean": 0.5563418602084755, "mean_cluster_cpu_util_min": 0.534833299925838, "mean_cluster_cpu_util_max": 0.5753755942408122, "mean_cluster_mem_util_mean": 0.36187699866170087, "mean_cluster_mem_util_min": 0.3521317167900916, "mean_cluster_mem_util_max": 0.3702840893108298, "reward_consolidation_mean_mean": -0.053450000000000004, "reward_consolidation_mean_min": -0.10500000000000002, "reward_consolidation_mean_max": -0.015833333333333338, "reward_illegal_mean_mean": -1.5543333333333331, "reward_illegal_mean_min": -1.8499999999999996, "reward_illegal_mean_max": -1.2333333333333334, "reward_accuracy_mean_mean": 0.01910766666666661, "reward_accuracy_mean_min": 0.0060999999999999666, "reward_accuracy_mean_max": 0.034533333333333284, "reward_sla_mean_mean": -0.35113, "reward_sla_mean_min": -0.6333333333333333, "reward_sla_mean_max": -0.14633333333333332, "reward_consolidation_sum_mean": -5.345, "reward_consolidation_sum_min": -10.500000000000002, "reward_consolidation_sum_max": -1.583333333333334, "reward_illegal_sum_mean": -155.4333333333333, "reward_illegal_sum_min": -184.99999999999997, "reward_illegal_sum_max": -123.33333333333333, "reward_accuracy_sum_mean": 1.9107666666666612, "reward_accuracy_sum_min": 0.6099999999999967, "reward_accuracy_sum_max": 3.4533333333333287, "reward_sla_sum_mean": -35.113, "reward_sla_sum_min": -63.33333333333333, "reward_sla_sum_max": -14.633333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5189.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-198.1799999999999, -187.94666666666657, -189.24333333333337, -205.57999999999984, -193.71333333333325, -207.6366666666666, -203.13333333333333, -211.6533333333332, -202.2266666666667, -208.37999999999994, -192.62666666666664, -194.63333333333333, -197.71333333333328, -195.75000000000003, -201.8333333333332, -191.56999999999988, -199.5933333333332, -199.01999999999978, -209.16999999999993, -206.2433333333334, -194.63999999999993, -193.51666666666665, -201.07333333333332, -200.08000000000004, -189.39333333333326, -202.35666666666657, -187.0633333333332, -193.03333333333333, -202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20802292641105458, "mean_inference_ms": 1.8682219202289048, "mean_action_processing_ms": 0.07851470755209959, "mean_env_wait_ms": 1.2542411670340052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004914999008178711, "StateBufferConnector_ms": 0.003083944320678711, "ViewRequirementAgentConnector_ms": 0.07117176055908203}, "num_episodes": 28, "episode_return_max": -174.0533333333332, "episode_return_min": -215.02333333333314, "episode_return_mean": -193.98056666666656, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62800, "num_agent_steps_trained": 62700, "num_env_steps_sampled": 62800, "num_env_steps_trained": 62700, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.94410867771944, "num_env_steps_trained_throughput_per_sec": 299.94011644041365, "timesteps_total": 62800, "num_env_steps_sampled_lifetime": 62800, "num_agent_steps_sampled_lifetime": 62800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 62800, "timers": {"training_iteration_time_ms": 10129.32, "restore_workers_time_ms": 0.013, "training_step_time_ms": 368.299, "sample_time_ms": 358.094, "synch_weights_time_ms": 9.181}, "counters": {"num_env_steps_sampled": 62800, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 62800, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 628, "num_samples_added_to_queue": 62700}, "done": false, "training_iteration": 22, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-02", "timestamp": 1728592082, "time_this_iter_s": 10.010828018188477, "time_total_s": 223.76141357421875, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79480>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.76141357421875, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.986666666666666, "ram_util_percent": 50.006666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -100524.875, "policy_loss": -100573.078125, "entropy": 21.036378860473633, "entropy_coeff": 0.01, "var_gnorm": 16.499704360961914, "vf_loss": 111315.765625, "vf_explained_var": 0.2679687738418579}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 65600, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65600, "num_agent_steps_trained": 65400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 656, "num_samples_added_to_queue": 65400, "learner_queue": {"size_count": 218, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.862, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1050.283, "learner_dequeue_time_ms": 8696.597}}, "env_runners": {"episode_reward_max": -174.0533333333332, "episode_reward_min": -215.02333333333314, "episode_reward_mean": -189.95456666666658, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -215.02333333333314}, "policy_reward_max": {"default_policy": -174.0533333333332}, "policy_reward_mean": {"default_policy": -189.95456666666658}, "custom_metrics": {"num_consolidated_mean": 0.7452, "num_consolidated_min": 0.56, "num_consolidated_max": 1.0, "num_overloaded_mean": 0.9171999999999998, "num_overloaded_min": 0.78, "num_overloaded_max": 1.07, "num_moves_mean": 8.798700000000002, "num_moves_min": 6.91, "num_moves_max": 9.74, "mean_accuracy_mean": 40.691373333333324, "mean_accuracy_min": 40.35266666666666, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.2204, "num_model_switches_min": 4.12, "num_model_switches_max": 5.88, "num_slav_mean": 0.14662766666666663, "num_slav_min": 0.11729999999999999, "num_slav_max": 0.16755000000000003, "mean_cluster_cpu_util_mean": 0.553221531656445, "mean_cluster_cpu_util_min": 0.5326240194623221, "mean_cluster_cpu_util_max": 0.5753755942408122, "mean_cluster_mem_util_mean": 0.36088199555455097, "mean_cluster_mem_util_min": 0.3500713081962743, "mean_cluster_mem_util_max": 0.3702840893108298, "reward_consolidation_mean_mean": -0.05108333333333335, "reward_consolidation_mean_min": -0.10000000000000002, "reward_consolidation_mean_max": -0.015833333333333338, "reward_illegal_mean_mean": -1.5286666666666664, "reward_illegal_mean_min": -1.7833333333333334, "reward_illegal_mean_max": -1.2999999999999994, "reward_accuracy_mean_mean": 0.017465999999999933, "reward_accuracy_mean_min": 0.0060999999999999666, "reward_accuracy_mean_max": 0.033299999999999975, "reward_sla_mean_mean": -0.3372616666666666, "reward_sla_mean_min": -0.5456666666666667, "reward_sla_mean_max": -0.14633333333333332, "reward_consolidation_sum_mean": -5.108333333333334, "reward_consolidation_sum_min": -10.000000000000002, "reward_consolidation_sum_max": -1.583333333333334, "reward_illegal_sum_mean": -152.86666666666665, "reward_illegal_sum_min": -178.33333333333334, "reward_illegal_sum_max": -129.99999999999994, "reward_accuracy_sum_mean": 1.7465999999999935, "reward_accuracy_sum_min": 0.6099999999999967, "reward_accuracy_sum_max": 3.3299999999999974, "reward_sla_sum_mean": -33.72616666666667, "reward_sla_sum_min": -54.56666666666667, "reward_sla_sum_max": -14.633333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4405.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-202.79000000000002, -215.02333333333314, -201.88999999999984, -192.8766666666666, -195.04333333333327, -193.05333333333326, -191.8033333333333, -195.73999999999984, -201.79333333333318, -200.94333333333324, -193.77666666666673, -184.79333333333327, -188.44999999999993, -188.43333333333317, -189.14666666666662, -190.6866666666665, -197.42333333333315, -186.0433333333332, -184.55333333333323, -186.12999999999997, -187.57999999999984, -185.0, -197.22333333333327, -189.21000000000004, -198.58999999999995, -191.08999999999986, -196.27666666666659, -197.47333333333324, -174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20821347838364054, "mean_inference_ms": 1.8668417464147213, "mean_action_processing_ms": 0.07855329682785069, "mean_env_wait_ms": 1.2546523781771883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004997730255126953, "StateBufferConnector_ms": 0.0030972957611083984, "ViewRequirementAgentConnector_ms": 0.07243800163269043}, "num_episodes": 28, "episode_return_max": -174.0533333333332, "episode_return_min": -215.02333333333314, "episode_return_mean": -189.95456666666658, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65600, "num_agent_steps_trained": 65400, "num_env_steps_sampled": 65600, "num_env_steps_trained": 65400, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.0289876152641, "num_env_steps_trained_throughput_per_sec": 268.09938091471895, "timesteps_total": 65600, "num_env_steps_sampled_lifetime": 65600, "num_agent_steps_sampled_lifetime": 65600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 65600, "timers": {"training_iteration_time_ms": 10135.349, "restore_workers_time_ms": 0.013, "training_step_time_ms": 350.474, "sample_time_ms": 340.555, "synch_weights_time_ms": 8.908}, "counters": {"num_env_steps_sampled": 65600, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65600, "num_agent_steps_trained": 65400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 656, "num_samples_added_to_queue": 65400}, "done": false, "training_iteration": 23, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-12", "timestamp": 1728592092, "time_this_iter_s": 10.081475257873535, "time_total_s": 233.84288883209229, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79960>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.84288883209229, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.114285714285714, "ram_util_percent": 50.24285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -80425.8203125, "policy_loss": -80457.7265625, "entropy": 19.48447036743164, "entropy_coeff": 0.01, "var_gnorm": 16.601789474487305, "vf_loss": 90359.921875, "vf_explained_var": 0.33437907695770264}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 68400, "num_env_steps_trained": 68100, "num_agent_steps_sampled": 68400, "num_agent_steps_trained": 68100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 684, "num_samples_added_to_queue": 68400, "learner_queue": {"size_count": 227, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.827, "learner_load_time_ms": 0.274, "learner_load_wait_time_ms": 1017.607, "learner_dequeue_time_ms": 8712.584}}, "env_runners": {"episode_reward_max": -167.56333333333328, "episode_reward_min": -206.86999999999995, "episode_reward_mean": -185.5051999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.86999999999995}, "policy_reward_max": {"default_policy": -167.56333333333328}, "policy_reward_mean": {"default_policy": -185.5051999999999}, "custom_metrics": {"num_consolidated_mean": 0.7483, "num_consolidated_min": 0.54, "num_consolidated_max": 1.0, "num_overloaded_mean": 0.8783999999999998, "num_overloaded_min": 0.64, "num_overloaded_max": 1.06, "num_moves_mean": 8.1113, "num_moves_min": 6.12, "num_moves_max": 9.48, "mean_accuracy_mean": 40.583073333333324, "mean_accuracy_min": 40.16899999999999, "mean_accuracy_max": 40.96066666666667, "num_model_switches_mean": 4.8275, "num_model_switches_min": 3.48, "num_model_switches_max": 5.8, "num_slav_mean": 0.1466885, "num_slav_min": 0.13025, "num_slav_max": 0.16326666666666667, "mean_cluster_cpu_util_mean": 0.5441858331321501, "mean_cluster_cpu_util_min": 0.5025844021290774, "mean_cluster_cpu_util_max": 0.5753755942408122, "mean_cluster_mem_util_mean": 0.3573238151191911, "mean_cluster_mem_util_min": 0.3393016145698787, "mean_cluster_mem_util_max": 0.36939569394213384, "reward_consolidation_mean_mean": -0.05373333333333334, "reward_consolidation_mean_min": -0.12333333333333335, "reward_consolidation_mean_max": -0.00916666666666667, "reward_illegal_mean_mean": -1.4639999999999997, "reward_illegal_mean_min": -1.7666666666666668, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.015887999999999906, "reward_accuracy_mean_min": 0.0060999999999999666, "reward_accuracy_mean_max": 0.033299999999999975, "reward_sla_mean_mean": -0.3532066666666666, "reward_sla_mean_min": -0.6629999999999999, "reward_sla_mean_max": -0.12349999999999998, "reward_consolidation_sum_mean": -5.373333333333332, "reward_consolidation_sum_min": -12.333333333333336, "reward_consolidation_sum_max": -0.9166666666666671, "reward_illegal_sum_mean": -146.39999999999998, "reward_illegal_sum_min": -176.66666666666669, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 1.588799999999991, "reward_accuracy_sum_min": 0.6099999999999967, "reward_accuracy_sum_max": 3.3299999999999974, "reward_sla_sum_mean": -35.32066666666667, "reward_sla_sum_min": -66.3, "reward_sla_sum_max": -12.349999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3621.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-174.0533333333332, -192.12999999999997, -191.6133333333332, -193.48666666666665, -188.07333333333324, -197.04999999999993, -196.44999999999993, -203.21999999999994, -198.04999999999998, -196.94333333333327, -192.41333333333324, -180.13999999999984, -193.20666666666662, -193.52333333333326, -206.86999999999995, -196.84666666666652, -188.00666666666652, -194.10999999999987, -186.40333333333328, -196.78333333333327, -189.60333333333324, -191.30333333333317, -186.75999999999988, -186.51999999999984, -178.22666666666652, -188.11999999999998, -186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2084336136124053, "mean_inference_ms": 1.8660639778549892, "mean_action_processing_ms": 0.0785881177690229, "mean_env_wait_ms": 1.2552038955015632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005005598068237305, "StateBufferConnector_ms": 0.003111124038696289, "ViewRequirementAgentConnector_ms": 0.07284998893737793}, "num_episodes": 28, "episode_return_max": -167.56333333333328, "episode_return_min": -206.86999999999995, "episode_return_mean": -185.5051999999999, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68400, "num_agent_steps_trained": 68100, "num_env_steps_sampled": 68400, "num_env_steps_trained": 68100, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.58394738054983, "num_env_steps_trained_throughput_per_sec": 269.598806402673, "timesteps_total": 68400, "num_env_steps_sampled_lifetime": 68400, "num_agent_steps_sampled_lifetime": 68400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 68400, "timers": {"training_iteration_time_ms": 10115.581, "restore_workers_time_ms": 0.013, "training_step_time_ms": 348.044, "sample_time_ms": 337.786, "synch_weights_time_ms": 9.325}, "counters": {"num_env_steps_sampled": 68400, "num_env_steps_trained": 68100, "num_agent_steps_sampled": 68400, "num_agent_steps_trained": 68100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 684, "num_samples_added_to_queue": 68400}, "done": false, "training_iteration": 24, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-23", "timestamp": 1728592103, "time_this_iter_s": 10.02537202835083, "time_total_s": 243.86826086044312, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81f0d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.86826086044312, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.707142857142857, "ram_util_percent": 50.42142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -49353.38671875, "policy_loss": -49389.43359375, "entropy": 15.29535961151123, "entropy_coeff": 0.01, "var_gnorm": 16.728771209716797, "vf_loss": 81935.0, "vf_explained_var": 0.33799028396606445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 70800, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 70800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 710, "num_samples_added_to_queue": 70800, "learner_queue": {"size_count": 236, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.319, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1112.639, "learner_dequeue_time_ms": 8737.608}}, "env_runners": {"episode_reward_max": -165.66000000000003, "episode_reward_min": -198.66999999999985, "episode_reward_mean": -180.83243333333326, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -198.66999999999985}, "policy_reward_max": {"default_policy": -165.66000000000003}, "policy_reward_mean": {"default_policy": -180.83243333333326}, "custom_metrics": {"num_consolidated_mean": 0.7772, "num_consolidated_min": 0.54, "num_consolidated_max": 1.18, "num_overloaded_mean": 0.8716999999999999, "num_overloaded_min": 0.64, "num_overloaded_max": 1.04, "num_moves_mean": 7.3006, "num_moves_min": 5.07, "num_moves_max": 9.27, "mean_accuracy_mean": 40.36191333333333, "mean_accuracy_min": 39.25699999999998, "mean_accuracy_max": 40.783333333333324, "num_model_switches_mean": 4.296, "num_model_switches_min": 2.41, "num_model_switches_max": 5.71, "num_slav_mean": 0.1451735, "num_slav_min": 0.10925000000000001, "num_slav_max": 0.16326666666666667, "mean_cluster_cpu_util_mean": 0.5425990950753445, "mean_cluster_cpu_util_min": 0.5025844021290774, "mean_cluster_cpu_util_max": 0.6037803329669285, "mean_cluster_mem_util_mean": 0.35664274922321243, "mean_cluster_mem_util_min": 0.3393016145698787, "mean_cluster_mem_util_max": 0.3829410086397428, "reward_consolidation_mean_mean": -0.04992500000000002, "reward_consolidation_mean_min": -0.12333333333333335, "reward_consolidation_mean_max": 0.0033333333333333327, "reward_illegal_mean_mean": -1.4528333333333328, "reward_illegal_mean_min": -1.7333333333333332, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.012683999999999902, "reward_accuracy_mean_min": -0.0005000000000000356, "reward_accuracy_mean_max": 0.028133333333333354, "reward_sla_mean_mean": -0.31825000000000003, "reward_sla_mean_min": -0.6629999999999999, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": -4.992500000000001, "reward_consolidation_sum_min": -12.333333333333336, "reward_consolidation_sum_max": 0.33333333333333326, "reward_illegal_sum_mean": -145.28333333333333, "reward_illegal_sum_min": -173.33333333333331, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 1.2683999999999902, "reward_accuracy_sum_min": -0.050000000000003555, "reward_accuracy_sum_max": 2.8133333333333352, "reward_sla_sum_mean": -31.824999999999996, "reward_sla_sum_min": -66.3, "reward_sla_sum_max": 0.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2917.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-186.64666666666668, -187.42666666666653, -192.2533333333333, -187.85666666666657, -194.15999999999994, -198.66999999999985, -183.66333333333327, -193.6233333333332, -196.95000000000002, -176.62333333333328, -191.53666666666663, -195.52333333333326, -198.22666666666663, -196.71999999999983, -194.51333333333318, -185.43333333333325, -189.50333333333327, -188.9799999999999, -179.13999999999987, -194.8166666666666, -188.38999999999993, -195.91999999999996, -198.01999999999984, -177.90666666666658, -191.34666666666655, -178.98000000000002, -181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2089174145540963, "mean_inference_ms": 1.870586950848912, "mean_action_processing_ms": 0.0787273363980899, "mean_env_wait_ms": 1.2573524779523648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005063295364379883, "StateBufferConnector_ms": 0.003270864486694336, "ViewRequirementAgentConnector_ms": 0.07613396644592285}, "num_episodes": 26, "episode_return_max": -165.66000000000003, "episode_return_min": -198.66999999999985, "episode_return_mean": -180.83243333333326, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 70800, "num_env_steps_sampled": 71000, "num_env_steps_trained": 70800, "num_env_steps_sampled_this_iter": 2600, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 251.62716985130422, "num_env_steps_trained_throughput_per_sec": 261.3051379225082, "timesteps_total": 71000, "num_env_steps_sampled_lifetime": 71000, "num_agent_steps_sampled_lifetime": 71000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 10125.384, "restore_workers_time_ms": 0.014, "training_step_time_ms": 444.543, "sample_time_ms": 433.864, "synch_weights_time_ms": 9.686}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 70800, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 70800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 710, "num_samples_added_to_queue": 70800}, "done": false, "training_iteration": 25, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-33", "timestamp": 1728592113, "time_this_iter_s": 10.349947214126587, "time_total_s": 254.2182080745697, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d4520>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.2182080745697, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.85333333333333, "ram_util_percent": 50.866666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -30481.98828125, "policy_loss": -30509.3671875, "entropy": 12.337872505187988, "entropy_coeff": 0.01, "var_gnorm": 16.889863967895508, "vf_loss": 64393.0859375, "vf_explained_var": 0.3954446315765381}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 245.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 73700, "num_env_steps_trained": 73500, "num_agent_steps_sampled": 73700, "num_agent_steps_trained": 73500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 737, "num_samples_added_to_queue": 73500, "learner_queue": {"size_count": 245, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.062, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1070.717, "learner_dequeue_time_ms": 8826.492}}, "env_runners": {"episode_reward_max": -165.66000000000003, "episode_reward_min": -196.28666666666658, "episode_reward_mean": -175.12643333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -196.28666666666658}, "policy_reward_max": {"default_policy": -165.66000000000003}, "policy_reward_mean": {"default_policy": -175.12643333333327}, "custom_metrics": {"num_consolidated_mean": 1.0267, "num_consolidated_min": 0.54, "num_consolidated_max": 2.11, "num_overloaded_mean": 0.8947000000000002, "num_overloaded_min": 0.64, "num_overloaded_max": 1.04, "num_moves_mean": 6.213000000000001, "num_moves_min": 4.11, "num_moves_max": 8.58, "mean_accuracy_mean": 39.888433333333325, "mean_accuracy_min": 38.50966666666665, "mean_accuracy_max": 40.758, "num_model_switches_mean": 3.5149, "num_model_switches_min": 1.76, "num_model_switches_max": 5.17, "num_slav_mean": 0.13519849999999997, "num_slav_min": 0.0956, "num_slav_max": 0.16326666666666667, "mean_cluster_cpu_util_mean": 0.5809415412189312, "mean_cluster_cpu_util_min": 0.5025844021290774, "mean_cluster_cpu_util_max": 0.7999172353442848, "mean_cluster_mem_util_mean": 0.37370842974288876, "mean_cluster_mem_util_min": 0.3393016145698787, "mean_cluster_mem_util_max": 0.47336912529779845, "reward_consolidation_mean_mean": -0.03650833333333334, "reward_consolidation_mean_min": -0.12333333333333335, "reward_consolidation_mean_max": 0.0033333333333333327, "reward_illegal_mean_mean": -1.491166666666666, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.008345666666666586, "reward_accuracy_mean_min": -0.0008000000000000185, "reward_accuracy_mean_max": 0.028133333333333354, "reward_sla_mean_mean": -0.231935, "reward_sla_mean_min": -0.6629999999999999, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": -3.6508333333333343, "reward_consolidation_sum_min": -12.333333333333336, "reward_consolidation_sum_max": 0.33333333333333326, "reward_illegal_sum_mean": -149.11666666666662, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 0.8345666666666586, "reward_accuracy_sum_min": -0.08000000000000185, "reward_accuracy_sum_max": 2.8133333333333352, "reward_sla_sum_mean": -23.1935, "reward_sla_sum_min": -66.3, "reward_sla_sum_max": 0.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3134.0, "global_timestep_min": 300, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-181.12999999999997, -182.0299999999999, -178.64333333333323, -177.92999999999986, -176.72666666666657, -176.99999999999997, -190.93333333333334, -181.91666666666666, -182.2566666666666, -184.59333333333325, -183.38333333333324, -180.3833333333332, -196.28666666666658, -185.05333333333317, -179.60333333333318, -191.52999999999994, -181.82666666666665, -177.18999999999997, -179.62333333333325, -181.8433333333332, -175.1466666666666, -189.53666666666658, -167.56333333333328, -169.17333333333326, -184.90999999999994, -175.24999999999991, -172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20931442520111943, "mean_inference_ms": 1.8747950445625496, "mean_action_processing_ms": 0.07884926960521157, "mean_env_wait_ms": 1.259355878803116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004933834075927734, "StateBufferConnector_ms": 0.0032396316528320312, "ViewRequirementAgentConnector_ms": 0.07584166526794434}, "num_episodes": 26, "episode_return_max": -165.66000000000003, "episode_return_min": -196.28666666666658, "episode_return_mean": -175.12643333333327, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73700, "num_agent_steps_trained": 73500, "num_env_steps_sampled": 73700, "num_env_steps_trained": 73500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.1106262548223, "num_env_steps_trained_throughput_per_sec": 269.1106262548223, "timesteps_total": 73700, "num_env_steps_sampled_lifetime": 73700, "num_agent_steps_sampled_lifetime": 73700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 73700, "timers": {"training_iteration_time_ms": 10122.828, "restore_workers_time_ms": 0.012, "training_step_time_ms": 369.657, "sample_time_ms": 360.509, "synch_weights_time_ms": 8.294}, "counters": {"num_env_steps_sampled": 73700, "num_env_steps_trained": 73500, "num_agent_steps_sampled": 73700, "num_agent_steps_trained": 73500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 737, "num_samples_added_to_queue": 73500}, "done": false, "training_iteration": 26, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-43", "timestamp": 1728592123, "time_this_iter_s": 10.051196098327637, "time_total_s": 264.26940417289734, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81f3a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.26940417289734, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 13.786666666666665, "ram_util_percent": 51.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -35108.1875, "policy_loss": -35142.25390625, "entropy": 11.516311645507812, "entropy_coeff": 0.01, "var_gnorm": 17.076038360595703, "vf_loss": 68616.2109375, "vf_explained_var": 0.3934286832809448}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333428}}, "num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 762, "num_samples_added_to_queue": 76200, "learner_queue": {"size_count": 253, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.906, "learner_load_time_ms": 0.302, "learner_load_wait_time_ms": 1129.768, "learner_dequeue_time_ms": 8761.268}}, "env_runners": {"episode_reward_max": -165.66000000000003, "episode_reward_min": -186.25666666666658, "episode_reward_mean": -171.36179999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -186.25666666666658}, "policy_reward_max": {"default_policy": -165.66000000000003}, "policy_reward_mean": {"default_policy": -171.36179999999996}, "custom_metrics": {"num_consolidated_mean": 1.3512, "num_consolidated_min": 0.54, "num_consolidated_max": 2.29, "num_overloaded_mean": 0.9297999999999998, "num_overloaded_min": 0.64, "num_overloaded_max": 1.04, "num_moves_mean": 5.4228000000000005, "num_moves_min": 4.11, "num_moves_max": 7.31, "mean_accuracy_mean": 39.39335666666665, "mean_accuracy_min": 38.40199999999997, "mean_accuracy_max": 40.599666666666664, "num_model_switches_mean": 2.8925, "num_model_switches_min": 1.69, "num_model_switches_max": 4.51, "num_slav_mean": 0.12080400000000002, "num_slav_min": 0.08020000000000001, "num_slav_max": 0.16153333333333333, "mean_cluster_cpu_util_mean": 0.6379527120942814, "mean_cluster_cpu_util_min": 0.5025844021290774, "mean_cluster_cpu_util_max": 0.8026726461082263, "mean_cluster_mem_util_mean": 0.39895935162999796, "mean_cluster_mem_util_min": 0.3393016145698787, "mean_cluster_mem_util_max": 0.47475456761818646, "reward_consolidation_mean_mean": -0.023850000000000007, "reward_consolidation_mean_min": -0.12333333333333335, "reward_consolidation_mean_max": 0.0033333333333333327, "reward_illegal_mean_mean": -1.549666666666666, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.004811999999999945, "reward_accuracy_mean_min": -0.0008000000000000185, "reward_accuracy_mean_max": 0.027533333333333177, "reward_sla_mean_mean": -0.1449133333333333, "reward_sla_mean_min": -0.6629999999999999, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": -2.3850000000000007, "reward_consolidation_sum_min": -12.333333333333336, "reward_consolidation_sum_max": 0.33333333333333326, "reward_illegal_sum_mean": -154.96666666666658, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 0.4811999999999945, "reward_accuracy_sum_min": -0.08000000000000185, "reward_accuracy_sum_max": 2.753333333333318, "reward_sla_sum_mean": -14.491333333333332, "reward_sla_sum_min": -66.3, "reward_sla_sum_max": 0.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4441.0, "global_timestep_min": 1700, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-172.27333333333323, -179.42999999999995, -177.30666666666662, -184.7733333333333, -176.2166666666666, -175.45999999999995, -175.5566666666666, -172.02999999999994, -183.87999999999985, -179.95666666666662, -170.95000000000002, -172.91999999999987, -174.4233333333333, -177.11666666666656, -180.4933333333333, -179.95999999999998, -177.2133333333333, -179.27999999999994, -181.04666666666665, -178.57, -186.25666666666658, -181.20666666666665, -182.39666666666656, -180.89333333333323, -171.93999999999988, -173.52999999999986, -174.97666666666663, -170.86666666666665, -172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20989343741479605, "mean_inference_ms": 1.8818123158431286, "mean_action_processing_ms": 0.07902596163187486, "mean_env_wait_ms": 1.2620975865310704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004979848861694336, "StateBufferConnector_ms": 0.0032835006713867188, "ViewRequirementAgentConnector_ms": 0.07684588432312012}, "num_episodes": 26, "episode_return_max": -165.66000000000003, "episode_return_min": -186.25666666666658, "episode_return_mean": -171.36179999999996, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_env_steps_sampled_this_iter": 2500, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.01611540870744, "num_env_steps_trained_throughput_per_sec": 238.09547079235915, "timesteps_total": 76200, "num_env_steps_sampled_lifetime": 76200, "num_agent_steps_sampled_lifetime": 76200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 76200, "timers": {"training_iteration_time_ms": 10090.898, "restore_workers_time_ms": 0.018, "training_step_time_ms": 399.216, "sample_time_ms": 387.541, "synch_weights_time_ms": 10.714}, "counters": {"num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 762, "num_samples_added_to_queue": 76200}, "done": false, "training_iteration": 27, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-28-53", "timestamp": 1728592133, "time_this_iter_s": 10.090089321136475, "time_total_s": 274.3594934940338, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa78580>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.3594934940338, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.235714285714288, "ram_util_percent": 51.528571428571425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": -31.699153900146484, "policy_loss": -83.20521545410156, "entropy": 1.7484968900680542, "entropy_coeff": 0.01, "var_gnorm": 17.351102828979492, "vf_loss": 56751.55078125, "vf_explained_var": 0.4452105164527893}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 78900, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 78900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 790, "num_samples_added_to_queue": 78900, "learner_queue": {"size_count": 263, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.022, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1050.376, "learner_dequeue_time_ms": 8877.631}}, "env_runners": {"episode_reward_max": -165.66000000000003, "episode_reward_min": -181.56999999999988, "episode_reward_mean": -168.31923333333324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.56999999999988}, "policy_reward_max": {"default_policy": -165.66000000000003}, "policy_reward_mean": {"default_policy": -168.31923333333324}, "custom_metrics": {"num_consolidated_mean": 2.1057, "num_consolidated_min": 0.64, "num_consolidated_max": 4.82, "num_overloaded_mean": 0.991, "num_overloaded_min": 0.7, "num_overloaded_max": 1.04, "num_moves_mean": 4.301900000000001, "num_moves_min": 0.36, "num_moves_max": 6.69, "mean_accuracy_mean": 38.71093999999997, "mean_accuracy_min": 37.31266666666664, "mean_accuracy_max": 40.46666666666666, "num_model_switches_mean": 2.1273, "num_model_switches_min": 0.04, "num_model_switches_max": 4.18, "num_slav_mean": 0.09093300000000001, "num_slav_min": 0.0, "num_slav_max": 0.16068333333333334, "mean_cluster_cpu_util_mean": 0.932646656389441, "mean_cluster_cpu_util_min": 0.5110913678181327, "mean_cluster_cpu_util_max": 2.7722106538473814, "mean_cluster_mem_util_mean": 0.5335880584815149, "mean_cluster_mem_util_min": 0.34214233061368016, "mean_cluster_mem_util_max": 1.3859519306667816, "reward_consolidation_mean_mean": -0.004333333333333334, "reward_consolidation_mean_min": -0.08083333333333335, "reward_consolidation_mean_max": 0.0033333333333333327, "reward_illegal_mean_mean": -1.6516666666666664, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.1666666666666665, "reward_accuracy_mean_mean": 0.0008126666666666546, "reward_accuracy_mean_min": -0.0008000000000000185, "reward_accuracy_mean_max": 0.022533333333333194, "reward_sla_mean_mean": -0.028005, "reward_sla_mean_min": -0.5355, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": -0.4333333333333334, "reward_consolidation_sum_min": -8.083333333333336, "reward_consolidation_sum_max": 0.33333333333333326, "reward_illegal_sum_mean": -165.16666666666657, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -116.66666666666666, "reward_accuracy_sum_mean": 0.08126666666666545, "reward_accuracy_sum_min": -0.08000000000000185, "reward_accuracy_sum_max": 2.253333333333319, "reward_sla_sum_mean": -2.8005, "reward_sla_sum_min": -53.55, "reward_sla_sum_max": 0.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5061.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-172.58666666666656, -171.16999999999993, -173.73999999999987, -171.66666666666657, -172.02333333333323, -172.76666666666662, -168.33333333333326, -177.71333333333328, -178.72333333333333, -171.47333333333333, -165.66000000000003, -177.53666666666655, -173.33666666666662, -181.56999999999988, -168.44333333333324, -176.4166666666666, -174.34999999999994, -170.51666666666654, -169.9999999999999, -169.99999999999991, -169.99999999999991, -169.99999999999991, -169.9999999999999, -166.6666666666666, -168.33333333333326, -168.33333333333326, -166.6666666666666, -169.9999999999999, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2105054754244805, "mean_inference_ms": 1.8883426335924118, "mean_action_processing_ms": 0.07921748659323184, "mean_env_wait_ms": 1.264563923314372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050716400146484375, "StateBufferConnector_ms": 0.0032944679260253906, "ViewRequirementAgentConnector_ms": 0.07783126831054688}, "num_episodes": 28, "episode_return_max": -165.66000000000003, "episode_return_min": -181.56999999999988, "episode_return_mean": -168.31923333333324, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 78900, "num_env_steps_sampled": 79000, "num_env_steps_trained": 78900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 269.5834934820027, "num_env_steps_trained_throughput_per_sec": 288.8394573021458, "timesteps_total": 79000, "num_env_steps_sampled_lifetime": 79000, "num_agent_steps_sampled_lifetime": 79000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 10107.573, "restore_workers_time_ms": 0.018, "training_step_time_ms": 372.339, "sample_time_ms": 361.711, "synch_weights_time_ms": 9.549}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 78900, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 78900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 790, "num_samples_added_to_queue": 78900}, "done": false, "training_iteration": 28, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-04", "timestamp": 1728592144, "time_this_iter_s": 10.399808645248413, "time_total_s": 284.7593021392822, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b7cc805e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.7593021392822, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 14.24, "ram_util_percent": 51.45333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 487.88287353515625, "policy_loss": 377.1592102050781, "entropy": 0.21604055166244507, "entropy_coeff": 0.01, "var_gnorm": 17.657346725463867, "vf_loss": 111371.78125, "vf_explained_var": 0.3772304654121399}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 272.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 81800, "num_env_steps_trained": 81600, "num_agent_steps_sampled": 81800, "num_agent_steps_trained": 81600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 818, "num_samples_added_to_queue": 81600, "learner_queue": {"size_count": 272, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.025, "learner_load_time_ms": 0.273, "learner_load_wait_time_ms": 1043.039, "learner_dequeue_time_ms": 8912.011}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -171.66666666666657, "episode_reward_mean": -166.90563333333324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -171.66666666666657}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.90563333333324}, "custom_metrics": {"num_consolidated_mean": 3.1923000000000004, "num_consolidated_min": 1.28, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0012999999999999, "num_overloaded_min": 1.0, "num_overloaded_max": 1.03, "num_moves_mean": 2.7636000000000003, "num_moves_min": 0.0, "num_moves_max": 5.07, "mean_accuracy_mean": 38.079126666666646, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 39.32033333333332, "num_model_switches_mean": 1.2971000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 2.63, "num_slav_mean": 0.05436466666666666, "num_slav_min": 0.0, "num_slav_max": 0.12303333333333337, "mean_cluster_cpu_util_mean": 1.6104190850838183, "mean_cluster_cpu_util_min": 0.6224008787463312, "mean_cluster_cpu_util_max": 3.056020725388601, "mean_cluster_mem_util_mean": 0.8469350798261288, "mean_cluster_mem_util_min": 0.39158351470334957, "mean_cluster_mem_util_max": 1.5103265306122449, "reward_consolidation_mean_mean": -5e-05, "reward_consolidation_mean_min": -0.005, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6688333333333327, "reward_illegal_mean_min": -1.7166666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": -8.000000000000184e-06, "reward_accuracy_mean_min": -0.0008000000000000185, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": -0.000165, "reward_sla_mean_min": -0.0165, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": -0.005, "reward_consolidation_sum_min": -0.5, "reward_consolidation_sum_max": 0.0, "reward_illegal_sum_mean": -166.88333333333324, "reward_illegal_sum_min": -171.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": -0.0008000000000000185, "reward_accuracy_sum_min": -0.08000000000000185, "reward_accuracy_sum_max": 0.0, "reward_sla_sum_mean": -0.0165, "reward_sla_sum_min": -1.6500000000000001, "reward_sla_sum_max": 0.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4270.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -169.99999999999991, -166.6666666666666, -170.56333333333325, -171.66666666666657, -168.33333333333323, -168.3333333333333, -168.33333333333323, -166.6666666666666, -168.33333333333323, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -168.3333333333333, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21091020674627373, "mean_inference_ms": 1.8915531370167522, "mean_action_processing_ms": 0.07935009524990713, "mean_env_wait_ms": 1.2654947208382068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005228757858276367, "StateBufferConnector_ms": 0.0031735897064208984, "ViewRequirementAgentConnector_ms": 0.07509350776672363}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -171.66666666666657, "episode_return_mean": -166.90563333333324, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81800, "num_agent_steps_trained": 81600, "num_env_steps_sampled": 81800, "num_env_steps_trained": 81600, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.116614241922, "num_env_steps_trained_throughput_per_sec": 265.29102087613904, "timesteps_total": 81800, "num_env_steps_sampled_lifetime": 81800, "num_agent_steps_sampled_lifetime": 81800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 81800, "timers": {"training_iteration_time_ms": 10124.54, "restore_workers_time_ms": 0.014, "training_step_time_ms": 366.345, "sample_time_ms": 355.622, "synch_weights_time_ms": 9.675}, "counters": {"num_env_steps_sampled": 81800, "num_env_steps_trained": 81600, "num_agent_steps_sampled": 81800, "num_agent_steps_trained": 81600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 818, "num_samples_added_to_queue": 81600}, "done": false, "training_iteration": 29, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-14", "timestamp": 1728592154, "time_this_iter_s": 10.190313816070557, "time_total_s": 294.9496159553528, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa794b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.9496159553528, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 14.064285714285715, "ram_util_percent": 51.557142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 159.98336791992188, "policy_loss": 32.200111389160156, "entropy": 0.020770229399204254, "entropy_coeff": 0.01, "var_gnorm": 17.99266242980957, "vf_loss": 127845.5546875, "vf_explained_var": 0.4240524172782898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 84400, "num_env_steps_trained": 84300, "num_agent_steps_sampled": 84400, "num_agent_steps_trained": 84300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 84300, "learner_queue": {"size_count": 281, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.597, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1107.554, "learner_dequeue_time_ms": 9016.424}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 4.0124, "num_consolidated_min": 1.81, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 1.5856000000000001, "num_moves_min": 0.0, "num_moves_max": 5.07, "mean_accuracy_mean": 37.709069999999976, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 38.75033333333331, "num_model_switches_mean": 0.7319, "num_model_switches_min": 0.0, "num_model_switches_max": 2.36, "num_slav_mean": 0.02761533333333334, "num_slav_min": 0.0, "num_slav_max": 0.10305, "mean_cluster_cpu_util_mean": 2.2114655608957134, "mean_cluster_cpu_util_min": 0.720218853449516, "mean_cluster_cpu_util_max": 3.056020725388601, "mean_cluster_mem_util_mean": 1.125285233484744, "mean_cluster_mem_util_min": 0.43424137425012205, "mean_cluster_mem_util_max": 1.510761904761905, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3542.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21145254737393457, "mean_inference_ms": 1.8960051579383594, "mean_action_processing_ms": 0.07952542272183705, "mean_env_wait_ms": 1.2665010926651863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053141117095947266, "StateBufferConnector_ms": 0.003210783004760742, "ViewRequirementAgentConnector_ms": 0.07640838623046875}, "num_episodes": 26, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84400, "num_agent_steps_trained": 84300, "num_env_steps_sampled": 84400, "num_env_steps_trained": 84300, "num_env_steps_sampled_this_iter": 2600, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 258.68969658232874, "num_env_steps_trained_throughput_per_sec": 268.6393002970337, "timesteps_total": 84400, "num_env_steps_sampled_lifetime": 84400, "num_agent_steps_sampled_lifetime": 84400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 84400, "timers": {"training_iteration_time_ms": 10126.437, "restore_workers_time_ms": 0.014, "training_step_time_ms": 410.395, "sample_time_ms": 399.674, "synch_weights_time_ms": 9.668}, "counters": {"num_env_steps_sampled": 84400, "num_env_steps_trained": 84300, "num_agent_steps_sampled": 84400, "num_agent_steps_trained": 84300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 84300}, "done": false, "training_iteration": 30, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-24", "timestamp": 1728592164, "time_this_iter_s": 10.059723854064941, "time_total_s": 305.0093398094177, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9ce680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.0093398094177, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 16.94, "ram_util_percent": 52.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 121.13652801513672, "policy_loss": 1.96367347240448, "entropy": 0.0015478447312489152, "entropy_coeff": 0.01, "var_gnorm": 18.268098831176758, "vf_loss": 119177.4921875, "vf_explained_var": 0.38512343168258667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 290.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 87100, "num_env_steps_trained": 87000, "num_agent_steps_sampled": 87100, "num_agent_steps_trained": 87000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 871, "num_samples_added_to_queue": 87000, "learner_queue": {"size_count": 290, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.332, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 1085.921, "learner_dequeue_time_ms": 9075.284}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 4.7416, "num_consolidated_min": 1.84, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.4422999999999999, "num_moves_min": 0.0, "num_moves_max": 4.99, "mean_accuracy_mean": 37.396139999999974, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 38.73133333333331, "num_model_switches_mean": 0.196, "num_model_switches_min": 0.0, "num_model_switches_max": 2.3, "num_slav_mean": 0.006007833333333334, "num_slav_min": 0.0, "num_slav_max": 0.08826666666666666, "mean_cluster_cpu_util_mean": 2.787352061310346, "mean_cluster_cpu_util_min": 0.7212622812734882, "mean_cluster_cpu_util_max": 3.056020725388601, "mean_cluster_mem_util_mean": 1.3925470167843512, "mean_cluster_mem_util_min": 0.43424137425012205, "mean_cluster_mem_util_max": 1.510761904761905, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2814.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.211861512272183, "mean_inference_ms": 1.898991386280303, "mean_action_processing_ms": 0.07966981309556118, "mean_env_wait_ms": 1.26681121494498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051729679107666016, "StateBufferConnector_ms": 0.00316619873046875, "ViewRequirementAgentConnector_ms": 0.07495355606079102}, "num_episodes": 26, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87100, "num_agent_steps_trained": 87000, "num_env_steps_sampled": 87100, "num_env_steps_trained": 87000, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 268.19808122891834, "num_env_steps_trained_throughput_per_sec": 268.19808122891834, "timesteps_total": 87100, "num_env_steps_sampled_lifetime": 87100, "num_agent_steps_sampled_lifetime": 87100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 87100, "timers": {"training_iteration_time_ms": 10121.538, "restore_workers_time_ms": 0.014, "training_step_time_ms": 369.966, "sample_time_ms": 360.048, "synch_weights_time_ms": 8.883}, "counters": {"num_env_steps_sampled": 87100, "num_env_steps_trained": 87000, "num_agent_steps_sampled": 87100, "num_agent_steps_trained": 87000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 871, "num_samples_added_to_queue": 87000}, "done": false, "training_iteration": 31, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-34", "timestamp": 1728592174, "time_this_iter_s": 10.075519800186157, "time_total_s": 315.0848596096039, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d4070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 315.0848596096039, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 15.492857142857146, "ram_util_percent": 52.50714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 122.76641845703125, "policy_loss": 0.36790037155151367, "entropy": 0.00033858721144497395, "entropy_coeff": 0.01, "var_gnorm": 18.4166316986084, "vf_loss": 122399.53125, "vf_explained_var": 0.4199298620223999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 89900, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 89900, "num_agent_steps_trained": 89700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 899, "num_samples_added_to_queue": 89700, "learner_queue": {"size_count": 299, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.569, "learner_load_time_ms": 0.295, "learner_load_wait_time_ms": 1037.872, "learner_dequeue_time_ms": 9071.086}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 4.9979000000000005, "num_consolidated_min": 4.87, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0042, "num_moves_min": 0.0, "num_moves_max": 0.26, "mean_accuracy_mean": 37.300443333333305, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.331666666666635, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.1, "num_slav_mean": 8.166666666666666e-06, "num_slav_min": 0.0, "num_slav_max": 0.0008166666666666666, "mean_cluster_cpu_util_mean": 3.0367144371566366, "mean_cluster_cpu_util_min": 2.855481399479341, "mean_cluster_cpu_util_max": 3.056020725388601, "mean_cluster_mem_util_mean": 1.5083039017336894, "mean_cluster_mem_util_min": 1.4223750609948624, "mean_cluster_mem_util_max": 1.5110068027210883, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3434.0, "global_timestep_min": 600, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21226785113497557, "mean_inference_ms": 1.9018983757902732, "mean_action_processing_ms": 0.07980031568108896, "mean_env_wait_ms": 1.2668378397676903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005085945129394531, "StateBufferConnector_ms": 0.0031833648681640625, "ViewRequirementAgentConnector_ms": 0.07433485984802246}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89900, "num_agent_steps_trained": 89700, "num_env_steps_sampled": 89900, "num_env_steps_trained": 89700, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.57682434226774, "num_env_steps_trained_throughput_per_sec": 263.806223472901, "timesteps_total": 89900, "num_env_steps_sampled_lifetime": 89900, "num_agent_steps_sampled_lifetime": 89900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 89900, "timers": {"training_iteration_time_ms": 10144.817, "restore_workers_time_ms": 0.016, "training_step_time_ms": 378.503, "sample_time_ms": 367.869, "synch_weights_time_ms": 9.631}, "counters": {"num_env_steps_sampled": 89900, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 89900, "num_agent_steps_trained": 89700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 899, "num_samples_added_to_queue": 89700}, "done": false, "training_iteration": 32, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-44", "timestamp": 1728592184, "time_this_iter_s": 10.24364948272705, "time_total_s": 325.32850909233093, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d5000>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.32850909233093, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 15.706666666666669, "ram_util_percent": 52.80666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.04610824584961, "cur_lr": 0.001, "total_loss": 126.73722076416016, "policy_loss": 0.17774680256843567, "entropy": 0.00019433988200034946, "entropy_coeff": 0.01, "var_gnorm": 18.473857879638672, "vf_loss": 126560.0546875, "vf_explained_var": 0.42841678857803345}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 309.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 92800, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 92800, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 928, "num_samples_added_to_queue": 92700, "learner_queue": {"size_count": 309, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.674, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1012.517, "learner_dequeue_time_ms": 9045.171}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 4.9999, "num_consolidated_min": 4.99, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0390487761693037, "mean_cluster_cpu_util_min": 3.0191574096765157, "mean_cluster_cpu_util_max": 3.052455958549223, "mean_cluster_mem_util_mean": 1.509648366001464, "mean_cluster_mem_util_min": 1.5022923824593133, "mean_cluster_mem_util_max": 1.5110068027210883, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4925.0, "global_timestep_min": 2000, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21250452783546475, "mean_inference_ms": 1.9032048950404115, "mean_action_processing_ms": 0.07987261203958168, "mean_env_wait_ms": 1.2662314021788026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004700660705566406, "StateBufferConnector_ms": 0.003170013427734375, "ViewRequirementAgentConnector_ms": 0.07399487495422363}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92800, "num_agent_steps_trained": 92700, "num_env_steps_sampled": 92800, "num_env_steps_trained": 92700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.8112290493636, "num_env_steps_trained_throughput_per_sec": 290.494374878652, "timesteps_total": 92800, "num_env_steps_sampled_lifetime": 92800, "num_agent_steps_sampled_lifetime": 92800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 92800, "timers": {"training_iteration_time_ms": 10170.45, "restore_workers_time_ms": 0.014, "training_step_time_ms": 384.054, "sample_time_ms": 373.826, "synch_weights_time_ms": 9.124}, "counters": {"num_env_steps_sampled": 92800, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 92800, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 928, "num_samples_added_to_queue": 92700}, "done": false, "training_iteration": 33, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-29-55", "timestamp": 1728592195, "time_this_iter_s": 10.344828844070435, "time_total_s": 335.67333793640137, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79ed0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.67333793640137, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 14.819999999999999, "ram_util_percent": 53.34000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 126.11613464355469, "policy_loss": 0.1531892716884613, "entropy": 0.00019315112149342895, "entropy_coeff": 0.01, "var_gnorm": 18.47102928161621, "vf_loss": 125963.515625, "vf_explained_var": 0.4137856960296631}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 95700, "num_env_steps_trained": 95400, "num_agent_steps_sampled": 95700, "num_agent_steps_trained": 95400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 957, "num_samples_added_to_queue": 95700, "learner_queue": {"size_count": 318, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.915, "learner_load_time_ms": 0.3, "learner_load_wait_time_ms": 1022.499, "learner_dequeue_time_ms": 9089.115}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 4.9999, "num_consolidated_min": 4.99, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0022, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0391484652884757, "mean_cluster_cpu_util_min": 3.0191574096765157, "mean_cluster_cpu_util_max": 3.0554611398963734, "mean_cluster_mem_util_mean": 1.509681563280376, "mean_cluster_mem_util_min": 1.5022923824593133, "mean_cluster_mem_util_max": 1.5110068027210883, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4754.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2124947486779305, "mean_inference_ms": 1.9028283047467187, "mean_action_processing_ms": 0.0798712464272962, "mean_env_wait_ms": 1.2649763825510771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004511594772338867, "StateBufferConnector_ms": 0.0030813217163085938, "ViewRequirementAgentConnector_ms": 0.07188940048217773}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95700, "num_agent_steps_trained": 95400, "num_env_steps_sampled": 95700, "num_env_steps_trained": 95400, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 282.96809142892346, "num_env_steps_trained_throughput_per_sec": 263.4530506407218, "timesteps_total": 95700, "num_env_steps_sampled_lifetime": 95700, "num_agent_steps_sampled_lifetime": 95700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 95700, "timers": {"training_iteration_time_ms": 10193.812, "restore_workers_time_ms": 0.012, "training_step_time_ms": 329.45, "sample_time_ms": 319.835, "synch_weights_time_ms": 8.714}, "counters": {"num_env_steps_sampled": 95700, "num_env_steps_trained": 95400, "num_agent_steps_sampled": 95700, "num_agent_steps_trained": 95400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 957, "num_samples_added_to_queue": 95700}, "done": false, "training_iteration": 34, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-05", "timestamp": 1728592205, "time_this_iter_s": 10.257375478744507, "time_total_s": 345.9307134151459, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79c90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.9307134151459, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 14.457142857142854, "ram_util_percent": 54.60714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 118.08074188232422, "policy_loss": 0.15287072956562042, "entropy": 0.00021512809325940907, "entropy_coeff": 0.01, "var_gnorm": 18.46953773498535, "vf_loss": 117928.515625, "vf_explained_var": 0.38858556747436523}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 328.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 98600, "num_env_steps_trained": 98400, "num_agent_steps_sampled": 98600, "num_agent_steps_trained": 98400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 986, "num_samples_added_to_queue": 98400, "learner_queue": {"size_count": 328, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.752, "learner_load_time_ms": 0.272, "learner_load_wait_time_ms": 991.172, "learner_dequeue_time_ms": 8948.312}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0396582383419695, "mean_cluster_cpu_util_min": 3.026176165803108, "mean_cluster_cpu_util_max": 3.0554611398963734, "mean_cluster_mem_util_mean": 1.5098285714285715, "mean_cluster_mem_util_min": 1.5085034013605443, "mean_cluster_mem_util_max": 1.5110068027210883, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3914.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21235261920005055, "mean_inference_ms": 1.9022648065283239, "mean_action_processing_ms": 0.07983610523150275, "mean_env_wait_ms": 1.263390463761218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439000129699707, "StateBufferConnector_ms": 0.003059864044189453, "ViewRequirementAgentConnector_ms": 0.07079076766967773}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98600, "num_agent_steps_trained": 98400, "num_env_steps_sampled": 98600, "num_env_steps_trained": 98400, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.7701722262191, "num_env_steps_trained_throughput_per_sec": 296.6587988547094, "timesteps_total": 98600, "num_env_steps_sampled_lifetime": 98600, "num_agent_steps_sampled_lifetime": 98600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 98600, "timers": {"training_iteration_time_ms": 10171.8, "restore_workers_time_ms": 0.013, "training_step_time_ms": 361.057, "sample_time_ms": 350.331, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 98600, "num_env_steps_trained": 98400, "num_agent_steps_sampled": 98600, "num_agent_steps_trained": 98400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 986, "num_samples_added_to_queue": 98400}, "done": false, "training_iteration": 35, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-15", "timestamp": 1728592215, "time_this_iter_s": 10.122575521469116, "time_total_s": 356.053288936615, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79ba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 356.053288936615, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.873333333333331, "ram_util_percent": 54.426666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 124.13687896728516, "policy_loss": 0.1545001119375229, "entropy": 0.00023686746135354042, "entropy_coeff": 0.01, "var_gnorm": 18.480602264404297, "vf_loss": 123983.0859375, "vf_explained_var": 0.3853151798248291}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 101500, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 101500, "num_agent_steps_trained": 101400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1015, "num_samples_added_to_queue": 101400, "learner_queue": {"size_count": 338, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.949, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1004.376, "learner_dequeue_time_ms": 8736.182}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039410155440415, "mean_cluster_cpu_util_min": 3.0205181347150254, "mean_cluster_cpu_util_max": 3.0554611398963734, "mean_cluster_mem_util_mean": 1.5097659863945578, "mean_cluster_mem_util_min": 1.5085034013605443, "mean_cluster_mem_util_max": 1.5115918367346939, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3117.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21210955931940886, "mean_inference_ms": 1.9004226987608437, "mean_action_processing_ms": 0.07977429181071748, "mean_env_wait_ms": 1.2616063751848516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004322052001953125, "StateBufferConnector_ms": 0.0029408931732177734, "ViewRequirementAgentConnector_ms": 0.06760764122009277}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101500, "num_agent_steps_trained": 101400, "num_env_steps_sampled": 101500, "num_env_steps_trained": 101400, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.53907823644965, "num_env_steps_trained_throughput_per_sec": 289.17835679632725, "timesteps_total": 101500, "num_env_steps_sampled_lifetime": 101500, "num_agent_steps_sampled_lifetime": 101500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 101500, "timers": {"training_iteration_time_ms": 10205.917, "restore_workers_time_ms": 0.013, "training_step_time_ms": 372.608, "sample_time_ms": 362.639, "synch_weights_time_ms": 8.943}, "counters": {"num_env_steps_sampled": 101500, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 101500, "num_agent_steps_trained": 101400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1015, "num_samples_added_to_queue": 101400}, "done": false, "training_iteration": 36, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-26", "timestamp": 1728592226, "time_this_iter_s": 10.384167671203613, "time_total_s": 366.4374566078186, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d4280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 366.4374566078186, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 13.626666666666663, "ram_util_percent": 54.47333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.775386810302734, "cur_lr": 0.001, "total_loss": 117.56998443603516, "policy_loss": 0.15456534922122955, "entropy": 0.0002601934829726815, "entropy_coeff": 0.01, "var_gnorm": 18.486080169677734, "vf_loss": 117416.1953125, "vf_explained_var": 0.43390583992004395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 104400, "num_env_steps_trained": 104100, "num_agent_steps_sampled": 104400, "num_agent_steps_trained": 104100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1044, "num_samples_added_to_queue": 104400, "learner_queue": {"size_count": 347, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.201, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 1000.194, "learner_dequeue_time_ms": 8697.244}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039786321243523, "mean_cluster_cpu_util_min": 3.019606217616581, "mean_cluster_cpu_util_max": 3.05641450777202, "mean_cluster_mem_util_mean": 1.509761904761905, "mean_cluster_mem_util_min": 1.508571428571429, "mean_cluster_mem_util_max": 1.5115918367346939, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3070.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21195750579665099, "mean_inference_ms": 1.900417710006463, "mean_action_processing_ms": 0.07973162279781569, "mean_env_wait_ms": 1.26020961858135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004338979721069336, "StateBufferConnector_ms": 0.0029189586639404297, "ViewRequirementAgentConnector_ms": 0.06679725646972656}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104400, "num_agent_steps_trained": 104100, "num_env_steps_sampled": 104400, "num_env_steps_trained": 104100, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 287.93924175719263, "num_env_steps_trained_throughput_per_sec": 268.08136301531727, "timesteps_total": 104400, "num_env_steps_sampled_lifetime": 104400, "num_agent_steps_sampled_lifetime": 104400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 104400, "timers": {"training_iteration_time_ms": 10205.075, "restore_workers_time_ms": 0.012, "training_step_time_ms": 353.15, "sample_time_ms": 343.437, "synch_weights_time_ms": 8.699}, "counters": {"num_env_steps_sampled": 104400, "num_env_steps_trained": 104100, "num_agent_steps_sampled": 104400, "num_agent_steps_trained": 104100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1044, "num_samples_added_to_queue": 104400}, "done": false, "training_iteration": 37, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-36", "timestamp": 1728592236, "time_this_iter_s": 10.081079006195068, "time_total_s": 376.5185356140137, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7a7a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 376.5185356140137, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 12.65, "ram_util_percent": 54.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.73265075683594, "cur_lr": 0.001, "total_loss": 115.40591430664062, "policy_loss": 0.15804243087768555, "entropy": 0.00028655186179094017, "entropy_coeff": 0.01, "var_gnorm": 18.489439010620117, "vf_loss": 115248.7265625, "vf_explained_var": 0.433743953704834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 357.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 107300, "num_env_steps_trained": 107100, "num_agent_steps_sampled": 107300, "num_agent_steps_trained": 107100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1073, "num_samples_added_to_queue": 107100, "learner_queue": {"size_count": 357, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.568, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1028.757, "learner_dequeue_time_ms": 8686.158}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039638549222798, "mean_cluster_cpu_util_min": 3.019606217616581, "mean_cluster_cpu_util_max": 3.0566010362694307, "mean_cluster_mem_util_mean": 1.5097529251700683, "mean_cluster_mem_util_min": 1.508571428571429, "mean_cluster_mem_util_max": 1.5115918367346939, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4301.0, "global_timestep_min": 1200, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21180746346051582, "mean_inference_ms": 1.8987023459376646, "mean_action_processing_ms": 0.07968901401727937, "mean_env_wait_ms": 1.2587874580314082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004443645477294922, "StateBufferConnector_ms": 0.002966165542602539, "ViewRequirementAgentConnector_ms": 0.06797623634338379}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107300, "num_agent_steps_trained": 107100, "num_env_steps_sampled": 107300, "num_env_steps_trained": 107100, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 281.2705878946885, "num_env_steps_trained_throughput_per_sec": 290.9695736841605, "timesteps_total": 107300, "num_env_steps_sampled_lifetime": 107300, "num_agent_steps_sampled_lifetime": 107300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 107300, "timers": {"training_iteration_time_ms": 10197.471, "restore_workers_time_ms": 0.011, "training_step_time_ms": 339.541, "sample_time_ms": 331.08, "synch_weights_time_ms": 7.395}, "counters": {"num_env_steps_sampled": 107300, "num_env_steps_trained": 107100, "num_agent_steps_sampled": 107300, "num_agent_steps_trained": 107100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1073, "num_samples_added_to_queue": 107100}, "done": false, "training_iteration": 38, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-46", "timestamp": 1728592246, "time_this_iter_s": 10.320311784744263, "time_total_s": 386.83884739875793, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7b7c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.83884739875793, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 13.726666666666668, "ram_util_percent": 54.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.924962043762207, "cur_lr": 0.001, "total_loss": 122.49791717529297, "policy_loss": 0.15550333261489868, "entropy": 0.0003052818647120148, "entropy_coeff": 0.01, "var_gnorm": 18.49799346923828, "vf_loss": 122343.328125, "vf_explained_var": 0.4198035001754761}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 110300, "num_env_steps_trained": 110100, "num_agent_steps_sampled": 110300, "num_agent_steps_trained": 110100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1103, "num_samples_added_to_queue": 110100, "learner_queue": {"size_count": 367, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.824, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 975.791, "learner_dequeue_time_ms": 8605.977}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0401687046632127, "mean_cluster_cpu_util_min": 3.019606217616581, "mean_cluster_cpu_util_max": 3.0566010362694307, "mean_cluster_mem_util_mean": 1.5098000000000003, "mean_cluster_mem_util_min": 1.5086666666666664, "mean_cluster_mem_util_max": 1.5115918367346939, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5034.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21167967988846445, "mean_inference_ms": 1.8984346080989454, "mean_action_processing_ms": 0.0796452941433203, "mean_env_wait_ms": 1.2574260451799315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004338741302490234, "StateBufferConnector_ms": 0.0029442310333251953, "ViewRequirementAgentConnector_ms": 0.06747126579284668}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110300, "num_agent_steps_trained": 110100, "num_env_steps_sampled": 110300, "num_env_steps_trained": 110100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.1042419696281, "num_env_steps_trained_throughput_per_sec": 295.1042419696281, "timesteps_total": 110300, "num_env_steps_sampled_lifetime": 110300, "num_agent_steps_sampled_lifetime": 110300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 110300, "timers": {"training_iteration_time_ms": 10196.311, "restore_workers_time_ms": 0.012, "training_step_time_ms": 327.151, "sample_time_ms": 318.167, "synch_weights_time_ms": 8.106}, "counters": {"num_env_steps_sampled": 110300, "num_env_steps_trained": 110100, "num_agent_steps_sampled": 110300, "num_agent_steps_trained": 110100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1103, "num_samples_added_to_queue": 110100}, "done": false, "training_iteration": 39, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-30-56", "timestamp": 1728592256, "time_this_iter_s": 10.173927068710327, "time_total_s": 397.01277446746826, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7b010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.01277446746826, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.686666666666667, "ram_util_percent": 54.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 122.70268249511719, "policy_loss": 0.15649273991584778, "entropy": 0.00032437313348054886, "entropy_coeff": 0.01, "var_gnorm": 18.49704933166504, "vf_loss": 122547.15625, "vf_explained_var": 0.35916686058044434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 376.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1131, "num_samples_added_to_queue": 113100, "learner_queue": {"size_count": 376, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.254, "learner_load_time_ms": 0.296, "learner_load_wait_time_ms": 1002.098, "learner_dequeue_time_ms": 8487.724}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0404124352331605, "mean_cluster_cpu_util_min": 3.0233367875647668, "mean_cluster_cpu_util_max": 3.0566010362694307, "mean_cluster_mem_util_mean": 1.509788299319728, "mean_cluster_mem_util_min": 1.5086666666666664, "mean_cluster_mem_util_max": 1.510993197278912, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4237.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2114934456691391, "mean_inference_ms": 1.8962267866849978, "mean_action_processing_ms": 0.07958037298280486, "mean_env_wait_ms": 1.255648421947536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004215717315673828, "StateBufferConnector_ms": 0.0029425621032714844, "ViewRequirementAgentConnector_ms": 0.06801605224609375}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.40489870974216, "num_env_steps_trained_throughput_per_sec": 269.4261523272514, "timesteps_total": 113100, "num_env_steps_sampled_lifetime": 113100, "num_agent_steps_sampled_lifetime": 113100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 113100, "timers": {"training_iteration_time_ms": 10193.375, "restore_workers_time_ms": 0.012, "training_step_time_ms": 329.385, "sample_time_ms": 320.185, "synch_weights_time_ms": 8.254}, "counters": {"num_env_steps_sampled": 113100, "num_env_steps_trained": 112800, "num_agent_steps_sampled": 113100, "num_agent_steps_trained": 112800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1131, "num_samples_added_to_queue": 113100}, "done": false, "training_iteration": 40, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-06", "timestamp": 1728592266, "time_this_iter_s": 10.030470132827759, "time_total_s": 407.043244600296, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81c6a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 407.043244600296, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 12.485714285714286, "ram_util_percent": 55.1142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.18073272705078, "policy_loss": 0.14827822148799896, "entropy": 0.00033224793151021004, "entropy_coeff": 0.01, "var_gnorm": 18.504926681518555, "vf_loss": 113033.453125, "vf_explained_var": 0.3772590756416321}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 386.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 115900, "num_env_steps_trained": 115800, "num_agent_steps_sampled": 115900, "num_agent_steps_trained": 115800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1159, "num_samples_added_to_queue": 115800, "learner_queue": {"size_count": 386, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.964, "learner_load_time_ms": 0.27, "learner_load_wait_time_ms": 1041.749, "learner_dequeue_time_ms": 8543.058}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0400578238341973, "mean_cluster_cpu_util_min": 3.026673575129534, "mean_cluster_cpu_util_max": 3.0566010362694307, "mean_cluster_mem_util_mean": 1.509897278911565, "mean_cluster_mem_util_min": 1.5083537414965988, "mean_cluster_mem_util_max": 1.510993197278912, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3453.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2114265864640974, "mean_inference_ms": 1.896002923942329, "mean_action_processing_ms": 0.0795521913404452, "mean_env_wait_ms": 1.2544324365461534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00420832633972168, "StateBufferConnector_ms": 0.002943277359008789, "ViewRequirementAgentConnector_ms": 0.06860542297363281}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115900, "num_agent_steps_trained": 115800, "num_env_steps_sampled": 115900, "num_env_steps_trained": 115800, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.37697811352444, "num_env_steps_trained_throughput_per_sec": 291.8324765502048, "timesteps_total": 115900, "num_env_steps_sampled_lifetime": 115900, "num_agent_steps_sampled_lifetime": 115900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 115900, "timers": {"training_iteration_time_ms": 10214.644, "restore_workers_time_ms": 0.012, "training_step_time_ms": 359.912, "sample_time_ms": 349.591, "synch_weights_time_ms": 9.382}, "counters": {"num_env_steps_sampled": 115900, "num_env_steps_trained": 115800, "num_agent_steps_sampled": 115900, "num_agent_steps_trained": 115800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1159, "num_samples_added_to_queue": 115800}, "done": false, "training_iteration": 41, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-17", "timestamp": 1728592277, "time_this_iter_s": 10.28991413116455, "time_total_s": 417.33315873146057, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d50f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.33315873146057, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 13.721428571428573, "ram_util_percent": 55.16428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 110.4967269897461, "policy_loss": 0.14219717681407928, "entropy": 0.0003340617404319346, "entropy_coeff": 0.01, "var_gnorm": 18.516504287719727, "vf_loss": 110355.5234375, "vf_explained_var": 0.43244844675064087}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 395.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 118600, "num_env_steps_trained": 118500, "num_agent_steps_sampled": 118600, "num_agent_steps_trained": 118500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1186, "num_samples_added_to_queue": 118500, "learner_queue": {"size_count": 395, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.304, "learner_load_time_ms": 0.27, "learner_load_wait_time_ms": 1073.436, "learner_dequeue_time_ms": 8487.935}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039960829015544, "mean_cluster_cpu_util_min": 3.026259067357513, "mean_cluster_cpu_util_max": 3.0535129533678758, "mean_cluster_mem_util_mean": 1.5099167346938773, "mean_cluster_mem_util_min": 1.5083537414965988, "mean_cluster_mem_util_max": 1.5111020408163265, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2981.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2115517842884852, "mean_inference_ms": 1.8971687500644254, "mean_action_processing_ms": 0.07957390606348143, "mean_env_wait_ms": 1.2538607224396785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004458189010620117, "StateBufferConnector_ms": 0.0030400753021240234, "ViewRequirementAgentConnector_ms": 0.07253861427307129}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118600, "num_agent_steps_trained": 118500, "num_env_steps_sampled": 118600, "num_env_steps_trained": 118500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 264.1900109783082, "num_env_steps_trained_throughput_per_sec": 264.1900109783082, "timesteps_total": 118600, "num_env_steps_sampled_lifetime": 118600, "num_agent_steps_sampled_lifetime": 118600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 118600, "timers": {"training_iteration_time_ms": 10213.157, "restore_workers_time_ms": 0.016, "training_step_time_ms": 427.663, "sample_time_ms": 416.365, "synch_weights_time_ms": 10.06}, "counters": {"num_env_steps_sampled": 118600, "num_env_steps_trained": 118500, "num_agent_steps_sampled": 118600, "num_agent_steps_trained": 118500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1186, "num_samples_added_to_queue": 118500}, "done": false, "training_iteration": 42, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-27", "timestamp": 1728592287, "time_this_iter_s": 10.230058908462524, "time_total_s": 427.5632176399231, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6320>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.5632176399231, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 15.580000000000002, "ram_util_percent": 55.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.10511016845703, "cur_lr": 0.001, "total_loss": 113.87895202636719, "policy_loss": 0.13660414516925812, "entropy": 0.00033236524905078113, "entropy_coeff": 0.01, "var_gnorm": 18.53362274169922, "vf_loss": 113743.34375, "vf_explained_var": 0.4318208694458008}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 405.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 121700, "num_env_steps_trained": 121500, "num_agent_steps_sampled": 121700, "num_agent_steps_trained": 121500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1217, "num_samples_added_to_queue": 121500, "learner_queue": {"size_count": 405, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.228, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 947.04, "learner_dequeue_time_ms": 8540.903}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0401728497409324, "mean_cluster_cpu_util_min": 3.026259067357513, "mean_cluster_cpu_util_max": 3.051481865284974, "mean_cluster_mem_util_mean": 1.5098514285714284, "mean_cluster_mem_util_min": 1.5083537414965988, "mean_cluster_mem_util_max": 1.5111020408163265, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3701.0, "global_timestep_min": 600, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21162981976890907, "mean_inference_ms": 1.89737115933109, "mean_action_processing_ms": 0.07957563455283563, "mean_env_wait_ms": 1.2530016228964007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047054290771484375, "StateBufferConnector_ms": 0.0030548572540283203, "ViewRequirementAgentConnector_ms": 0.07242703437805176}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121700, "num_agent_steps_trained": 121500, "num_env_steps_sampled": 121700, "num_env_steps_trained": 121500, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.6319586241944, "num_env_steps_trained_throughput_per_sec": 293.8373793137365, "timesteps_total": 121700, "num_env_steps_sampled_lifetime": 121700, "num_agent_steps_sampled_lifetime": 121700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 121700, "timers": {"training_iteration_time_ms": 10201.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 333.257, "sample_time_ms": 323.889, "synch_weights_time_ms": 8.4}, "counters": {"num_env_steps_sampled": 121700, "num_env_steps_trained": 121500, "num_agent_steps_sampled": 121700, "num_agent_steps_trained": 121500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1217, "num_samples_added_to_queue": 121500}, "done": false, "training_iteration": 43, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-37", "timestamp": 1728592297, "time_this_iter_s": 10.21870732307434, "time_total_s": 437.78192496299744, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d5000>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.78192496299744, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 11.979999999999999, "ram_util_percent": 55.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 121.9442138671875, "policy_loss": 0.131968691945076, "entropy": 0.00033391325268894434, "entropy_coeff": 0.01, "var_gnorm": 18.54311180114746, "vf_loss": 121813.2421875, "vf_explained_var": 0.3690198063850403}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 414.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 124500, "num_env_steps_trained": 124200, "num_agent_steps_sampled": 124500, "num_agent_steps_trained": 124200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1245, "num_samples_added_to_queue": 124500, "learner_queue": {"size_count": 414, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.033, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1044.653, "learner_dequeue_time_ms": 8522.105}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0394729533678753, "mean_cluster_cpu_util_min": 3.026259067357513, "mean_cluster_cpu_util_max": 3.051481865284974, "mean_cluster_mem_util_mean": 1.5097903401360546, "mean_cluster_mem_util_min": 1.5083537414965988, "mean_cluster_mem_util_max": 1.5111020408163265, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5101.0, "global_timestep_min": 2000, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21175674338777875, "mean_inference_ms": 1.8976393451238653, "mean_action_processing_ms": 0.07959721578741072, "mean_env_wait_ms": 1.2523975796053168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872322082519531, "StateBufferConnector_ms": 0.0031270980834960938, "ViewRequirementAgentConnector_ms": 0.07295060157775879}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124500, "num_agent_steps_trained": 124200, "num_env_steps_sampled": 124500, "num_env_steps_trained": 124200, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.45397714419965, "num_env_steps_trained_throughput_per_sec": 263.68776367476397, "timesteps_total": 124500, "num_env_steps_sampled_lifetime": 124500, "num_agent_steps_sampled_lifetime": 124500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 124500, "timers": {"training_iteration_time_ms": 10200.496, "restore_workers_time_ms": 0.014, "training_step_time_ms": 388.826, "sample_time_ms": 378.573, "synch_weights_time_ms": 9.118}, "counters": {"num_env_steps_sampled": 124500, "num_env_steps_trained": 124200, "num_agent_steps_sampled": 124500, "num_agent_steps_trained": 124200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1245, "num_samples_added_to_queue": 124500}, "done": false, "training_iteration": 44, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-47", "timestamp": 1728592307, "time_this_iter_s": 10.249101161956787, "time_total_s": 448.0310261249542, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d5db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 448.0310261249542, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 14.328571428571431, "ram_util_percent": 56.057142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 123.11864471435547, "policy_loss": 0.12588374316692352, "entropy": 0.0003384334850125015, "entropy_coeff": 0.01, "var_gnorm": 18.544910430908203, "vf_loss": 122993.765625, "vf_explained_var": 0.35788869857788086}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 424.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 127400, "num_env_steps_trained": 127200, "num_agent_steps_sampled": 127400, "num_agent_steps_trained": 127200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1274, "num_samples_added_to_queue": 127200, "learner_queue": {"size_count": 424, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.311, "learner_load_time_ms": 0.242, "learner_load_wait_time_ms": 988.425, "learner_dequeue_time_ms": 8579.291}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039623005181347, "mean_cluster_cpu_util_min": 3.022507772020725, "mean_cluster_cpu_util_max": 3.053077720207254, "mean_cluster_mem_util_mean": 1.5097375510204083, "mean_cluster_mem_util_min": 1.5086394557823133, "mean_cluster_mem_util_max": 1.5108979591836735, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4586.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2118232868987163, "mean_inference_ms": 1.897887184953318, "mean_action_processing_ms": 0.07959729796614651, "mean_env_wait_ms": 1.2514597883928813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004737377166748047, "StateBufferConnector_ms": 0.0030684471130371094, "ViewRequirementAgentConnector_ms": 0.06994915008544922}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127400, "num_agent_steps_trained": 127200, "num_env_steps_sampled": 127400, "num_env_steps_trained": 127200, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.98180912175604, "num_env_steps_trained_throughput_per_sec": 298.94669909147177, "timesteps_total": 127400, "num_env_steps_sampled_lifetime": 127400, "num_agent_steps_sampled_lifetime": 127400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 127400, "timers": {"training_iteration_time_ms": 10192.757, "restore_workers_time_ms": 0.013, "training_step_time_ms": 351.754, "sample_time_ms": 341.814, "synch_weights_time_ms": 8.983}, "counters": {"num_env_steps_sampled": 127400, "num_env_steps_trained": 127200, "num_agent_steps_sampled": 127400, "num_agent_steps_trained": 127200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1274, "num_samples_added_to_queue": 127200}, "done": false, "training_iteration": 45, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-31-58", "timestamp": 1728592318, "time_this_iter_s": 10.049941062927246, "time_total_s": 458.08096718788147, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d61a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 458.08096718788147, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 13.48, "ram_util_percent": 56.10666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.33857727050781, "policy_loss": 0.11980041116476059, "entropy": 0.0003387048782315105, "entropy_coeff": 0.01, "var_gnorm": 18.548246383666992, "vf_loss": 107219.7890625, "vf_explained_var": 0.43135935068130493}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1302, "num_samples_added_to_queue": 130200, "learner_queue": {"size_count": 433, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.951, "learner_load_time_ms": 0.264, "learner_load_wait_time_ms": 1021.291, "learner_dequeue_time_ms": 8534.985}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0399931606217616, "mean_cluster_cpu_util_min": 3.022507772020725, "mean_cluster_cpu_util_max": 3.05340932642487, "mean_cluster_mem_util_mean": 1.5097805442176868, "mean_cluster_mem_util_min": 1.5086394557823133, "mean_cluster_mem_util_max": 1.510857142857143, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3789.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21181045311228203, "mean_inference_ms": 1.896003304153831, "mean_action_processing_ms": 0.07958022932087838, "mean_env_wait_ms": 1.2503175476799777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004549741744995117, "StateBufferConnector_ms": 0.003064870834350586, "ViewRequirementAgentConnector_ms": 0.06923818588256836}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.365963820743, "num_env_steps_trained_throughput_per_sec": 269.38860797000217, "timesteps_total": 130200, "num_env_steps_sampled_lifetime": 130200, "num_agent_steps_sampled_lifetime": 130200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 130200, "timers": {"training_iteration_time_ms": 10157.604, "restore_workers_time_ms": 0.014, "training_step_time_ms": 345.993, "sample_time_ms": 335.214, "synch_weights_time_ms": 9.752}, "counters": {"num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1302, "num_samples_added_to_queue": 130200}, "done": false, "training_iteration": 46, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-08", "timestamp": 1728592328, "time_this_iter_s": 10.031304121017456, "time_total_s": 468.1122713088989, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6440>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.1122713088989, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 14.335714285714285, "ram_util_percent": 56.27142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 114.33149719238281, "policy_loss": 0.11370910704135895, "entropy": 0.00033240002812817693, "entropy_coeff": 0.01, "var_gnorm": 18.56092643737793, "vf_loss": 114218.78125, "vf_explained_var": 0.36835789680480957}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 444.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 133300, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133300, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1333, "num_samples_added_to_queue": 133200, "learner_queue": {"size_count": 444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.856, "learner_load_time_ms": 0.252, "learner_load_wait_time_ms": 952.89, "learner_dequeue_time_ms": 8511.874}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.040350259067358, "mean_cluster_cpu_util_min": 3.022507772020725, "mean_cluster_cpu_util_max": 3.058113989637306, "mean_cluster_mem_util_mean": 1.5098393197278912, "mean_cluster_mem_util_min": 1.508979591836735, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2962.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21182950890645105, "mean_inference_ms": 1.8960843784462367, "mean_action_processing_ms": 0.07956711049169993, "mean_env_wait_ms": 1.2493720574969376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004271984100341797, "StateBufferConnector_ms": 0.0030274391174316406, "ViewRequirementAgentConnector_ms": 0.06858301162719727}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133300, "num_agent_steps_trained": 133200, "num_env_steps_sampled": 133300, "num_env_steps_trained": 133200, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 299.2525396842677, "num_env_steps_trained_throughput_per_sec": 318.5591551477688, "timesteps_total": 133300, "num_env_steps_sampled_lifetime": 133300, "num_agent_steps_sampled_lifetime": 133300, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 133300, "timers": {"training_iteration_time_ms": 10186.362, "restore_workers_time_ms": 0.012, "training_step_time_ms": 327.505, "sample_time_ms": 318.27, "synch_weights_time_ms": 8.319}, "counters": {"num_env_steps_sampled": 133300, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133300, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1333, "num_samples_added_to_queue": 133200}, "done": false, "training_iteration": 47, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-18", "timestamp": 1728592338, "time_this_iter_s": 10.376569986343384, "time_total_s": 478.4888412952423, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6d70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 478.4888412952423, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 11.253333333333334, "ram_util_percent": 56.19333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 118.05458068847656, "policy_loss": 0.10799890011548996, "entropy": 0.0003255362098570913, "entropy_coeff": 0.01, "var_gnorm": 18.573875427246094, "vf_loss": 117947.546875, "vf_explained_var": 0.3663364052772522}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 454.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 136400, "num_env_steps_trained": 136200, "num_agent_steps_sampled": 136400, "num_agent_steps_trained": 136200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1364, "num_samples_added_to_queue": 136200, "learner_queue": {"size_count": 454, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.418, "learner_load_time_ms": 0.254, "learner_load_wait_time_ms": 929.888, "learner_dequeue_time_ms": 8491.375}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0399179274611394, "mean_cluster_cpu_util_min": 3.0181554404145077, "mean_cluster_cpu_util_max": 3.058113989637306, "mean_cluster_mem_util_mean": 1.5098216326530614, "mean_cluster_mem_util_min": 1.5083537414965982, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3325.0, "global_timestep_min": 400, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21166270708161022, "mean_inference_ms": 1.8948415377542858, "mean_action_processing_ms": 0.0794939458441434, "mean_env_wait_ms": 1.247780290869438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983974456787109, "StateBufferConnector_ms": 0.0028998851776123047, "ViewRequirementAgentConnector_ms": 0.06537294387817383}, "num_episodes": 32, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136400, "num_agent_steps_trained": 136200, "num_env_steps_sampled": 136400, "num_env_steps_trained": 136200, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 307.0832862950747, "num_env_steps_trained_throughput_per_sec": 297.1773738339432, "timesteps_total": 136400, "num_env_steps_sampled_lifetime": 136400, "num_agent_steps_sampled_lifetime": 136400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 136400, "timers": {"training_iteration_time_ms": 10164.824, "restore_workers_time_ms": 0.012, "training_step_time_ms": 332.026, "sample_time_ms": 322.935, "synch_weights_time_ms": 8.227}, "counters": {"num_env_steps_sampled": 136400, "num_env_steps_trained": 136200, "num_agent_steps_sampled": 136400, "num_agent_steps_trained": 136200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1364, "num_samples_added_to_queue": 136200}, "done": false, "training_iteration": 48, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-28", "timestamp": 1728592348, "time_this_iter_s": 10.104846000671387, "time_total_s": 488.5936872959137, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d69e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.5936872959137, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.907142857142857, "ram_util_percent": 56.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 122.2625961303711, "policy_loss": 0.10355426371097565, "entropy": 0.0003192359290551394, "entropy_coeff": 0.01, "var_gnorm": 18.586822509765625, "vf_loss": 122159.9921875, "vf_explained_var": 0.36216139793395996}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 139400, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139400, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1394, "num_samples_added_to_queue": 139200, "learner_queue": {"size_count": 464, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.816, "learner_load_time_ms": 0.258, "learner_load_wait_time_ms": 983.697, "learner_dequeue_time_ms": 8421.009}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039771813471502, "mean_cluster_cpu_util_min": 3.0181554404145077, "mean_cluster_cpu_util_max": 3.058113989637306, "mean_cluster_mem_util_mean": 1.5098151020408164, "mean_cluster_mem_util_min": 1.5083537414965982, "mean_cluster_mem_util_max": 1.5108299319727894, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4834.0, "global_timestep_min": 2000, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21151043669818087, "mean_inference_ms": 1.8935793789116093, "mean_action_processing_ms": 0.07941909607759765, "mean_env_wait_ms": 1.246226743619597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004097938537597656, "StateBufferConnector_ms": 0.002920389175415039, "ViewRequirementAgentConnector_ms": 0.06659221649169922}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139400, "num_agent_steps_trained": 139200, "num_env_steps_sampled": 139400, "num_env_steps_trained": 139200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.187375457882, "num_env_steps_trained_throughput_per_sec": 290.187375457882, "timesteps_total": 139400, "num_env_steps_sampled_lifetime": 139400, "num_agent_steps_sampled_lifetime": 139400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 139400, "timers": {"training_iteration_time_ms": 10182.048, "restore_workers_time_ms": 0.013, "training_step_time_ms": 335.636, "sample_time_ms": 325.913, "synch_weights_time_ms": 8.83}, "counters": {"num_env_steps_sampled": 139400, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139400, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1394, "num_samples_added_to_queue": 139200}, "done": false, "training_iteration": 49, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-39", "timestamp": 1728592359, "time_this_iter_s": 10.352768421173096, "time_total_s": 498.9464557170868, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81c580>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.9464557170868, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 13.219999999999999, "ram_util_percent": 56.82666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.88925552368164, "cur_lr": 0.001, "total_loss": 116.4334945678711, "policy_loss": 0.09977691620588303, "entropy": 0.000319507293170318, "entropy_coeff": 0.01, "var_gnorm": 18.587783813476562, "vf_loss": 116334.671875, "vf_explained_var": 0.43550145626068115}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 142200, "num_env_steps_trained": 141900, "num_agent_steps_sampled": 142200, "num_agent_steps_trained": 141900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1422, "num_samples_added_to_queue": 142200, "learner_queue": {"size_count": 473, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.908, "learner_load_time_ms": 0.297, "learner_load_wait_time_ms": 1039.779, "learner_dequeue_time_ms": 8389.875}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039505699481866, "mean_cluster_cpu_util_min": 3.0181554404145077, "mean_cluster_cpu_util_max": 3.0552953367875646, "mean_cluster_mem_util_mean": 1.5097872108843535, "mean_cluster_mem_util_min": 1.5083537414965982, "mean_cluster_mem_util_max": 1.5108979591836738, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4821.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2113395058639368, "mean_inference_ms": 1.8908399003491718, "mean_action_processing_ms": 0.07935206099889652, "mean_env_wait_ms": 1.2446690235840865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004502773284912109, "StateBufferConnector_ms": 0.0029621124267578125, "ViewRequirementAgentConnector_ms": 0.06779742240905762}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142200, "num_agent_steps_trained": 141900, "num_env_steps_sampled": 142200, "num_env_steps_trained": 141900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.23256159496947, "num_env_steps_trained_throughput_per_sec": 265.402827252292, "timesteps_total": 142200, "num_env_steps_sampled_lifetime": 142200, "num_agent_steps_sampled_lifetime": 142200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 142200, "timers": {"training_iteration_time_ms": 10197.24, "restore_workers_time_ms": 0.013, "training_step_time_ms": 366.82, "sample_time_ms": 355.927, "synch_weights_time_ms": 9.952}, "counters": {"num_env_steps_sampled": 142200, "num_env_steps_trained": 141900, "num_agent_steps_sampled": 142200, "num_agent_steps_trained": 141900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1422, "num_samples_added_to_queue": 142200}, "done": false, "training_iteration": 50, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-49", "timestamp": 1728592369, "time_this_iter_s": 10.190972566604614, "time_total_s": 509.1374282836914, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d5960>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 509.1374282836914, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 14.08, "ram_util_percent": 56.99333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 108.33573913574219, "policy_loss": 0.09508289396762848, "entropy": 0.00031986809335649014, "entropy_coeff": 0.01, "var_gnorm": 18.58833885192871, "vf_loss": 108241.609375, "vf_explained_var": 0.4374569058418274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 483.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 145200, "num_env_steps_trained": 144900, "num_agent_steps_sampled": 145200, "num_agent_steps_trained": 144900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1452, "num_samples_added_to_queue": 145200, "learner_queue": {"size_count": 483, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.471, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 974.939, "learner_dequeue_time_ms": 8330.795}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039369533678756, "mean_cluster_cpu_util_min": 3.021554404145077, "mean_cluster_cpu_util_max": 3.0543834196891195, "mean_cluster_mem_util_mean": 1.5097447619047621, "mean_cluster_mem_util_min": 1.5084761904761905, "mean_cluster_mem_util_max": 1.5108979591836738, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3970.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21123073914485813, "mean_inference_ms": 1.8885735284037617, "mean_action_processing_ms": 0.07930238768646211, "mean_env_wait_ms": 1.243310157523738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004564046859741211, "StateBufferConnector_ms": 0.0029768943786621094, "ViewRequirementAgentConnector_ms": 0.0682992935180664}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145200, "num_agent_steps_trained": 144900, "num_env_steps_sampled": 145200, "num_env_steps_trained": 144900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.1615689171916, "num_env_steps_trained_throughput_per_sec": 293.1615689171916, "timesteps_total": 145200, "num_env_steps_sampled_lifetime": 145200, "num_agent_steps_sampled_lifetime": 145200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 145200, "timers": {"training_iteration_time_ms": 10192.58, "restore_workers_time_ms": 0.013, "training_step_time_ms": 352.257, "sample_time_ms": 341.846, "synch_weights_time_ms": 9.476}, "counters": {"num_env_steps_sampled": 145200, "num_env_steps_trained": 144900, "num_agent_steps_sampled": 145200, "num_agent_steps_trained": 144900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1452, "num_samples_added_to_queue": 145200}, "done": false, "training_iteration": 51, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-32-59", "timestamp": 1728592379, "time_this_iter_s": 10.241997241973877, "time_total_s": 519.3794255256653, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81ee60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.3794255256653, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 12.292857142857143, "ram_util_percent": 56.935714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.01680755615234, "policy_loss": 0.09082509577274323, "entropy": 0.0003158113395329565, "entropy_coeff": 0.01, "var_gnorm": 18.595773696899414, "vf_loss": 106926.9296875, "vf_explained_var": 0.4294084906578064}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 147900, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 147900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1480, "num_samples_added_to_queue": 147900, "learner_queue": {"size_count": 493, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.771, "learner_load_time_ms": 0.326, "learner_load_wait_time_ms": 1030.613, "learner_dequeue_time_ms": 8413.64}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039366010362694, "mean_cluster_cpu_util_min": 3.021554404145077, "mean_cluster_cpu_util_max": 3.057284974093264, "mean_cluster_mem_util_mean": 1.5097299319727893, "mean_cluster_mem_util_min": 1.5084761904761905, "mean_cluster_mem_util_max": 1.5108979591836738, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3173.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21115263411755297, "mean_inference_ms": 1.8873065655705858, "mean_action_processing_ms": 0.07927406686870228, "mean_env_wait_ms": 1.2423415732015044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004589080810546875, "StateBufferConnector_ms": 0.0029871463775634766, "ViewRequirementAgentConnector_ms": 0.0688316822052002}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 147900, "num_env_steps_sampled": 148000, "num_env_steps_trained": 147900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 275.2805862025771, "num_env_steps_trained_throughput_per_sec": 294.94348521704694, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10187.732, "restore_workers_time_ms": 0.013, "training_step_time_ms": 338.654, "sample_time_ms": 329.711, "synch_weights_time_ms": 8.062}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 147900, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 147900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1480, "num_samples_added_to_queue": 147900}, "done": false, "training_iteration": 52, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-33-09", "timestamp": 1728592389, "time_this_iter_s": 10.180071353912354, "time_total_s": 529.5594968795776, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa79600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.5594968795776, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 15.17333333333333, "ram_util_percent": 57.99333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.61946868896484, "policy_loss": 0.08663676679134369, "entropy": 0.0003100267786066979, "entropy_coeff": 0.01, "var_gnorm": 18.606002807617188, "vf_loss": 113533.7578125, "vf_explained_var": 0.3633418083190918}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 502.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 150900, "num_env_steps_trained": 150600, "num_agent_steps_sampled": 150900, "num_agent_steps_trained": 150600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1509, "num_samples_added_to_queue": 150900, "learner_queue": {"size_count": 502, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.509, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1008.96, "learner_dequeue_time_ms": 8353.345}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0397079792746116, "mean_cluster_cpu_util_min": 3.023440414507773, "mean_cluster_cpu_util_max": 3.057284974093264, "mean_cluster_mem_util_mean": 1.5097740136054423, "mean_cluster_mem_util_min": 1.5084761904761905, "mean_cluster_mem_util_max": 1.510802721088435, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3091.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2111305121791163, "mean_inference_ms": 1.8873922203557123, "mean_action_processing_ms": 0.07926206248695106, "mean_env_wait_ms": 1.2417301206586413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004411220550537109, "StateBufferConnector_ms": 0.0029821395874023438, "ViewRequirementAgentConnector_ms": 0.06863164901733398}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150900, "num_agent_steps_trained": 150600, "num_env_steps_sampled": 150900, "num_env_steps_trained": 150600, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 284.7310649166274, "num_env_steps_trained_throughput_per_sec": 265.09443974996344, "timesteps_total": 150900, "num_env_steps_sampled_lifetime": 150900, "num_agent_steps_sampled_lifetime": 150900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 150900, "timers": {"training_iteration_time_ms": 10185.264, "restore_workers_time_ms": 0.011, "training_step_time_ms": 352.867, "sample_time_ms": 342.951, "synch_weights_time_ms": 8.9}, "counters": {"num_env_steps_sampled": 150900, "num_env_steps_trained": 150600, "num_agent_steps_sampled": 150900, "num_agent_steps_trained": 150600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1509, "num_samples_added_to_queue": 150900}, "done": false, "training_iteration": 53, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-33-20", "timestamp": 1728592400, "time_this_iter_s": 10.193880319595337, "time_total_s": 539.753377199173, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81cee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.753377199173, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 13.440000000000001, "ram_util_percent": 58.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 109.83637237548828, "policy_loss": 0.08148830384016037, "entropy": 0.000303821376292035, "entropy_coeff": 0.01, "var_gnorm": 18.617267608642578, "vf_loss": 109755.796875, "vf_explained_var": 0.42844629287719727}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 513.0, "diff_num_grad_updates_vs_sampler_policy": 0.3333333333333144}}, "num_env_steps_sampled": 154000, "num_env_steps_trained": 153900, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 153900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1540, "num_samples_added_to_queue": 153900, "learner_queue": {"size_count": 513, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 42.081, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 950.439, "learner_dequeue_time_ms": 8289.835}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0395396891191706, "mean_cluster_cpu_util_min": 3.023440414507773, "mean_cluster_cpu_util_max": 3.057284974093264, "mean_cluster_mem_util_mean": 1.5098327891156464, "mean_cluster_mem_util_min": 1.50865306122449, "mean_cluster_mem_util_max": 1.5111292517006802, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4314.0, "global_timestep_min": 1300, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21108687786981747, "mean_inference_ms": 1.8877318541235946, "mean_action_processing_ms": 0.07923483393305909, "mean_env_wait_ms": 1.2410062811442715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004138469696044922, "StateBufferConnector_ms": 0.0029456615447998047, "ViewRequirementAgentConnector_ms": 0.0672464370727539}, "num_episodes": 32, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 153900, "num_env_steps_sampled": 154000, "num_env_steps_trained": 153900, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 300.4963837499847, "num_env_steps_trained_throughput_per_sec": 319.8832472177257, "timesteps_total": 154000, "num_env_steps_sampled_lifetime": 154000, "num_agent_steps_sampled_lifetime": 154000, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 154000, "timers": {"training_iteration_time_ms": 10192.952, "restore_workers_time_ms": 0.013, "training_step_time_ms": 329.268, "sample_time_ms": 319.803, "synch_weights_time_ms": 8.428}, "counters": {"num_env_steps_sampled": 154000, "num_env_steps_trained": 153900, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 153900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1540, "num_samples_added_to_queue": 153900}, "done": false, "training_iteration": 54, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-33-30", "timestamp": 1728592410, "time_this_iter_s": 10.32702922821045, "time_total_s": 550.0804064273834, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81c640>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 550.0804064273834, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 11.67857142857143, "ram_util_percent": 58.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 126.28596496582031, "policy_loss": 0.07871119678020477, "entropy": 0.00029817252652719617, "entropy_coeff": 0.01, "var_gnorm": 18.62904930114746, "vf_loss": 126208.140625, "vf_explained_var": 0.3666122555732727}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 522.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 156800, "num_env_steps_trained": 156600, "num_agent_steps_sampled": 156800, "num_agent_steps_trained": 156600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1568, "num_samples_added_to_queue": 156600, "learner_queue": {"size_count": 522, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.711, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 1030.505, "learner_dequeue_time_ms": 8355.592}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0399098445595856, "mean_cluster_cpu_util_min": 3.0218652849740932, "mean_cluster_cpu_util_max": 3.057284974093264, "mean_cluster_mem_util_mean": 1.5098614965986394, "mean_cluster_mem_util_min": 1.5080680272108844, "mean_cluster_mem_util_max": 1.5111292517006802, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5090.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21103867949568425, "mean_inference_ms": 1.8869608853134927, "mean_action_processing_ms": 0.07921737761952778, "mean_env_wait_ms": 1.2403012287775264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004233837127685547, "StateBufferConnector_ms": 0.0029680728912353516, "ViewRequirementAgentConnector_ms": 0.06886816024780273}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156800, "num_agent_steps_trained": 156600, "num_env_steps_sampled": 156800, "num_env_steps_trained": 156600, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 276.66922053734186, "num_env_steps_trained_throughput_per_sec": 266.7881769467225, "timesteps_total": 156800, "num_env_steps_sampled_lifetime": 156800, "num_agent_steps_sampled_lifetime": 156800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 156800, "timers": {"training_iteration_time_ms": 10201.468, "restore_workers_time_ms": 0.014, "training_step_time_ms": 347.797, "sample_time_ms": 337.829, "synch_weights_time_ms": 9.079}, "counters": {"num_env_steps_sampled": 156800, "num_env_steps_trained": 156600, "num_agent_steps_sampled": 156800, "num_agent_steps_trained": 156600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1568, "num_samples_added_to_queue": 156600}, "done": false, "training_iteration": 55, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-33-40", "timestamp": 1728592420, "time_this_iter_s": 10.129300594329834, "time_total_s": 560.2097070217133, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81db70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 560.2097070217133, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 14.086666666666668, "ram_util_percent": 58.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 122.61528778076172, "policy_loss": 0.07504244893789291, "entropy": 0.000298877595923841, "entropy_coeff": 0.01, "var_gnorm": 18.62980842590332, "vf_loss": 122541.140625, "vf_explained_var": 0.3400936722755432}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 532.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 159900, "num_env_steps_trained": 159600, "num_agent_steps_sampled": 159900, "num_agent_steps_trained": 159600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1599, "num_samples_added_to_queue": 159900, "learner_queue": {"size_count": 532, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.612, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 929.109, "learner_dequeue_time_ms": 8378.597}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.03997968911917, "mean_cluster_cpu_util_min": 3.0218652849740932, "mean_cluster_cpu_util_max": 3.0569948186528495, "mean_cluster_mem_util_mean": 1.5098522448979594, "mean_cluster_mem_util_min": 1.5080680272108844, "mean_cluster_mem_util_max": 1.5111292517006802, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4261.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21095842190697717, "mean_inference_ms": 1.8866510418286522, "mean_action_processing_ms": 0.07918631798079324, "mean_env_wait_ms": 1.239450338941923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004164218902587891, "StateBufferConnector_ms": 0.002938985824584961, "ViewRequirementAgentConnector_ms": 0.06795001029968262}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159900, "num_agent_steps_trained": 159600, "num_env_steps_sampled": 159900, "num_env_steps_trained": 159600, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 305.8566501133936, "num_env_steps_trained_throughput_per_sec": 295.99030656134863, "timesteps_total": 159900, "num_env_steps_sampled_lifetime": 159900, "num_agent_steps_sampled_lifetime": 159900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 159900, "timers": {"training_iteration_time_ms": 10212.747, "restore_workers_time_ms": 0.011, "training_step_time_ms": 321.855, "sample_time_ms": 312.786, "synch_weights_time_ms": 8.121}, "counters": {"num_env_steps_sampled": 159900, "num_env_steps_trained": 159600, "num_agent_steps_sampled": 159900, "num_agent_steps_trained": 159600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1599, "num_samples_added_to_queue": 159900}, "done": false, "training_iteration": 56, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-33-50", "timestamp": 1728592430, "time_this_iter_s": 10.144506692886353, "time_total_s": 570.3542137145996, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d1000>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 570.3542137145996, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 11.035714285714286, "ram_util_percent": 58.878571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.13135528564453, "policy_loss": 0.07077916711568832, "entropy": 0.0002971783687826246, "entropy_coeff": 0.01, "var_gnorm": 18.63414192199707, "vf_loss": 107061.46875, "vf_explained_var": 0.42781007289886475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 543.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 163100, "num_env_steps_trained": 162900, "num_agent_steps_sampled": 163100, "num_agent_steps_trained": 162900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1631, "num_samples_added_to_queue": 162900, "learner_queue": {"size_count": 543, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.103, "learner_load_time_ms": 0.36, "learner_load_wait_time_ms": 906.306, "learner_dequeue_time_ms": 8349.469}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0397813471502597, "mean_cluster_cpu_util_min": 3.0218652849740932, "mean_cluster_cpu_util_max": 3.0569948186528495, "mean_cluster_mem_util_mean": 1.5097775510204081, "mean_cluster_mem_util_min": 1.5080680272108844, "mean_cluster_mem_util_max": 1.5111292517006802, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3365.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21072422387974704, "mean_inference_ms": 1.8844255165070667, "mean_action_processing_ms": 0.07911148500054382, "mean_env_wait_ms": 1.2379503856840393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004379749298095703, "StateBufferConnector_ms": 0.002950429916381836, "ViewRequirementAgentConnector_ms": 0.06702280044555664}, "num_episodes": 32, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163100, "num_agent_steps_trained": 162900, "num_env_steps_sampled": 163100, "num_env_steps_trained": 162900, "num_env_steps_sampled_this_iter": 3200, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 311.76500539082457, "num_env_steps_trained_throughput_per_sec": 321.5076618092878, "timesteps_total": 163100, "num_env_steps_sampled_lifetime": 163100, "num_agent_steps_sampled_lifetime": 163100, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 163100, "timers": {"training_iteration_time_ms": 10203.246, "restore_workers_time_ms": 0.011, "training_step_time_ms": 322.484, "sample_time_ms": 313.716, "synch_weights_time_ms": 7.897}, "counters": {"num_env_steps_sampled": 163100, "num_env_steps_trained": 162900, "num_agent_steps_sampled": 163100, "num_agent_steps_trained": 162900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1631, "num_samples_added_to_queue": 162900}, "done": false, "training_iteration": 57, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-01", "timestamp": 1728592441, "time_this_iter_s": 10.273993730545044, "time_total_s": 580.6282074451447, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9cfa60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.6282074451447, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.633333333333331, "ram_util_percent": 59.066666666666684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.73466491699219, "policy_loss": 0.06884916871786118, "entropy": 0.0002934828808065504, "entropy_coeff": 0.01, "var_gnorm": 18.642765045166016, "vf_loss": 107666.6875, "vf_explained_var": 0.4272034168243408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 166200, "num_env_steps_trained": 165900, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 165900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1662, "num_samples_added_to_queue": 166200, "learner_queue": {"size_count": 553, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.062, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 941.123, "learner_dequeue_time_ms": 8213.706}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0399958549222794, "mean_cluster_cpu_util_min": 3.0265699481865282, "mean_cluster_cpu_util_max": 3.0563937823834197, "mean_cluster_mem_util_mean": 1.5097621768707485, "mean_cluster_mem_util_min": 1.5086394557823126, "mean_cluster_mem_util_max": 1.5110476190476194, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2797.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2104506975987832, "mean_inference_ms": 1.8838354623998668, "mean_action_processing_ms": 0.07901793349931778, "mean_env_wait_ms": 1.236472527360011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076957702636719, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06305885314941406}, "num_episodes": 32, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 165900, "num_env_steps_sampled": 166200, "num_env_steps_trained": 165900, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.67579807095507, "num_env_steps_trained_throughput_per_sec": 293.87980458479524, "timesteps_total": 166200, "num_env_steps_sampled_lifetime": 166200, "num_agent_steps_sampled_lifetime": 166200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 166200, "timers": {"training_iteration_time_ms": 10214.574, "restore_workers_time_ms": 0.012, "training_step_time_ms": 337.034, "sample_time_ms": 327.715, "synch_weights_time_ms": 8.421}, "counters": {"num_env_steps_sampled": 166200, "num_env_steps_trained": 165900, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 165900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1662, "num_samples_added_to_queue": 166200}, "done": false, "training_iteration": 58, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-11", "timestamp": 1728592451, "time_this_iter_s": 10.217433452606201, "time_total_s": 590.8456408977509, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d1cc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.8456408977509, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.566666666666666, "ram_util_percent": 59.21333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 108.68944549560547, "policy_loss": 0.06671930104494095, "entropy": 0.0002890575269702822, "entropy_coeff": 0.01, "var_gnorm": 18.652624130249023, "vf_loss": 108623.59375, "vf_explained_var": 0.4273830056190491}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1692, "num_samples_added_to_queue": 169200, "learner_queue": {"size_count": 563, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.632, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 966.571, "learner_dequeue_time_ms": 8217.838}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0394352331606216, "mean_cluster_cpu_util_min": 3.027854922279792, "mean_cluster_cpu_util_max": 3.050300518134715, "mean_cluster_mem_util_mean": 1.5097536054421772, "mean_cluster_mem_util_min": 1.5086394557823126, "mean_cluster_mem_util_max": 1.510938775510204, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4141.0, "global_timestep_min": 1400, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21010064866612105, "mean_inference_ms": 1.8813708409915773, "mean_action_processing_ms": 0.07890325128143176, "mean_env_wait_ms": 1.2347588450694673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004031181335449219, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.06256508827209473}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.3308090818133, "num_env_steps_trained_throughput_per_sec": 295.3308090818133, "timesteps_total": 169200, "num_env_steps_sampled_lifetime": 169200, "num_agent_steps_sampled_lifetime": 169200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 169200, "timers": {"training_iteration_time_ms": 10196.569, "restore_workers_time_ms": 0.011, "training_step_time_ms": 324.137, "sample_time_ms": 314.41, "synch_weights_time_ms": 8.832}, "counters": {"num_env_steps_sampled": 169200, "num_env_steps_trained": 168900, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1692, "num_samples_added_to_queue": 169200}, "done": false, "training_iteration": 59, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-21", "timestamp": 1728592461, "time_this_iter_s": 10.175571918487549, "time_total_s": 601.0212128162384, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81c6d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 601.0212128162384, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.678571428571429, "ram_util_percent": 59.26428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.14787673950195, "cur_lr": 0.001, "total_loss": 114.04190063476562, "policy_loss": 0.06383941322565079, "entropy": 0.00028367331833578646, "entropy_coeff": 0.01, "var_gnorm": 18.6632137298584, "vf_loss": 113978.90625, "vf_explained_var": 0.4261006712913513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 172200, "num_env_steps_trained": 171900, "num_agent_steps_sampled": 172200, "num_agent_steps_trained": 171900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1722, "num_samples_added_to_queue": 172200, "learner_queue": {"size_count": 573, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.241, "learner_load_time_ms": 0.334, "learner_load_wait_time_ms": 981.461, "learner_dequeue_time_ms": 8104.305}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.040400829015544, "mean_cluster_cpu_util_min": 3.02640414507772, "mean_cluster_cpu_util_max": 3.0518341968911913, "mean_cluster_mem_util_mean": 1.5098658503401359, "mean_cluster_mem_util_min": 1.5086122448979589, "mean_cluster_mem_util_max": 1.510938775510204, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5166.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.209813776091326, "mean_inference_ms": 1.878479496736075, "mean_action_processing_ms": 0.07881286402259866, "mean_env_wait_ms": 1.2332632766167526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985881805419922, "StateBufferConnector_ms": 0.0028944015502929688, "ViewRequirementAgentConnector_ms": 0.06497430801391602}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172200, "num_agent_steps_trained": 171900, "num_env_steps_sampled": 172200, "num_env_steps_trained": 171900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.64830964408696, "num_env_steps_trained_throughput_per_sec": 290.64830964408696, "timesteps_total": 172200, "num_env_steps_sampled_lifetime": 172200, "num_agent_steps_sampled_lifetime": 172200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 172200, "timers": {"training_iteration_time_ms": 10211.423, "restore_workers_time_ms": 0.013, "training_step_time_ms": 376.222, "sample_time_ms": 365.993, "synch_weights_time_ms": 9.212}, "counters": {"num_env_steps_sampled": 172200, "num_env_steps_trained": 171900, "num_agent_steps_sampled": 172200, "num_agent_steps_trained": 171900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1722, "num_samples_added_to_queue": 172200}, "done": false, "training_iteration": 60, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-31", "timestamp": 1728592471, "time_this_iter_s": 10.346778392791748, "time_total_s": 611.3679912090302, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81c8b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 611.3679912090302, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 12.593333333333334, "ram_util_percent": 58.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.073944091796875, "cur_lr": 0.001, "total_loss": 113.09380340576172, "policy_loss": 0.0609537735581398, "entropy": 0.00028208698495291173, "entropy_coeff": 0.01, "var_gnorm": 18.666669845581055, "vf_loss": 113033.6953125, "vf_explained_var": 0.420040488243103}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 583.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 175000, "num_env_steps_trained": 174900, "num_agent_steps_sampled": 175000, "num_agent_steps_trained": 174900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1750, "num_samples_added_to_queue": 174900, "learner_queue": {"size_count": 583, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.325, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1053.124, "learner_dequeue_time_ms": 8212.468}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.040720207253886, "mean_cluster_cpu_util_min": 3.02640414507772, "mean_cluster_cpu_util_max": 3.0530362694300517, "mean_cluster_mem_util_mean": 1.5098519727891162, "mean_cluster_mem_util_min": 1.5086122448979589, "mean_cluster_mem_util_max": 1.510938775510204, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4362.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20962048065505212, "mean_inference_ms": 1.8756611397453167, "mean_action_processing_ms": 0.07876076988006528, "mean_env_wait_ms": 1.23223064419861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040967464447021484, "StateBufferConnector_ms": 0.0029480457305908203, "ViewRequirementAgentConnector_ms": 0.06712865829467773}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175000, "num_agent_steps_trained": 174900, "num_env_steps_sampled": 175000, "num_env_steps_trained": 174900, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.7092747197956, "num_env_steps_trained_throughput_per_sec": 292.1885086283524, "timesteps_total": 175000, "num_env_steps_sampled_lifetime": 175000, "num_agent_steps_sampled_lifetime": 175000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 175000, "timers": {"training_iteration_time_ms": 10214.831, "restore_workers_time_ms": 0.011, "training_step_time_ms": 339.942, "sample_time_ms": 331.756, "synch_weights_time_ms": 7.245}, "counters": {"num_env_steps_sampled": 175000, "num_env_steps_trained": 174900, "num_agent_steps_sampled": 175000, "num_agent_steps_trained": 174900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1750, "num_samples_added_to_queue": 174900}, "done": false, "training_iteration": 61, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-42", "timestamp": 1728592482, "time_this_iter_s": 10.282214879989624, "time_total_s": 621.6502060890198, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d7d90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 621.6502060890198, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.973333333333336, "ram_util_percent": 61.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 112.56796264648438, "policy_loss": 0.05739932134747505, "entropy": 0.00027903440059162676, "entropy_coeff": 0.01, "var_gnorm": 18.670841217041016, "vf_loss": 112511.390625, "vf_explained_var": 0.357433021068573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 592.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1779, "num_samples_added_to_queue": 177900, "learner_queue": {"size_count": 592, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.313, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 990.967, "learner_dequeue_time_ms": 8231.894}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0400051813471505, "mean_cluster_cpu_util_min": 3.025284974093264, "mean_cluster_cpu_util_max": 3.0530362694300517, "mean_cluster_mem_util_mean": 1.5098389115646262, "mean_cluster_mem_util_min": 1.5086122448979589, "mean_cluster_mem_util_max": 1.510938775510204, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3565.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20954154195622482, "mean_inference_ms": 1.8741872472591303, "mean_action_processing_ms": 0.07873929745618521, "mean_env_wait_ms": 1.2315982674355141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212856292724609, "StateBufferConnector_ms": 0.003007650375366211, "ViewRequirementAgentConnector_ms": 0.0688636302947998}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 288.6533103685489, "num_env_steps_trained_throughput_per_sec": 268.74618551554556, "timesteps_total": 177900, "num_env_steps_sampled_lifetime": 177900, "num_agent_steps_sampled_lifetime": 177900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 177900, "timers": {"training_iteration_time_ms": 10202.352, "restore_workers_time_ms": 0.013, "training_step_time_ms": 374.743, "sample_time_ms": 363.887, "synch_weights_time_ms": 9.885}, "counters": {"num_env_steps_sampled": 177900, "num_env_steps_trained": 177600, "num_agent_steps_sampled": 177900, "num_agent_steps_trained": 177600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1779, "num_samples_added_to_queue": 177900}, "done": false, "training_iteration": 62, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-34-52", "timestamp": 1728592492, "time_this_iter_s": 10.058760166168213, "time_total_s": 631.708966255188, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5da2f100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 631.708966255188, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 12.64285714285714, "ram_util_percent": 61.38571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.37206268310547, "policy_loss": 0.05522753670811653, "entropy": 0.00027571417740546167, "entropy_coeff": 0.01, "var_gnorm": 18.67569351196289, "vf_loss": 107317.65625, "vf_explained_var": 0.42621713876724243}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 601.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 180600, "num_env_steps_trained": 180300, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 180600, "learner_queue": {"size_count": 601, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.95, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1086.204, "learner_dequeue_time_ms": 8254.863}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0398043523316067, "mean_cluster_cpu_util_min": 3.025284974093264, "mean_cluster_cpu_util_max": 3.054238341968912, "mean_cluster_mem_util_mean": 1.509831020408163, "mean_cluster_mem_util_min": 1.508843537414966, "mean_cluster_mem_util_max": 1.5108163265306123, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2937.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20960855389980287, "mean_inference_ms": 1.874891852290038, "mean_action_processing_ms": 0.07877086456404196, "mean_env_wait_ms": 1.2316468966010679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045053958892822266, "StateBufferConnector_ms": 0.0030753612518310547, "ViewRequirementAgentConnector_ms": 0.07099366188049316}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180300, "num_env_steps_sampled": 180600, "num_env_steps_trained": 180300, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 266.51232203617434, "num_env_steps_trained_throughput_per_sec": 266.51232203617434, "timesteps_total": 180600, "num_env_steps_sampled_lifetime": 180600, "num_agent_steps_sampled_lifetime": 180600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 180600, "timers": {"training_iteration_time_ms": 10196.934, "restore_workers_time_ms": 0.014, "training_step_time_ms": 374.364, "sample_time_ms": 363.824, "synch_weights_time_ms": 9.548}, "counters": {"num_env_steps_sampled": 180600, "num_env_steps_trained": 180300, "num_agent_steps_sampled": 180600, "num_agent_steps_trained": 180300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 180600}, "done": false, "training_iteration": 63, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-02", "timestamp": 1728592502, "time_this_iter_s": 10.142969369888306, "time_total_s": 641.8519356250763, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81ce80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.8519356250763, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 15.366666666666669, "ram_util_percent": 62.24666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.90396118164062, "policy_loss": 0.0533730611205101, "entropy": 0.0002710041298996657, "entropy_coeff": 0.01, "var_gnorm": 18.68343162536621, "vf_loss": 107851.3984375, "vf_explained_var": 0.42613983154296875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 611.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 183400, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 183400, "num_agent_steps_trained": 183300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1834, "num_samples_added_to_queue": 183300, "learner_queue": {"size_count": 611, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.582, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 1043.572, "learner_dequeue_time_ms": 8334.028}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.03955689119171, "mean_cluster_cpu_util_min": 3.025284974093264, "mean_cluster_cpu_util_max": 3.0575544041450775, "mean_cluster_mem_util_mean": 1.5097752380952383, "mean_cluster_mem_util_min": 1.508829931972789, "mean_cluster_mem_util_max": 1.5107755102040812, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3414.0, "global_timestep_min": 400, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20972801131077923, "mean_inference_ms": 1.8771305977375419, "mean_action_processing_ms": 0.07882337693293781, "mean_env_wait_ms": 1.2321005697691212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004598855972290039, "StateBufferConnector_ms": 0.0030205249786376953, "ViewRequirementAgentConnector_ms": 0.06928682327270508}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183400, "num_agent_steps_trained": 183300, "num_env_steps_sampled": 183400, "num_env_steps_trained": 183300, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 270.9942424819789, "num_env_steps_trained_throughput_per_sec": 290.3509740878346, "timesteps_total": 183400, "num_env_steps_sampled_lifetime": 183400, "num_agent_steps_sampled_lifetime": 183400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 183400, "timers": {"training_iteration_time_ms": 10198.54, "restore_workers_time_ms": 0.012, "training_step_time_ms": 363.937, "sample_time_ms": 353.794, "synch_weights_time_ms": 9.212}, "counters": {"num_env_steps_sampled": 183400, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 183400, "num_agent_steps_trained": 183300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1834, "num_samples_added_to_queue": 183300}, "done": false, "training_iteration": 64, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-12", "timestamp": 1728592512, "time_this_iter_s": 10.345899105072021, "time_total_s": 652.1978347301483, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f81e1d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 652.1978347301483, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 15.379999999999997, "ram_util_percent": 62.419999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 116.33445739746094, "policy_loss": 0.05227702111005783, "entropy": 0.0002661691978573799, "entropy_coeff": 0.01, "var_gnorm": 18.691890716552734, "vf_loss": 116282.9765625, "vf_explained_var": 0.3540574908256531}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 620.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 186200, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186200, "num_agent_steps_trained": 186000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1862, "num_samples_added_to_queue": 186000, "learner_queue": {"size_count": 620, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.403, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 1037.195, "learner_dequeue_time_ms": 8439.892}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0393790673575127, "mean_cluster_cpu_util_min": 3.020062176165803, "mean_cluster_cpu_util_max": 3.0575544041450775, "mean_cluster_mem_util_mean": 1.5097568707482991, "mean_cluster_mem_util_min": 1.508312925170068, "mean_cluster_mem_util_max": 1.51087074829932, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4814.0, "global_timestep_min": 1800, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20982112706807501, "mean_inference_ms": 1.8782430088602557, "mean_action_processing_ms": 0.07886442205872939, "mean_env_wait_ms": 1.2323062133533815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004782438278198242, "StateBufferConnector_ms": 0.003077983856201172, "ViewRequirementAgentConnector_ms": 0.07123827934265137}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186200, "num_agent_steps_trained": 186000, "num_env_steps_sampled": 186200, "num_env_steps_trained": 186000, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.86430537255956, "num_env_steps_trained_throughput_per_sec": 268.90486589496817, "timesteps_total": 186200, "num_env_steps_sampled_lifetime": 186200, "num_agent_steps_sampled_lifetime": 186200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 186200, "timers": {"training_iteration_time_ms": 10190.575, "restore_workers_time_ms": 0.013, "training_step_time_ms": 363.316, "sample_time_ms": 353.469, "synch_weights_time_ms": 8.765}, "counters": {"num_env_steps_sampled": 186200, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186200, "num_agent_steps_trained": 186000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1862, "num_samples_added_to_queue": 186000}, "done": false, "training_iteration": 65, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-22", "timestamp": 1728592522, "time_this_iter_s": 10.05517315864563, "time_total_s": 662.253007888794, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d3040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 662.253007888794, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 14.521428571428572, "ram_util_percent": 62.35714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.873783111572266, "cur_lr": 0.001, "total_loss": 114.66032409667969, "policy_loss": 0.050747308880090714, "entropy": 0.00026300796889699996, "entropy_coeff": 0.01, "var_gnorm": 18.69666290283203, "vf_loss": 114610.359375, "vf_explained_var": 0.42920804023742676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 629.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 188900, "num_env_steps_trained": 188700, "num_agent_steps_sampled": 188900, "num_agent_steps_trained": 188700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1889, "num_samples_added_to_queue": 188700, "learner_queue": {"size_count": 629, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.862, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1044.901, "learner_dequeue_time_ms": 8533.872}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0398439378238344, "mean_cluster_cpu_util_min": 3.020062176165803, "mean_cluster_cpu_util_max": 3.0575544041450775, "mean_cluster_mem_util_mean": 1.5097761904761908, "mean_cluster_mem_util_min": 1.508312925170068, "mean_cluster_mem_util_max": 1.51087074829932, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4877.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20998683259056847, "mean_inference_ms": 1.8809227622193692, "mean_action_processing_ms": 0.07892544065438854, "mean_env_wait_ms": 1.2328936282392526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048406124114990234, "StateBufferConnector_ms": 0.003095865249633789, "ViewRequirementAgentConnector_ms": 0.07194757461547852}, "num_episodes": 26, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188900, "num_agent_steps_trained": 188700, "num_env_steps_sampled": 188900, "num_env_steps_trained": 188700, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.22590722422996, "num_env_steps_trained_throughput_per_sec": 263.22590722422996, "timesteps_total": 188900, "num_env_steps_sampled_lifetime": 188900, "num_agent_steps_sampled_lifetime": 188900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 188900, "timers": {"training_iteration_time_ms": 10202.761, "restore_workers_time_ms": 0.013, "training_step_time_ms": 418.846, "sample_time_ms": 408.67, "synch_weights_time_ms": 9.137}, "counters": {"num_env_steps_sampled": 188900, "num_env_steps_trained": 188700, "num_agent_steps_sampled": 188900, "num_agent_steps_trained": 188700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1889, "num_samples_added_to_queue": 188700}, "done": false, "training_iteration": 66, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-33", "timestamp": 1728592533, "time_this_iter_s": 10.270004749298096, "time_total_s": 672.523012638092, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d0fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 672.523012638092, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.186666666666667, "ram_util_percent": 61.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 109.1187744140625, "policy_loss": 0.04874331131577492, "entropy": 0.0002609716902952641, "entropy_coeff": 0.01, "var_gnorm": 18.699054718017578, "vf_loss": 109070.8125, "vf_explained_var": 0.4313649535179138}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 639.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 191800, "num_env_steps_trained": 191700, "num_agent_steps_sampled": 191800, "num_agent_steps_trained": 191700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1918, "num_samples_added_to_queue": 191700, "learner_queue": {"size_count": 639, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.301, "learner_load_time_ms": 0.321, "learner_load_wait_time_ms": 1023.064, "learner_dequeue_time_ms": 8681.398}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039650569948186, "mean_cluster_cpu_util_min": 3.020062176165803, "mean_cluster_cpu_util_max": 3.0567875647668394, "mean_cluster_mem_util_mean": 1.5097587755102042, "mean_cluster_mem_util_min": 1.508312925170068, "mean_cluster_mem_util_max": 1.51087074829932, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4026.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21004017206328462, "mean_inference_ms": 1.8807249565933353, "mean_action_processing_ms": 0.07894015828650786, "mean_env_wait_ms": 1.232784423957835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004480123519897461, "StateBufferConnector_ms": 0.0030448436737060547, "ViewRequirementAgentConnector_ms": 0.07062506675720215}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191800, "num_agent_steps_trained": 191700, "num_env_steps_sampled": 191800, "num_env_steps_trained": 191700, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.7871258032672, "num_env_steps_trained_throughput_per_sec": 295.64185427924195, "timesteps_total": 191800, "num_env_steps_sampled_lifetime": 191800, "num_agent_steps_sampled_lifetime": 191800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 191800, "timers": {"training_iteration_time_ms": 10191.088, "restore_workers_time_ms": 0.011, "training_step_time_ms": 334.613, "sample_time_ms": 325.917, "synch_weights_time_ms": 7.737}, "counters": {"num_env_steps_sampled": 191800, "num_env_steps_trained": 191700, "num_agent_steps_sampled": 191800, "num_agent_steps_trained": 191700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1918, "num_samples_added_to_queue": 191700}, "done": false, "training_iteration": 67, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-43", "timestamp": 1728592543, "time_this_iter_s": 10.160909414291382, "time_total_s": 682.6839220523834, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9cfc10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 682.6839220523834, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 12.685714285714287, "ram_util_percent": 64.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 112.30195617675781, "policy_loss": 0.04659417271614075, "entropy": 0.0002575269900262356, "entropy_coeff": 0.01, "var_gnorm": 18.703672409057617, "vf_loss": 112256.125, "vf_explained_var": 0.3551197052001953}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 648.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 194700, "num_env_steps_trained": 194400, "num_agent_steps_sampled": 194700, "num_agent_steps_trained": 194400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1947, "num_samples_added_to_queue": 194700, "learner_queue": {"size_count": 648, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.927, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 1012.779, "learner_dequeue_time_ms": 8740.046}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039773678756477, "mean_cluster_cpu_util_min": 3.020062176165803, "mean_cluster_cpu_util_max": 3.0580725388601038, "mean_cluster_mem_util_mean": 1.5098168707482993, "mean_cluster_mem_util_min": 1.508312925170068, "mean_cluster_mem_util_max": 1.5110340136054423, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3242.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21009430128265297, "mean_inference_ms": 1.8812408857637248, "mean_action_processing_ms": 0.07896003908469833, "mean_env_wait_ms": 1.2328111779162993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042572021484375, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.06896829605102539}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194700, "num_agent_steps_trained": 194400, "num_env_steps_sampled": 194700, "num_env_steps_trained": 194400, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.87593707141014, "num_env_steps_trained_throughput_per_sec": 261.5051827906232, "timesteps_total": 194700, "num_env_steps_sampled_lifetime": 194700, "num_agent_steps_sampled_lifetime": 194700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 194700, "timers": {"training_iteration_time_ms": 10202.747, "restore_workers_time_ms": 0.014, "training_step_time_ms": 347.877, "sample_time_ms": 336.787, "synch_weights_time_ms": 10.037}, "counters": {"num_env_steps_sampled": 194700, "num_env_steps_trained": 194400, "num_agent_steps_sampled": 194700, "num_agent_steps_trained": 194400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1947, "num_samples_added_to_queue": 194700}, "done": false, "training_iteration": 68, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-35-53", "timestamp": 1728592553, "time_this_iter_s": 10.33553409576416, "time_total_s": 693.0194561481476, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa795d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 693.0194561481476, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 13.860000000000001, "ram_util_percent": 63.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.64632415771484, "policy_loss": 0.04500722885131836, "entropy": 0.000253557984251529, "entropy_coeff": 0.01, "var_gnorm": 18.70977020263672, "vf_loss": 113602.078125, "vf_explained_var": 0.35338735580444336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 658.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197500, "num_agent_steps_trained": 197400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1975, "num_samples_added_to_queue": 197400, "learner_queue": {"size_count": 658, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.242, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 1029.392, "learner_dequeue_time_ms": 8674.332}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039806632124352, "mean_cluster_cpu_util_min": 3.022943005181348, "mean_cluster_cpu_util_max": 3.0580725388601038, "mean_cluster_mem_util_mean": 1.5098151020408164, "mean_cluster_mem_util_min": 1.5083401360544217, "mean_cluster_mem_util_max": 1.5110340136054423, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3004.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21013868172473274, "mean_inference_ms": 1.88152734333252, "mean_action_processing_ms": 0.07898044355809168, "mean_env_wait_ms": 1.2328172908040806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374027252197266, "StateBufferConnector_ms": 0.003024578094482422, "ViewRequirementAgentConnector_ms": 0.07021808624267578}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197500, "num_agent_steps_trained": 197400, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197400, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 276.40135570696526, "num_env_steps_trained_throughput_per_sec": 296.14430968603426, "timesteps_total": 197500, "num_env_steps_sampled_lifetime": 197500, "num_agent_steps_sampled_lifetime": 197500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 197500, "timers": {"training_iteration_time_ms": 10199.957, "restore_workers_time_ms": 0.012, "training_step_time_ms": 373.45, "sample_time_ms": 362.596, "synch_weights_time_ms": 9.832}, "counters": {"num_env_steps_sampled": 197500, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197500, "num_agent_steps_trained": 197400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1975, "num_samples_added_to_queue": 197400}, "done": false, "training_iteration": 69, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-04", "timestamp": 1728592564, "time_this_iter_s": 10.148396968841553, "time_total_s": 703.1678531169891, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d2230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 703.1678531169891, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 14.2, "ram_util_percent": 63.63571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 115.20787048339844, "policy_loss": 0.04320317879319191, "entropy": 0.0002492287312634289, "entropy_coeff": 0.01, "var_gnorm": 18.716732025146484, "vf_loss": 115165.40625, "vf_explained_var": 0.3520493507385254}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 200500, "num_env_steps_trained": 200400, "num_agent_steps_sampled": 200500, "num_agent_steps_trained": 200400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2005, "num_samples_added_to_queue": 200400, "learner_queue": {"size_count": 668, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.94, "learner_load_time_ms": 0.361, "learner_load_wait_time_ms": 960.084, "learner_dequeue_time_ms": 8685.305}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039876683937824, "mean_cluster_cpu_util_min": 3.0241450777202066, "mean_cluster_cpu_util_max": 3.06, "mean_cluster_mem_util_mean": 1.5098170068027212, "mean_cluster_mem_util_min": 1.5083401360544217, "mean_cluster_mem_util_max": 1.5110340136054423, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4101.0, "global_timestep_min": 1000, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2100191448937289, "mean_inference_ms": 1.879980843654752, "mean_action_processing_ms": 0.07895921429882861, "mean_env_wait_ms": 1.2322563691834458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225492477416992, "StateBufferConnector_ms": 0.0029189586639404297, "ViewRequirementAgentConnector_ms": 0.06719851493835449}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200500, "num_agent_steps_trained": 200400, "num_env_steps_sampled": 200500, "num_env_steps_trained": 200400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.2701655378995, "num_env_steps_trained_throughput_per_sec": 298.2701655378995, "timesteps_total": 200500, "num_env_steps_sampled_lifetime": 200500, "num_agent_steps_sampled_lifetime": 200500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 200500, "timers": {"training_iteration_time_ms": 10173.581, "restore_workers_time_ms": 0.013, "training_step_time_ms": 335.342, "sample_time_ms": 326.08, "synch_weights_time_ms": 8.343}, "counters": {"num_env_steps_sampled": 200500, "num_env_steps_trained": 200400, "num_agent_steps_sampled": 200500, "num_agent_steps_trained": 200400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2005, "num_samples_added_to_queue": 200400}, "done": false, "training_iteration": 70, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-14", "timestamp": 1728592574, "time_this_iter_s": 10.066580772399902, "time_total_s": 713.234433889389, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa78b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.234433889389, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 11.186666666666667, "ram_util_percent": 63.046666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 123.09178161621094, "policy_loss": 0.04216136038303375, "entropy": 0.00024520751321688294, "entropy_coeff": 0.01, "var_gnorm": 18.724140167236328, "vf_loss": 123050.3515625, "vf_explained_var": 0.3587561249732971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 678.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 203500, "num_env_steps_trained": 203400, "num_agent_steps_sampled": 203500, "num_agent_steps_trained": 203400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2035, "num_samples_added_to_queue": 203400, "learner_queue": {"size_count": 678, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.384, "learner_load_time_ms": 0.344, "learner_load_wait_time_ms": 982.673, "learner_dequeue_time_ms": 8656.785}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0404901554404145, "mean_cluster_cpu_util_min": 3.0241450777202066, "mean_cluster_cpu_util_max": 3.06, "mean_cluster_mem_util_mean": 1.509851156462585, "mean_cluster_mem_util_min": 1.5083401360544217, "mean_cluster_mem_util_max": 1.511074829931973, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5146.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20998088554327432, "mean_inference_ms": 1.880959674774698, "mean_action_processing_ms": 0.07896572704815713, "mean_env_wait_ms": 1.2322152921853522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044651031494140625, "StateBufferConnector_ms": 0.00292205810546875, "ViewRequirementAgentConnector_ms": 0.06683921813964844}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203500, "num_agent_steps_trained": 203400, "num_env_steps_sampled": 203500, "num_env_steps_trained": 203400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.0539266084874, "num_env_steps_trained_throughput_per_sec": 285.0539266084874, "timesteps_total": 203500, "num_env_steps_sampled_lifetime": 203500, "num_agent_steps_sampled_lifetime": 203500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 203500, "timers": {"training_iteration_time_ms": 10199.278, "restore_workers_time_ms": 0.012, "training_step_time_ms": 361.558, "sample_time_ms": 351.621, "synch_weights_time_ms": 8.943}, "counters": {"num_env_steps_sampled": 203500, "num_env_steps_trained": 203400, "num_agent_steps_sampled": 203500, "num_agent_steps_trained": 203400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2035, "num_samples_added_to_queue": 203400}, "done": false, "training_iteration": 71, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-24", "timestamp": 1728592584, "time_this_iter_s": 10.549747705459595, "time_total_s": 723.7841815948486, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d1e70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.7841815948486, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 13.04, "ram_util_percent": 63.14666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.92108917236328, "cur_lr": 0.001, "total_loss": 112.24576568603516, "policy_loss": 0.04065583646297455, "entropy": 0.00024383075651712716, "entropy_coeff": 0.01, "var_gnorm": 18.725879669189453, "vf_loss": 112205.8359375, "vf_explained_var": 0.4192085266113281}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 687.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 206200, "num_env_steps_trained": 206100, "num_agent_steps_sampled": 206200, "num_agent_steps_trained": 206100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2062, "num_samples_added_to_queue": 206100, "learner_queue": {"size_count": 687, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.243, "learner_load_time_ms": 0.342, "learner_load_wait_time_ms": 1073.907, "learner_dequeue_time_ms": 8660.752}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0402694300518136, "mean_cluster_cpu_util_min": 3.0241450777202066, "mean_cluster_cpu_util_max": 3.06, "mean_cluster_mem_util_mean": 1.5098321088435376, "mean_cluster_mem_util_min": 1.5087891156462583, "mean_cluster_mem_util_max": 1.511074829931973, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4362.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2099093694191218, "mean_inference_ms": 1.8809635687681299, "mean_action_processing_ms": 0.07896283575933032, "mean_env_wait_ms": 1.232062482810128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045604705810546875, "StateBufferConnector_ms": 0.0029604434967041016, "ViewRequirementAgentConnector_ms": 0.06775903701782227}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206200, "num_agent_steps_trained": 206100, "num_env_steps_sampled": 206200, "num_env_steps_trained": 206100, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 267.9618994400083, "num_env_steps_trained_throughput_per_sec": 267.9618994400083, "timesteps_total": 206200, "num_env_steps_sampled_lifetime": 206200, "num_agent_steps_sampled_lifetime": 206200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 206200, "timers": {"training_iteration_time_ms": 10202.219, "restore_workers_time_ms": 0.012, "training_step_time_ms": 344.301, "sample_time_ms": 335.561, "synch_weights_time_ms": 7.794}, "counters": {"num_env_steps_sampled": 206200, "num_env_steps_trained": 206100, "num_agent_steps_sampled": 206200, "num_agent_steps_trained": 206100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2062, "num_samples_added_to_queue": 206100}, "done": false, "training_iteration": 72, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-34", "timestamp": 1728592594, "time_this_iter_s": 10.086493015289307, "time_total_s": 733.8706746101379, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d3df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 733.8706746101379, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.099999999999998, "ram_util_percent": 65.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.42721557617188, "policy_loss": 0.039449624717235565, "entropy": 0.00024128923541866243, "entropy_coeff": 0.01, "var_gnorm": 18.72972869873047, "vf_loss": 113388.484375, "vf_explained_var": 0.35200804471969604}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 696.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 209000, "num_env_steps_trained": 208800, "num_agent_steps_sampled": 209000, "num_agent_steps_trained": 208800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2090, "num_samples_added_to_queue": 208800, "learner_queue": {"size_count": 696, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.061, "learner_load_time_ms": 0.344, "learner_load_wait_time_ms": 1023.451, "learner_dequeue_time_ms": 8655.935}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.040300932642487, "mean_cluster_cpu_util_min": 3.0241450777202066, "mean_cluster_cpu_util_max": 3.055772020725388, "mean_cluster_mem_util_mean": 1.5098519727891158, "mean_cluster_mem_util_min": 1.5087891156462583, "mean_cluster_mem_util_max": 1.511074829931973, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3565.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20987681737700825, "mean_inference_ms": 1.8801899105886009, "mean_action_processing_ms": 0.07897057937573983, "mean_env_wait_ms": 1.2319326085262081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004752159118652344, "StateBufferConnector_ms": 0.0030670166015625, "ViewRequirementAgentConnector_ms": 0.07158970832824707}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209000, "num_agent_steps_trained": 208800, "num_env_steps_sampled": 209000, "num_env_steps_trained": 208800, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 272.9717219124793, "num_env_steps_trained_throughput_per_sec": 263.2227318441765, "timesteps_total": 209000, "num_env_steps_sampled_lifetime": 209000, "num_agent_steps_sampled_lifetime": 209000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 209000, "timers": {"training_iteration_time_ms": 10214.879, "restore_workers_time_ms": 0.014, "training_step_time_ms": 374.137, "sample_time_ms": 364.173, "synch_weights_time_ms": 8.952}, "counters": {"num_env_steps_sampled": 209000, "num_env_steps_trained": 208800, "num_agent_steps_sampled": 209000, "num_agent_steps_trained": 208800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2090, "num_samples_added_to_queue": 208800}, "done": false, "training_iteration": 73, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-45", "timestamp": 1728592605, "time_this_iter_s": 10.267111539840698, "time_total_s": 744.1377861499786, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5fa7a590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.1377861499786, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 14.026666666666669, "ram_util_percent": 65.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 107.5760269165039, "policy_loss": 0.03804304078221321, "entropy": 0.00023861430236138403, "entropy_coeff": 0.01, "var_gnorm": 18.733375549316406, "vf_loss": 107538.6875, "vf_explained_var": 0.4241178035736084}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 705.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 211700, "num_env_steps_trained": 211500, "num_agent_steps_sampled": 211700, "num_agent_steps_trained": 211500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2117, "num_samples_added_to_queue": 211500, "learner_queue": {"size_count": 705, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.568, "learner_load_time_ms": 0.365, "learner_load_wait_time_ms": 1067.575, "learner_dequeue_time_ms": 8691.852}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0403295336787575, "mean_cluster_cpu_util_min": 3.0210777202072534, "mean_cluster_cpu_util_max": 3.0549430051813475, "mean_cluster_mem_util_mean": 1.5098278911564627, "mean_cluster_mem_util_min": 1.5088571428571433, "mean_cluster_mem_util_max": 1.511074829931973, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2850.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2100400133962239, "mean_inference_ms": 1.8824272089975507, "mean_action_processing_ms": 0.07903422196501976, "mean_env_wait_ms": 1.23260918362275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004910707473754883, "StateBufferConnector_ms": 0.003209352493286133, "ViewRequirementAgentConnector_ms": 0.07533693313598633}, "num_episodes": 26, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211700, "num_agent_steps_trained": 211500, "num_env_steps_sampled": 211700, "num_env_steps_trained": 211500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.03921011174697, "num_env_steps_trained_throughput_per_sec": 263.03921011174697, "timesteps_total": 211700, "num_env_steps_sampled_lifetime": 211700, "num_agent_steps_sampled_lifetime": 211700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 211700, "timers": {"training_iteration_time_ms": 10208.11, "restore_workers_time_ms": 0.016, "training_step_time_ms": 400.935, "sample_time_ms": 389.756, "synch_weights_time_ms": 10.111}, "counters": {"num_env_steps_sampled": 211700, "num_env_steps_trained": 211500, "num_agent_steps_sampled": 211700, "num_agent_steps_trained": 211500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2117, "num_samples_added_to_queue": 211500}, "done": false, "training_iteration": 74, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-36-55", "timestamp": 1728592615, "time_this_iter_s": 10.277202367782593, "time_total_s": 754.4149885177612, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d31c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 754.4149885177612, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 15.44, "ram_util_percent": 65.07333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 108.24465942382812, "policy_loss": 0.03713567182421684, "entropy": 0.00023515494831372052, "entropy_coeff": 0.01, "var_gnorm": 18.739442825317383, "vf_loss": 108208.2265625, "vf_explained_var": 0.4237462282180786}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 715.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 214600, "num_env_steps_trained": 214500, "num_agent_steps_sampled": 214600, "num_agent_steps_trained": 214500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2146, "num_samples_added_to_queue": 214500, "learner_queue": {"size_count": 715, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.727, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1013.313, "learner_dequeue_time_ms": 8612.831}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039799378238342, "mean_cluster_cpu_util_min": 3.0210777202072534, "mean_cluster_cpu_util_max": 3.055274611398963, "mean_cluster_mem_util_mean": 1.5097804081632653, "mean_cluster_mem_util_min": 1.5088163265306118, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3414.0, "global_timestep_min": 400, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2101823413337566, "mean_inference_ms": 1.8833730503403847, "mean_action_processing_ms": 0.07908335505943997, "mean_env_wait_ms": 1.2329946400541127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004830360412597656, "StateBufferConnector_ms": 0.0031762123107910156, "ViewRequirementAgentConnector_ms": 0.07462906837463379}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214600, "num_agent_steps_trained": 214500, "num_env_steps_sampled": 214600, "num_env_steps_trained": 214500, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.72211710977757, "num_env_steps_trained_throughput_per_sec": 290.402190113563, "timesteps_total": 214600, "num_env_steps_sampled_lifetime": 214600, "num_agent_steps_sampled_lifetime": 214600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 214600, "timers": {"training_iteration_time_ms": 10237.087, "restore_workers_time_ms": 0.013, "training_step_time_ms": 363.375, "sample_time_ms": 352.684, "synch_weights_time_ms": 9.71}, "counters": {"num_env_steps_sampled": 214600, "num_env_steps_trained": 214500, "num_agent_steps_sampled": 214600, "num_agent_steps_trained": 214500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2146, "num_samples_added_to_queue": 214500}, "done": false, "training_iteration": 75, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-05", "timestamp": 1728592625, "time_this_iter_s": 10.341675758361816, "time_total_s": 764.756664276123, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5da2c130>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.756664276123, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 12.860000000000001, "ram_util_percent": 64.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 116.80531311035156, "policy_loss": 0.03640731796622276, "entropy": 0.00023160112323239446, "entropy_coeff": 0.01, "var_gnorm": 18.746309280395508, "vf_loss": 116769.59375, "vf_explained_var": 0.34906286001205444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 724.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 217300, "num_env_steps_trained": 217200, "num_agent_steps_sampled": 217300, "num_agent_steps_trained": 217200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2173, "num_samples_added_to_queue": 217200, "learner_queue": {"size_count": 724, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.351, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1071.29, "learner_dequeue_time_ms": 8684.474}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0391856994818647, "mean_cluster_cpu_util_min": 3.0210777202072534, "mean_cluster_cpu_util_max": 3.055274611398963, "mean_cluster_mem_util_mean": 1.5097457142857145, "mean_cluster_mem_util_min": 1.5086258503401364, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4725.0, "global_timestep_min": 1800, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21035421306625524, "mean_inference_ms": 1.8855295855416865, "mean_action_processing_ms": 0.07913725086417597, "mean_env_wait_ms": 1.2336149806219676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004848480224609375, "StateBufferConnector_ms": 0.0032062530517578125, "ViewRequirementAgentConnector_ms": 0.07524681091308594}, "num_episodes": 26, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 26}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217300, "num_agent_steps_trained": 217200, "num_env_steps_sampled": 217300, "num_env_steps_trained": 217200, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 267.3752083294475, "num_env_steps_trained_throughput_per_sec": 267.3752083294475, "timesteps_total": 217300, "num_env_steps_sampled_lifetime": 217300, "num_agent_steps_sampled_lifetime": 217300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 217300, "timers": {"training_iteration_time_ms": 10221.169, "restore_workers_time_ms": 0.014, "training_step_time_ms": 377.162, "sample_time_ms": 366.481, "synch_weights_time_ms": 9.638}, "counters": {"num_env_steps_sampled": 217300, "num_env_steps_trained": 217200, "num_agent_steps_sampled": 217300, "num_agent_steps_trained": 217200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2173, "num_samples_added_to_queue": 217200}, "done": false, "training_iteration": 76, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-15", "timestamp": 1728592635, "time_this_iter_s": 10.109057426452637, "time_total_s": 774.8657217025757, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d2140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 774.8657217025757, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 16.864285714285714, "ram_util_percent": 64.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.97779083251953, "policy_loss": 0.03469298034906387, "entropy": 0.00022925148368813097, "entropy_coeff": 0.01, "var_gnorm": 18.74952507019043, "vf_loss": 113943.78125, "vf_explained_var": 0.42710328102111816}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 733.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 219900, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 219900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2200, "num_samples_added_to_queue": 219900, "learner_queue": {"size_count": 733, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.316, "learner_load_time_ms": 0.297, "learner_load_wait_time_ms": 1082.201, "learner_dequeue_time_ms": 8722.585}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.038779689119171, "mean_cluster_cpu_util_min": 3.021222797927461, "mean_cluster_cpu_util_max": 3.055274611398963, "mean_cluster_mem_util_mean": 1.5097306122448984, "mean_cluster_mem_util_min": 1.5084625850340136, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4877.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21046389637950186, "mean_inference_ms": 1.8869539026167934, "mean_action_processing_ms": 0.0791847602113507, "mean_env_wait_ms": 1.2341300629329128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004755973815917969, "StateBufferConnector_ms": 0.0031518936157226562, "ViewRequirementAgentConnector_ms": 0.07329583168029785}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 219900, "num_env_steps_sampled": 220000, "num_env_steps_trained": 219900, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 257.0312264699325, "num_env_steps_trained_throughput_per_sec": 257.0312264699325, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 10256.884, "restore_workers_time_ms": 0.015, "training_step_time_ms": 425.224, "sample_time_ms": 414.524, "synch_weights_time_ms": 9.714}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 219900, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 219900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2200, "num_samples_added_to_queue": 219900}, "done": false, "training_iteration": 77, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-26", "timestamp": 1728592646, "time_this_iter_s": 10.513101577758789, "time_total_s": 785.3788232803345, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d7d90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 785.3788232803345, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 15.726666666666665, "ram_util_percent": 64.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 108.70967864990234, "policy_loss": 0.03320762887597084, "entropy": 0.00022721596178598702, "entropy_coeff": 0.01, "var_gnorm": 18.751510620117188, "vf_loss": 108677.1484375, "vf_explained_var": 0.42871564626693726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 223000, "num_env_steps_trained": 222900, "num_agent_steps_sampled": 223000, "num_agent_steps_trained": 222900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2230, "num_samples_added_to_queue": 222900, "learner_queue": {"size_count": 743, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.085, "learner_load_time_ms": 0.27, "learner_load_wait_time_ms": 980.718, "learner_dequeue_time_ms": 8776.735}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.03885098445596, "mean_cluster_cpu_util_min": 3.021222797927461, "mean_cluster_cpu_util_max": 3.0560829015544044, "mean_cluster_mem_util_mean": 1.5097254421768707, "mean_cluster_mem_util_min": 1.5084625850340136, "mean_cluster_mem_util_max": 1.5107891156462585, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4013.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21042353625900334, "mean_inference_ms": 1.8853141240377622, "mean_action_processing_ms": 0.07918013949807175, "mean_env_wait_ms": 1.233876645690394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004797458648681641, "StateBufferConnector_ms": 0.0030786991119384766, "ViewRequirementAgentConnector_ms": 0.07126379013061523}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223000, "num_agent_steps_trained": 222900, "num_env_steps_sampled": 223000, "num_env_steps_trained": 222900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.4919905164249, "num_env_steps_trained_throughput_per_sec": 291.4919905164249, "timesteps_total": 223000, "num_env_steps_sampled_lifetime": 223000, "num_agent_steps_sampled_lifetime": 223000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 223000, "timers": {"training_iteration_time_ms": 10253.587, "restore_workers_time_ms": 0.014, "training_step_time_ms": 332.685, "sample_time_ms": 322.779, "synch_weights_time_ms": 8.998}, "counters": {"num_env_steps_sampled": 223000, "num_env_steps_trained": 222900, "num_agent_steps_sampled": 223000, "num_agent_steps_trained": 222900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2230, "num_samples_added_to_queue": 222900}, "done": false, "training_iteration": 78, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-36", "timestamp": 1728592656, "time_this_iter_s": 10.308372020721436, "time_total_s": 795.6871953010559, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d1840>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 795.6871953010559, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 12.579999999999997, "ram_util_percent": 64.74666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 113.3062973022461, "policy_loss": 0.03275076299905777, "entropy": 0.000224436167627573, "entropy_coeff": 0.01, "var_gnorm": 18.75606918334961, "vf_loss": 113274.21875, "vf_explained_var": 0.35042524337768555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 752.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 225900, "num_env_steps_trained": 225600, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2259, "num_samples_added_to_queue": 225900, "learner_queue": {"size_count": 752, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.599, "learner_load_time_ms": 0.278, "learner_load_wait_time_ms": 1002.106, "learner_dequeue_time_ms": 8823.619}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0387539896373066, "mean_cluster_cpu_util_min": 3.025139896373057, "mean_cluster_cpu_util_max": 3.0560829015544044, "mean_cluster_mem_util_mean": 1.5097187755102042, "mean_cluster_mem_util_min": 1.5084625850340136, "mean_cluster_mem_util_max": 1.5108571428571431, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3242.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21051577322652995, "mean_inference_ms": 1.887203657959104, "mean_action_processing_ms": 0.07921523394680767, "mean_env_wait_ms": 1.2342705886776009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004683017730712891, "StateBufferConnector_ms": 0.003034830093383789, "ViewRequirementAgentConnector_ms": 0.07023096084594727}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225600, "num_env_steps_sampled": 225900, "num_env_steps_trained": 225600, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.77172302830087, "num_env_steps_trained_throughput_per_sec": 264.20125937117666, "timesteps_total": 225900, "num_env_steps_sampled_lifetime": 225900, "num_agent_steps_sampled_lifetime": 225900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 225900, "timers": {"training_iteration_time_ms": 10262.516, "restore_workers_time_ms": 0.013, "training_step_time_ms": 336.332, "sample_time_ms": 326.02, "synch_weights_time_ms": 9.343}, "counters": {"num_env_steps_sampled": 225900, "num_env_steps_trained": 225600, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2259, "num_samples_added_to_queue": 225900}, "done": false, "training_iteration": 79, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-47", "timestamp": 1728592667, "time_this_iter_s": 10.229723930358887, "time_total_s": 805.9169192314148, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6e90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 805.9169192314148, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 12.757142857142856, "ram_util_percent": 64.70714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 114.47929382324219, "policy_loss": 0.03202959522604942, "entropy": 0.00022122343943919986, "entropy_coeff": 0.01, "var_gnorm": 18.761058807373047, "vf_loss": 114447.921875, "vf_explained_var": 0.349163293838501}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 762.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2289, "num_samples_added_to_queue": 228900, "learner_queue": {"size_count": 762, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.239, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 959.716, "learner_dequeue_time_ms": 8735.4}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.001, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0390619689119176, "mean_cluster_cpu_util_min": 3.025139896373057, "mean_cluster_cpu_util_max": 3.0560829015544044, "mean_cluster_mem_util_mean": 1.5097642176870751, "mean_cluster_mem_util_min": 1.5085578231292518, "mean_cluster_mem_util_max": 1.5109387755102042, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3026.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2104461790934266, "mean_inference_ms": 1.8868087346640854, "mean_action_processing_ms": 0.07919702352140215, "mean_env_wait_ms": 1.2338758590099743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004475831985473633, "StateBufferConnector_ms": 0.002961397171020508, "ViewRequirementAgentConnector_ms": 0.0679020881652832}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.34348475742496, "num_env_steps_trained_throughput_per_sec": 294.34348475742496, "timesteps_total": 228900, "num_env_steps_sampled_lifetime": 228900, "num_agent_steps_sampled_lifetime": 228900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 228900, "timers": {"training_iteration_time_ms": 10275.934, "restore_workers_time_ms": 0.012, "training_step_time_ms": 342.741, "sample_time_ms": 332.249, "synch_weights_time_ms": 9.471}, "counters": {"num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2289, "num_samples_added_to_queue": 228900}, "done": false, "training_iteration": 80, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-37-57", "timestamp": 1728592677, "time_this_iter_s": 10.202386379241943, "time_total_s": 816.1193056106567, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d6c80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.1193056106567, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.24, "ram_util_percent": 64.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.001, "total_loss": 115.78897857666016, "policy_loss": 0.03137439489364624, "entropy": 0.00021789950551465154, "entropy_coeff": 0.01, "var_gnorm": 18.766508102416992, "vf_loss": 115758.25, "vf_explained_var": 0.3482295274734497}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 772.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 231800, "num_env_steps_trained": 231600, "num_agent_steps_sampled": 231800, "num_agent_steps_trained": 231600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2318, "num_samples_added_to_queue": 231600, "learner_queue": {"size_count": 772, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.313, "learner_load_time_ms": 0.316, "learner_load_wait_time_ms": 997.719, "learner_dequeue_time_ms": 8694.277}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.0394194818652847, "mean_cluster_cpu_util_min": 3.0248082901554403, "mean_cluster_cpu_util_max": 3.058632124352331, "mean_cluster_mem_util_mean": 1.5097710204081634, "mean_cluster_mem_util_min": 1.5085714285714287, "mean_cluster_mem_util_max": 1.5109795918367346, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4214.0, "global_timestep_min": 1200, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2103733930465684, "mean_inference_ms": 1.8862001340927883, "mean_action_processing_ms": 0.07917487107308188, "mean_env_wait_ms": 1.2334522215070167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428462028503418, "StateBufferConnector_ms": 0.002979755401611328, "ViewRequirementAgentConnector_ms": 0.06827521324157715}, "num_episodes": 30, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 30}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231800, "num_agent_steps_trained": 231600, "num_env_steps_sampled": 231800, "num_env_steps_trained": 231600, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.8969357920018, "num_env_steps_trained_throughput_per_sec": 293.68648530207076, "timesteps_total": 231800, "num_env_steps_sampled_lifetime": 231800, "num_agent_steps_sampled_lifetime": 231800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 231800, "timers": {"training_iteration_time_ms": 10244.999, "restore_workers_time_ms": 0.012, "training_step_time_ms": 355.557, "sample_time_ms": 346.581, "synch_weights_time_ms": 8.06}, "counters": {"num_env_steps_sampled": 231800, "num_env_steps_trained": 231600, "num_agent_steps_sampled": 231800, "num_agent_steps_trained": 231600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2318, "num_samples_added_to_queue": 231600}, "done": false, "training_iteration": 81, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-38-07", "timestamp": 1728592687, "time_this_iter_s": 10.22831106185913, "time_total_s": 826.3476166725159, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d55a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.3476166725159, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 12.193333333333335, "ram_util_percent": 65.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.58970260620117, "cur_lr": 0.001, "total_loss": 112.7597427368164, "policy_loss": 0.03070944920182228, "entropy": 0.00021513509273063391, "entropy_coeff": 0.01, "var_gnorm": 18.770692825317383, "vf_loss": 112729.671875, "vf_explained_var": 0.42174869775772095}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 781.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 234600, "num_env_steps_trained": 234300, "num_agent_steps_sampled": 234600, "num_agent_steps_trained": 234300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2346, "num_samples_added_to_queue": 234600, "learner_queue": {"size_count": 781, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.649, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1022.05, "learner_dequeue_time_ms": 8688.635}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039694300518135, "mean_cluster_cpu_util_min": 3.0240621761658035, "mean_cluster_cpu_util_max": 3.058632124352331, "mean_cluster_mem_util_mean": 1.5098383673469384, "mean_cluster_mem_util_min": 1.5086666666666668, "mean_cluster_mem_util_max": 1.5109795918367346, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5146.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21031223188629838, "mean_inference_ms": 1.8858578454060677, "mean_action_processing_ms": 0.07915952618707733, "mean_env_wait_ms": 1.2331580827781463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004179239273071289, "StateBufferConnector_ms": 0.0029616355895996094, "ViewRequirementAgentConnector_ms": 0.06834650039672852}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234600, "num_agent_steps_trained": 234300, "num_env_steps_sampled": 234600, "num_env_steps_trained": 234300, "num_env_steps_sampled_this_iter": 2800, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.41240736700587, "num_env_steps_trained_throughput_per_sec": 267.5048213896128, "timesteps_total": 234600, "num_env_steps_sampled_lifetime": 234600, "num_agent_steps_sampled_lifetime": 234600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 234600, "timers": {"training_iteration_time_ms": 10246.721, "restore_workers_time_ms": 0.013, "training_step_time_ms": 364.076, "sample_time_ms": 352.704, "synch_weights_time_ms": 10.342}, "counters": {"num_env_steps_sampled": 234600, "num_env_steps_trained": 234300, "num_agent_steps_sampled": 234600, "num_agent_steps_trained": 234300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2346, "num_samples_added_to_queue": 234600}, "done": false, "training_iteration": 82, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-38-17", "timestamp": 1728592697, "time_this_iter_s": 10.10232663154602, "time_total_s": 836.4499433040619, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9d2500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 836.4499433040619, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 12.721428571428573, "ram_util_percent": 65.17142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.74596405029297, "cur_lr": 0.001, "total_loss": 111.16612243652344, "policy_loss": 0.02939642407000065, "entropy": 0.00021336905774660408, "entropy_coeff": 0.01, "var_gnorm": 18.772235870361328, "vf_loss": 111137.359375, "vf_explained_var": 0.41884565353393555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 791.0, "diff_num_grad_updates_vs_sampler_policy": 0.33333333333337123}}, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237300, "num_agent_steps_sampled": 237500, "num_agent_steps_trained": 237300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2375, "num_samples_added_to_queue": 237300, "learner_queue": {"size_count": 791, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.437, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 970.75, "learner_dequeue_time_ms": 8620.38}}, "env_runners": {"episode_reward_max": -166.6666666666666, "episode_reward_min": -166.6666666666666, "episode_reward_mean": -166.66666666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -166.6666666666666}, "policy_reward_max": {"default_policy": -166.6666666666666}, "policy_reward_mean": {"default_policy": -166.66666666666657}, "custom_metrics": {"num_consolidated_mean": 5.0, "num_consolidated_min": 5.0, "num_consolidated_max": 5.0, "num_overloaded_mean": 1.0, "num_overloaded_min": 1.0, "num_overloaded_max": 1.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 37.29999999999997, "mean_accuracy_min": 37.29999999999997, "mean_accuracy_max": 37.29999999999997, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.0, "num_slav_min": 0.0, "num_slav_max": 0.0, "mean_cluster_cpu_util_mean": 3.039606632124353, "mean_cluster_cpu_util_min": 3.0240621761658035, "mean_cluster_cpu_util_max": 3.058632124352331, "mean_cluster_mem_util_mean": 1.5098059863945577, "mean_cluster_mem_util_min": 1.508707482993197, "mean_cluster_mem_util_max": 1.5109795918367346, "reward_consolidation_mean_mean": 0.0, "reward_consolidation_mean_min": 0.0, "reward_consolidation_mean_max": 0.0, "reward_illegal_mean_mean": -1.6666666666666663, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.6666666666666663, "reward_accuracy_mean_mean": 0.0, "reward_accuracy_mean_min": 0.0, "reward_accuracy_mean_max": 0.0, "reward_sla_mean_mean": 0.0, "reward_sla_mean_min": 0.0, "reward_sla_mean_max": 0.0, "reward_consolidation_sum_mean": 0.0, "reward_consolidation_sum_min": 0, "reward_consolidation_sum_max": 0, "reward_illegal_sum_mean": -166.6666666666666, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -166.66666666666663, "reward_accuracy_sum_mean": 0.0, "reward_accuracy_sum_min": 0, "reward_accuracy_sum_max": 0, "reward_sla_sum_mean": 0.0, "reward_sla_sum_min": 0, "reward_sla_sum_max": 0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4349.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666, -166.6666666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21022425488612193, "mean_inference_ms": 1.8844096476442362, "mean_action_processing_ms": 0.07913505539172994, "mean_env_wait_ms": 1.2326941004387038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004279136657714844, "StateBufferConnector_ms": 0.0029900074005126953, "ViewRequirementAgentConnector_ms": 0.0691523551940918}, "num_episodes": 28, "episode_return_max": -166.6666666666666, "episode_return_min": -166.6666666666666, "episode_return_mean": -166.66666666666657, "episodes_this_iter": 28}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237500, "num_agent_steps_trained": 237300, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237300, "num_env_steps_sampled_this_iter": 2900, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.2479530406139, "num_env_steps_trained_throughput_per_sec": 295.0840893523592, "timesteps_total": 237500, "num_env_steps_sampled_lifetime": 237500, "num_agent_steps_sampled_lifetime": 237500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 237500, "timers": {"training_iteration_time_ms": 10237.633, "restore_workers_time_ms": 0.017, "training_step_time_ms": 364.441, "sample_time_ms": 354.63, "synch_weights_time_ms": 8.872}, "counters": {"num_env_steps_sampled": 237500, "num_env_steps_trained": 237300, "num_agent_steps_sampled": 237500, "num_agent_steps_trained": 237300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2375, "num_samples_added_to_queue": 237300}, "done": false, "training_iteration": 83, "trial_id": "9fd5a_00000", "date": "2024-10-10_21-38-27", "timestamp": 1728592707, "time_this_iter_s": 10.183576107025146, "time_total_s": 846.633519411087, "pid": 216051, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 1, "penalty_accuracy": 1, "episode_length": 100, "accuracy_lower": 40, "accuracy_upper": 50, "consolidation_lower": 0.2, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x783b5f9cf8b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x783b5934dc60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.5, "replay_buffer_num_slots": 500, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 846.633519411087, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 13.146666666666668, "ram_util_percent": 65.06666666666666}}
