{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -143603.65625, "policy_loss": -144059.671875, "entropy": 29.8187313079834, "entropy_coeff": 0.01, "var_gnorm": 16.000757217407227, "vf_loss": 54547.4921875, "vf_explained_var": 0.0005400180816650391}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2100, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 16, "num_samples_added_to_queue": 2400, "learner_queue": {"size_count": 7, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.193, "learner_load_time_ms": 0.088, "learner_load_wait_time_ms": 1238.778, "learner_dequeue_time_ms": 1269.602}}, "env_runners": {"episode_reward_max": -119.25333333333339, "episode_reward_min": -179.45888888888885, "episode_reward_mean": -153.19569444444446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2400, "policy_reward_min": {"default_policy": -179.45888888888885}, "policy_reward_max": {"default_policy": -119.25333333333339}, "policy_reward_mean": {"default_policy": -153.19569444444446}, "custom_metrics": {"num_consolidated_mean": 0.6762499999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0625, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.997083333333334, "num_moves_min": 9.76, "num_moves_max": 10.25, "mean_accuracy_mean": 41.09234722222222, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.034166666666667, "num_model_switches_min": 5.65, "num_model_switches_max": 6.37, "num_slav_mean": 0.16213541666666667, "num_slav_min": 0.14303333333333332, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.695833333333333, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5709831920257601, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5936630994624079, "mean_cluster_mem_util_mean": 0.36634485546460144, "mean_cluster_mem_util_min": 0.3573489758245069, "mean_cluster_mem_util_max": 0.37662231694365517, "reward_consolidation_mean_mean": -0.3175925925925926, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.12777777777777782, "reward_illegal_mean_mean": -1.770833333333333, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.762848611111111, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0831666666666668, "reward_sla_mean_mean": -0.20637962962962966, "reward_sla_mean_min": -0.316, "reward_sla_mean_max": -0.12477777777777778, "reward_consolidation_sum_mean": -31.759259259259267, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -12.777777777777782, "reward_illegal_sum_mean": -177.08333333333334, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 76.28486111111111, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 108.31666666666669, "reward_sla_sum_mean": -20.637962962962963, "reward_sla_sum_min": -31.6, "reward_sla_sum_max": -12.477777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 450.0, "global_timestep_min": 100, "global_timestep_max": 800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24439283474951154, "mean_inference_ms": 2.243158274573978, "mean_action_processing_ms": 0.09342773824843376, "mean_env_wait_ms": 1.5909002068337428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794827938079834, "StateBufferConnector_ms": 0.003494819005330404, "ViewRequirementAgentConnector_ms": 0.09106099605560303}, "num_episodes": 24, "episode_return_max": -119.25333333333339, "episode_return_min": -179.45888888888885, "episode_return_mean": -153.19569444444446, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2100, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 231.18454267988312, "num_env_steps_trained_throughput_per_sec": 202.28647484489773, "timesteps_total": 2400, "num_env_steps_sampled_lifetime": 2400, "num_agent_steps_sampled_lifetime": 2400, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 2400, "timers": {"training_iteration_time_ms": 10381.326, "restore_workers_time_ms": 0.012, "training_step_time_ms": 642.16, "sample_time_ms": 626.259, "synch_weights_time_ms": 14.557}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 2100, "num_agent_steps_sampled": 2400, "num_agent_steps_trained": 2100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 16, "num_samples_added_to_queue": 2400}, "done": false, "training_iteration": 1, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-27-36", "timestamp": 1728649656, "time_this_iter_s": 10.387448787689209, "time_total_s": 10.387448787689209, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c4b9fdc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.387448787689209, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.833333333333332, "ram_util_percent": 53.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -107706.953125, "policy_loss": -107983.5703125, "entropy": 29.818561553955078, "entropy_coeff": 0.01, "var_gnorm": 16.00103759765625, "vf_loss": 36607.11328125, "vf_explained_var": 0.0009804368019104004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 4800, "learner_queue": {"size_count": 15, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.457, "learner_load_time_ms": 0.221, "learner_load_wait_time_ms": 1210.626, "learner_dequeue_time_ms": 5833.927}}, "env_runners": {"episode_reward_max": -100.49333333333345, "episode_reward_min": -187.56888888888895, "episode_reward_mean": -148.32974537037038, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 4800, "policy_reward_min": {"default_policy": -187.56888888888895}, "policy_reward_max": {"default_policy": -100.49333333333345}, "policy_reward_mean": {"default_policy": -148.32974537037038}, "custom_metrics": {"num_consolidated_mean": 0.6887500000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.050625, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.978333333333333, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08152777777778, "mean_accuracy_min": 40.78333333333333, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.037499999999999, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.15973541666666666, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.728333333333333, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5712279312711831, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.3663035378813973, "mean_cluster_mem_util_min": 0.3573489758245069, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.31226851851851856, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.1277777777777778, "reward_illegal_mean_mean": -1.7510416666666666, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7827256944444446, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0831666666666668, "reward_sla_mean_mean": -0.202712962962963, "reward_sla_mean_min": -0.316, "reward_sla_mean_max": -0.12477777777777778, "reward_consolidation_sum_mean": -31.22685185185185, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -12.77777777777778, "reward_illegal_sum_mean": -175.10416666666663, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 78.27256944444444, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 108.31666666666669, "reward_sla_sum_mean": -20.2712962962963, "reward_sla_sum_min": -31.6, "reward_sla_sum_max": -12.477777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 850.0, "global_timestep_min": 100, "global_timestep_max": 1600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24435910900773683, "mean_inference_ms": 2.23757302184835, "mean_action_processing_ms": 0.09297801898245216, "mean_env_wait_ms": 1.583209461769129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006986657778422038, "StateBufferConnector_ms": 0.0033602118492126465, "ViewRequirementAgentConnector_ms": 0.08793820937474568}, "num_episodes": 24, "episode_return_max": -100.49333333333345, "episode_return_min": -187.56888888888895, "episode_return_mean": -148.32974537037038, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.63936472969743, "num_env_steps_trained_throughput_per_sec": 233.63936472969743, "timesteps_total": 4800, "num_env_steps_sampled_lifetime": 4800, "num_agent_steps_sampled_lifetime": 4800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 10326.793, "restore_workers_time_ms": 0.011, "training_step_time_ms": 658.297, "sample_time_ms": 643.378, "synch_weights_time_ms": 13.566}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4500, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 32, "num_samples_added_to_queue": 4800}, "done": false, "training_iteration": 2, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-27-46", "timestamp": 1728649666, "time_this_iter_s": 10.278953790664673, "time_total_s": 20.666402578353882, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46df520>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.666402578353882, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.573333333333334, "ram_util_percent": 52.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -145022.796875, "policy_loss": -145502.578125, "entropy": 29.818359375, "entropy_coeff": 0.01, "var_gnorm": 16.001840591430664, "vf_loss": 56923.171875, "vf_explained_var": 0.001788794994354248}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 6900, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 6900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 48, "num_samples_added_to_queue": 7200, "learner_queue": {"size_count": 23, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.55, "learner_load_time_ms": 0.189, "learner_load_wait_time_ms": 1209.644, "learner_dequeue_time_ms": 7314.099}}, "env_runners": {"episode_reward_max": -100.49333333333345, "episode_reward_min": -187.56888888888895, "episode_reward_mean": -147.44913580246916, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"default_policy": -187.56888888888895}, "policy_reward_max": {"default_policy": -100.49333333333345}, "policy_reward_mean": {"default_policy": -147.44913580246916}, "custom_metrics": {"num_consolidated_mean": 0.6747222222222222, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0481944444444444, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.98986111111111, "num_moves_min": 9.7, "num_moves_max": 10.33, "mean_accuracy_mean": 41.094018518518524, "mean_accuracy_min": 40.78333333333333, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 6.018194444444443, "num_model_switches_min": 5.61, "num_model_switches_max": 6.38, "num_slav_mean": 0.1606997685185185, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.6747222222222224, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5704377999639033, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.3657873098520057, "mean_cluster_mem_util_min": 0.3573489758245069, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.31520061728395066, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.10000000000000003, "reward_illegal_mean_mean": -1.7469907407407406, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7926444444444445, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0951333333333333, "reward_sla_mean_mean": -0.20494444444444446, "reward_sla_mean_min": -0.316, "reward_sla_mean_max": -0.12477777777777778, "reward_consolidation_sum_mean": -31.52006172839506, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -10.000000000000004, "reward_illegal_sum_mean": -174.69907407407402, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 79.26444444444444, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 109.51333333333332, "reward_sla_sum_mean": -20.494444444444444, "reward_sla_sum_min": -31.6, "reward_sla_sum_max": -12.477777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1250.0, "global_timestep_min": 100, "global_timestep_max": 2400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2447790281819211, "mean_inference_ms": 2.229445586248176, "mean_action_processing_ms": 0.09286328272369693, "mean_env_wait_ms": 1.5812007260536611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684992048475478, "StateBufferConnector_ms": 0.0033749474419487845, "ViewRequirementAgentConnector_ms": 0.08790757921006945}, "num_episodes": 24, "episode_return_max": -100.49333333333345, "episode_return_min": -187.56888888888895, "episode_return_mean": -147.44913580246916, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 6900, "num_env_steps_sampled": 7200, "num_env_steps_trained": 6900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 235.39518672124652, "num_env_steps_trained_throughput_per_sec": 235.39518672124652, "timesteps_total": 7200, "num_env_steps_sampled_lifetime": 7200, "num_agent_steps_sampled_lifetime": 7200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 7200, "timers": {"training_iteration_time_ms": 10283.072, "restore_workers_time_ms": 0.012, "training_step_time_ms": 657.719, "sample_time_ms": 643.016, "synch_weights_time_ms": 13.344}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 6900, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 6900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 48, "num_samples_added_to_queue": 7200}, "done": false, "training_iteration": 3, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-27-56", "timestamp": 1728649676, "time_this_iter_s": 10.211316108703613, "time_total_s": 30.877718687057495, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46de3e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.877718687057495, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.006666666666668, "ram_util_percent": 52.29333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -130467.40625, "policy_loss": -130862.109375, "entropy": 29.818078994750977, "entropy_coeff": 0.01, "var_gnorm": 16.0034122467041, "vf_loss": 48415.97265625, "vf_explained_var": 0.0023294687271118164}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 9300, "learner_queue": {"size_count": 31, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.901, "learner_load_time_ms": 0.171, "learner_load_wait_time_ms": 1310.702, "learner_dequeue_time_ms": 8078.2}}, "env_runners": {"episode_reward_max": -100.49333333333345, "episode_reward_min": -187.56888888888895, "episode_reward_mean": -147.46649940262844, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9300, "policy_reward_min": {"default_policy": -187.56888888888895}, "policy_reward_max": {"default_policy": -100.49333333333345}, "policy_reward_mean": {"default_policy": -147.46649940262844}, "custom_metrics": {"num_consolidated_mean": 0.6791397849462366, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0476344086021505, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.98763440860215, "num_moves_min": 9.7, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09223655913979, "mean_accuracy_min": 40.78333333333333, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.998172043010752, "num_model_switches_min": 5.61, "num_model_switches_max": 6.38, "num_slav_mean": 0.16080645161290325, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.698924731182796, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5708726772581263, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5969375171473155, "mean_cluster_mem_util_mean": 0.36602647846568864, "mean_cluster_mem_util_min": 0.3573489758245069, "mean_cluster_mem_util_max": 0.3770742174717988, "reward_consolidation_mean_mean": -0.3142174432497013, "reward_consolidation_mean_min": -0.5611111111111111, "reward_consolidation_mean_max": -0.07222222222222224, "reward_illegal_mean_mean": -1.7460573476702508, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7943362007168462, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.20872640382317806, "reward_sla_mean_min": -0.33455555555555555, "reward_sla_mean_max": -0.12466666666666665, "reward_consolidation_sum_mean": -31.42174432497013, "reward_consolidation_sum_min": -56.111111111111114, "reward_consolidation_sum_max": -7.222222222222225, "reward_illegal_sum_mean": -174.60573476702507, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 79.43362007168459, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -20.8726403823178, "reward_sla_sum_min": -33.455555555555556, "reward_sla_sum_max": -12.466666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1600.0, "global_timestep_min": 100, "global_timestep_max": 3100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-119.25333333333339, -131.5144444444445, -170.17666666666656, -154.31888888888892, -176.9333333333333, -146.52444444444436, -160.78777777777776, -131.78888888888895, -129.29222222222225, -160.68333333333325, -178.70555555555546, -142.72777777777776, -171.32444444444437, -178.39444444444442, -136.6777777777778, -159.45222222222222, -173.01999999999987, -179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24608932822623553, "mean_inference_ms": 2.238221478169742, "mean_action_processing_ms": 0.09314357848299758, "mean_env_wait_ms": 1.5874200960790787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597785539524529, "StateBufferConnector_ms": 0.003445020285985803, "ViewRequirementAgentConnector_ms": 0.09020297758040889}, "num_episodes": 21, "episode_return_max": -100.49333333333345, "episode_return_min": -187.56888888888895, "episode_return_mean": -147.46649940262844, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 213.36789718856818, "num_env_steps_trained_throughput_per_sec": 227.59242366780606, "timesteps_total": 9450, "num_env_steps_sampled_lifetime": 9450, "num_agent_steps_sampled_lifetime": 9450, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 9450, "timers": {"training_iteration_time_ms": 10348.598, "restore_workers_time_ms": 0.011, "training_step_time_ms": 669.334, "sample_time_ms": 652.889, "synch_weights_time_ms": 14.85}, "counters": {"num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 9300}, "done": false, "training_iteration": 4, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-07", "timestamp": 1728649687, "time_this_iter_s": 10.555663824081421, "time_total_s": 41.433382511138916, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46de2c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.433382511138916, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.580000000000002, "ram_util_percent": 54.026666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -140221.140625, "policy_loss": -140679.1875, "entropy": 29.817655563354492, "entropy_coeff": 0.01, "var_gnorm": 16.005151748657227, "vf_loss": 54749.765625, "vf_explained_var": 0.003213167190551758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 11850, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 11850, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 79, "num_samples_added_to_queue": 11700, "learner_queue": {"size_count": 39, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.882, "learner_load_time_ms": 0.163, "learner_load_wait_time_ms": 1252.205, "learner_dequeue_time_ms": 8724.969}}, "env_runners": {"episode_reward_max": -100.49333333333345, "episode_reward_min": -187.56888888888895, "episode_reward_mean": -146.30186666666668, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -187.56888888888895}, "policy_reward_max": {"default_policy": -100.49333333333345}, "policy_reward_mean": {"default_policy": -146.30186666666668}, "custom_metrics": {"num_consolidated_mean": 0.6775999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0434999999999999, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.9798, "num_moves_min": 9.6, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10094999999999, "mean_accuracy_min": 40.78333333333333, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.9869, "num_model_switches_min": 5.61, "num_model_switches_max": 6.41, "num_slav_mean": 0.16168016666666662, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.6806, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5702885695439148, "mean_cluster_cpu_util_min": 0.5520417576486554, "mean_cluster_cpu_util_max": 0.6002739920772259, "mean_cluster_mem_util_mean": 0.36571083300503754, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38167166071069786, "reward_consolidation_mean_mean": -0.3165555555555556, "reward_consolidation_mean_min": -0.5833333333333334, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7391666666666663, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.8011913333333331, "reward_accuracy_mean_min": 0.49129999999999996, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.2084877777777778, "reward_sla_mean_min": -0.33455555555555555, "reward_sla_mean_max": -0.12466666666666665, "reward_consolidation_sum_mean": -31.65555555555555, "reward_consolidation_sum_min": -58.333333333333336, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -173.91666666666663, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 80.11913333333335, "reward_accuracy_sum_min": 49.129999999999995, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -20.848777777777784, "reward_sla_sum_min": -33.455555555555556, "reward_sla_sum_max": -12.466666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2267.0, "global_timestep_min": 200, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.45888888888885, -142.6577777777777, -157.72444444444452, -159.59666666666664, -156.19444444444446, -130.05, -129.43888888888893, -163.23999999999998, -146.5122222222222, -122.53555555555566, -100.49333333333345, -152.70888888888882, -170.03555555555573, -131.52666666666673, -187.56888888888895, -163.1877777777778, -124.43111111111119, -156.70777777777766, -117.58666666666667, -123.25555555555562, -130.3311111111111, -129.90222222222226, -134.70777777777786, -161.0900000000001, -143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24765580812918764, "mean_inference_ms": 2.2380201866922085, "mean_action_processing_ms": 0.09311478211826583, "mean_env_wait_ms": 1.590683204822072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062274932861328125, "StateBufferConnector_ms": 0.0034644603729248047, "ViewRequirementAgentConnector_ms": 0.0917818546295166}, "num_episodes": 24, "episode_return_max": -100.49333333333345, "episode_return_min": -187.56888888888895, "episode_return_mean": -146.30186666666668, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11850, "num_agent_steps_trained": 11700, "num_env_steps_sampled": 11850, "num_env_steps_trained": 11700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 229.57789178450278, "num_env_steps_trained_throughput_per_sec": 229.57789178450278, "timesteps_total": 11850, "num_env_steps_sampled_lifetime": 11850, "num_agent_steps_sampled_lifetime": 11850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 11850, "timers": {"training_iteration_time_ms": 10369.674, "restore_workers_time_ms": 0.014, "training_step_time_ms": 649.842, "sample_time_ms": 634.138, "synch_weights_time_ms": 13.928}, "counters": {"num_env_steps_sampled": 11850, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 11850, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 79, "num_samples_added_to_queue": 11700}, "done": false, "training_iteration": 5, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-17", "timestamp": 1728649697, "time_this_iter_s": 10.468849182128906, "time_total_s": 51.90223169326782, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dcd60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.90223169326782, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.673333333333332, "ram_util_percent": 54.05333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -133709.453125, "policy_loss": -134109.671875, "entropy": 29.817171096801758, "entropy_coeff": 0.01, "var_gnorm": 16.006940841674805, "vf_loss": 48967.82421875, "vf_explained_var": 0.004470765590667725}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 14250, "num_env_steps_trained": 14100, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 95, "num_samples_added_to_queue": 14100, "learner_queue": {"size_count": 47, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.508, "learner_load_time_ms": 0.198, "learner_load_wait_time_ms": 1238.311, "learner_dequeue_time_ms": 8999.347}}, "env_runners": {"episode_reward_max": -108.82666666666671, "episode_reward_min": -181.05777777777774, "episode_reward_mean": -145.68065555555557, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -181.05777777777774}, "policy_reward_max": {"default_policy": -108.82666666666671}, "policy_reward_mean": {"default_policy": -145.68065555555557}, "custom_metrics": {"num_consolidated_mean": 0.67, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0393, "num_overloaded_min": 0.9, "num_overloaded_max": 1.15, "num_moves_mean": 9.9804, "num_moves_min": 9.6, "num_moves_max": 10.33, "mean_accuracy_mean": 41.106840000000005, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.985499999999999, "num_model_switches_min": 5.61, "num_model_switches_max": 6.41, "num_slav_mean": 0.16323083333333333, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.6488, "cpu_conserved_cost_min": 1.94, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5690325262617387, "mean_cluster_cpu_util_min": 0.548386726861484, "mean_cluster_cpu_util_max": 0.6002739920772259, "mean_cluster_mem_util_mean": 0.3651262308314676, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38167166071069786, "reward_consolidation_mean_mean": -0.3187222222222223, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7321666666666664, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.804979, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.21089666666666665, "reward_sla_mean_min": -0.33455555555555555, "reward_sla_mean_max": -0.12466666666666665, "reward_consolidation_sum_mean": -31.872222222222227, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -173.21666666666667, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 80.4979, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -21.089666666666673, "reward_sla_sum_min": -33.455555555555556, "reward_sla_sum_max": -12.466666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3067.0, "global_timestep_min": 1000, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-143.2355555555556, -181.05777777777774, -136.72444444444443, -133.88000000000005, -155.87333333333336, -134.34999999999997, -142.18888888888884, -132.72666666666666, -157.19333333333321, -171.1377777777778, -157.95111111111112, -138.89000000000007, -146.9044444444445, -142.50444444444443, -141.93888888888887, -136.16555555555567, -165.91777777777781, -136.56111111111116, -151.4777777777777, -125.89888888888895, -125.60555555555554, -142.37444444444444, -161.74333333333334, -133.16666666666669, -127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2490739498190818, "mean_inference_ms": 2.2420559175378303, "mean_action_processing_ms": 0.093568028164511, "mean_env_wait_ms": 1.5979342809840562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062067508697509766, "StateBufferConnector_ms": 0.003505229949951172, "ViewRequirementAgentConnector_ms": 0.09329581260681152}, "num_episodes": 24, "episode_return_max": -108.82666666666671, "episode_return_min": -181.05777777777774, "episode_return_mean": -145.68065555555557, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14100, "num_env_steps_sampled": 14250, "num_env_steps_trained": 14100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 229.29712686394623, "num_env_steps_trained_throughput_per_sec": 229.29712686394623, "timesteps_total": 14250, "num_env_steps_sampled_lifetime": 14250, "num_agent_steps_sampled_lifetime": 14250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 14250, "timers": {"training_iteration_time_ms": 10385.858, "restore_workers_time_ms": 0.013, "training_step_time_ms": 645.422, "sample_time_ms": 630.322, "synch_weights_time_ms": 13.527}, "counters": {"num_env_steps_sampled": 14250, "num_env_steps_trained": 14100, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 95, "num_samples_added_to_queue": 14100}, "done": false, "training_iteration": 6, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-28", "timestamp": 1728649708, "time_this_iter_s": 10.48594069480896, "time_total_s": 62.38817238807678, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452e470>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.38817238807678, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.546666666666667, "ram_util_percent": 54.15333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -176184.875, "policy_loss": -176881.65625, "entropy": 29.816513061523438, "entropy_coeff": 0.01, "var_gnorm": 16.00908851623535, "vf_loss": 78623.109375, "vf_explained_var": 0.0056915283203125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 16500, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16500, "num_agent_steps_trained": 16200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 110, "num_samples_added_to_queue": 16500, "learner_queue": {"size_count": 54, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.54, "learner_load_time_ms": 0.185, "learner_load_wait_time_ms": 1264.224, "learner_dequeue_time_ms": 9246.677}}, "env_runners": {"episode_reward_max": -105.03777777777785, "episode_reward_min": -184.57333333333324, "episode_reward_mean": -145.62165555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -184.57333333333324}, "policy_reward_max": {"default_policy": -105.03777777777785}, "policy_reward_mean": {"default_policy": -145.62165555555555}, "custom_metrics": {"num_consolidated_mean": 0.674, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0388, "num_overloaded_min": 0.9, "num_overloaded_max": 1.17, "num_moves_mean": 9.9822, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.106713333333325, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.002299999999999, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.1634191666666667, "num_slav_min": 0.14439999999999997, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6662, "cpu_conserved_cost_min": 1.94, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.568816051773223, "mean_cluster_cpu_util_min": 0.548386726861484, "mean_cluster_cpu_util_max": 0.6002739920772259, "mean_cluster_mem_util_mean": 0.3650953709384598, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38167166071069786, "reward_consolidation_mean_mean": -0.32516666666666666, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.7313333333333332, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.8138823333333332, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -0.2135988888888889, "reward_sla_mean_min": -0.3356666666666667, "reward_sla_mean_max": -0.12466666666666665, "reward_consolidation_sum_mean": -32.51666666666667, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -173.1333333333333, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 81.38823333333333, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -21.359888888888896, "reward_sla_sum_min": -33.56666666666667, "reward_sla_sum_max": -12.466666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3867.0, "global_timestep_min": 1800, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-127.64777777777786, -120.63111111111124, -163.82111111111095, -170.6833333333332, -131.05444444444453, -156.04333333333327, -158.47111111111107, -135.78777777777788, -133.7811111111112, -137.82333333333332, -148.36999999999998, -168.44333333333324, -134.24000000000007, -140.04444444444454, -163.38333333333324, -156.67666666666676, -150.0577777777778, -172.41111111111107, -152.65444444444447, -161.78555555555553, -144.59444444444458, -152.69777777777782, -114.06222222222229, -142.2122222222223, -156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25084637728075276, "mean_inference_ms": 2.2546859993707984, "mean_action_processing_ms": 0.09406037219733357, "mean_env_wait_ms": 1.607136521388295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006283760070800781, "StateBufferConnector_ms": 0.003577709197998047, "ViewRequirementAgentConnector_ms": 0.09595656394958496}, "num_episodes": 24, "episode_return_max": -105.03777777777785, "episode_return_min": -184.57333333333324, "episode_return_mean": -145.62165555555555, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16500, "num_agent_steps_trained": 16200, "num_env_steps_sampled": 16500, "num_env_steps_trained": 16200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 224.94411664735162, "num_env_steps_trained_throughput_per_sec": 209.94784220419484, "timesteps_total": 16500, "num_env_steps_sampled_lifetime": 16500, "num_agent_steps_sampled_lifetime": 16500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 16500, "timers": {"training_iteration_time_ms": 10331.091, "restore_workers_time_ms": 0.013, "training_step_time_ms": 637.652, "sample_time_ms": 621.511, "synch_weights_time_ms": 14.66}, "counters": {"num_env_steps_sampled": 16500, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16500, "num_agent_steps_trained": 16200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 110, "num_samples_added_to_queue": 16500}, "done": false, "training_iteration": 7, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-38", "timestamp": 1728649718, "time_this_iter_s": 10.015859603881836, "time_total_s": 72.40403199195862, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27de0b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.40403199195862, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.892857142857142, "ram_util_percent": 53.8642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -136467.578125, "policy_loss": -136863.640625, "entropy": 29.81525421142578, "entropy_coeff": 0.01, "var_gnorm": 16.012224197387695, "vf_loss": 48551.78515625, "vf_explained_var": 0.008318066596984863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 18900, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18900, "num_agent_steps_trained": 18600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 126, "num_samples_added_to_queue": 18900, "learner_queue": {"size_count": 62, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.945, "learner_load_time_ms": 0.18, "learner_load_wait_time_ms": 1247.846, "learner_dequeue_time_ms": 9405.676}}, "env_runners": {"episode_reward_max": -92.2322222222223, "episode_reward_min": -184.57333333333324, "episode_reward_mean": -144.36535555555557, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -184.57333333333324}, "policy_reward_max": {"default_policy": -92.2322222222223}, "policy_reward_mean": {"default_policy": -144.36535555555557}, "custom_metrics": {"num_consolidated_mean": 0.6769, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0361, "num_overloaded_min": 0.88, "num_overloaded_max": 1.17, "num_moves_mean": 9.990100000000002, "num_moves_min": 9.6, "num_moves_max": 10.41, "mean_accuracy_mean": 41.11564333333333, "mean_accuracy_min": 40.89733333333333, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 6.002199999999999, "num_model_switches_min": 5.55, "num_model_switches_max": 6.45, "num_slav_mean": 0.16432983333333331, "num_slav_min": 0.14878333333333332, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6590000000000003, "cpu_conserved_cost_min": 1.94, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5681584280338187, "mean_cluster_cpu_util_min": 0.5426481824024246, "mean_cluster_cpu_util_max": 0.6002739920772259, "mean_cluster_mem_util_mean": 0.3647601565845748, "mean_cluster_mem_util_min": 0.35413467827004225, "mean_cluster_mem_util_max": 0.38167166071069786, "reward_consolidation_mean_mean": -0.32144444444444453, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.02777777777777782, "reward_illegal_mean_mean": -1.726833333333333, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.8192253333333334, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -0.21460111111111108, "reward_sla_mean_min": -0.3356666666666667, "reward_sla_mean_max": -0.12988888888888891, "reward_consolidation_sum_mean": -32.144444444444446, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -2.777777777777782, "reward_illegal_sum_mean": -172.68333333333328, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 81.92253333333333, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -21.46011111111111, "reward_sla_sum_min": -33.56666666666667, "reward_sla_sum_max": -12.98888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4678.0, "global_timestep_min": 2800, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-156.0955555555555, -139.78111111111124, -150.11666666666665, -143.02777777777774, -138.15555555555568, -140.21666666666667, -131.76888888888888, -149.63111111111115, -163.59222222222215, -156.99777777777777, -158.59888888888892, -163.11111111111117, -160.0666666666666, -137.9477777777778, -168.6844444444445, -165.24333333333334, -146.41444444444448, -164.01777777777772, -128.9522222222223, -148.26111111111115, -158.57333333333332, -148.4666666666667, -134.60555555555555, -125.3433333333334, -158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517720416926814, "mean_inference_ms": 2.2590436999924544, "mean_action_processing_ms": 0.09424510593016329, "mean_env_wait_ms": 1.6109340165510124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006206512451171875, "StateBufferConnector_ms": 0.00351715087890625, "ViewRequirementAgentConnector_ms": 0.09453105926513672}, "num_episodes": 24, "episode_return_max": -92.2322222222223, "episode_return_min": -184.57333333333324, "episode_return_mean": -144.36535555555557, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18900, "num_agent_steps_trained": 18600, "num_env_steps_sampled": 18900, "num_env_steps_trained": 18600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 228.5105653278874, "num_env_steps_trained_throughput_per_sec": 228.5105653278874, "timesteps_total": 18900, "num_env_steps_sampled_lifetime": 18900, "num_agent_steps_sampled_lifetime": 18900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 18900, "timers": {"training_iteration_time_ms": 10352.556, "restore_workers_time_ms": 0.012, "training_step_time_ms": 664.47, "sample_time_ms": 647.883, "synch_weights_time_ms": 14.618}, "counters": {"num_env_steps_sampled": 18900, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18900, "num_agent_steps_trained": 18600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 126, "num_samples_added_to_queue": 18900}, "done": false, "training_iteration": 8, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-48", "timestamp": 1728649728, "time_this_iter_s": 10.517695665359497, "time_total_s": 82.92172765731812, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dd240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.92172765731812, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.393333333333334, "ram_util_percent": 53.946666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -120363.0078125, "policy_loss": -120701.75, "entropy": 29.813804626464844, "entropy_coeff": 0.01, "var_gnorm": 16.015113830566406, "vf_loss": 42819.01953125, "vf_explained_var": 0.008039236068725586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 21300, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21300, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 142, "num_samples_added_to_queue": 21300, "learner_queue": {"size_count": 70, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.444, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 1299.739, "learner_dequeue_time_ms": 9538.738}}, "env_runners": {"episode_reward_max": -92.2322222222223, "episode_reward_min": -184.57333333333324, "episode_reward_mean": -141.6254555555556, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -184.57333333333324}, "policy_reward_max": {"default_policy": -92.2322222222223}, "policy_reward_mean": {"default_policy": -141.6254555555556}, "custom_metrics": {"num_consolidated_mean": 0.6753999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0251000000000001, "num_overloaded_min": 0.88, "num_overloaded_max": 1.17, "num_moves_mean": 10.006200000000002, "num_moves_min": 9.7, "num_moves_max": 10.41, "mean_accuracy_mean": 41.10905666666667, "mean_accuracy_min": 40.859333333333325, "mean_accuracy_max": 41.31533333333333, "num_model_switches_mean": 6.0258, "num_model_switches_min": 5.55, "num_model_switches_max": 6.45, "num_slav_mean": 0.16359033333333334, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6493999999999986, "cpu_conserved_cost_min": 1.94, "cpu_conserved_cost_max": 3.3, "mean_cluster_cpu_util_mean": 0.5672901160000707, "mean_cluster_cpu_util_min": 0.5426481824024246, "mean_cluster_cpu_util_max": 0.5874164467017376, "mean_cluster_mem_util_mean": 0.3644023233534975, "mean_cluster_mem_util_min": 0.35413467827004225, "mean_cluster_mem_util_max": 0.374902162626654, "reward_consolidation_mean_mean": -0.3299444444444445, "reward_consolidation_mean_min": -0.5888888888888889, "reward_consolidation_mean_max": -0.06666666666666674, "reward_illegal_mean_mean": -1.7084999999999997, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.842791, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -0.22060111111111108, "reward_sla_mean_min": -0.3356666666666667, "reward_sla_mean_max": -0.12988888888888891, "reward_consolidation_sum_mean": -32.99444444444445, "reward_consolidation_sum_min": -58.888888888888886, "reward_consolidation_sum_max": -6.666666666666673, "reward_illegal_sum_mean": -170.85, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 84.27909999999999, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -22.060111111111112, "reward_sla_sum_min": -33.56666666666667, "reward_sla_sum_max": -12.98888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5478.0, "global_timestep_min": 3600, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-158.108888888889, -137.7533333333334, -122.25222222222231, -130.61444444444453, -112.0033333333334, -150.7788888888889, -140.90555555555557, -139.69555555555556, -108.82666666666671, -138.15555555555562, -142.70666666666662, -132.46111111111125, -169.27999999999994, -146.53555555555565, -148.25999999999993, -158.65888888888884, -151.2833333333334, -141.9411111111111, -120.93000000000005, -157.85444444444448, -135.85555555555558, -166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525061474329082, "mean_inference_ms": 2.26119204472206, "mean_action_processing_ms": 0.09441341629561396, "mean_env_wait_ms": 1.6141231013516653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006324291229248047, "StateBufferConnector_ms": 0.003565549850463867, "ViewRequirementAgentConnector_ms": 0.09456205368041992}, "num_episodes": 24, "episode_return_max": -92.2322222222223, "episode_return_min": -184.57333333333324, "episode_return_mean": -141.6254555555556, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21300, "num_agent_steps_trained": 21000, "num_env_steps_sampled": 21300, "num_env_steps_trained": 21000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 220.61724474740055, "num_env_steps_trained_throughput_per_sec": 220.61724474740055, "timesteps_total": 21300, "num_env_steps_sampled_lifetime": 21300, "num_agent_steps_sampled_lifetime": 21300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 21300, "timers": {"training_iteration_time_ms": 10411.003, "restore_workers_time_ms": 0.012, "training_step_time_ms": 691.284, "sample_time_ms": 675.056, "synch_weights_time_ms": 14.457}, "counters": {"num_env_steps_sampled": 21300, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21300, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 142, "num_samples_added_to_queue": 21300}, "done": false, "training_iteration": 9, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-28-59", "timestamp": 1728649739, "time_this_iter_s": 10.898521661758423, "time_total_s": 93.82024931907654, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46df6a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.82024931907654, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.325000000000003, "ram_util_percent": 53.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -121135.96875, "policy_loss": -121465.2265625, "entropy": 29.812528610229492, "entropy_coeff": 0.01, "var_gnorm": 16.0172061920166, "vf_loss": 41869.81640625, "vf_explained_var": 0.010650157928466797}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 157, "num_samples_added_to_queue": 23400, "learner_queue": {"size_count": 78, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.414, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 1328.127, "learner_dequeue_time_ms": 9702.088}}, "env_runners": {"episode_reward_max": -89.08777777777783, "episode_reward_min": -184.57333333333324, "episode_reward_mean": -141.56352222222225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -184.57333333333324}, "policy_reward_max": {"default_policy": -89.08777777777783}, "policy_reward_mean": {"default_policy": -141.56352222222225}, "custom_metrics": {"num_consolidated_mean": 0.6783, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0231999999999999, "num_overloaded_min": 0.84, "num_overloaded_max": 1.17, "num_moves_mean": 10.009799999999998, "num_moves_min": 9.55, "num_moves_max": 10.41, "mean_accuracy_mean": 41.10994333333334, "mean_accuracy_min": 40.859333333333325, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0133, "num_model_switches_min": 5.55, "num_model_switches_max": 6.45, "num_slav_mean": 0.16345716666666668, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "cpu_conserved_cost_mean": 2.6741999999999995, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5674522660053222, "mean_cluster_cpu_util_min": 0.5426481824024246, "mean_cluster_cpu_util_max": 0.5874164467017376, "mean_cluster_mem_util_mean": 0.36460008556502765, "mean_cluster_mem_util_min": 0.35413467827004225, "mean_cluster_mem_util_max": 0.374902162626654, "reward_consolidation_mean_mean": -0.3435555555555556, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.07777777777777783, "reward_illegal_mean_mean": -1.705333333333333, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.859307, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.3512333333333333, "reward_sla_mean_mean": -0.22605333333333333, "reward_sla_mean_min": -0.3356666666666667, "reward_sla_mean_max": -0.12988888888888891, "reward_consolidation_sum_mean": -34.355555555555554, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -7.777777777777784, "reward_illegal_sum_mean": -170.53333333333327, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 85.9307, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 135.12333333333333, "reward_sla_sum_mean": -22.605333333333334, "reward_sla_sum_min": -33.56666666666667, "reward_sla_sum_max": -12.98888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6167.0, "global_timestep_min": 4100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.34888888888878, -159.55444444444424, -144.4922222222222, -145.3355555555555, -122.74111111111118, -156.23777777777775, -117.97888888888893, -143.23888888888888, -126.01222222222232, -158.27111111111103, -152.3044444444444, -142.48, -126.00000000000006, -184.57333333333324, -141.72888888888883, -105.03777777777785, -176.2822222222221, -143.85555555555553, -137.7566666666666, -148.1311111111111, -154.7733333333334, -179.19222222222223, -134.96444444444438, -130.7077777777778, -139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536278434644775, "mean_inference_ms": 2.263415665078669, "mean_action_processing_ms": 0.09458260329087358, "mean_env_wait_ms": 1.618096322442539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006333589553833008, "StateBufferConnector_ms": 0.0035829544067382812, "ViewRequirementAgentConnector_ms": 0.09437108039855957}, "num_episodes": 21, "episode_return_max": -89.08777777777783, "episode_return_min": -184.57333333333324, "episode_return_mean": -141.56352222222225, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 219.02382448617263, "num_env_steps_trained_throughput_per_sec": 233.6254127852508, "timesteps_total": 23550, "num_env_steps_sampled_lifetime": 23550, "num_agent_steps_sampled_lifetime": 23550, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 23550, "timers": {"training_iteration_time_ms": 10397.189, "restore_workers_time_ms": 0.011, "training_step_time_ms": 673.717, "sample_time_ms": 658.185, "synch_weights_time_ms": 13.941}, "counters": {"num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 157, "num_samples_added_to_queue": 23400}, "done": false, "training_iteration": 10, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-29-10", "timestamp": 1728649750, "time_this_iter_s": 10.282641172409058, "time_total_s": 104.1028904914856, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27de6b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.1028904914856, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.95, "ram_util_percent": 55.607142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -139533.296875, "policy_loss": -139958.578125, "entropy": 29.80945587158203, "entropy_coeff": 0.01, "var_gnorm": 16.02094268798828, "vf_loss": 51470.78125, "vf_explained_var": 0.014829516410827637}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 173, "num_samples_added_to_queue": 25800, "learner_queue": {"size_count": 86, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.657, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1273.324, "learner_dequeue_time_ms": 10649.857}}, "env_runners": {"episode_reward_max": -89.08777777777783, "episode_reward_min": -176.87333333333328, "episode_reward_mean": -138.3075777777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -176.87333333333328}, "policy_reward_max": {"default_policy": -89.08777777777783}, "policy_reward_mean": {"default_policy": -138.3075777777778}, "custom_metrics": {"num_consolidated_mean": 0.6765000000000002, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0078, "num_overloaded_min": 0.84, "num_overloaded_max": 1.15, "num_moves_mean": 9.9854, "num_moves_min": 9.55, "num_moves_max": 10.41, "mean_accuracy_mean": 41.10835999999999, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.000200000000002, "num_model_switches_min": 5.37, "num_model_switches_max": 6.45, "num_slav_mean": 0.1635095, "num_slav_min": 0.1381, "num_slav_max": 0.19095000000000004, "cpu_conserved_cost_mean": 2.6576000000000004, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5664690616264396, "mean_cluster_cpu_util_min": 0.5426481824024246, "mean_cluster_cpu_util_max": 0.5901313676526134, "mean_cluster_mem_util_mean": 0.36422857081862275, "mean_cluster_mem_util_min": 0.35413467827004225, "mean_cluster_mem_util_max": 0.374902162626654, "reward_consolidation_mean_mean": -0.3552777777777778, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.11111111111111115, "reward_illegal_mean_mean": -1.6796666666666666, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.8865786666666667, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.4239333333333333, "reward_sla_mean_mean": -0.23471, "reward_sla_mean_min": -0.3893333333333333, "reward_sla_mean_max": -0.13055555555555554, "reward_consolidation_sum_mean": -35.52777777777778, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -11.111111111111114, "reward_illegal_sum_mean": -167.9666666666666, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 88.65786666666669, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 142.39333333333332, "reward_sla_sum_mean": -23.471000000000004, "reward_sla_sum_min": -38.93333333333333, "reward_sla_sum_max": -13.055555555555554, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5095.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-139.27222222222227, -136.08111111111126, -138.4644444444445, -146.24666666666667, -162.17777777777772, -162.27333333333326, -119.74222222222231, -176.87333333333328, -133.2277777777778, -153.81888888888895, -145.0022222222221, -153.42555555555555, -145.71333333333328, -143.8111111111111, -138.84666666666655, -143.9755555555555, -164.84222222222215, -130.45666666666673, -158.40444444444435, -172.7788888888889, -153.45, -136.98333333333335, -122.44333333333336, -151.8, -147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25474137129792235, "mean_inference_ms": 2.267142549061004, "mean_action_processing_ms": 0.09481690132486896, "mean_env_wait_ms": 1.6225543966991633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006250858306884766, "StateBufferConnector_ms": 0.003547191619873047, "ViewRequirementAgentConnector_ms": 0.0924842357635498}, "num_episodes": 24, "episode_return_max": -89.08777777777783, "episode_return_min": -176.87333333333328, "episode_return_mean": -138.3075777777778, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 25950, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 227.8141103159026, "num_env_steps_trained_throughput_per_sec": 227.8141103159026, "timesteps_total": 25950, "num_env_steps_sampled_lifetime": 25950, "num_agent_steps_sampled_lifetime": 25950, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 25950, "timers": {"training_iteration_time_ms": 10412.548, "restore_workers_time_ms": 0.011, "training_step_time_ms": 652.671, "sample_time_ms": 636.792, "synch_weights_time_ms": 14.482}, "counters": {"num_env_steps_sampled": 25950, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25950, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 173, "num_samples_added_to_queue": 25800}, "done": false, "training_iteration": 11, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-29-20", "timestamp": 1728649760, "time_this_iter_s": 10.54852819442749, "time_total_s": 114.65141868591309, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27ded40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.65141868591309, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.253333333333334, "ram_util_percent": 54.919999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -136036.328125, "policy_loss": -136441.90625, "entropy": 29.80729866027832, "entropy_coeff": 0.01, "var_gnorm": 16.02402687072754, "vf_loss": 49499.53125, "vf_explained_var": 0.017004966735839844}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 28350, "num_env_steps_trained": 28200, "num_agent_steps_sampled": 28350, "num_agent_steps_trained": 28200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 189, "num_samples_added_to_queue": 28200, "learner_queue": {"size_count": 94, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.63, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1251.203, "learner_dequeue_time_ms": 10670.648}}, "env_runners": {"episode_reward_max": -89.08777777777783, "episode_reward_min": -175.61333333333326, "episode_reward_mean": -136.37, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -175.61333333333326}, "policy_reward_max": {"default_policy": -89.08777777777783}, "policy_reward_mean": {"default_policy": -136.37}, "custom_metrics": {"num_consolidated_mean": 0.6717000000000002, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9983, "num_overloaded_min": 0.84, "num_overloaded_max": 1.13, "num_moves_mean": 9.9916, "num_moves_min": 9.55, "num_moves_max": 10.36, "mean_accuracy_mean": 41.1057, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0181, "num_model_switches_min": 5.37, "num_model_switches_max": 6.42, "num_slav_mean": 0.16408466666666666, "num_slav_min": 0.1381, "num_slav_max": 0.19095000000000004, "cpu_conserved_cost_mean": 2.6312, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5649723539071944, "mean_cluster_cpu_util_min": 0.5426481824024246, "mean_cluster_cpu_util_max": 0.5901313676526134, "mean_cluster_mem_util_mean": 0.363728599914966, "mean_cluster_mem_util_min": 0.35413467827004225, "mean_cluster_mem_util_max": 0.3748265020881771, "reward_consolidation_mean_mean": -0.36611111111111105, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.6638333333333333, "reward_illegal_mean_min": -1.8833333333333329, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.9071033333333333, "reward_accuracy_mean_min": 0.5292333333333333, "reward_accuracy_mean_max": 1.4239333333333333, "reward_sla_mean_mean": -0.24085888888888887, "reward_sla_mean_min": -0.3893333333333333, "reward_sla_mean_max": -0.13622222222222224, "reward_consolidation_sum_mean": -36.611111111111114, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -166.3833333333333, "reward_illegal_sum_min": -188.3333333333333, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 90.71033333333335, "reward_accuracy_sum_min": 52.92333333333333, "reward_accuracy_sum_max": 142.39333333333332, "reward_sla_sum_mean": -24.085888888888885, "reward_sla_sum_min": -38.93333333333333, "reward_sla_sum_max": -13.622222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4023.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-147.19444444444443, -92.2322222222223, -122.31555555555568, -164.89888888888885, -123.99888888888894, -125.38444444444453, -109.87000000000006, -133.45666666666673, -142.18888888888895, -175.61333333333326, -145.29555555555555, -142.5144444444445, -152.09111111111116, -145.50333333333342, -162.20222222222225, -126.05888888888894, -130.68111111111122, -139.70111111111103, -126.03555555555565, -135.76666666666674, -133.0177777777778, -127.51888888888895, -126.24333333333344, -134.50222222222226, -130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25572557527482737, "mean_inference_ms": 2.2677885101438515, "mean_action_processing_ms": 0.0949850698945771, "mean_env_wait_ms": 1.6253721583558811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006208658218383789, "StateBufferConnector_ms": 0.0035369396209716797, "ViewRequirementAgentConnector_ms": 0.09172821044921875}, "num_episodes": 24, "episode_return_max": -89.08777777777783, "episode_return_min": -175.61333333333326, "episode_return_mean": -136.37, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28350, "num_agent_steps_trained": 28200, "num_env_steps_sampled": 28350, "num_env_steps_trained": 28200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 226.6366883830909, "num_env_steps_trained_throughput_per_sec": 226.6366883830909, "timesteps_total": 28350, "num_env_steps_sampled_lifetime": 28350, "num_agent_steps_sampled_lifetime": 28350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 28350, "timers": {"training_iteration_time_ms": 10444.286, "restore_workers_time_ms": 0.011, "training_step_time_ms": 652.415, "sample_time_ms": 636.301, "synch_weights_time_ms": 14.528}, "counters": {"num_env_steps_sampled": 28350, "num_env_steps_trained": 28200, "num_agent_steps_sampled": 28350, "num_agent_steps_trained": 28200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 189, "num_samples_added_to_queue": 28200}, "done": false, "training_iteration": 12, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-29-31", "timestamp": 1728649771, "time_this_iter_s": 10.600708961486816, "time_total_s": 125.2521276473999, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46ddba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.2521276473999, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.71875, "ram_util_percent": 54.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -131136.875, "policy_loss": -131506.328125, "entropy": 29.80428123474121, "entropy_coeff": 0.01, "var_gnorm": 16.02770233154297, "vf_loss": 45886.171875, "vf_explained_var": 0.020409762859344482}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 30600, "learner_queue": {"size_count": 102, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.058, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1264.352, "learner_dequeue_time_ms": 10706.48}}, "env_runners": {"episode_reward_max": -89.08777777777783, "episode_reward_min": -165.5033333333333, "episode_reward_mean": -135.31672222222227, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -165.5033333333333}, "policy_reward_max": {"default_policy": -89.08777777777783}, "policy_reward_mean": {"default_policy": -135.31672222222227}, "custom_metrics": {"num_consolidated_mean": 0.6718000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9957999999999998, "num_overloaded_min": 0.84, "num_overloaded_max": 1.12, "num_moves_mean": 9.999, "num_moves_min": 9.55, "num_moves_max": 10.36, "mean_accuracy_mean": 41.10652333333333, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.009200000000001, "num_model_switches_min": 5.37, "num_model_switches_max": 6.36, "num_slav_mean": 0.16362316666666668, "num_slav_min": 0.1381, "num_slav_max": 0.19095000000000004, "cpu_conserved_cost_mean": 2.6362, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5644976609843263, "mean_cluster_cpu_util_min": 0.5461200901281952, "mean_cluster_cpu_util_max": 0.5901313676526134, "mean_cluster_mem_util_mean": 0.36348627760017505, "mean_cluster_mem_util_min": 0.3544375166838887, "mean_cluster_mem_util_max": 0.3748265020881771, "reward_consolidation_mean_mean": -0.3627777777777778, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.6596666666666662, "reward_illegal_mean_min": -1.8666666666666665, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.9139650000000001, "reward_accuracy_mean_min": 0.5355666666666665, "reward_accuracy_mean_max": 1.4239333333333333, "reward_sla_mean_mean": -0.24468777777777778, "reward_sla_mean_min": -0.3893333333333333, "reward_sla_mean_max": -0.13622222222222224, "reward_consolidation_sum_mean": -36.277777777777786, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -165.96666666666664, "reward_illegal_sum_min": -186.66666666666666, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 91.39649999999997, "reward_accuracy_sum_min": 53.55666666666666, "reward_accuracy_sum_max": 142.39333333333332, "reward_sla_sum_mean": -24.468777777777778, "reward_sla_sum_min": -38.93333333333333, "reward_sla_sum_max": -13.622222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2951.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-130.2266666666667, -158.21777777777777, -133.85333333333338, -153.15777777777777, -100.6622222222223, -114.15444444444455, -135.01666666666674, -152.19999999999996, -156.8044444444444, -150.88222222222225, -145.83, -162.98999999999995, -151.6155555555556, -135.15777777777777, -149.44666666666674, -121.65333333333339, -154.11777777777775, -137.10222222222222, -122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2566007304408573, "mean_inference_ms": 2.268104149484456, "mean_action_processing_ms": 0.09512315457524478, "mean_env_wait_ms": 1.6277366491548713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062863826751708984, "StateBufferConnector_ms": 0.0035381317138671875, "ViewRequirementAgentConnector_ms": 0.0917656421661377}, "num_episodes": 24, "episode_return_max": -89.08777777777783, "episode_return_min": -165.5033333333333, "episode_return_mean": -135.31672222222227, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 227.56139932702266, "num_env_steps_trained_throughput_per_sec": 227.56139932702266, "timesteps_total": 30750, "num_env_steps_sampled_lifetime": 30750, "num_agent_steps_sampled_lifetime": 30750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 30750, "timers": {"training_iteration_time_ms": 10479.384, "restore_workers_time_ms": 0.012, "training_step_time_ms": 651.37, "sample_time_ms": 632.905, "synch_weights_time_ms": 16.761}, "counters": {"num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 30600}, "done": false, "training_iteration": 13, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-29-41", "timestamp": 1728649781, "time_this_iter_s": 10.565253496170044, "time_total_s": 135.81738114356995, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dd9f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.81738114356995, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.19333333333333, "ram_util_percent": 53.55333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -117771.1171875, "policy_loss": -118079.7734375, "entropy": 29.80141258239746, "entropy_coeff": 0.01, "var_gnorm": 16.03079605102539, "vf_loss": 39806.03125, "vf_explained_var": 0.02027517557144165}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 32400, "num_env_steps_trained": 32100, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 32100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 216, "num_samples_added_to_queue": 32400, "learner_queue": {"size_count": 107, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.215, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1585.036, "learner_dequeue_time_ms": 10786.598}}, "env_runners": {"episode_reward_max": -89.08777777777783, "episode_reward_min": -165.5033333333333, "episode_reward_mean": -133.72260000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -165.5033333333333}, "policy_reward_max": {"default_policy": -89.08777777777783}, "policy_reward_mean": {"default_policy": -133.72260000000003}, "custom_metrics": {"num_consolidated_mean": 0.6655999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9898000000000002, "num_overloaded_min": 0.84, "num_overloaded_max": 1.12, "num_moves_mean": 9.986600000000001, "num_moves_min": 9.6, "num_moves_max": 10.36, "mean_accuracy_mean": 41.09981, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.004, "num_model_switches_min": 5.37, "num_model_switches_max": 6.31, "num_slav_mean": 0.163062, "num_slav_min": 0.1381, "num_slav_max": 0.19095000000000004, "cpu_conserved_cost_mean": 2.5978000000000003, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5630189209063999, "mean_cluster_cpu_util_min": 0.5458069066469187, "mean_cluster_cpu_util_max": 0.5901313676526134, "mean_cluster_mem_util_mean": 0.36274514303115757, "mean_cluster_mem_util_min": 0.3544375166838887, "mean_cluster_mem_util_max": 0.3735791411923419, "reward_consolidation_mean_mean": -0.36427777777777776, "reward_consolidation_mean_min": -0.6888888888888889, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.6496666666666664, "reward_illegal_mean_min": -1.8666666666666665, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.9230006666666667, "reward_accuracy_mean_min": 0.5355666666666665, "reward_accuracy_mean_max": 1.4239333333333333, "reward_sla_mean_mean": -0.24628222222222224, "reward_sla_mean_min": -0.3893333333333333, "reward_sla_mean_max": -0.13622222222222224, "reward_consolidation_sum_mean": -36.42777777777778, "reward_consolidation_sum_min": -68.88888888888889, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -164.96666666666664, "reward_illegal_sum_min": -186.66666666666666, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 92.30006666666668, "reward_accuracy_sum_min": 53.55666666666666, "reward_accuracy_sum_max": 142.39333333333332, "reward_sla_sum_mean": -24.628222222222217, "reward_sla_sum_min": -38.93333333333333, "reward_sla_sum_max": -13.622222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2151.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-122.91111111111114, -158.7355555555555, -124.7955555555556, -135.04666666666674, -89.08777777777783, -135.03444444444452, -130.2433333333334, -115.55555555555566, -163.8155555555555, -145.64222222222222, -114.47777777777783, -163.68, -143.33777777777772, -145.7144444444444, -131.29000000000008, -160.30111111111114, -124.33444444444447, -159.11888888888888, -145.49111111111114, -110.34222222222235, -108.29333333333335, -91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25777843929212113, "mean_inference_ms": 2.2750157394046555, "mean_action_processing_ms": 0.09545539199797717, "mean_env_wait_ms": 1.6340102509466745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007180452346801758, "StateBufferConnector_ms": 0.0038552284240722656, "ViewRequirementAgentConnector_ms": 0.09877133369445801}, "num_episodes": 18, "episode_return_max": -89.08777777777783, "episode_return_min": -165.5033333333333, "episode_return_mean": -133.72260000000003, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 32100, "num_env_steps_sampled": 32400, "num_env_steps_trained": 32100, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 153.8365113445676, "num_env_steps_trained_throughput_per_sec": 139.8513739496069, "timesteps_total": 32400, "num_env_steps_sampled_lifetime": 32400, "num_agent_steps_sampled_lifetime": 32400, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 32400, "timers": {"training_iteration_time_ms": 10497.435, "restore_workers_time_ms": 0.019, "training_step_time_ms": 1004.245, "sample_time_ms": 982.46, "synch_weights_time_ms": 19.604}, "counters": {"num_env_steps_sampled": 32400, "num_env_steps_trained": 32100, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 32100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 216, "num_samples_added_to_queue": 32400}, "done": false, "training_iteration": 14, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-29-52", "timestamp": 1728649792, "time_this_iter_s": 10.736721515655518, "time_total_s": 146.55410265922546, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46dfb80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.55410265922546, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.44666666666667, "ram_util_percent": 55.906666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -121097.75, "policy_loss": -121405.0, "entropy": 29.795194625854492, "entropy_coeff": 0.01, "var_gnorm": 16.035852432250977, "vf_loss": 39662.90625, "vf_explained_var": 0.027917802333831787}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 34650, "num_env_steps_trained": 34500, "num_agent_steps_sampled": 34650, "num_agent_steps_trained": 34500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 231, "num_samples_added_to_queue": 34500, "learner_queue": {"size_count": 115, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.693, "learner_load_time_ms": 0.324, "learner_load_wait_time_ms": 1557.929, "learner_dequeue_time_ms": 11041.122}}, "env_runners": {"episode_reward_max": -81.73555555555555, "episode_reward_min": -168.96333333333334, "episode_reward_mean": -133.27183333333338, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -168.96333333333334}, "policy_reward_max": {"default_policy": -81.73555555555555}, "policy_reward_mean": {"default_policy": -133.27183333333338}, "custom_metrics": {"num_consolidated_mean": 0.667, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9867, "num_overloaded_min": 0.83, "num_overloaded_max": 1.12, "num_moves_mean": 10.006400000000001, "num_moves_min": 9.71, "num_moves_max": 10.36, "mean_accuracy_mean": 41.088409999999996, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.302666666666674, "num_model_switches_mean": 6.0172, "num_model_switches_min": 5.37, "num_model_switches_max": 6.31, "num_slav_mean": 0.16244366666666665, "num_slav_min": 0.1381, "num_slav_max": 0.18166666666666664, "cpu_conserved_cost_mean": 2.5904000000000003, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5618853255347284, "mean_cluster_cpu_util_min": 0.5458069066469187, "mean_cluster_cpu_util_max": 0.5799135905156769, "mean_cluster_mem_util_mean": 0.36228386233639026, "mean_cluster_mem_util_min": 0.3544375166838887, "mean_cluster_mem_util_max": 0.36992740911765554, "reward_consolidation_mean_mean": -0.36477777777777776, "reward_consolidation_mean_min": -0.6222222222222222, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.6444999999999996, "reward_illegal_mean_min": -1.8666666666666665, "reward_illegal_mean_max": -1.383333333333333, "reward_accuracy_mean_mean": 0.9202116666666668, "reward_accuracy_mean_min": 0.5355666666666665, "reward_accuracy_mean_max": 1.4429333333333334, "reward_sla_mean_mean": -0.24365222222222221, "reward_sla_mean_min": -0.4075555555555556, "reward_sla_mean_max": -0.13622222222222224, "reward_consolidation_sum_mean": -36.47777777777778, "reward_consolidation_sum_min": -62.22222222222223, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -164.44999999999996, "reward_illegal_sum_min": -186.66666666666666, "reward_illegal_sum_max": -138.33333333333331, "reward_accuracy_sum_mean": 92.02116666666667, "reward_accuracy_sum_min": 53.55666666666666, "reward_accuracy_sum_max": 144.29333333333335, "reward_sla_sum_mean": -24.365222222222222, "reward_sla_sum_min": -40.75555555555556, "reward_sla_sum_max": -13.622222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2067.0, "global_timestep_min": 100, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-91.49555555555551, -151.61333333333334, -107.79111111111122, -99.76333333333342, -121.6333333333334, -159.67555555555558, -140.52111111111117, -130.02222222222227, -126.72222222222236, -120.44333333333343, -145.07333333333327, -135.27444444444453, -135.99444444444453, -136.58000000000007, -152.41999999999996, -103.80111111111114, -141.16666666666654, -163.3322222222221, -119.99555555555564, -144.31111111111113, -134.92888888888893, -115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2590874228664629, "mean_inference_ms": 2.2835201687224633, "mean_action_processing_ms": 0.09581603701170881, "mean_env_wait_ms": 1.6411559657061234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007192850112915039, "StateBufferConnector_ms": 0.003840923309326172, "ViewRequirementAgentConnector_ms": 0.09872221946716309}, "num_episodes": 21, "episode_return_max": -81.73555555555555, "episode_return_min": -168.96333333333334, "episode_return_mean": -133.27183333333338, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34650, "num_agent_steps_trained": 34500, "num_env_steps_sampled": 34650, "num_env_steps_trained": 34500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 218.7462862590629, "num_env_steps_trained_throughput_per_sec": 233.3293720096671, "timesteps_total": 34650, "num_env_steps_sampled_lifetime": 34650, "num_agent_steps_sampled_lifetime": 34650, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 34650, "timers": {"training_iteration_time_ms": 10480.627, "restore_workers_time_ms": 0.013, "training_step_time_ms": 657.282, "sample_time_ms": 639.332, "synch_weights_time_ms": 16.525}, "counters": {"num_env_steps_sampled": 34650, "num_env_steps_trained": 34500, "num_agent_steps_sampled": 34650, "num_agent_steps_trained": 34500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 231, "num_samples_added_to_queue": 34500}, "done": false, "training_iteration": 15, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-02", "timestamp": 1728649802, "time_this_iter_s": 10.29961085319519, "time_total_s": 156.85371351242065, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46deaa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.85371351242065, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.959999999999997, "ram_util_percent": 57.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -122067.5546875, "policy_loss": -122384.671875, "entropy": 29.789623260498047, "entropy_coeff": 0.01, "var_gnorm": 16.03997802734375, "vf_loss": 40648.5546875, "vf_explained_var": 0.03191250562667847}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 36750, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 245, "num_samples_added_to_queue": 36600, "learner_queue": {"size_count": 122, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.852, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 1342.645, "learner_dequeue_time_ms": 11137.113}}, "env_runners": {"episode_reward_max": -77.96666666666665, "episode_reward_min": -174.53222222222217, "episode_reward_mean": -130.8543555555556, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -174.53222222222217}, "policy_reward_max": {"default_policy": -77.96666666666665}, "policy_reward_mean": {"default_policy": -130.8543555555556}, "custom_metrics": {"num_consolidated_mean": 0.6662, "num_consolidated_min": 0.55, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9802999999999998, "num_overloaded_min": 0.79, "num_overloaded_max": 1.12, "num_moves_mean": 9.9989, "num_moves_min": 9.71, "num_moves_max": 10.31, "mean_accuracy_mean": 41.07435, "mean_accuracy_min": 40.87833333333333, "mean_accuracy_max": 41.251999999999995, "num_model_switches_mean": 6.035299999999999, "num_model_switches_min": 5.71, "num_model_switches_max": 6.33, "num_slav_mean": 0.1614711666666667, "num_slav_min": 0.14031666666666667, "num_slav_max": 0.18166666666666664, "cpu_conserved_cost_mean": 2.5692000000000004, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.560432523084871, "mean_cluster_cpu_util_min": 0.5378923563132365, "mean_cluster_cpu_util_max": 0.5776323795913129, "mean_cluster_mem_util_mean": 0.3615739226136656, "mean_cluster_mem_util_min": 0.3522675469660439, "mean_cluster_mem_util_max": 0.3706586978673326, "reward_consolidation_mean_mean": -0.356888888888889, "reward_consolidation_mean_min": -0.6222222222222222, "reward_consolidation_mean_max": -0.10555555555555558, "reward_illegal_mean_mean": -1.6338333333333332, "reward_illegal_mean_min": -1.8666666666666665, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.924972, "reward_accuracy_mean_min": 0.5716, "reward_accuracy_mean_max": 1.4429333333333334, "reward_sla_mean_mean": -0.24279333333333333, "reward_sla_mean_min": -0.4075555555555556, "reward_sla_mean_max": -0.13622222222222224, "reward_consolidation_sum_mean": -35.68888888888889, "reward_consolidation_sum_min": -62.22222222222223, "reward_consolidation_sum_max": -10.555555555555559, "reward_illegal_sum_mean": -163.3833333333333, "reward_illegal_sum_min": -186.66666666666666, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 92.4972, "reward_accuracy_sum_min": 57.16, "reward_accuracy_sum_max": 144.29333333333335, "reward_sla_sum_mean": -24.279333333333337, "reward_sla_sum_min": -40.75555555555556, "reward_sla_sum_max": -13.622222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2762.0, "global_timestep_min": 900, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-115.85888888888897, -123.28222222222237, -165.5033333333333, -136.1011111111112, -153.6844444444444, -132.60777777777787, -150.15888888888884, -141.49000000000004, -140.79555555555555, -164.9511111111111, -129.28555555555556, -124.09222222222235, -129.83222222222224, -147.50111111111107, -142.5944444444444, -142.07888888888894, -115.21555555555564, -115.06444444444453, -127.77555555555566, -127.03666666666676, -122.21333333333338, -123.84222222222232, -123.23888888888895, -148.72222222222223, -117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2604783116192245, "mean_inference_ms": 2.295025229337426, "mean_action_processing_ms": 0.09627469569289669, "mean_env_wait_ms": 1.6499690426023097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007212400436401367, "StateBufferConnector_ms": 0.003876924514770508, "ViewRequirementAgentConnector_ms": 0.09879374504089355}, "num_episodes": 21, "episode_return_max": -77.96666666666665, "episode_return_min": -174.53222222222217, "episode_return_mean": -130.8543555555556, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36600, "num_env_steps_sampled": 36750, "num_env_steps_trained": 36600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 207.56933829643722, "num_env_steps_trained_throughput_per_sec": 207.56933829643722, "timesteps_total": 36750, "num_env_steps_sampled_lifetime": 36750, "num_agent_steps_sampled_lifetime": 36750, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 36750, "timers": {"training_iteration_time_ms": 10445.66, "restore_workers_time_ms": 0.015, "training_step_time_ms": 717.041, "sample_time_ms": 700.425, "synch_weights_time_ms": 15.261}, "counters": {"num_env_steps_sampled": 36750, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 245, "num_samples_added_to_queue": 36600}, "done": false, "training_iteration": 16, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-13", "timestamp": 1728649813, "time_this_iter_s": 10.141762733459473, "time_total_s": 166.99547624588013, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dd0c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.99547624588013, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.314285714285717, "ram_util_percent": 57.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -102560.1484375, "policy_loss": -102799.03125, "entropy": 29.7819881439209, "entropy_coeff": 0.01, "var_gnorm": 16.0443115234375, "vf_loss": 32822.84375, "vf_explained_var": 0.029512643814086914}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 129.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 38700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 260, "num_samples_added_to_queue": 39000, "learner_queue": {"size_count": 129, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.213, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1324.097, "learner_dequeue_time_ms": 11182.951}}, "env_runners": {"episode_reward_max": -77.96666666666665, "episode_reward_min": -174.53222222222217, "episode_reward_mean": -128.75531111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -174.53222222222217}, "policy_reward_max": {"default_policy": -77.96666666666665}, "policy_reward_mean": {"default_policy": -128.75531111111113}, "custom_metrics": {"num_consolidated_mean": 0.6625, "num_consolidated_min": 0.54, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9691000000000001, "num_overloaded_min": 0.79, "num_overloaded_max": 1.11, "num_moves_mean": 9.992399999999998, "num_moves_min": 9.71, "num_moves_max": 10.23, "mean_accuracy_mean": 41.07156333333333, "mean_accuracy_min": 40.89099999999999, "mean_accuracy_max": 41.37233333333333, "num_model_switches_mean": 6.027100000000001, "num_model_switches_min": 5.52, "num_model_switches_max": 6.34, "num_slav_mean": 0.160739, "num_slav_min": 0.14031666666666667, "num_slav_max": 0.18166666666666664, "cpu_conserved_cost_mean": 2.5564, "cpu_conserved_cost_min": 2.04, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.559282884455137, "mean_cluster_cpu_util_min": 0.5378923563132365, "mean_cluster_cpu_util_max": 0.5776323795913129, "mean_cluster_mem_util_mean": 0.3609929415292488, "mean_cluster_mem_util_min": 0.3522675469660439, "mean_cluster_mem_util_max": 0.3706586978673326, "reward_consolidation_mean_mean": -0.37811111111111123, "reward_consolidation_mean_min": -0.6277777777777778, "reward_consolidation_mean_max": -0.12222222222222225, "reward_illegal_mean_mean": -1.6151666666666662, "reward_illegal_mean_min": -1.85, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9544246666666666, "reward_accuracy_mean_min": 0.5374666666666666, "reward_accuracy_mean_max": 1.4429333333333334, "reward_sla_mean_mean": -0.2487, "reward_sla_mean_min": -0.4075555555555556, "reward_sla_mean_max": -0.13877777777777778, "reward_consolidation_sum_mean": -37.81111111111111, "reward_consolidation_sum_min": -62.77777777777778, "reward_consolidation_sum_max": -12.222222222222225, "reward_illegal_sum_mean": -161.51666666666662, "reward_illegal_sum_min": -185.0, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 95.44246666666666, "reward_accuracy_sum_min": 53.74666666666667, "reward_accuracy_sum_max": 144.29333333333335, "reward_sla_sum_mean": -24.870000000000008, "reward_sla_sum_min": -40.75555555555556, "reward_sla_sum_max": -13.877777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3562.0, "global_timestep_min": 1700, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-117.33000000000006, -107.95222222222225, -140.61555555555566, -147.23000000000002, -139.0644444444445, -144.91666666666666, -159.3177777777778, -116.82777777777787, -152.81555555555562, -116.42888888888892, -124.61666666666672, -118.90777777777785, -153.0577777777778, -152.29555555555552, -116.3744444444445, -148.0977777777778, -158.60111111111115, -111.34777777777786, -134.02222222222224, -111.16111111111115, -110.14555555555559, -160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2621220216700681, "mean_inference_ms": 2.311839933851889, "mean_action_processing_ms": 0.09685175303527757, "mean_env_wait_ms": 1.66154061285381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144927978515625, "StateBufferConnector_ms": 0.00391697883605957, "ViewRequirementAgentConnector_ms": 0.09934806823730469}, "num_episodes": 24, "episode_return_max": -77.96666666666665, "episode_return_min": -174.53222222222217, "episode_return_mean": -128.75531111111113, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 38700, "num_env_steps_sampled": 39000, "num_env_steps_trained": 38700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 214.0625681549838, "num_env_steps_trained_throughput_per_sec": 199.7917302779849, "timesteps_total": 39000, "num_env_steps_sampled_lifetime": 39000, "num_agent_steps_sampled_lifetime": 39000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 10496.506, "restore_workers_time_ms": 0.014, "training_step_time_ms": 718.269, "sample_time_ms": 700.935, "synch_weights_time_ms": 15.752}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 38700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 260, "num_samples_added_to_queue": 39000}, "done": false, "training_iteration": 17, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-23", "timestamp": 1728649823, "time_this_iter_s": 10.522979497909546, "time_total_s": 177.51845574378967, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46defe0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.51845574378967, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.04666666666667, "ram_util_percent": 56.973333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -88465.109375, "policy_loss": -88630.234375, "entropy": 29.771936416625977, "entropy_coeff": 0.01, "var_gnorm": 16.04981803894043, "vf_loss": 25443.849609375, "vf_explained_var": 0.035940349102020264}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 136.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 41100, "num_env_steps_trained": 40800, "num_agent_steps_sampled": 41100, "num_agent_steps_trained": 40800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 274, "num_samples_added_to_queue": 41100, "learner_queue": {"size_count": 136, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.706, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1405.047, "learner_dequeue_time_ms": 11315.819}}, "env_runners": {"episode_reward_max": -77.96666666666665, "episode_reward_min": -174.53222222222217, "episode_reward_mean": -124.99683333333338, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -174.53222222222217}, "policy_reward_max": {"default_policy": -77.96666666666665}, "policy_reward_mean": {"default_policy": -124.99683333333338}, "custom_metrics": {"num_consolidated_mean": 0.6679999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9559000000000002, "num_overloaded_min": 0.79, "num_overloaded_max": 1.11, "num_moves_mean": 10.001100000000001, "num_moves_min": 9.71, "num_moves_max": 10.31, "mean_accuracy_mean": 41.059973333333325, "mean_accuracy_min": 40.86566666666667, "mean_accuracy_max": 41.37233333333333, "num_model_switches_mean": 6.0203, "num_model_switches_min": 5.52, "num_model_switches_max": 6.34, "num_slav_mean": 0.16046933333333335, "num_slav_min": 0.14031666666666667, "num_slav_max": 0.18166666666666664, "cpu_conserved_cost_mean": 2.5587999999999997, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5579209421936013, "mean_cluster_cpu_util_min": 0.537583747801214, "mean_cluster_cpu_util_max": 0.5776323795913129, "mean_cluster_mem_util_mean": 0.36046552914836816, "mean_cluster_mem_util_min": 0.35098509016475793, "mean_cluster_mem_util_max": 0.3706586978673326, "reward_consolidation_mean_mean": -0.37799999999999995, "reward_consolidation_mean_min": -0.6277777777777778, "reward_consolidation_mean_max": -0.06111111111111117, "reward_illegal_mean_mean": -1.5931666666666664, "reward_illegal_mean_min": -1.85, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9735383333333333, "reward_accuracy_mean_min": 0.5374666666666666, "reward_accuracy_mean_max": 1.4429333333333334, "reward_sla_mean_mean": -0.25234, "reward_sla_mean_min": -0.4075555555555556, "reward_sla_mean_max": -0.13877777777777778, "reward_consolidation_sum_mean": -37.8, "reward_consolidation_sum_min": -62.77777777777778, "reward_consolidation_sum_max": -6.111111111111117, "reward_illegal_sum_mean": -159.31666666666663, "reward_illegal_sum_min": -185.0, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 97.35383333333333, "reward_accuracy_sum_min": 53.74666666666667, "reward_accuracy_sum_max": 144.29333333333335, "reward_sla_sum_mean": -25.234000000000005, "reward_sla_sum_min": -40.75555555555556, "reward_sla_sum_max": -13.877777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4275.0, "global_timestep_min": 2500, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.6822222222222, -165.3355555555555, -161.62999999999985, -135.56777777777788, -137.05777777777783, -116.19444444444456, -132.67666666666673, -126.758888888889, -89.73555555555562, -145.26777777777778, -117.90888888888895, -147.62666666666667, -121.95666666666676, -114.67666666666673, -145.95555555555555, -137.0622222222223, -168.96333333333334, -150.80555555555557, -139.11333333333346, -120.16444444444454, -161.7811111111111, -153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2634402765409774, "mean_inference_ms": 2.330220538990167, "mean_action_processing_ms": 0.09738693175110669, "mean_env_wait_ms": 1.6724520803798304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006974220275878906, "StateBufferConnector_ms": 0.003934621810913086, "ViewRequirementAgentConnector_ms": 0.09938478469848633}, "num_episodes": 21, "episode_return_max": -77.96666666666665, "episode_return_min": -174.53222222222217, "episode_return_mean": -124.99683333333338, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41100, "num_agent_steps_trained": 40800, "num_env_steps_sampled": 41100, "num_env_steps_trained": 40800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 203.95329128767807, "num_env_steps_trained_throughput_per_sec": 203.95329128767807, "timesteps_total": 41100, "num_env_steps_sampled_lifetime": 41100, "num_agent_steps_sampled_lifetime": 41100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 41100, "timers": {"training_iteration_time_ms": 10475.874, "restore_workers_time_ms": 0.017, "training_step_time_ms": 727.295, "sample_time_ms": 709.958, "synch_weights_time_ms": 15.771}, "counters": {"num_env_steps_sampled": 41100, "num_env_steps_trained": 40800, "num_agent_steps_sampled": 41100, "num_agent_steps_trained": 40800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 274, "num_samples_added_to_queue": 41100}, "done": false, "training_iteration": 18, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-34", "timestamp": 1728649834, "time_this_iter_s": 10.307317018508911, "time_total_s": 187.82577276229858, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46dfaf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 187.82577276229858, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.553333333333335, "ram_util_percent": 56.393333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -106224.8359375, "policy_loss": -106458.03125, "entropy": 29.756282806396484, "entropy_coeff": 0.01, "var_gnorm": 16.05709457397461, "vf_loss": 32245.8671875, "vf_explained_var": 0.0479775071144104}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 144.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 43350, "num_env_steps_trained": 43200, "num_agent_steps_sampled": 43350, "num_agent_steps_trained": 43200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 289, "num_samples_added_to_queue": 43200, "learner_queue": {"size_count": 144, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.493, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1334.693, "learner_dequeue_time_ms": 11315.819}}, "env_runners": {"episode_reward_max": -77.96666666666665, "episode_reward_min": -174.53222222222217, "episode_reward_mean": -119.59421111111115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -174.53222222222217}, "policy_reward_max": {"default_policy": -77.96666666666665}, "policy_reward_mean": {"default_policy": -119.59421111111115}, "custom_metrics": {"num_consolidated_mean": 0.6704000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.79, "num_overloaded_mean": 0.9400000000000002, "num_overloaded_min": 0.79, "num_overloaded_max": 1.11, "num_moves_mean": 10.004100000000001, "num_moves_min": 9.75, "num_moves_max": 10.31, "mean_accuracy_mean": 41.05839, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.37233333333333, "num_model_switches_mean": 6.001799999999999, "num_model_switches_min": 5.52, "num_model_switches_max": 6.34, "num_slav_mean": 0.16026566666666664, "num_slav_min": 0.14031666666666667, "num_slav_max": 0.18166666666666664, "cpu_conserved_cost_mean": 2.5433999999999997, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.14, "mean_cluster_cpu_util_mean": 0.5562435664017883, "mean_cluster_cpu_util_min": 0.5348539229276993, "mean_cluster_cpu_util_max": 0.5776323795913129, "mean_cluster_mem_util_mean": 0.35957567349809116, "mean_cluster_mem_util_min": 0.35067720801400726, "mean_cluster_mem_util_max": 0.3706586978673326, "reward_consolidation_mean_mean": -0.3858333333333334, "reward_consolidation_mean_min": -0.6277777777777778, "reward_consolidation_mean_max": -0.06111111111111117, "reward_illegal_mean_mean": -1.566666666666666, "reward_illegal_mean_min": -1.85, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 1.0185956666666667, "reward_accuracy_mean_min": 0.5374666666666666, "reward_accuracy_mean_max": 1.4429333333333334, "reward_sla_mean_mean": -0.26203777777777776, "reward_sla_mean_min": -0.4075555555555556, "reward_sla_mean_max": -0.13877777777777778, "reward_consolidation_sum_mean": -38.583333333333336, "reward_consolidation_sum_min": -62.77777777777778, "reward_consolidation_sum_max": -6.111111111111117, "reward_illegal_sum_mean": -156.66666666666663, "reward_illegal_sum_min": -185.0, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 101.85956666666665, "reward_accuracy_sum_min": 53.74666666666667, "reward_accuracy_sum_max": 144.29333333333335, "reward_sla_sum_mean": -26.20377777777778, "reward_sla_sum_min": -40.75555555555556, "reward_sla_sum_max": -13.877777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4969.0, "global_timestep_min": 3100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-153.77333333333326, -142.98111111111112, -139.45555555555563, -146.79666666666662, -81.73555555555555, -138.53000000000003, -129.50444444444446, -100.92000000000006, -90.35111111111111, -123.80111111111117, -129.5822222222223, -133.30555555555557, -132.91333333333338, -109.53000000000002, -83.34444444444449, -136.91333333333338, -135.23444444444448, -127.65555555555568, -146.48777777777784, -128.88888888888897, -174.53222222222217, -109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2637953020792213, "mean_inference_ms": 2.3325356242252933, "mean_action_processing_ms": 0.0975729193605272, "mean_env_wait_ms": 1.6764188774989128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062143802642822266, "StateBufferConnector_ms": 0.003675699234008789, "ViewRequirementAgentConnector_ms": 0.09373307228088379}, "num_episodes": 21, "episode_return_max": -77.96666666666665, "episode_return_min": -174.53222222222217, "episode_return_mean": -119.59421111111115, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43350, "num_agent_steps_trained": 43200, "num_env_steps_sampled": 43350, "num_env_steps_trained": 43200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 213.7227485029395, "num_env_steps_trained_throughput_per_sec": 227.9709317364688, "timesteps_total": 43350, "num_env_steps_sampled_lifetime": 43350, "num_agent_steps_sampled_lifetime": 43350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 43350, "timers": {"training_iteration_time_ms": 10440.783, "restore_workers_time_ms": 0.012, "training_step_time_ms": 701.347, "sample_time_ms": 683.061, "synch_weights_time_ms": 16.576}, "counters": {"num_env_steps_sampled": 43350, "num_env_steps_trained": 43200, "num_agent_steps_sampled": 43350, "num_agent_steps_trained": 43200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 289, "num_samples_added_to_queue": 43200}, "done": false, "training_iteration": 19, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-44", "timestamp": 1728649844, "time_this_iter_s": 10.553906679153442, "time_total_s": 198.37967944145203, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452dff0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.37967944145203, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.966666666666672, "ram_util_percent": 56.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -102196.34375, "policy_loss": -102397.8515625, "entropy": 29.73198890686035, "entropy_coeff": 0.01, "var_gnorm": 16.066255569458008, "vf_loss": 29070.685546875, "vf_explained_var": 0.06349873542785645}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 45450, "num_env_steps_trained": 45300, "num_agent_steps_sampled": 45450, "num_agent_steps_trained": 45300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 303, "num_samples_added_to_queue": 45300, "learner_queue": {"size_count": 151, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.079, "learner_load_time_ms": 0.32, "learner_load_wait_time_ms": 1363.559, "learner_dequeue_time_ms": 11384.429}}, "env_runners": {"episode_reward_max": -63.953333333333326, "episode_reward_min": -152.90888888888892, "episode_reward_mean": -115.89455555555561, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -152.90888888888892}, "policy_reward_max": {"default_policy": -63.953333333333326}, "policy_reward_mean": {"default_policy": -115.89455555555561}, "custom_metrics": {"num_consolidated_mean": 0.6753000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9292999999999999, "num_overloaded_min": 0.79, "num_overloaded_max": 1.07, "num_moves_mean": 10.0089, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 41.051233333333336, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.37233333333333, "num_model_switches_mean": 6.0029, "num_model_switches_min": 5.52, "num_model_switches_max": 6.34, "num_slav_mean": 0.16058050000000001, "num_slav_min": 0.14031666666666667, "num_slav_max": 0.17654999999999998, "cpu_conserved_cost_mean": 2.5504, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.14, "mean_cluster_cpu_util_mean": 0.5548577340990205, "mean_cluster_cpu_util_min": 0.5348539229276993, "mean_cluster_cpu_util_max": 0.5709550128717991, "mean_cluster_mem_util_mean": 0.35893457652164246, "mean_cluster_mem_util_min": 0.35067720801400726, "mean_cluster_mem_util_max": 0.36698009002124055, "reward_consolidation_mean_mean": -0.3883888888888889, "reward_consolidation_mean_min": -0.6277777777777778, "reward_consolidation_mean_max": -0.06111111111111117, "reward_illegal_mean_mean": -1.5488333333333333, "reward_illegal_mean_min": -1.7833333333333328, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 1.0495466666666666, "reward_accuracy_mean_min": 0.5374666666666666, "reward_accuracy_mean_max": 1.4201333333333332, "reward_sla_mean_mean": -0.27127, "reward_sla_mean_min": -0.4046666666666667, "reward_sla_mean_max": -0.13877777777777778, "reward_consolidation_sum_mean": -38.83888888888889, "reward_consolidation_sum_min": -62.77777777777778, "reward_consolidation_sum_max": -6.111111111111117, "reward_illegal_sum_mean": -154.88333333333333, "reward_illegal_sum_min": -178.3333333333333, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 104.95466666666665, "reward_accuracy_sum_min": 53.74666666666667, "reward_accuracy_sum_max": 142.01333333333332, "reward_sla_sum_mean": -27.127, "reward_sla_sum_min": -40.46666666666667, "reward_sla_sum_max": -13.877777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5669.0, "global_timestep_min": 3800, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-109.85222222222225, -107.26444444444452, -118.02111111111117, -102.06555555555562, -101.71444444444442, -134.52888888888896, -133.71111111111114, -131.17666666666676, -118.53777777777792, -146.77222222222213, -93.86555555555563, -102.74777777777784, -77.96666666666665, -105.9933333333334, -110.64444444444447, -133.9477777777778, -130.67000000000004, -122.63000000000005, -147.11222222222227, -112.7666666666667, -113.53777777777789, -136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26423201501726273, "mean_inference_ms": 2.3378495903703542, "mean_action_processing_ms": 0.09781902211125766, "mean_env_wait_ms": 1.6812878458013687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006356716156005859, "StateBufferConnector_ms": 0.003755807876586914, "ViewRequirementAgentConnector_ms": 0.0964968204498291}, "num_episodes": 21, "episode_return_max": -63.953333333333326, "episode_return_min": -152.90888888888892, "episode_return_mean": -115.89455555555561, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45450, "num_agent_steps_trained": 45300, "num_env_steps_sampled": 45450, "num_env_steps_trained": 45300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 204.5453313602505, "num_env_steps_trained_throughput_per_sec": 204.5453313602505, "timesteps_total": 45450, "num_env_steps_sampled_lifetime": 45450, "num_agent_steps_sampled_lifetime": 45450, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 45450, "timers": {"training_iteration_time_ms": 10440.165, "restore_workers_time_ms": 0.013, "training_step_time_ms": 758.353, "sample_time_ms": 740.422, "synch_weights_time_ms": 16.188}, "counters": {"num_env_steps_sampled": 45450, "num_env_steps_trained": 45300, "num_agent_steps_sampled": 45450, "num_agent_steps_trained": 45300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 303, "num_samples_added_to_queue": 45300}, "done": false, "training_iteration": 20, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-30-54", "timestamp": 1728649854, "time_this_iter_s": 10.287843227386475, "time_total_s": 208.6675226688385, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452d3f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.6675226688385, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.81333333333333, "ram_util_percent": 56.413333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -87877.046875, "policy_loss": -88009.953125, "entropy": 29.687057495117188, "entropy_coeff": 0.01, "var_gnorm": 16.076749801635742, "vf_loss": 22196.76171875, "vf_explained_var": 0.08302325010299683}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 47550, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47550, "num_agent_steps_trained": 47400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 317, "num_samples_added_to_queue": 47400, "learner_queue": {"size_count": 158, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.016, "learner_load_time_ms": 0.302, "learner_load_wait_time_ms": 1399.597, "learner_dequeue_time_ms": 11453.05}}, "env_runners": {"episode_reward_max": -61.68999999999997, "episode_reward_min": -152.90888888888892, "episode_reward_mean": -111.0461666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -152.90888888888892}, "policy_reward_max": {"default_policy": -61.68999999999997}, "policy_reward_mean": {"default_policy": -111.0461666666667}, "custom_metrics": {"num_consolidated_mean": 0.6794, "num_consolidated_min": 0.54, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9143000000000001, "num_overloaded_min": 0.75, "num_overloaded_max": 1.04, "num_moves_mean": 10.0041, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 41.039896666666664, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.37233333333333, "num_model_switches_mean": 5.9785, "num_model_switches_min": 5.52, "num_model_switches_max": 6.34, "num_slav_mean": 0.16073600000000002, "num_slav_min": 0.14329999999999998, "num_slav_max": 0.1782166666666666, "cpu_conserved_cost_mean": 2.5514, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.14, "mean_cluster_cpu_util_mean": 0.5535121012959202, "mean_cluster_cpu_util_min": 0.5348539229276993, "mean_cluster_cpu_util_max": 0.5698781859503709, "mean_cluster_mem_util_mean": 0.3585243478626683, "mean_cluster_mem_util_min": 0.35067720801400726, "mean_cluster_mem_util_max": 0.36525603562099945, "reward_consolidation_mean_mean": -0.39949999999999997, "reward_consolidation_mean_min": -0.7444444444444442, "reward_consolidation_mean_max": -0.06111111111111117, "reward_illegal_mean_mean": -1.523833333333333, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 1.0958616666666665, "reward_accuracy_mean_min": 0.5374666666666666, "reward_accuracy_mean_max": 1.5813666666666666, "reward_sla_mean_mean": -0.28299, "reward_sla_mean_min": -0.4046666666666667, "reward_sla_mean_max": -0.13877777777777778, "reward_consolidation_sum_mean": -39.95, "reward_consolidation_sum_min": -74.44444444444443, "reward_consolidation_sum_max": -6.111111111111117, "reward_illegal_sum_mean": -152.3833333333333, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 109.58616666666667, "reward_accuracy_sum_min": 53.74666666666667, "reward_accuracy_sum_max": 158.13666666666666, "reward_sla_sum_mean": -28.29900000000001, "reward_sla_sum_min": -40.46666666666667, "reward_sla_sum_max": -13.877777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5894.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-136.69444444444446, -132.57333333333338, -149.2333333333333, -132.52777777777789, -111.49666666666681, -136.5488888888889, -83.14111111111112, -132.1155555555557, -122.15888888888897, -132.0488888888889, -136.36888888888893, -108.55555555555557, -125.21444444444447, -125.22666666666669, -152.90888888888892, -138.90666666666664, -99.79444444444448, -131.01666666666677, -99.15555555555555, -97.67111111111114, -91.26444444444446, -103.91777777777784, -138.47555555555564, -121.74444444444447, -127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2646667326960666, "mean_inference_ms": 2.3417083940933163, "mean_action_processing_ms": 0.09803684890088489, "mean_env_wait_ms": 1.6856042416117754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006383419036865234, "StateBufferConnector_ms": 0.003751516342163086, "ViewRequirementAgentConnector_ms": 0.09726500511169434}, "num_episodes": 21, "episode_return_max": -61.68999999999997, "episode_return_min": -152.90888888888892, "episode_return_mean": -111.0461666666667, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47550, "num_agent_steps_trained": 47400, "num_env_steps_sampled": 47550, "num_env_steps_trained": 47400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 207.38219963086695, "num_env_steps_trained_throughput_per_sec": 207.38219963086695, "timesteps_total": 47550, "num_env_steps_sampled_lifetime": 47550, "num_agent_steps_sampled_lifetime": 47550, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 47550, "timers": {"training_iteration_time_ms": 10399.298, "restore_workers_time_ms": 0.014, "training_step_time_ms": 726.227, "sample_time_ms": 709.798, "synch_weights_time_ms": 14.788}, "counters": {"num_env_steps_sampled": 47550, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47550, "num_agent_steps_trained": 47400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 317, "num_samples_added_to_queue": 47400}, "done": false, "training_iteration": 21, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-05", "timestamp": 1728649865, "time_this_iter_s": 10.14090609550476, "time_total_s": 218.80842876434326, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452c160>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.80842876434326, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.792857142857144, "ram_util_percent": 56.964285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -81190.5390625, "policy_loss": -81300.0859375, "entropy": 29.634244918823242, "entropy_coeff": 0.01, "var_gnorm": 16.0887451171875, "vf_loss": 19845.03125, "vf_explained_var": 0.09468197822570801}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 165.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 332, "num_samples_added_to_queue": 49800, "learner_queue": {"size_count": 165, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.342, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 1343.209, "learner_dequeue_time_ms": 11538.236}}, "env_runners": {"episode_reward_max": -51.06999999999998, "episode_reward_min": -148.52444444444444, "episode_reward_mean": -102.04473333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -148.52444444444444}, "policy_reward_max": {"default_policy": -51.06999999999998}, "policy_reward_mean": {"default_policy": -102.04473333333337}, "custom_metrics": {"num_consolidated_mean": 0.6958000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.8861000000000001, "num_overloaded_min": 0.71, "num_overloaded_max": 1.04, "num_moves_mean": 9.9811, "num_moves_min": 9.66, "num_moves_max": 10.26, "mean_accuracy_mean": 41.031156666666675, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 5.9666999999999994, "num_model_switches_min": 5.66, "num_model_switches_max": 6.31, "num_slav_mean": 0.160725, "num_slav_min": 0.14235, "num_slav_max": 0.1782166666666666, "cpu_conserved_cost_mean": 2.5673999999999997, "cpu_conserved_cost_min": 2.02, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5503987791709476, "mean_cluster_cpu_util_min": 0.5295905853646947, "mean_cluster_cpu_util_max": 0.5665529318515672, "mean_cluster_mem_util_mean": 0.3571066789086943, "mean_cluster_mem_util_min": 0.3452320820416775, "mean_cluster_mem_util_max": 0.3651433764961681, "reward_consolidation_mean_mean": -0.4047777777777778, "reward_consolidation_mean_min": -0.7444444444444442, "reward_consolidation_mean_max": -0.12222222222222229, "reward_illegal_mean_mean": -1.4768333333333328, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.1833333333333331, "reward_accuracy_mean_mean": 1.1614126666666666, "reward_accuracy_mean_min": 0.7707666666666667, "reward_accuracy_mean_max": 1.7160666666666669, "reward_sla_mean_mean": -0.3002488888888889, "reward_sla_mean_min": -0.47644444444444445, "reward_sla_mean_max": -0.17366666666666666, "reward_consolidation_sum_mean": -40.47777777777779, "reward_consolidation_sum_min": -74.44444444444443, "reward_consolidation_sum_max": -12.222222222222229, "reward_illegal_sum_mean": -147.6833333333333, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -118.33333333333331, "reward_accuracy_sum_mean": 116.14126666666665, "reward_accuracy_sum_min": 77.07666666666667, "reward_accuracy_sum_max": 171.60666666666668, "reward_sla_sum_mean": -30.024888888888892, "reward_sla_sum_min": -47.644444444444446, "reward_sla_sum_max": -17.366666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4829.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-127.5722222222223, -135.65111111111122, -125.99222222222227, -84.07444444444448, -119.62777777777794, -127.50111111111117, -121.35444444444451, -148.52444444444444, -106.32666666666671, -113.62777777777785, -123.29666666666675, -100.26777777777781, -88.42222222222215, -99.6611111111111, -127.44666666666677, -112.5844444444445, -125.53, -125.36444444444453, -86.40777777777785, -111.9688888888889, -128.09333333333342, -100.53444444444455, -142.7888888888889, -97.32444444444451, -115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26514074735649956, "mean_inference_ms": 2.3492205928763847, "mean_action_processing_ms": 0.0982840673005314, "mean_env_wait_ms": 1.6906211361358618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062868595123291016, "StateBufferConnector_ms": 0.0036916732788085938, "ViewRequirementAgentConnector_ms": 0.09525370597839355}, "num_episodes": 24, "episode_return_max": -51.06999999999998, "episode_return_min": -148.52444444444444, "episode_return_mean": -102.04473333333337, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 215.27977555861412, "num_env_steps_trained_throughput_per_sec": 200.92779052137317, "timesteps_total": 49800, "num_env_steps_sampled_lifetime": 49800, "num_agent_steps_sampled_lifetime": 49800, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 49800, "timers": {"training_iteration_time_ms": 10385.486, "restore_workers_time_ms": 0.014, "training_step_time_ms": 687.972, "sample_time_ms": 670.677, "synch_weights_time_ms": 15.678}, "counters": {"num_env_steps_sampled": 49800, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 332, "num_samples_added_to_queue": 49800}, "done": false, "training_iteration": 22, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-15", "timestamp": 1728649875, "time_this_iter_s": 10.465453624725342, "time_total_s": 229.2738823890686, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46dd780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.2738823890686, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.513333333333332, "ram_util_percent": 56.71999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -26754.494140625, "policy_loss": -26756.36328125, "entropy": 29.53615951538086, "entropy_coeff": 0.01, "var_gnorm": 16.10449981689453, "vf_loss": 9047.7734375, "vf_explained_var": 0.047086119651794434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 52200, "num_env_steps_trained": 51900, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 348, "num_samples_added_to_queue": 52200, "learner_queue": {"size_count": 173, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.042, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1244.087, "learner_dequeue_time_ms": 11555.896}}, "env_runners": {"episode_reward_max": -20.990000000000016, "episode_reward_min": -134.84888888888884, "episode_reward_mean": -89.17615555555558, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -134.84888888888884}, "policy_reward_max": {"default_policy": -20.990000000000016}, "policy_reward_mean": {"default_policy": -89.17615555555558}, "custom_metrics": {"num_consolidated_mean": 0.6997, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.8432999999999999, "num_overloaded_min": 0.62, "num_overloaded_max": 1.04, "num_moves_mean": 9.9659, "num_moves_min": 9.66, "num_moves_max": 10.26, "mean_accuracy_mean": 41.00804, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.9909, "num_model_switches_min": 5.66, "num_model_switches_max": 6.53, "num_slav_mean": 0.16031116666666667, "num_slav_min": 0.14235, "num_slav_max": 0.1782166666666666, "cpu_conserved_cost_mean": 2.5308, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.545465850725147, "mean_cluster_cpu_util_min": 0.5254584410220466, "mean_cluster_cpu_util_max": 0.5649393718735919, "mean_cluster_mem_util_mean": 0.35513314744969704, "mean_cluster_mem_util_min": 0.3452320820416775, "mean_cluster_mem_util_max": 0.3651433764961681, "reward_consolidation_mean_mean": -0.42811111111111116, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.12222222222222229, "reward_illegal_mean_mean": -1.4054999999999995, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.0333333333333332, "reward_accuracy_mean_mean": 1.2692573333333332, "reward_accuracy_mean_min": 0.8232666666666667, "reward_accuracy_mean_max": 1.9872999999999998, "reward_sla_mean_mean": -0.3274077777777778, "reward_sla_mean_min": -0.49277777777777776, "reward_sla_mean_max": -0.17366666666666666, "reward_consolidation_sum_mean": -42.8111111111111, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -12.222222222222229, "reward_illegal_sum_mean": -140.54999999999995, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -103.33333333333333, "reward_accuracy_sum_mean": 126.92573333333331, "reward_accuracy_sum_min": 82.32666666666667, "reward_accuracy_sum_max": 198.73, "reward_sla_sum_mean": -32.74077777777777, "reward_sla_sum_min": -49.27777777777778, "reward_sla_sum_max": -17.366666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3759.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-115.08111111111116, -111.59888888888896, -122.7744444444445, -79.94999999999999, -118.92666666666676, -105.19555555555559, -124.59666666666674, -107.33333333333339, -89.09777777777778, -124.40000000000006, -114.57555555555558, -125.16444444444458, -85.57000000000005, -120.69222222222236, -103.55111111111118, -86.2344444444445, -91.39666666666673, -99.67444444444452, -126.91444444444446, -126.08333333333348, -86.59111111111116, -122.93888888888897, -134.84888888888884, -132.12111111111116, -128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26532861380740885, "mean_inference_ms": 2.3529418332374603, "mean_action_processing_ms": 0.09838058799371381, "mean_env_wait_ms": 1.6928970430210595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006165266036987305, "StateBufferConnector_ms": 0.003610372543334961, "ViewRequirementAgentConnector_ms": 0.09371161460876465}, "num_episodes": 24, "episode_return_max": -20.990000000000016, "episode_return_min": -134.84888888888884, "episode_return_mean": -89.17615555555558, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51900, "num_env_steps_sampled": 52200, "num_env_steps_trained": 51900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 232.3801779596211, "num_env_steps_trained_throughput_per_sec": 232.3801779596211, "timesteps_total": 52200, "num_env_steps_sampled_lifetime": 52200, "num_agent_steps_sampled_lifetime": 52200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 52200, "timers": {"training_iteration_time_ms": 10363.616, "restore_workers_time_ms": 0.013, "training_step_time_ms": 648.284, "sample_time_ms": 632.549, "synch_weights_time_ms": 14.227}, "counters": {"num_env_steps_sampled": 52200, "num_env_steps_trained": 51900, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 51900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 348, "num_samples_added_to_queue": 52200}, "done": false, "training_iteration": 23, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-26", "timestamp": 1728649886, "time_this_iter_s": 10.342381477355957, "time_total_s": 239.61626386642456, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452e4a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.61626386642456, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.240000000000006, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -18226.57421875, "policy_loss": -18186.734375, "entropy": 29.408769607543945, "entropy_coeff": 0.01, "var_gnorm": 16.125986099243164, "vf_loss": 4838.6630859375, "vf_explained_var": 0.07097148895263672}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 182.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 54750, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54750, "num_agent_steps_trained": 54600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 365, "num_samples_added_to_queue": 54600, "learner_queue": {"size_count": 182, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.582, "learner_load_time_ms": 0.349, "learner_load_wait_time_ms": 1193.489, "learner_dequeue_time_ms": 11513.054}}, "env_runners": {"episode_reward_max": -6.4544444444444355, "episode_reward_min": -132.9444444444445, "episode_reward_mean": -75.13832222222224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -132.9444444444445}, "policy_reward_max": {"default_policy": -6.4544444444444355}, "policy_reward_mean": {"default_policy": -75.13832222222224}, "custom_metrics": {"num_consolidated_mean": 0.7076, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.7933000000000001, "num_overloaded_min": 0.59, "num_overloaded_max": 1.04, "num_moves_mean": 9.9542, "num_moves_min": 9.65, "num_moves_max": 10.29, "mean_accuracy_mean": 40.98258, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.9761000000000015, "num_model_switches_min": 5.59, "num_model_switches_max": 6.53, "num_slav_mean": 0.15870366666666663, "num_slav_min": 0.141, "num_slav_max": 0.1782166666666666, "cpu_conserved_cost_mean": 2.5079999999999996, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5404658713358033, "mean_cluster_cpu_util_min": 0.5175052317203663, "mean_cluster_cpu_util_max": 0.5636095831434029, "mean_cluster_mem_util_mean": 0.3529153403674762, "mean_cluster_mem_util_min": 0.34255944092826995, "mean_cluster_mem_util_max": 0.36310933903097103, "reward_consolidation_mean_mean": -0.4694444444444445, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.17222222222222228, "reward_illegal_mean_mean": -1.3221666666666665, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -0.9833333333333333, "reward_accuracy_mean_mean": 1.3994923333333333, "reward_accuracy_mean_min": 0.8232666666666667, "reward_accuracy_mean_max": 1.9872999999999998, "reward_sla_mean_mean": -0.3592644444444445, "reward_sla_mean_min": -0.5354444444444444, "reward_sla_mean_max": -0.21588888888888888, "reward_consolidation_sum_mean": -46.944444444444436, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -17.22222222222223, "reward_illegal_sum_mean": -132.2166666666666, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -98.33333333333333, "reward_accuracy_sum_mean": 139.94923333333335, "reward_accuracy_sum_min": 82.32666666666667, "reward_accuracy_sum_max": 198.73, "reward_sla_sum_mean": -35.92644444444445, "reward_sla_sum_min": -53.54444444444444, "reward_sla_sum_max": -21.58888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2683.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-128.3111111111111, -114.76333333333336, -122.41666666666674, -90.54777777777784, -63.953333333333326, -115.4600000000001, -124.46222222222232, -61.68999999999997, -132.9444444444445, -66.89555555555556, -110.9511111111111, -127.20222222222223, -78.79666666666671, -103.58555555555557, -107.50222222222224, -116.58000000000007, -82.96777777777775, -111.29111111111112, -75.0522222222222, -115.9944444444445, -109.4700000000001, -64.29000000000003, -64.9311111111111, -78.08555555555559, -108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26536437024675374, "mean_inference_ms": 2.3534292358430133, "mean_action_processing_ms": 0.09835112299930053, "mean_env_wait_ms": 1.6930098419274588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006016254425048828, "StateBufferConnector_ms": 0.003529071807861328, "ViewRequirementAgentConnector_ms": 0.0917210578918457}, "num_episodes": 24, "episode_return_max": -6.4544444444444355, "episode_return_min": -132.9444444444445, "episode_return_mean": -75.13832222222224, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54750, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 54750, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 242.41303464629837, "num_env_steps_trained_throughput_per_sec": 256.67262491961003, "timesteps_total": 54750, "num_env_steps_sampled_lifetime": 54750, "num_agent_steps_sampled_lifetime": 54750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 54750, "timers": {"training_iteration_time_ms": 10342.972, "restore_workers_time_ms": 0.012, "training_step_time_ms": 617.101, "sample_time_ms": 601.542, "synch_weights_time_ms": 14.136}, "counters": {"num_env_steps_sampled": 54750, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54750, "num_agent_steps_trained": 54600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 365, "num_samples_added_to_queue": 54600}, "done": false, "training_iteration": 24, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-36", "timestamp": 1728649896, "time_this_iter_s": 10.528998374938965, "time_total_s": 250.14526224136353, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452df60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.14526224136353, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.113333333333333, "ram_util_percent": 56.11333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 15263.224609375, "policy_loss": 15292.8017578125, "entropy": 29.194032669067383, "entropy_coeff": 0.01, "var_gnorm": 16.147775650024414, "vf_loss": 5800.478515625, "vf_explained_var": -0.0155411958694458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 190.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 57150, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 57000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 57000, "learner_queue": {"size_count": 190, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.263, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1176.147, "learner_dequeue_time_ms": 11398.749}}, "env_runners": {"episode_reward_max": 43.810000000000066, "episode_reward_min": -119.37222222222223, "episode_reward_mean": -55.63783333333334, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -119.37222222222223}, "policy_reward_max": {"default_policy": 43.810000000000066}, "policy_reward_mean": {"default_policy": -55.63783333333334}, "custom_metrics": {"num_consolidated_mean": 0.7254, "num_consolidated_min": 0.55, "num_consolidated_max": 0.98, "num_overloaded_mean": 0.7306999999999999, "num_overloaded_min": 0.52, "num_overloaded_max": 0.93, "num_moves_mean": 9.9275, "num_moves_min": 9.65, "num_moves_max": 10.29, "mean_accuracy_mean": 40.95414333333334, "mean_accuracy_min": 40.61866666666666, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.9807, "num_model_switches_min": 5.59, "num_model_switches_max": 6.53, "num_slav_mean": 0.15691733333333335, "num_slav_min": 0.13841666666666666, "num_slav_max": 0.1744666666666667, "cpu_conserved_cost_mean": 2.4844, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5333548133366164, "mean_cluster_cpu_util_min": 0.5055754890348871, "mean_cluster_cpu_util_max": 0.5622207967404859, "mean_cluster_mem_util_mean": 0.3494292619316714, "mean_cluster_mem_util_min": 0.3351489431743162, "mean_cluster_mem_util_max": 0.36131821808892334, "reward_consolidation_mean_mean": -0.5016111111111112, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.21111111111111117, "reward_illegal_mean_mean": -1.2178333333333333, "reward_illegal_mean_min": -1.5499999999999998, "reward_illegal_mean_max": -0.8666666666666665, "reward_accuracy_mean_mean": 1.5601216666666664, "reward_accuracy_mean_min": 0.9825999999999999, "reward_accuracy_mean_max": 2.275633333333333, "reward_sla_mean_mean": -0.39705555555555555, "reward_sla_mean_min": -0.564111111111111, "reward_sla_mean_max": -0.2381111111111111, "reward_consolidation_sum_mean": -50.16111111111111, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -21.111111111111118, "reward_illegal_sum_mean": -121.78333333333332, "reward_illegal_sum_min": -154.99999999999997, "reward_illegal_sum_max": -86.66666666666664, "reward_accuracy_sum_mean": 156.01216666666664, "reward_accuracy_sum_min": 98.25999999999999, "reward_accuracy_sum_max": 227.5633333333333, "reward_sla_sum_mean": -39.705555555555556, "reward_sla_sum_min": -56.411111111111104, "reward_sla_sum_max": -23.81111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-108.2577777777778, -78.62, -93.08555555555566, -82.49444444444444, -98.36666666666666, -98.04111111111115, -71.64666666666665, -51.06999999999998, -119.37222222222223, -70.02888888888886, -101.34777777777778, -52.06444444444439, -87.59444444444445, -67.70444444444443, -90.68444444444448, -94.37888888888897, -72.73222222222223, -62.19666666666662, -92.33777777777783, -81.23333333333339, -108.90222222222226, -101.00666666666672, -76.95444444444445, -97.05000000000004, -107.64666666666672, -68.10666666666664, -100.6755555555556, -67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2649167446037838, "mean_inference_ms": 2.348872385801844, "mean_action_processing_ms": 0.09818263661716348, "mean_env_wait_ms": 1.6902269723078682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005844831466674805, "StateBufferConnector_ms": 0.003427743911743164, "ViewRequirementAgentConnector_ms": 0.08803153038024902}, "num_episodes": 24, "episode_return_max": 43.810000000000066, "episode_return_min": -119.37222222222223, "episode_return_mean": -55.63783333333334, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 57000, "num_env_steps_sampled": 57150, "num_env_steps_trained": 57000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.65153389527998, "num_env_steps_trained_throughput_per_sec": 237.65153389527998, "timesteps_total": 57150, "num_env_steps_sampled_lifetime": 57150, "num_agent_steps_sampled_lifetime": 57150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 57150, "timers": {"training_iteration_time_ms": 10324.265, "restore_workers_time_ms": 0.013, "training_step_time_ms": 621.399, "sample_time_ms": 606.255, "synch_weights_time_ms": 13.761}, "counters": {"num_env_steps_sampled": 57150, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 57000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 57000}, "done": false, "training_iteration": 25, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-46", "timestamp": 1728649906, "time_this_iter_s": 10.108566761016846, "time_total_s": 260.25382900238037, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46ddab0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.25382900238037, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.119999999999997, "ram_util_percent": 55.87333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 84847.4609375, "policy_loss": 84710.1796875, "entropy": 28.856616973876953, "entropy_coeff": 0.01, "var_gnorm": 16.17337417602539, "vf_loss": 22385.20703125, "vf_explained_var": -0.1888282299041748}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 198.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 59700, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59700, "num_agent_steps_trained": 59400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 398, "num_samples_added_to_queue": 59700, "learner_queue": {"size_count": 198, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.639, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 1177.744, "learner_dequeue_time_ms": 11019.999}}, "env_runners": {"episode_reward_max": 113.90555555555548, "episode_reward_min": -98.39666666666669, "episode_reward_mean": -22.438233333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -98.39666666666669}, "policy_reward_max": {"default_policy": 113.90555555555548}, "policy_reward_mean": {"default_policy": -22.438233333333336}, "custom_metrics": {"num_consolidated_mean": 0.7606999999999999, "num_consolidated_min": 0.55, "num_consolidated_max": 0.99, "num_overloaded_mean": 0.6425, "num_overloaded_min": 0.39, "num_overloaded_max": 0.89, "num_moves_mean": 9.8697, "num_moves_min": 9.49, "num_moves_max": 10.29, "mean_accuracy_mean": 40.906643333333335, "mean_accuracy_min": 40.61866666666666, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.973399999999999, "num_model_switches_min": 5.55, "num_model_switches_max": 6.53, "num_slav_mean": 0.153996, "num_slav_min": 0.1345666666666667, "num_slav_max": 0.1705, "cpu_conserved_cost_mean": 2.4768, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.12, "mean_cluster_cpu_util_mean": 0.5240816401122328, "mean_cluster_cpu_util_min": 0.49225349980578287, "mean_cluster_cpu_util_max": 0.5533810175586129, "mean_cluster_mem_util_mean": 0.344761952454505, "mean_cluster_mem_util_min": 0.3280703552412526, "mean_cluster_mem_util_max": 0.3604859858922471, "reward_consolidation_mean_mean": -0.5153888888888889, "reward_consolidation_mean_min": -0.85, "reward_consolidation_mean_max": -0.13333333333333353, "reward_illegal_mean_mean": -1.070833333333333, "reward_illegal_mean_min": -1.4833333333333332, "reward_illegal_mean_max": -0.65, "reward_accuracy_mean_mean": 1.815037666666666, "reward_accuracy_mean_min": 1.0565666666666664, "reward_accuracy_mean_max": 2.6114000000000006, "reward_sla_mean_mean": -0.45319777777777775, "reward_sla_mean_min": -0.657777777777778, "reward_sla_mean_max": -0.24799999999999997, "reward_consolidation_sum_mean": -51.538888888888884, "reward_consolidation_sum_min": -85.0, "reward_consolidation_sum_max": -13.333333333333353, "reward_illegal_sum_mean": -107.08333333333331, "reward_illegal_sum_min": -148.33333333333331, "reward_illegal_sum_max": -65.0, "reward_accuracy_sum_mean": 181.50376666666668, "reward_accuracy_sum_min": 105.65666666666665, "reward_accuracy_sum_max": 261.14000000000004, "reward_sla_sum_mean": -45.31977777777778, "reward_sla_sum_min": -65.7777777777778, "reward_sla_sum_max": -24.799999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2683.0, "global_timestep_min": 1000, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-67.47444444444444, -30.10333333333335, -98.39666666666669, -80.11555555555559, -50.876666666666644, -49.354444444444404, -69.65333333333328, -61.59888888888888, -64.87444444444445, -71.36111111111107, -83.89444444444445, -86.76333333333335, -48.26888888888884, -47.66111111111106, -58.572222222222244, -47.2022222222222, -47.244444444444426, -62.38333333333333, -46.658888888888825, -62.17333333333331, -81.02222222222223, -73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26404422921977994, "mean_inference_ms": 2.339611800491874, "mean_action_processing_ms": 0.09786773489482538, "mean_env_wait_ms": 1.6847788303165594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00577092170715332, "StateBufferConnector_ms": 0.003341197967529297, "ViewRequirementAgentConnector_ms": 0.08651161193847656}, "num_episodes": 27, "episode_return_max": 113.90555555555548, "episode_return_min": -98.39666666666669, "episode_return_mean": -22.438233333333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59700, "num_agent_steps_trained": 59400, "num_env_steps_sampled": 59700, "num_env_steps_trained": 59400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.70643727363878, "num_env_steps_trained_throughput_per_sec": 229.3707644928365, "timesteps_total": 59700, "num_env_steps_sampled_lifetime": 59700, "num_agent_steps_sampled_lifetime": 59700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 59700, "timers": {"training_iteration_time_ms": 10358.896, "restore_workers_time_ms": 0.012, "training_step_time_ms": 617.845, "sample_time_ms": 601.897, "synch_weights_time_ms": 14.512}, "counters": {"num_env_steps_sampled": 59700, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59700, "num_agent_steps_trained": 59400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 398, "num_samples_added_to_queue": 59700}, "done": false, "training_iteration": 26, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-31-57", "timestamp": 1728649917, "time_this_iter_s": 10.479131698608398, "time_total_s": 270.73296070098877, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dfa90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.73296070098877, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.053333333333335, "ram_util_percent": 56.07999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 104991.140625, "policy_loss": 104719.4921875, "entropy": 28.4843692779541, "entropy_coeff": 0.01, "var_gnorm": 16.19499969482422, "vf_loss": 35710.5078125, "vf_explained_var": -0.16135823726654053}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 61950, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 413, "num_samples_added_to_queue": 61800, "learner_queue": {"size_count": 206, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.186, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1252.471, "learner_dequeue_time_ms": 10927.265}}, "env_runners": {"episode_reward_max": 124.46999999999986, "episode_reward_min": -92.47666666666672, "episode_reward_mean": 9.100822222222208, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -92.47666666666672}, "policy_reward_max": {"default_policy": 124.46999999999986}, "policy_reward_mean": {"default_policy": 9.100822222222208}, "custom_metrics": {"num_consolidated_mean": 0.8085, "num_consolidated_min": 0.55, "num_consolidated_max": 1.15, "num_overloaded_mean": 0.5690999999999999, "num_overloaded_min": 0.33, "num_overloaded_max": 0.82, "num_moves_mean": 9.8006, "num_moves_min": 9.31, "num_moves_max": 10.29, "mean_accuracy_mean": 40.856989999999996, "mean_accuracy_min": 40.56166666666667, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.926600000000002, "num_model_switches_min": 5.55, "num_model_switches_max": 6.38, "num_slav_mean": 0.15098650000000002, "num_slav_min": 0.12535, "num_slav_max": 0.16904999999999998, "cpu_conserved_cost_mean": 2.5062, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.22, "mean_cluster_cpu_util_mean": 0.5161122983528397, "mean_cluster_cpu_util_min": 0.48493897473164455, "mean_cluster_cpu_util_max": 0.5439375646894383, "mean_cluster_mem_util_mean": 0.34043819062688363, "mean_cluster_mem_util_min": 0.32253441419816875, "mean_cluster_mem_util_max": 0.3550059001765263, "reward_consolidation_mean_mean": -0.49266666666666686, "reward_consolidation_mean_min": -0.8333333333333333, "reward_consolidation_mean_max": -0.005555555555555808, "reward_illegal_mean_mean": -0.9485000000000001, "reward_illegal_mean_min": -1.3666666666666665, "reward_illegal_mean_max": -0.5499999999999998, "reward_accuracy_mean_mean": 2.0278226666666663, "reward_accuracy_mean_min": 1.0565666666666664, "reward_accuracy_mean_max": 2.8371000000000004, "reward_sla_mean_mean": -0.4956477777777778, "reward_sla_mean_min": -0.6752222222222223, "reward_sla_mean_max": -0.24799999999999997, "reward_consolidation_sum_mean": -49.26666666666668, "reward_consolidation_sum_min": -83.33333333333333, "reward_consolidation_sum_max": -0.5555555555555808, "reward_illegal_sum_mean": -94.85, "reward_illegal_sum_min": -136.66666666666666, "reward_illegal_sum_max": -54.999999999999986, "reward_accuracy_sum_mean": 202.7822666666667, "reward_accuracy_sum_min": 105.65666666666665, "reward_accuracy_sum_max": 283.71000000000004, "reward_sla_sum_mean": -49.56477777777778, "reward_sla_sum_min": -67.52222222222223, "reward_sla_sum_max": -24.799999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3378.0, "global_timestep_min": 1500, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-73.76555555555555, -72.76222222222223, -20.990000000000016, -77.3888888888889, -56.5033333333333, -82.89777777777776, -41.096666666666636, -79.3, -68.9655555555555, -73.94111111111113, -6.4544444444444355, -29.825555555555567, -37.0277777777778, -36.801111111111126, -24.26555555555556, -66.69888888888887, -65.79888888888887, -28.90555555555557, -68.71111111111111, -38.16555555555556, -82.34555555555556, -92.47666666666672, -67.49333333333333, -43.62333333333329, -25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2635919081161698, "mean_inference_ms": 2.330435993691727, "mean_action_processing_ms": 0.09762151396922465, "mean_env_wait_ms": 1.680710267923108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006222248077392578, "StateBufferConnector_ms": 0.003427267074584961, "ViewRequirementAgentConnector_ms": 0.08822941780090332}, "num_episodes": 21, "episode_return_max": 124.46999999999986, "episode_return_min": -92.47666666666672, "episode_return_mean": 9.100822222222208, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61800, "num_env_steps_sampled": 61950, "num_env_steps_trained": 61800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 223.73353274951012, "num_env_steps_trained_throughput_per_sec": 238.64910159947746, "timesteps_total": 61950, "num_env_steps_sampled_lifetime": 61950, "num_agent_steps_sampled_lifetime": 61950, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 61950, "timers": {"training_iteration_time_ms": 10313.462, "restore_workers_time_ms": 0.012, "training_step_time_ms": 645.676, "sample_time_ms": 629.344, "synch_weights_time_ms": 14.706}, "counters": {"num_env_steps_sampled": 61950, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61950, "num_agent_steps_trained": 61800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 413, "num_samples_added_to_queue": 61800}, "done": false, "training_iteration": 27, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-07", "timestamp": 1728649927, "time_this_iter_s": 10.067338466644287, "time_total_s": 280.80029916763306, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46dc6d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.80029916763306, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.3, "ram_util_percent": 58.114285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 155710.09375, "policy_loss": 154961.859375, "entropy": 28.120567321777344, "entropy_coeff": 0.01, "var_gnorm": 16.212337493896484, "vf_loss": 83259.8203125, "vf_explained_var": -0.10538208484649658}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 214.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 64350, "num_env_steps_trained": 64200, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 64200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 429, "num_samples_added_to_queue": 64200, "learner_queue": {"size_count": 214, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.377, "learner_load_time_ms": 0.354, "learner_load_wait_time_ms": 1251.035, "learner_dequeue_time_ms": 10843.394}}, "env_runners": {"episode_reward_max": 182.91555555555564, "episode_reward_min": -81.53000000000003, "episode_reward_mean": 53.942877777777746, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -81.53000000000003}, "policy_reward_max": {"default_policy": 182.91555555555564}, "policy_reward_mean": {"default_policy": 53.942877777777746}, "custom_metrics": {"num_consolidated_mean": 0.8833000000000003, "num_consolidated_min": 0.63, "num_consolidated_max": 1.15, "num_overloaded_mean": 0.47819999999999996, "num_overloaded_min": 0.21, "num_overloaded_max": 0.82, "num_moves_mean": 9.712, "num_moves_min": 9.12, "num_moves_max": 10.29, "mean_accuracy_mean": 40.811896666666655, "mean_accuracy_min": 40.473, "mean_accuracy_max": 41.11900000000001, "num_model_switches_mean": 5.9201, "num_model_switches_min": 5.55, "num_model_switches_max": 6.38, "num_slav_mean": 0.14745516666666666, "num_slav_min": 0.12351666666666665, "num_slav_max": 0.16774999999999998, "cpu_conserved_cost_mean": 2.5812, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.22, "mean_cluster_cpu_util_mean": 0.5063882669656611, "mean_cluster_cpu_util_min": 0.48188836039632205, "mean_cluster_cpu_util_max": 0.5439375646894383, "mean_cluster_mem_util_mean": 0.3350052420796377, "mean_cluster_mem_util_min": 0.320790669221275, "mean_cluster_mem_util_max": 0.3550059001765263, "reward_consolidation_mean_mean": -0.42633333333333345, "reward_consolidation_mean_min": -0.8333333333333333, "reward_consolidation_mean_max": -0.005555555555555808, "reward_illegal_mean_mean": -0.7969999999999999, "reward_illegal_mean_min": -1.3666666666666665, "reward_illegal_mean_max": -0.35, "reward_accuracy_mean_mean": 2.3137643333333333, "reward_accuracy_mean_min": 1.4220333333333328, "reward_accuracy_mean_max": 3.313900000000001, "reward_sla_mean_mean": -0.5510022222222222, "reward_sla_mean_min": -0.8464444444444444, "reward_sla_mean_max": -0.3151111111111111, "reward_consolidation_sum_mean": -42.633333333333354, "reward_consolidation_sum_min": -83.33333333333333, "reward_consolidation_sum_max": -0.5555555555555808, "reward_illegal_sum_mean": -79.7, "reward_illegal_sum_min": -136.66666666666666, "reward_illegal_sum_max": -35.0, "reward_accuracy_sum_mean": 231.37643333333338, "reward_accuracy_sum_min": 142.2033333333333, "reward_accuracy_sum_max": 331.3900000000001, "reward_sla_sum_mean": -55.10022222222222, "reward_sla_sum_min": -84.64444444444445, "reward_sla_sum_max": -31.511111111111113, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4178.0, "global_timestep_min": 2300, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-25.858888888888917, -47.02777777777776, -46.69555555555555, -40.64777777777776, -21.591111111111104, -61.87777777777775, -25.76222222222223, -76.02555555555553, -9.103333333333344, 6.818888888888864, 43.810000000000066, 9.113333333333328, -56.28777777777775, -61.60777777777777, -52.207777777777764, -15.543333333333374, -31.972222222222236, 3.556666666666636, 4.9222222222222305, 2.7999999999999914, -21.633333333333333, -81.53000000000003, 3.3388888888888957, -4.413333333333339, -17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2630864741927612, "mean_inference_ms": 2.3246280608803946, "mean_action_processing_ms": 0.09743489312165005, "mean_env_wait_ms": 1.6775340183839338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006499767303466797, "StateBufferConnector_ms": 0.003453969955444336, "ViewRequirementAgentConnector_ms": 0.08859109878540039}, "num_episodes": 24, "episode_return_max": 182.91555555555564, "episode_return_min": -81.53000000000003, "episode_return_mean": 53.942877777777746, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 64200, "num_env_steps_sampled": 64350, "num_env_steps_trained": 64200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 222.99044362392044, "num_env_steps_trained_throughput_per_sec": 222.99044362392044, "timesteps_total": 64350, "num_env_steps_sampled_lifetime": 64350, "num_agent_steps_sampled_lifetime": 64350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 64350, "timers": {"training_iteration_time_ms": 10360.094, "restore_workers_time_ms": 0.012, "training_step_time_ms": 692.01, "sample_time_ms": 674.901, "synch_weights_time_ms": 15.079}, "counters": {"num_env_steps_sampled": 64350, "num_env_steps_trained": 64200, "num_agent_steps_sampled": 64350, "num_agent_steps_trained": 64200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 429, "num_samples_added_to_queue": 64200}, "done": false, "training_iteration": 28, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-18", "timestamp": 1728649938, "time_this_iter_s": 10.775487422943115, "time_total_s": 291.5757865905762, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c45726b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.5757865905762, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.06875, "ram_util_percent": 58.287499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 162240.5, "policy_loss": 161426.359375, "entropy": 27.85614013671875, "entropy_coeff": 0.01, "var_gnorm": 16.223430633544922, "vf_loss": 89771.0, "vf_explained_var": -0.10614943504333496}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 444, "num_samples_added_to_queue": 66600, "learner_queue": {"size_count": 221, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.199, "learner_load_time_ms": 0.383, "learner_load_wait_time_ms": 1315.041, "learner_dequeue_time_ms": 10737.587}}, "env_runners": {"episode_reward_max": 217.51888888888888, "episode_reward_min": -17.237777777777765, "episode_reward_mean": 98.87448888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -17.237777777777765}, "policy_reward_max": {"default_policy": 217.51888888888888}, "policy_reward_mean": {"default_policy": 98.87448888888886}, "custom_metrics": {"num_consolidated_mean": 0.9625, "num_consolidated_min": 0.69, "num_consolidated_max": 1.25, "num_overloaded_mean": 0.3959, "num_overloaded_min": 0.2, "num_overloaded_max": 0.64, "num_moves_mean": 9.595099999999997, "num_moves_min": 9.12, "num_moves_max": 9.96, "mean_accuracy_mean": 40.75736666666666, "mean_accuracy_min": 40.473, "mean_accuracy_max": 41.1, "num_model_switches_mean": 5.9132, "num_model_switches_min": 5.55, "num_model_switches_max": 6.43, "num_slav_mean": 0.14336933333333335, "num_slav_min": 0.11705, "num_slav_max": 0.16774999999999998, "cpu_conserved_cost_mean": 2.6598, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.22, "mean_cluster_cpu_util_mean": 0.49752382284929797, "mean_cluster_cpu_util_min": 0.4697214859970736, "mean_cluster_cpu_util_max": 0.5259476268978743, "mean_cluster_mem_util_mean": 0.3298450382599241, "mean_cluster_mem_util_min": 0.31286368437670425, "mean_cluster_mem_util_max": 0.34550245719595857, "reward_consolidation_mean_mean": -0.3310000000000002, "reward_consolidation_mean_min": -0.7055555555555557, "reward_consolidation_mean_max": 0.12777777777777743, "reward_illegal_mean_mean": -0.6598333333333334, "reward_illegal_mean_min": -1.0666666666666667, "reward_illegal_mean_max": -0.33333333333333326, "reward_accuracy_mean_mean": 2.5777893333333335, "reward_accuracy_mean_min": 1.6540666666666664, "reward_accuracy_mean_max": 3.313900000000001, "reward_sla_mean_mean": -0.598211111111111, "reward_sla_mean_min": -0.8464444444444444, "reward_sla_mean_max": -0.3472222222222222, "reward_consolidation_sum_mean": -33.10000000000002, "reward_consolidation_sum_min": -70.55555555555557, "reward_consolidation_sum_max": 12.777777777777745, "reward_illegal_sum_mean": -65.98333333333333, "reward_illegal_sum_min": -106.66666666666666, "reward_illegal_sum_max": -33.33333333333333, "reward_accuracy_sum_mean": 257.7789333333334, "reward_accuracy_sum_min": 165.40666666666664, "reward_accuracy_sum_max": 331.3900000000001, "reward_sla_sum_mean": -59.82111111111112, "reward_sla_sum_min": -84.64444444444445, "reward_sla_sum_max": -34.72222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4978.0, "global_timestep_min": 3100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-17.237777777777765, -1.134444444444442, 10.4311111111111, 35.04111111111107, 48.476666666666695, 1.239999999999994, -3.850000000000028, 53.965555555555525, -7.500000000000007, 75.88444444444441, 17.72444444444443, 92.00999999999996, 113.90555555555548, -3.744444444444465, 65.03888888888889, 22.54666666666666, 37.92333333333334, -4.095555555555568, -1.8777777777777733, 36.67111111111109, 65.23666666666665, 90.3622222222222, 16.27555555555555, 58.743333333333354, 28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26270704529964745, "mean_inference_ms": 2.3205647189585856, "mean_action_processing_ms": 0.09731265143152303, "mean_env_wait_ms": 1.6754451103252546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00665283203125, "StateBufferConnector_ms": 0.0035321712493896484, "ViewRequirementAgentConnector_ms": 0.0920710563659668}, "num_episodes": 24, "episode_return_max": 217.51888888888888, "episode_return_min": -17.237777777777765, "episode_return_mean": 98.87448888888886, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66300, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 223.8542152762852, "num_env_steps_trained_throughput_per_sec": 208.93060092453285, "timesteps_total": 66600, "num_env_steps_sampled_lifetime": 66600, "num_agent_steps_sampled_lifetime": 66600, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 66600, "timers": {"training_iteration_time_ms": 10312.446, "restore_workers_time_ms": 0.012, "training_step_time_ms": 689.096, "sample_time_ms": 672.853, "synch_weights_time_ms": 14.749}, "counters": {"num_env_steps_sampled": 66600, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 444, "num_samples_added_to_queue": 66600}, "done": false, "training_iteration": 29, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-28", "timestamp": 1728649948, "time_this_iter_s": 10.061181545257568, "time_total_s": 301.63696813583374, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c27dd300>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.63696813583374, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.75714285714286, "ram_util_percent": 59.02142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 222793.671875, "policy_loss": 221310.15625, "entropy": 27.552900314331055, "entropy_coeff": 0.01, "var_gnorm": 16.233572006225586, "vf_loss": 156616.6875, "vf_explained_var": -0.10517477989196777}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 229.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 68700, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 68700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 460, "num_samples_added_to_queue": 69000, "learner_queue": {"size_count": 229, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.998, "learner_load_time_ms": 0.357, "learner_load_wait_time_ms": 1259.515, "learner_dequeue_time_ms": 10707.268}}, "env_runners": {"episode_reward_max": 265.8999999999999, "episode_reward_min": -8.67000000000001, "episode_reward_mean": 138.88677777777775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -8.67000000000001}, "policy_reward_max": {"default_policy": 265.8999999999999}, "policy_reward_mean": {"default_policy": 138.88677777777775}, "custom_metrics": {"num_consolidated_mean": 1.0424, "num_consolidated_min": 0.72, "num_consolidated_max": 1.27, "num_overloaded_mean": 0.3312, "num_overloaded_min": 0.17, "num_overloaded_max": 0.58, "num_moves_mean": 9.5177, "num_moves_min": 9.12, "num_moves_max": 9.91, "mean_accuracy_mean": 40.71778333333334, "mean_accuracy_min": 40.473, "mean_accuracy_max": 40.95433333333333, "num_model_switches_mean": 5.888299999999999, "num_model_switches_min": 5.51, "num_model_switches_max": 6.43, "num_slav_mean": 0.13916383333333335, "num_slav_min": 0.11705, "num_slav_max": 0.16398333333333334, "cpu_conserved_cost_mean": 2.7708000000000004, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.49069506902291626, "mean_cluster_cpu_util_min": 0.4668698598629691, "mean_cluster_cpu_util_max": 0.5220739893473493, "mean_cluster_mem_util_mean": 0.32566922868588366, "mean_cluster_mem_util_min": 0.3112565517451706, "mean_cluster_mem_util_max": 0.34550245719595857, "reward_consolidation_mean_mean": -0.22588888888888914, "reward_consolidation_mean_min": -0.6666666666666669, "reward_consolidation_mean_max": 0.29999999999999966, "reward_illegal_mean_mean": -0.5519999999999999, "reward_illegal_mean_min": -0.9666666666666666, "reward_illegal_mean_max": -0.28333333333333327, "reward_accuracy_mean_mean": 2.7985966666666666, "reward_accuracy_mean_min": 1.9563333333333333, "reward_accuracy_mean_max": 3.4156666666666666, "reward_sla_mean_mean": -0.6318400000000001, "reward_sla_mean_min": -0.8464444444444444, "reward_sla_mean_max": -0.437888888888889, "reward_consolidation_sum_mean": -22.588888888888917, "reward_consolidation_sum_min": -66.66666666666669, "reward_consolidation_sum_max": 29.999999999999968, "reward_illegal_sum_mean": -55.19999999999999, "reward_illegal_sum_min": -96.66666666666666, "reward_illegal_sum_max": -28.33333333333333, "reward_accuracy_sum_mean": 279.85966666666667, "reward_accuracy_sum_min": 195.63333333333333, "reward_accuracy_sum_max": 341.56666666666666, "reward_sla_sum_mean": -63.184, "reward_sla_sum_min": -84.64444444444445, "reward_sla_sum_max": -43.7888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5767.0, "global_timestep_min": 3700, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [28.009999999999984, -2.600000000000016, 30.603333333333307, -8.67000000000001, 48.25444444444443, 88.82333333333332, 27.0022222222222, 63.61333333333334, 54.57444444444446, 86.48999999999997, 102.07999999999996, 113.1544444444444, 122.13222222222214, 108.70222222222212, 33.24111111111113, 32.77222222222218, 121.4088888888888, 93.04999999999993, 54.97000000000005, 77.92666666666662, 98.90666666666655, 124.46999999999986, 39.34888888888889, 90.49666666666661, 95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2625397068413817, "mean_inference_ms": 2.316845926761076, "mean_action_processing_ms": 0.09722765716310394, "mean_env_wait_ms": 1.6741270066787746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006734371185302734, "StateBufferConnector_ms": 0.003570079803466797, "ViewRequirementAgentConnector_ms": 0.0931854248046875}, "num_episodes": 24, "episode_return_max": 265.8999999999999, "episode_return_min": -8.67000000000001, "episode_return_mean": 138.88677777777775, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 68700, "num_env_steps_sampled": 69000, "num_env_steps_trained": 68700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 226.5605784492308, "num_env_steps_trained_throughput_per_sec": 226.5605784492308, "timesteps_total": 69000, "num_env_steps_sampled_lifetime": 69000, "num_agent_steps_sampled_lifetime": 69000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 10345.098, "restore_workers_time_ms": 0.012, "training_step_time_ms": 654.782, "sample_time_ms": 637.866, "synch_weights_time_ms": 15.467}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 68700, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 68700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 460, "num_samples_added_to_queue": 69000}, "done": false, "training_iteration": 30, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-38", "timestamp": 1728649958, "time_this_iter_s": 10.603980302810669, "time_total_s": 312.2409484386444, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b80256c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.2409484386444, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 19.82, "ram_util_percent": 58.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 232503.296875, "policy_loss": 230882.734375, "entropy": 27.09601593017578, "entropy_coeff": 0.01, "var_gnorm": 16.24172019958496, "vf_loss": 170183.828125, "vf_explained_var": -0.1088097095489502}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 237.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71100, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 476, "num_samples_added_to_queue": 71400, "learner_queue": {"size_count": 237, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.467, "learner_load_time_ms": 0.354, "learner_load_wait_time_ms": 1207.533, "learner_dequeue_time_ms": 10567.379}}, "env_runners": {"episode_reward_max": 285.9566666666665, "episode_reward_min": 56.623333333333306, "episode_reward_mean": 174.85476666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 56.623333333333306}, "policy_reward_max": {"default_policy": 285.9566666666665}, "policy_reward_mean": {"default_policy": 174.85476666666665}, "custom_metrics": {"num_consolidated_mean": 1.1181999999999999, "num_consolidated_min": 0.88, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.28, "num_overloaded_min": 0.11, "num_overloaded_max": 0.48, "num_moves_mean": 9.4306, "num_moves_min": 8.9, "num_moves_max": 9.79, "mean_accuracy_mean": 40.67357666666666, "mean_accuracy_min": 40.33999999999999, "mean_accuracy_max": 40.916333333333334, "num_model_switches_mean": 5.8382000000000005, "num_model_switches_min": 5.36, "num_model_switches_max": 6.43, "num_slav_mean": 0.13471149999999998, "num_slav_min": 0.117, "num_slav_max": 0.15611666666666668, "cpu_conserved_cost_mean": 2.8998000000000004, "cpu_conserved_cost_min": 2.42, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.4855988458652227, "mean_cluster_cpu_util_min": 0.4668698598629691, "mean_cluster_cpu_util_max": 0.5020939456074056, "mean_cluster_mem_util_mean": 0.3222051620041477, "mean_cluster_mem_util_min": 0.3105812421065473, "mean_cluster_mem_util_max": 0.33406181865151124, "reward_consolidation_mean_mean": -0.11216666666666691, "reward_consolidation_mean_min": -0.6666666666666669, "reward_consolidation_mean_max": 0.6777777777777773, "reward_illegal_mean_mean": -0.4666666666666666, "reward_illegal_mean_min": -0.7999999999999998, "reward_illegal_mean_max": -0.18333333333333332, "reward_accuracy_mean_mean": 2.9821543333333342, "reward_accuracy_mean_min": 2.3502333333333327, "reward_accuracy_mean_max": 3.6104000000000007, "reward_sla_mean_mean": -0.6547733333333332, "reward_sla_mean_min": -0.8464444444444444, "reward_sla_mean_max": -0.46444444444444444, "reward_consolidation_sum_mean": -11.216666666666692, "reward_consolidation_sum_min": -66.66666666666669, "reward_consolidation_sum_max": 67.77777777777773, "reward_illegal_sum_mean": -46.66666666666665, "reward_illegal_sum_min": -79.99999999999999, "reward_illegal_sum_max": -18.333333333333332, "reward_accuracy_sum_mean": 298.21543333333335, "reward_accuracy_sum_min": 235.02333333333328, "reward_accuracy_sum_max": 361.0400000000001, "reward_sla_sum_mean": -65.47733333333335, "reward_sla_sum_min": -84.64444444444445, "reward_sla_sum_max": -46.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5642.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [95.37666666666658, 107.51999999999985, 104.04999999999997, 113.96777777777773, 109.45888888888875, 131.90555555555548, 124.68666666666657, 75.64111111111107, 108.15999999999993, 131.95555555555552, 144.04444444444442, 131.77666666666656, 166.74555555555554, 174.3244444444444, 56.623333333333306, 101.80888888888884, 132.42999999999995, 180.70333333333338, 144.18333333333328, 169.64444444444447, 130.37666666666672, 104.87777777777774, 109.01222222222216, 119.03111111111097, 145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26215327424661294, "mean_inference_ms": 2.315879894720327, "mean_action_processing_ms": 0.09715786020856293, "mean_env_wait_ms": 1.673094694131505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006371974945068359, "StateBufferConnector_ms": 0.0035266876220703125, "ViewRequirementAgentConnector_ms": 0.0914459228515625}, "num_episodes": 24, "episode_return_max": 285.9566666666665, "episode_return_min": 56.623333333333306, "episode_return_mean": 174.85476666666665, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71100, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.80714399518624, "num_env_steps_trained_throughput_per_sec": 238.80714399518624, "timesteps_total": 71400, "num_env_steps_sampled_lifetime": 71400, "num_agent_steps_sampled_lifetime": 71400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 71400, "timers": {"training_iteration_time_ms": 10337.47, "restore_workers_time_ms": 0.013, "training_step_time_ms": 617.861, "sample_time_ms": 601.622, "synch_weights_time_ms": 14.841}, "counters": {"num_env_steps_sampled": 71400, "num_env_steps_trained": 71100, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 476, "num_samples_added_to_queue": 71400}, "done": false, "training_iteration": 31, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-49", "timestamp": 1728649969, "time_this_iter_s": 10.063032150268555, "time_total_s": 322.30398058891296, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b80257b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.30398058891296, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.164285714285715, "ram_util_percent": 57.88571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 198127.03125, "policy_loss": 196861.0625, "entropy": 26.90476417541504, "entropy_coeff": 0.01, "var_gnorm": 16.247228622436523, "vf_loss": 134668.09375, "vf_explained_var": -0.09319651126861572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 245.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73500, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 492, "num_samples_added_to_queue": 73800, "learner_queue": {"size_count": 245, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.942, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1224.991, "learner_dequeue_time_ms": 10407.883}}, "env_runners": {"episode_reward_max": 294.4677777777777, "episode_reward_min": 108.56444444444443, "episode_reward_mean": 203.9895555555556, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 108.56444444444443}, "policy_reward_max": {"default_policy": 294.4677777777777}, "policy_reward_mean": {"default_policy": 203.9895555555556}, "custom_metrics": {"num_consolidated_mean": 1.1878, "num_consolidated_min": 0.97, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.2471, "num_overloaded_min": 0.11, "num_overloaded_max": 0.41, "num_moves_mean": 9.3566, "num_moves_min": 8.9, "num_moves_max": 9.7, "mean_accuracy_mean": 40.62728, "mean_accuracy_min": 40.321, "mean_accuracy_max": 40.852999999999994, "num_model_switches_mean": 5.794099999999999, "num_model_switches_min": 5.27, "num_model_switches_max": 6.43, "num_slav_mean": 0.13105366666666665, "num_slav_min": 0.11403333333333332, "num_slav_max": 0.15216666666666667, "cpu_conserved_cost_mean": 3.0134, "cpu_conserved_cost_min": 2.52, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.4817758616918375, "mean_cluster_cpu_util_min": 0.4658568537670986, "mean_cluster_cpu_util_max": 0.4957334317875029, "mean_cluster_mem_util_mean": 0.31935623248012285, "mean_cluster_mem_util_min": 0.3100913209693161, "mean_cluster_mem_util_max": 0.330764455244123, "reward_consolidation_mean_mean": 0.015666666666666364, "reward_consolidation_mean_min": -0.6333333333333335, "reward_consolidation_mean_max": 0.6777777777777773, "reward_illegal_mean_mean": -0.4118333333333334, "reward_illegal_mean_min": -0.6833333333333332, "reward_illegal_mean_max": -0.18333333333333332, "reward_accuracy_mean_mean": 3.098396666666667, "reward_accuracy_mean_min": 2.4432, "reward_accuracy_mean_max": 3.6104000000000007, "reward_sla_mean_mean": -0.6623344444444444, "reward_sla_mean_min": -0.8271111111111111, "reward_sla_mean_max": -0.46444444444444444, "reward_consolidation_sum_mean": 1.5666666666666365, "reward_consolidation_sum_min": -63.33333333333335, "reward_consolidation_sum_max": 67.77777777777773, "reward_illegal_sum_mean": -41.18333333333333, "reward_illegal_sum_min": -68.33333333333333, "reward_illegal_sum_max": -18.333333333333332, "reward_accuracy_sum_mean": 309.8396666666667, "reward_accuracy_sum_min": 244.32000000000002, "reward_accuracy_sum_max": 361.0400000000001, "reward_sla_sum_mean": -66.23344444444443, "reward_sla_sum_min": -82.71111111111111, "reward_sla_sum_max": -46.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4570.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [145.87, 134.9255555555555, 136.89999999999995, 182.91555555555564, 130.84333333333328, 108.56444444444443, 156.62444444444435, 118.49666666666661, 135.95333333333326, 127.54333333333322, 204.61999999999995, 160.79222222222222, 184.3344444444444, 193.6211111111111, 162.42555555555555, 175.26444444444445, 158.51888888888882, 216.69333333333327, 164.1777777777779, 213.27111111111105, 135.62333333333328, 136.20222222222213, 161.56, 173.70333333333326, 169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2618497053359087, "mean_inference_ms": 2.312556117773788, "mean_action_processing_ms": 0.09705616910120499, "mean_env_wait_ms": 1.6716206172701846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060269832611083984, "StateBufferConnector_ms": 0.003508329391479492, "ViewRequirementAgentConnector_ms": 0.09172344207763672}, "num_episodes": 24, "episode_return_max": 294.4677777777777, "episode_return_min": 108.56444444444443, "episode_return_mean": 203.9895555555556, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73500, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 230.23126117040198, "num_env_steps_trained_throughput_per_sec": 230.23126117040198, "timesteps_total": 73800, "num_env_steps_sampled_lifetime": 73800, "num_agent_steps_sampled_lifetime": 73800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 73800, "timers": {"training_iteration_time_ms": 10334.748, "restore_workers_time_ms": 0.013, "training_step_time_ms": 665.091, "sample_time_ms": 647.806, "synch_weights_time_ms": 15.637}, "counters": {"num_env_steps_sampled": 73800, "num_env_steps_trained": 73500, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 492, "num_samples_added_to_queue": 73800}, "done": false, "training_iteration": 32, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-32-59", "timestamp": 1728649979, "time_this_iter_s": 10.436579942703247, "time_total_s": 332.7405605316162, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b8025a20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.7405605316162, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.12, "ram_util_percent": 57.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 235154.484375, "policy_loss": 233435.765625, "entropy": 26.859346389770508, "entropy_coeff": 0.01, "var_gnorm": 16.250640869140625, "vf_loss": 179929.21875, "vf_explained_var": -0.09255445003509521}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 508, "num_samples_added_to_queue": 76200, "learner_queue": {"size_count": 253, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.038, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1260.749, "learner_dequeue_time_ms": 10427.052}}, "env_runners": {"episode_reward_max": 303.13111111111095, "episode_reward_min": 121.04555555555545, "episode_reward_mean": 226.16561111111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 121.04555555555545}, "policy_reward_max": {"default_policy": 303.13111111111095}, "policy_reward_mean": {"default_policy": 226.16561111111108}, "custom_metrics": {"num_consolidated_mean": 1.2429000000000001, "num_consolidated_min": 0.97, "num_consolidated_max": 1.53, "num_overloaded_mean": 0.22210000000000002, "num_overloaded_min": 0.11, "num_overloaded_max": 0.36, "num_moves_mean": 9.2806, "num_moves_min": 8.89, "num_moves_max": 9.7, "mean_accuracy_mean": 40.59681666666666, "mean_accuracy_min": 40.321, "mean_accuracy_max": 40.90999999999999, "num_model_switches_mean": 5.7351, "num_model_switches_min": 5.27, "num_model_switches_max": 6.12, "num_slav_mean": 0.12841666666666668, "num_slav_min": 0.11216666666666666, "num_slav_max": 0.14926666666666663, "cpu_conserved_cost_mean": 3.1245999999999996, "cpu_conserved_cost_min": 2.54, "cpu_conserved_cost_max": 3.88, "mean_cluster_cpu_util_mean": 0.4790696882370071, "mean_cluster_cpu_util_min": 0.46509436477889016, "mean_cluster_cpu_util_max": 0.49399932307102223, "mean_cluster_mem_util_mean": 0.31739032668489336, "mean_cluster_mem_util_min": 0.3086203918381698, "mean_cluster_mem_util_max": 0.330764455244123, "reward_consolidation_mean_mean": 0.112833333333333, "reward_consolidation_mean_min": -0.6333333333333335, "reward_consolidation_mean_max": 0.6777777777777773, "reward_illegal_mean_mean": -0.3701666666666666, "reward_illegal_mean_min": -0.5999999999999999, "reward_illegal_mean_max": -0.18333333333333332, "reward_accuracy_mean_mean": 3.1859216666666668, "reward_accuracy_mean_min": 2.7106333333333335, "reward_accuracy_mean_max": 3.6104000000000007, "reward_sla_mean_mean": -0.6669322222222221, "reward_sla_mean_min": -0.7844444444444446, "reward_sla_mean_max": -0.5415555555555555, "reward_consolidation_sum_mean": 11.283333333333301, "reward_consolidation_sum_min": -63.33333333333335, "reward_consolidation_sum_max": 67.77777777777773, "reward_illegal_sum_mean": -37.01666666666666, "reward_illegal_sum_min": -59.999999999999986, "reward_illegal_sum_max": -18.333333333333332, "reward_accuracy_sum_mean": 318.5921666666667, "reward_accuracy_sum_min": 271.06333333333333, "reward_accuracy_sum_max": 361.0400000000001, "reward_sla_sum_mean": -66.69322222222222, "reward_sla_sum_min": -78.44444444444446, "reward_sla_sum_max": -54.155555555555544, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3498.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [169.15, 217.51888888888888, 121.04555555555545, 161.1877777777778, 123.16333333333323, 163.76111111111106, 193.2033333333334, 201.33555555555554, 209.01111111111115, 179.56333333333342, 242.96999999999997, 224.40333333333322, 202.98000000000002, 235.1466666666667, 219.6766666666667, 231.97555555555553, 203.84333333333342, 189.1433333333333, 238.53222222222206, 206.30222222222218, 265.8999999999999, 123.57222222222221, 173.04111111111112, 202.56777777777782, 216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26147647287915504, "mean_inference_ms": 2.308852960489178, "mean_action_processing_ms": 0.09693841327297814, "mean_env_wait_ms": 1.6699478859574122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005899667739868164, "StateBufferConnector_ms": 0.0034041404724121094, "ViewRequirementAgentConnector_ms": 0.0882270336151123}, "num_episodes": 24, "episode_return_max": 303.13111111111095, "episode_return_min": 121.04555555555545, "episode_return_mean": 226.16561111111108, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 227.52030381577435, "num_env_steps_trained_throughput_per_sec": 227.52030381577435, "timesteps_total": 76200, "num_env_steps_sampled_lifetime": 76200, "num_agent_steps_sampled_lifetime": 76200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 76200, "timers": {"training_iteration_time_ms": 10356.809, "restore_workers_time_ms": 0.013, "training_step_time_ms": 628.632, "sample_time_ms": 613.013, "synch_weights_time_ms": 14.24}, "counters": {"num_env_steps_sampled": 76200, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 508, "num_samples_added_to_queue": 76200}, "done": false, "training_iteration": 33, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-33-10", "timestamp": 1728649990, "time_this_iter_s": 10.558112859725952, "time_total_s": 343.29867339134216, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b8026260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 343.29867339134216, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.0, "ram_util_percent": 58.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 204515.078125, "policy_loss": 203157.140625, "entropy": 26.786884307861328, "entropy_coeff": 0.01, "var_gnorm": 16.255983352661133, "vf_loss": 143829.9375, "vf_explained_var": -0.0848698616027832}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 261.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 78600, "num_env_steps_trained": 78300, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 524, "num_samples_added_to_queue": 78600, "learner_queue": {"size_count": 261, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.909, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1224.129, "learner_dequeue_time_ms": 10424.791}}, "env_runners": {"episode_reward_max": 307.19444444444423, "episode_reward_min": 154.1833333333333, "episode_reward_mean": 240.80721111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 154.1833333333333}, "policy_reward_max": {"default_policy": 307.19444444444423}, "policy_reward_mean": {"default_policy": 240.80721111111106}, "custom_metrics": {"num_consolidated_mean": 1.2867000000000002, "num_consolidated_min": 1.09, "num_consolidated_max": 1.53, "num_overloaded_mean": 0.2106, "num_overloaded_min": 0.11, "num_overloaded_max": 0.33, "num_moves_mean": 9.2118, "num_moves_min": 8.86, "num_moves_max": 9.7, "mean_accuracy_mean": 40.57933666666666, "mean_accuracy_min": 40.321, "mean_accuracy_max": 40.90999999999999, "num_model_switches_mean": 5.675799999999999, "num_model_switches_min": 5.27, "num_model_switches_max": 6.12, "num_slav_mean": 0.12670433333333336, "num_slav_min": 0.10915, "num_slav_max": 0.14926666666666663, "cpu_conserved_cost_mean": 3.2088000000000005, "cpu_conserved_cost_min": 2.64, "cpu_conserved_cost_max": 3.88, "mean_cluster_cpu_util_mean": 0.477464609730405, "mean_cluster_cpu_util_min": 0.46473879960575465, "mean_cluster_cpu_util_max": 0.49214522961982027, "mean_cluster_mem_util_mean": 0.31586288285577946, "mean_cluster_mem_util_min": 0.30827174018341513, "mean_cluster_mem_util_max": 0.32604506246591464, "reward_consolidation_mean_mean": 0.19961111111111074, "reward_consolidation_mean_min": -0.277777777777778, "reward_consolidation_mean_max": 0.705555555555555, "reward_illegal_mean_mean": -0.3509999999999999, "reward_illegal_mean_min": -0.5499999999999998, "reward_illegal_mean_max": -0.18333333333333332, "reward_accuracy_mean_mean": 3.2264243333333336, "reward_accuracy_mean_min": 2.763133333333334, "reward_accuracy_mean_max": 3.6104000000000007, "reward_sla_mean_mean": -0.6669633333333335, "reward_sla_mean_min": -0.7844444444444446, "reward_sla_mean_max": -0.5415555555555555, "reward_consolidation_sum_mean": 19.96111111111108, "reward_consolidation_sum_min": -27.7777777777778, "reward_consolidation_sum_max": 70.5555555555555, "reward_illegal_sum_mean": -35.1, "reward_illegal_sum_min": -54.999999999999986, "reward_illegal_sum_max": -18.333333333333332, "reward_accuracy_sum_mean": 322.6424333333334, "reward_accuracy_sum_min": 276.3133333333334, "reward_accuracy_sum_max": 361.0400000000001, "reward_sla_sum_mean": -66.69633333333333, "reward_sla_sum_min": -78.44444444444446, "reward_sla_sum_max": -54.155555555555544, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2426.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [216.81222222222218, 190.45000000000005, 204.07555555555552, 161.8355555555556, 214.37000000000006, 236.29666666666674, 171.98777777777778, 181.79555555555558, 204.00222222222214, 188.3566666666666, 236.2755555555554, 262.05111111111114, 207.87333333333322, 154.1833333333333, 215.56, 226.4744444444445, 203.8033333333334, 253.81444444444438, 285.9566666666665, 224.70444444444442, 202.93, 176.1455555555555, 231.17666666666673, 189.39111111111112, 201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26110132412178017, "mean_inference_ms": 2.3050542617831495, "mean_action_processing_ms": 0.09681813496096428, "mean_env_wait_ms": 1.6681278838056317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850315093994141, "StateBufferConnector_ms": 0.0034017562866210938, "ViewRequirementAgentConnector_ms": 0.08831548690795898}, "num_episodes": 24, "episode_return_max": 307.19444444444423, "episode_return_min": 154.1833333333333, "episode_return_mean": 240.80721111111106, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78300, "num_env_steps_sampled": 78600, "num_env_steps_trained": 78300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 231.0388487159827, "num_env_steps_trained_throughput_per_sec": 231.0388487159827, "timesteps_total": 78600, "num_env_steps_sampled_lifetime": 78600, "num_agent_steps_sampled_lifetime": 78600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 78600, "timers": {"training_iteration_time_ms": 10343.672, "restore_workers_time_ms": 0.011, "training_step_time_ms": 653.945, "sample_time_ms": 637.756, "synch_weights_time_ms": 14.694}, "counters": {"num_env_steps_sampled": 78600, "num_env_steps_trained": 78300, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 524, "num_samples_added_to_queue": 78600}, "done": false, "training_iteration": 34, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-33-20", "timestamp": 1728650000, "time_this_iter_s": 10.398789167404175, "time_total_s": 353.69746255874634, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b8025300>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 353.69746255874634, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.22857142857143, "ram_util_percent": 58.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 257814.234375, "policy_loss": 255673.65625, "entropy": 26.49569320678711, "entropy_coeff": 0.01, "var_gnorm": 16.264331817626953, "vf_loss": 222006.234375, "vf_explained_var": -0.06980419158935547}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 269.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 80700, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 80700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 540, "num_samples_added_to_queue": 81000, "learner_queue": {"size_count": 269, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.777, "learner_load_time_ms": 0.247, "learner_load_wait_time_ms": 1237.784, "learner_dequeue_time_ms": 10480.053}}, "env_runners": {"episode_reward_max": 317.47444444444426, "episode_reward_min": 186.45222222222225, "episode_reward_mean": 255.33808888888893, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 186.45222222222225}, "policy_reward_max": {"default_policy": 317.47444444444426}, "policy_reward_mean": {"default_policy": 255.33808888888893}, "custom_metrics": {"num_consolidated_mean": 1.3212000000000002, "num_consolidated_min": 1.14, "num_consolidated_max": 1.55, "num_overloaded_mean": 0.19779999999999998, "num_overloaded_min": 0.1, "num_overloaded_max": 0.32, "num_moves_mean": 9.1565, "num_moves_min": 8.63, "num_moves_max": 9.56, "mean_accuracy_mean": 40.55343333333333, "mean_accuracy_min": 40.30833333333332, "mean_accuracy_max": 40.90999999999999, "num_model_switches_mean": 5.639600000000001, "num_model_switches_min": 5.15, "num_model_switches_max": 6.12, "num_slav_mean": 0.124749, "num_slav_min": 0.10823333333333332, "num_slav_max": 0.14926666666666663, "cpu_conserved_cost_mean": 3.2641999999999998, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.88, "mean_cluster_cpu_util_mean": 0.47572048288942026, "mean_cluster_cpu_util_min": 0.46473879960575465, "mean_cluster_cpu_util_max": 0.4914909528441681, "mean_cluster_mem_util_mean": 0.314440266025503, "mean_cluster_mem_util_min": 0.30827174018341513, "mean_cluster_mem_util_max": 0.3243698204598296, "reward_consolidation_mean_mean": 0.2771111111111107, "reward_consolidation_mean_min": -0.24444444444444471, "reward_consolidation_mean_max": 0.8888888888888883, "reward_illegal_mean_mean": -0.3296666666666666, "reward_illegal_mean_min": -0.5333333333333332, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.2704720000000003, "reward_accuracy_mean_min": 2.8326666666666664, "reward_accuracy_mean_max": 3.6432666666666664, "reward_sla_mean_mean": -0.6645355555555555, "reward_sla_mean_min": -0.7844444444444446, "reward_sla_mean_max": -0.5420000000000001, "reward_consolidation_sum_mean": 27.711111111111073, "reward_consolidation_sum_min": -24.44444444444447, "reward_consolidation_sum_max": 88.88888888888883, "reward_illegal_sum_mean": -32.96666666666666, "reward_illegal_sum_min": -53.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 327.04720000000003, "reward_accuracy_sum_min": 283.26666666666665, "reward_accuracy_sum_max": 364.32666666666665, "reward_sla_sum_mean": -66.45355555555555, "reward_sla_sum_min": -78.44444444444446, "reward_sla_sum_max": -54.20000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1978.0, "global_timestep_min": 100, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [201.94222222222217, 249.1655555555555, 254.38888888888883, 252.91444444444446, 258.9755555555554, 212.03555555555556, 264.5422222222223, 288.3933333333332, 242.26111111111106, 221.80888888888896, 233.6400000000001, 267.3988888888888, 236.05777777777791, 201.5822222222222, 294.4677777777777, 215.15111111111108, 262.17333333333323, 258.2455555555556, 242.44777777777765, 249.35888888888897, 251.2355555555555, 248.02888888888884, 268.16333333333324, 259.7488888888888, 222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607945822506539, "mean_inference_ms": 2.3015079116191908, "mean_action_processing_ms": 0.09671648674746976, "mean_env_wait_ms": 1.666548236488333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005774497985839844, "StateBufferConnector_ms": 0.0033185482025146484, "ViewRequirementAgentConnector_ms": 0.08649587631225586}, "num_episodes": 24, "episode_return_max": 317.47444444444426, "episode_return_min": 186.45222222222225, "episode_return_mean": 255.33808888888893, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 80700, "num_env_steps_sampled": 81000, "num_env_steps_trained": 80700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.33139845782026, "num_env_steps_trained_throughput_per_sec": 236.33139845782026, "timesteps_total": 81000, "num_env_steps_sampled_lifetime": 81000, "num_agent_steps_sampled_lifetime": 81000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 10349.313, "restore_workers_time_ms": 0.012, "training_step_time_ms": 616.922, "sample_time_ms": 600.848, "synch_weights_time_ms": 14.582}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 80700, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 80700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 540, "num_samples_added_to_queue": 81000}, "done": false, "training_iteration": 35, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-33-30", "timestamp": 1728650010, "time_this_iter_s": 10.169358968734741, "time_total_s": 363.8668215274811, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b8026560>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.8668215274811, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.459999999999997, "ram_util_percent": 58.31333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 259882.46875, "policy_loss": 257633.0625, "entropy": 26.279335021972656, "entropy_coeff": 0.01, "var_gnorm": 16.272262573242188, "vf_loss": 232825.359375, "vf_explained_var": -0.059589385986328125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 556, "num_samples_added_to_queue": 83400, "learner_queue": {"size_count": 277, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.922, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 1190.497, "learner_dequeue_time_ms": 10482.311}}, "env_runners": {"episode_reward_max": 361.1766666666665, "episode_reward_min": 186.45222222222225, "episode_reward_mean": 266.4521777777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 186.45222222222225}, "policy_reward_max": {"default_policy": 361.1766666666665}, "policy_reward_mean": {"default_policy": 266.4521777777777}, "custom_metrics": {"num_consolidated_mean": 1.3531, "num_consolidated_min": 1.17, "num_consolidated_max": 1.59, "num_overloaded_mean": 0.1901, "num_overloaded_min": 0.1, "num_overloaded_max": 0.32, "num_moves_mean": 9.092199999999998, "num_moves_min": 8.63, "num_moves_max": 9.54, "mean_accuracy_mean": 40.54387, "mean_accuracy_min": 40.30833333333332, "mean_accuracy_max": 40.90999999999999, "num_model_switches_mean": 5.615399999999998, "num_model_switches_min": 5.15, "num_model_switches_max": 6.12, "num_slav_mean": 0.123126, "num_slav_min": 0.10431666666666668, "num_slav_max": 0.14926666666666663, "cpu_conserved_cost_mean": 3.3493999999999993, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.98, "mean_cluster_cpu_util_mean": 0.47528165607671097, "mean_cluster_cpu_util_min": 0.46451231867607007, "mean_cluster_cpu_util_max": 0.4914909528441681, "mean_cluster_mem_util_mean": 0.31376822548544736, "mean_cluster_mem_util_min": 0.308215740621143, "mean_cluster_mem_util_max": 0.3243698204598296, "reward_consolidation_mean_mean": 0.3441666666666663, "reward_consolidation_mean_min": -0.24444444444444471, "reward_consolidation_mean_max": 0.9277777777777775, "reward_illegal_mean_mean": -0.31683333333333324, "reward_illegal_mean_min": -0.5333333333333332, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.297204000000001, "reward_accuracy_mean_min": 2.8326666666666664, "reward_accuracy_mean_max": 3.6432666666666664, "reward_sla_mean_mean": -0.6600155555555556, "reward_sla_mean_min": -0.7844444444444446, "reward_sla_mean_max": -0.5369999999999999, "reward_consolidation_sum_mean": 34.41666666666662, "reward_consolidation_sum_min": -24.44444444444447, "reward_consolidation_sum_max": 92.77777777777774, "reward_illegal_sum_mean": -31.68333333333333, "reward_illegal_sum_min": -53.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 329.7204, "reward_accuracy_sum_min": 283.26666666666665, "reward_accuracy_sum_max": 364.32666666666665, "reward_sla_sum_mean": -66.00155555555556, "reward_sla_sum_min": -78.44444444444446, "reward_sla_sum_max": -53.699999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2778.0, "global_timestep_min": 900, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [222.72888888888892, 214.3211111111111, 186.45222222222225, 282.5644444444443, 268.42999999999995, 215.88000000000005, 257.3, 222.69222222222217, 258.7099999999999, 287.5399999999999, 246.10444444444445, 286.1255555555555, 268.72555555555556, 223.5488888888888, 246.99555555555543, 216.64555555555563, 261.5600000000001, 252.8833333333334, 283.2944444444445, 269.9577777777777, 270.06777777777774, 267.7555555555555, 198.93444444444438, 239.34222222222223, 303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2604647732199413, "mean_inference_ms": 2.297732341979308, "mean_action_processing_ms": 0.096602292421802, "mean_env_wait_ms": 1.6648290157877152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005788087844848633, "StateBufferConnector_ms": 0.0033202171325683594, "ViewRequirementAgentConnector_ms": 0.08591556549072266}, "num_episodes": 24, "episode_return_max": 361.1766666666665, "episode_return_min": 186.45222222222225, "episode_return_mean": 266.4521777777777, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.04677738676048, "num_env_steps_trained_throughput_per_sec": 237.04677738676048, "timesteps_total": 83400, "num_env_steps_sampled_lifetime": 83400, "num_agent_steps_sampled_lifetime": 83400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 83400, "timers": {"training_iteration_time_ms": 10315.431, "restore_workers_time_ms": 0.014, "training_step_time_ms": 625.65, "sample_time_ms": 609.369, "synch_weights_time_ms": 14.83}, "counters": {"num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 556, "num_samples_added_to_queue": 83400}, "done": false, "training_iteration": 36, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-33-41", "timestamp": 1728650021, "time_this_iter_s": 10.149388313293457, "time_total_s": 374.01620984077454, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b8027e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.01620984077454, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.642857142857142, "ram_util_percent": 57.98571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 227743.71875, "policy_loss": 225969.0625, "entropy": 26.047304153442383, "entropy_coeff": 0.01, "var_gnorm": 16.279651641845703, "vf_loss": 185278.96875, "vf_explained_var": -0.06176173686981201}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 285.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 85800, "num_env_steps_trained": 85500, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 572, "num_samples_added_to_queue": 85800, "learner_queue": {"size_count": 285, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.576, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1216.252, "learner_dequeue_time_ms": 10467.977}}, "env_runners": {"episode_reward_max": 361.1766666666665, "episode_reward_min": 197.58222222222216, "episode_reward_mean": 279.22973333333323, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 197.58222222222216}, "policy_reward_max": {"default_policy": 361.1766666666665}, "policy_reward_mean": {"default_policy": 279.22973333333323}, "custom_metrics": {"num_consolidated_mean": 1.3905999999999998, "num_consolidated_min": 1.17, "num_consolidated_max": 1.6, "num_overloaded_mean": 0.18330000000000002, "num_overloaded_min": 0.1, "num_overloaded_max": 0.32, "num_moves_mean": 9.022000000000002, "num_moves_min": 8.63, "num_moves_max": 9.46, "mean_accuracy_mean": 40.51315333333333, "mean_accuracy_min": 40.16899999999999, "mean_accuracy_max": 40.776999999999994, "num_model_switches_mean": 5.585100000000001, "num_model_switches_min": 5.15, "num_model_switches_max": 6.06, "num_slav_mean": 0.12103166666666665, "num_slav_min": 0.10036666666666666, "num_slav_max": 0.13820000000000002, "cpu_conserved_cost_mean": 3.4250000000000007, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 4.1, "mean_cluster_cpu_util_mean": 0.47393829612711214, "mean_cluster_cpu_util_min": 0.46265534090649285, "mean_cluster_cpu_util_max": 0.4914909528441681, "mean_cluster_mem_util_mean": 0.31253063101158185, "mean_cluster_mem_util_min": 0.3062496876704268, "mean_cluster_mem_util_max": 0.321785297547289, "reward_consolidation_mean_mean": 0.4302222222222219, "reward_consolidation_mean_min": -0.24444444444444471, "reward_consolidation_mean_max": 0.9277777777777775, "reward_illegal_mean_mean": -0.3055, "reward_illegal_mean_min": -0.5333333333333332, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.3192539999999995, "reward_accuracy_mean_min": 2.8326666666666664, "reward_accuracy_mean_max": 3.6496000000000004, "reward_sla_mean_mean": -0.6516788888888888, "reward_sla_mean_min": -0.7665555555555557, "reward_sla_mean_max": -0.5369999999999999, "reward_consolidation_sum_mean": 43.02222222222219, "reward_consolidation_sum_min": -24.44444444444447, "reward_consolidation_sum_max": 92.77777777777774, "reward_illegal_sum_mean": -30.55, "reward_illegal_sum_min": -53.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 331.9254, "reward_accuracy_sum_min": 283.26666666666665, "reward_accuracy_sum_max": 364.96000000000004, "reward_sla_sum_mean": -65.16788888888888, "reward_sla_sum_min": -76.65555555555557, "reward_sla_sum_max": -53.699999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3578.0, "global_timestep_min": 1700, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [303.13111111111095, 217.2155555555556, 241.52444444444438, 232.6855555555556, 306.02666666666664, 296.7644444444446, 291.8333333333333, 227.08111111111103, 250.7644444444445, 262.3633333333334, 245.47777777777765, 261.33333333333326, 232.30222222222224, 197.58222222222216, 274.33666666666653, 268.51333333333343, 307.19444444444423, 207.04333333333332, 228.62555555555554, 278.98222222222216, 264.20000000000005, 222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2601166284688929, "mean_inference_ms": 2.2936869029059896, "mean_action_processing_ms": 0.09647707375148705, "mean_env_wait_ms": 1.6628923344652409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005713224411010742, "StateBufferConnector_ms": 0.003359079360961914, "ViewRequirementAgentConnector_ms": 0.08615875244140625}, "num_episodes": 24, "episode_return_max": 361.1766666666665, "episode_return_min": 197.58222222222216, "episode_return_mean": 279.22973333333323, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85500, "num_env_steps_sampled": 85800, "num_env_steps_trained": 85500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.33301731876506, "num_env_steps_trained_throughput_per_sec": 233.33301731876506, "timesteps_total": 85800, "num_env_steps_sampled_lifetime": 85800, "num_agent_steps_sampled_lifetime": 85800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 85800, "timers": {"training_iteration_time_ms": 10338.343, "restore_workers_time_ms": 0.015, "training_step_time_ms": 636.03, "sample_time_ms": 619.791, "synch_weights_time_ms": 14.808}, "counters": {"num_env_steps_sampled": 85800, "num_env_steps_trained": 85500, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 572, "num_samples_added_to_queue": 85800}, "done": false, "training_iteration": 37, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-33-51", "timestamp": 1728650031, "time_this_iter_s": 10.302950859069824, "time_total_s": 384.31916069984436, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46df4f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.31916069984436, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.993333333333332, "ram_util_percent": 58.106666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 271571.5, "policy_loss": 268946.1875, "entropy": 25.75910758972168, "entropy_coeff": 0.01, "var_gnorm": 16.288318634033203, "vf_loss": 270258.0625, "vf_explained_var": -0.0438075065612793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 88050, "num_env_steps_trained": 87900, "num_agent_steps_sampled": 88050, "num_agent_steps_trained": 87900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 587, "num_samples_added_to_queue": 87900, "learner_queue": {"size_count": 293, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.463, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1260.101, "learner_dequeue_time_ms": 10444.31}}, "env_runners": {"episode_reward_max": 378.5844444444442, "episode_reward_min": 212.26000000000016, "episode_reward_mean": 295.3247777777776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 212.26000000000016}, "policy_reward_max": {"default_policy": 378.5844444444442}, "policy_reward_mean": {"default_policy": 295.3247777777776}, "custom_metrics": {"num_consolidated_mean": 1.4317999999999995, "num_consolidated_min": 1.17, "num_consolidated_max": 1.67, "num_overloaded_mean": 0.17299999999999993, "num_overloaded_min": 0.1, "num_overloaded_max": 0.32, "num_moves_mean": 8.975200000000001, "num_moves_min": 8.63, "num_moves_max": 9.36, "mean_accuracy_mean": 40.47255666666666, "mean_accuracy_min": 40.16899999999999, "mean_accuracy_max": 40.72633333333333, "num_model_switches_mean": 5.552199999999999, "num_model_switches_min": 5.15, "num_model_switches_max": 6.06, "num_slav_mean": 0.11779783333333337, "num_slav_min": 0.09841666666666667, "num_slav_max": 0.13813333333333333, "cpu_conserved_cost_mean": 3.5273999999999996, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 4.4, "mean_cluster_cpu_util_mean": 0.47300612467539177, "mean_cluster_cpu_util_min": 0.4626499601711921, "mean_cluster_cpu_util_max": 0.4914909528441681, "mean_cluster_mem_util_mean": 0.3116051562132237, "mean_cluster_mem_util_min": 0.3053906297540113, "mean_cluster_mem_util_max": 0.3205501863931226, "reward_consolidation_mean_mean": 0.5267777777777775, "reward_consolidation_mean_min": -0.24444444444444471, "reward_consolidation_mean_max": 1.066666666666666, "reward_illegal_mean_mean": -0.2883333333333333, "reward_illegal_mean_min": -0.5333333333333332, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 3.35749, "reward_accuracy_mean_min": 2.8326666666666664, "reward_accuracy_mean_max": 3.6496000000000004, "reward_sla_mean_mean": -0.6426866666666667, "reward_sla_mean_min": -0.7589999999999999, "reward_sla_mean_max": -0.5369999999999999, "reward_consolidation_sum_mean": 52.677777777777735, "reward_consolidation_sum_min": -24.44444444444447, "reward_consolidation_sum_max": 106.6666666666666, "reward_illegal_sum_mean": -28.83333333333333, "reward_illegal_sum_min": -53.33333333333332, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 335.749, "reward_accuracy_sum_min": 283.26666666666665, "reward_accuracy_sum_max": 364.96000000000004, "reward_sla_sum_mean": -64.26866666666666, "reward_sla_sum_min": -75.89999999999999, "reward_sla_sum_max": -53.699999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4267.0, "global_timestep_min": 2200, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [222.5577777777778, 283.9222222222222, 247.10666666666674, 212.26000000000016, 236.9466666666667, 306.9533333333332, 252.98333333333323, 255.9388888888888, 220.8455555555555, 298.19444444444423, 240.79111111111098, 254.79777777777784, 223.46777777777794, 294.8066666666665, 315.8344444444442, 217.02222222222224, 299.8733333333332, 254.67444444444442, 249.30444444444458, 244.85444444444445, 314.2377777777777, 317.47444444444426, 313.26666666666654, 234.20666666666668, 267.6533333333333, 242.81888888888878, 252.19222222222223, 284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25995049959112143, "mean_inference_ms": 2.2890332949191174, "mean_action_processing_ms": 0.09635865239209324, "mean_env_wait_ms": 1.661210766338978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005765676498413086, "StateBufferConnector_ms": 0.0034101009368896484, "ViewRequirementAgentConnector_ms": 0.08716368675231934}, "num_episodes": 21, "episode_return_max": 378.5844444444442, "episode_return_min": 212.26000000000016, "episode_return_mean": 295.3247777777776, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88050, "num_agent_steps_trained": 87900, "num_env_steps_sampled": 88050, "num_env_steps_trained": 87900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 221.12359007170923, "num_env_steps_trained_throughput_per_sec": 235.86516274315653, "timesteps_total": 88050, "num_env_steps_sampled_lifetime": 88050, "num_agent_steps_sampled_lifetime": 88050, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 88050, "timers": {"training_iteration_time_ms": 10279.594, "restore_workers_time_ms": 0.013, "training_step_time_ms": 706.662, "sample_time_ms": 690.268, "synch_weights_time_ms": 14.775}, "counters": {"num_env_steps_sampled": 88050, "num_env_steps_trained": 87900, "num_agent_steps_sampled": 88050, "num_agent_steps_trained": 87900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 587, "num_samples_added_to_queue": 87900}, "done": false, "training_iteration": 38, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-01", "timestamp": 1728650041, "time_this_iter_s": 10.188177585601807, "time_total_s": 394.50733828544617, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b80272b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 394.50733828544617, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.59333333333333, "ram_util_percent": 57.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 295506.34375, "policy_loss": 292346.3125, "entropy": 25.501115798950195, "entropy_coeff": 0.01, "var_gnorm": 16.29546356201172, "vf_loss": 323652.84375, "vf_explained_var": -0.03809988498687744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 301.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 604, "num_samples_added_to_queue": 90600, "learner_queue": {"size_count": 301, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.596, "learner_load_time_ms": 0.253, "learner_load_wait_time_ms": 1231.216, "learner_dequeue_time_ms": 10450.806}}, "env_runners": {"episode_reward_max": 394.1233333333332, "episode_reward_min": 238.62444444444452, "episode_reward_mean": 317.09089999999986, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 238.62444444444452}, "policy_reward_max": {"default_policy": 394.1233333333332}, "policy_reward_mean": {"default_policy": 317.09089999999986}, "custom_metrics": {"num_consolidated_mean": 1.4874, "num_consolidated_min": 1.26, "num_consolidated_max": 1.72, "num_overloaded_mean": 0.1577, "num_overloaded_min": 0.07, "num_overloaded_max": 0.28, "num_moves_mean": 8.898500000000002, "num_moves_min": 8.5, "num_moves_max": 9.29, "mean_accuracy_mean": 40.43335333333333, "mean_accuracy_min": 40.16899999999999, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 5.5385, "num_model_switches_min": 5.22, "num_model_switches_max": 6.06, "num_slav_mean": 0.11475266666666668, "num_slav_min": 0.09646666666666666, "num_slav_max": 0.1348666666666667, "cpu_conserved_cost_mean": 3.6429999999999993, "cpu_conserved_cost_min": 3.0, "cpu_conserved_cost_max": 4.48, "mean_cluster_cpu_util_mean": 0.47091078237966877, "mean_cluster_cpu_util_min": 0.45674411153447514, "mean_cluster_cpu_util_max": 0.48250063639165225, "mean_cluster_mem_util_mean": 0.3099325091833147, "mean_cluster_mem_util_min": 0.3027890700795086, "mean_cluster_mem_util_max": 0.3167008928571428, "reward_consolidation_mean_mean": 0.6570555555555552, "reward_consolidation_mean_min": 0.1388888888888886, "reward_consolidation_mean_max": 1.1499999999999995, "reward_illegal_mean_mean": -0.2628333333333333, "reward_illegal_mean_min": -0.46666666666666656, "reward_illegal_mean_max": -0.11666666666666664, "reward_accuracy_mean_mean": 3.412702333333333, "reward_accuracy_mean_min": 3.0053, "reward_accuracy_mean_max": 3.7481999999999998, "reward_sla_mean_mean": -0.6360155555555554, "reward_sla_mean_min": -0.7589999999999999, "reward_sla_mean_max": -0.5369999999999999, "reward_consolidation_sum_mean": 65.70555555555552, "reward_consolidation_sum_min": 13.888888888888859, "reward_consolidation_sum_max": 114.99999999999996, "reward_illegal_sum_mean": -26.28333333333333, "reward_illegal_sum_min": -46.66666666666666, "reward_illegal_sum_max": -11.666666666666664, "reward_accuracy_sum_mean": 341.2702333333334, "reward_accuracy_sum_min": 300.53000000000003, "reward_accuracy_sum_max": 374.82, "reward_sla_sum_mean": -63.601555555555564, "reward_sla_sum_min": -75.89999999999999, "reward_sla_sum_max": -53.699999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5178.0, "global_timestep_min": 3300, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [284.51444444444434, 294.54, 299.6022222222223, 302.4977777777776, 274.17777777777764, 320.3933333333331, 269.3222222222221, 315.5522222222221, 304.53444444444426, 303.1144444444444, 315.31555555555553, 255.28555555555553, 320.32111111111084, 309.6088888888886, 263.4977777777776, 308.26888888888874, 361.1766666666665, 306.39888888888885, 303.62333333333316, 271.2788888888888, 294.4155555555554, 260.61, 285.31000000000006, 308.7466666666666, 269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25960068078463133, "mean_inference_ms": 2.2867267954929855, "mean_action_processing_ms": 0.09625412094960181, "mean_env_wait_ms": 1.6598628870932952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00587153434753418, "StateBufferConnector_ms": 0.0034203529357910156, "ViewRequirementAgentConnector_ms": 0.08759832382202148}, "num_episodes": 27, "episode_return_max": 394.1233333333332, "episode_return_min": 238.62444444444452, "episode_return_mean": 317.09089999999986, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.4564929631258, "num_env_steps_trained_throughput_per_sec": 227.25316984764783, "timesteps_total": 90600, "num_env_steps_sampled_lifetime": 90600, "num_agent_steps_sampled_lifetime": 90600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 90600, "timers": {"training_iteration_time_ms": 10330.567, "restore_workers_time_ms": 0.014, "training_step_time_ms": 622.501, "sample_time_ms": 606.046, "synch_weights_time_ms": 14.591}, "counters": {"num_env_steps_sampled": 90600, "num_env_steps_trained": 90300, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 604, "num_samples_added_to_queue": 90600}, "done": false, "training_iteration": 39, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-12", "timestamp": 1728650052, "time_this_iter_s": 10.57591986656189, "time_total_s": 405.08325815200806, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46dc3d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 405.08325815200806, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.653333333333332, "ram_util_percent": 59.30666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 285979.90625, "policy_loss": 283052.75, "entropy": 25.22415542602539, "entropy_coeff": 0.01, "var_gnorm": 16.30318260192871, "vf_loss": 300285.75, "vf_explained_var": -0.03662097454071045}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 309.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 620, "num_samples_added_to_queue": 93000, "learner_queue": {"size_count": 309, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.66, "learner_load_time_ms": 0.253, "learner_load_wait_time_ms": 1203.184, "learner_dequeue_time_ms": 10360.765}}, "env_runners": {"episode_reward_max": 431.2433333333333, "episode_reward_min": 238.62444444444452, "episode_reward_mean": 333.9500666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 238.62444444444452}, "policy_reward_max": {"default_policy": 431.2433333333333}, "policy_reward_mean": {"default_policy": 333.9500666666665}, "custom_metrics": {"num_consolidated_mean": 1.5317000000000005, "num_consolidated_min": 1.29, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.1476, "num_overloaded_min": 0.07, "num_overloaded_max": 0.28, "num_moves_mean": 8.8195, "num_moves_min": 8.27, "num_moves_max": 9.17, "mean_accuracy_mean": 40.392313333333334, "mean_accuracy_min": 40.01699999999999, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 5.506299999999999, "num_model_switches_min": 5.11, "num_model_switches_max": 6.06, "num_slav_mean": 0.11148316666666667, "num_slav_min": 0.09133333333333332, "num_slav_max": 0.13275, "cpu_conserved_cost_mean": 3.728400000000001, "cpu_conserved_cost_min": 3.16, "cpu_conserved_cost_max": 4.48, "mean_cluster_cpu_util_mean": 0.4691638282761554, "mean_cluster_cpu_util_min": 0.4560858540006116, "mean_cluster_cpu_util_max": 0.48250063639165225, "mean_cluster_mem_util_mean": 0.30847293679317717, "mean_cluster_mem_util_min": 0.3009174457863314, "mean_cluster_mem_util_max": 0.3167008928571428, "reward_consolidation_mean_mean": 0.763444444444444, "reward_consolidation_mean_min": 0.1388888888888886, "reward_consolidation_mean_max": 1.4499999999999997, "reward_illegal_mean_mean": -0.24599999999999997, "reward_illegal_mean_min": -0.46666666666666656, "reward_illegal_mean_max": -0.11666666666666664, "reward_accuracy_mean_mean": 3.4476306666666665, "reward_accuracy_mean_min": 3.0053, "reward_accuracy_mean_max": 3.7481999999999998, "reward_sla_mean_mean": -0.6255744444444444, "reward_sla_mean_min": -0.7403333333333335, "reward_sla_mean_max": -0.5196666666666666, "reward_consolidation_sum_mean": 76.3444444444444, "reward_consolidation_sum_min": 13.888888888888859, "reward_consolidation_sum_max": 144.99999999999997, "reward_illegal_sum_mean": -24.6, "reward_illegal_sum_min": -46.66666666666666, "reward_illegal_sum_max": -11.666666666666664, "reward_accuracy_sum_mean": 344.7630666666667, "reward_accuracy_sum_min": 300.53000000000003, "reward_accuracy_sum_max": 374.82, "reward_sla_sum_mean": -62.55744444444444, "reward_sla_sum_min": -74.03333333333335, "reward_sla_sum_max": -51.96666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5978.0, "global_timestep_min": 4100, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [269.1677777777776, 293.95777777777755, 292.83444444444444, 238.62444444444452, 320.2655555555554, 279.67333333333323, 317.15222222222195, 326.06666666666655, 244.9866666666666, 318.5766666666666, 259.3277777777778, 289.2188888888887, 331.38444444444434, 308.721111111111, 288.6966666666666, 282.47, 320.3733333333331, 342.0955555555554, 307.1455555555556, 277.38444444444434, 284.3866666666666, 295.30555555555543, 325.85777777777764, 297.20999999999964, 314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25935589983001345, "mean_inference_ms": 2.283434881039708, "mean_action_processing_ms": 0.09614655360501978, "mean_env_wait_ms": 1.658414089169961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063228607177734375, "StateBufferConnector_ms": 0.0034799575805664062, "ViewRequirementAgentConnector_ms": 0.08785104751586914}, "num_episodes": 24, "episode_return_max": 431.2433333333333, "episode_return_min": 238.62444444444452, "episode_return_mean": 333.9500666666665, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 92700, "num_env_steps_sampled": 93000, "num_env_steps_trained": 92700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.15984293186716, "num_env_steps_trained_throughput_per_sec": 236.15984293186716, "timesteps_total": 93000, "num_env_steps_sampled_lifetime": 93000, "num_agent_steps_sampled_lifetime": 93000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 10287.508, "restore_workers_time_ms": 0.012, "training_step_time_ms": 635.872, "sample_time_ms": 619.507, "synch_weights_time_ms": 14.854}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 92700, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 92700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 620, "num_samples_added_to_queue": 93000}, "done": false, "training_iteration": 40, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-22", "timestamp": 1728650062, "time_this_iter_s": 10.173697710037231, "time_total_s": 415.2569558620453, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c46de950>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.2569558620453, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.642857142857142, "ram_util_percent": 59.178571428571445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 309150.78125, "policy_loss": 305621.125, "entropy": 24.905397415161133, "entropy_coeff": 0.01, "var_gnorm": 16.307727813720703, "vf_loss": 360436.78125, "vf_explained_var": -0.029409170150756836}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 317.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 95400, "num_env_steps_trained": 95100, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 636, "num_samples_added_to_queue": 95400, "learner_queue": {"size_count": 317, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.014, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1203.417, "learner_dequeue_time_ms": 10345.478}}, "env_runners": {"episode_reward_max": 476.59222222222195, "episode_reward_min": 250.50888888888886, "episode_reward_mean": 355.72356666666644, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 250.50888888888886}, "policy_reward_max": {"default_policy": 476.59222222222195}, "policy_reward_mean": {"default_policy": 355.72356666666644}, "custom_metrics": {"num_consolidated_mean": 1.5791000000000002, "num_consolidated_min": 1.37, "num_consolidated_max": 1.85, "num_overloaded_mean": 0.13299999999999998, "num_overloaded_min": 0.05, "num_overloaded_max": 0.28, "num_moves_mean": 8.739799999999999, "num_moves_min": 8.08, "num_moves_max": 9.14, "mean_accuracy_mean": 40.35437666666666, "mean_accuracy_min": 40.01699999999999, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 5.458499999999999, "num_model_switches_min": 5.04, "num_model_switches_max": 6.06, "num_slav_mean": 0.10749216666666665, "num_slav_min": 0.09133333333333332, "num_slav_max": 0.12435, "cpu_conserved_cost_mean": 3.8194, "cpu_conserved_cost_min": 3.28, "cpu_conserved_cost_max": 4.54, "mean_cluster_cpu_util_mean": 0.46735159912666574, "mean_cluster_cpu_util_min": 0.4546448394380158, "mean_cluster_cpu_util_max": 0.48250063639165225, "mean_cluster_mem_util_mean": 0.30694637646387674, "mean_cluster_mem_util_min": 0.3003161928801056, "mean_cluster_mem_util_max": 0.3167008928571428, "reward_consolidation_mean_mean": 0.8908888888888883, "reward_consolidation_mean_min": 0.3499999999999996, "reward_consolidation_mean_max": 1.7611111111111108, "reward_illegal_mean_mean": -0.2216666666666666, "reward_illegal_mean_min": -0.46666666666666656, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 3.5032856666666667, "reward_accuracy_mean_min": 3.0053, "reward_accuracy_mean_max": 3.820266666666667, "reward_sla_mean_mean": -0.6152722222222222, "reward_sla_mean_min": -0.721111111111111, "reward_sla_mean_max": -0.5196666666666666, "reward_consolidation_sum_mean": 89.08888888888883, "reward_consolidation_sum_min": 34.99999999999996, "reward_consolidation_sum_max": 176.1111111111111, "reward_illegal_sum_mean": -22.166666666666664, "reward_illegal_sum_min": -46.66666666666666, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 350.3285666666667, "reward_accuracy_sum_min": 300.53000000000003, "reward_accuracy_sum_max": 382.0266666666667, "reward_sla_sum_mean": -61.527222222222214, "reward_sla_sum_min": -72.1111111111111, "reward_sla_sum_max": -51.96666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5374.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [314.1744444444441, 250.50888888888886, 330.87111111111096, 314.46222222222224, 344.01333333333304, 354.4199999999996, 336.9755555555552, 318.5655555555554, 364.462222222222, 302.97555555555533, 351.4755555555552, 296.3688888888888, 277.07333333333315, 338.54555555555544, 320.6444444444443, 333.59999999999997, 358.0566666666665, 355.7288888888887, 372.2655555555553, 323.90777777777765, 345.5122222222221, 312.19000000000005, 378.5844444444442, 350.21111111111094, 268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25909058441562677, "mean_inference_ms": 2.2804298325765777, "mean_action_processing_ms": 0.09604368259894311, "mean_env_wait_ms": 1.6569769888367416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006361246109008789, "StateBufferConnector_ms": 0.003452777862548828, "ViewRequirementAgentConnector_ms": 0.08814811706542969}, "num_episodes": 24, "episode_return_max": 476.59222222222195, "episode_return_min": 250.50888888888886, "episode_return_mean": 355.72356666666644, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95100, "num_env_steps_sampled": 95400, "num_env_steps_trained": 95100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 234.08481415539356, "num_env_steps_trained_throughput_per_sec": 234.08481415539356, "timesteps_total": 95400, "num_env_steps_sampled_lifetime": 95400, "num_agent_steps_sampled_lifetime": 95400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 95400, "timers": {"training_iteration_time_ms": 10307.783, "restore_workers_time_ms": 0.014, "training_step_time_ms": 635.594, "sample_time_ms": 618.379, "synch_weights_time_ms": 15.755}, "counters": {"num_env_steps_sampled": 95400, "num_env_steps_trained": 95100, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 636, "num_samples_added_to_queue": 95400}, "done": false, "training_iteration": 41, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-32", "timestamp": 1728650072, "time_this_iter_s": 10.265578031539917, "time_total_s": 425.5225338935852, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452e290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 425.5225338935852, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.26, "ram_util_percent": 58.906666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 312972.5625, "policy_loss": 309395.5, "entropy": 24.648723602294922, "entropy_coeff": 0.01, "var_gnorm": 16.312007904052734, "vf_loss": 365100.5625, "vf_explained_var": -0.025656461715698242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 325.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 652, "num_samples_added_to_queue": 97800, "learner_queue": {"size_count": 325, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.864, "learner_load_time_ms": 0.278, "learner_load_wait_time_ms": 1200.538, "learner_dequeue_time_ms": 10366.884}}, "env_runners": {"episode_reward_max": 476.59222222222195, "episode_reward_min": 268.9088888888889, "episode_reward_mean": 372.8885666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 268.9088888888889}, "policy_reward_max": {"default_policy": 476.59222222222195}, "policy_reward_mean": {"default_policy": 372.8885666666665}, "custom_metrics": {"num_consolidated_mean": 1.6169000000000002, "num_consolidated_min": 1.42, "num_consolidated_max": 1.89, "num_overloaded_mean": 0.1217, "num_overloaded_min": 0.05, "num_overloaded_max": 0.28, "num_moves_mean": 8.6318, "num_moves_min": 8.01, "num_moves_max": 9.1, "mean_accuracy_mean": 40.31878333333332, "mean_accuracy_min": 40.01699999999999, "mean_accuracy_max": 40.681999999999995, "num_model_switches_mean": 5.4117, "num_model_switches_min": 4.88, "num_model_switches_max": 5.95, "num_slav_mean": 0.10456066666666666, "num_slav_min": 0.08205, "num_slav_max": 0.12435, "cpu_conserved_cost_mean": 3.8828000000000005, "cpu_conserved_cost_min": 3.28, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.46519013689309213, "mean_cluster_cpu_util_min": 0.45405188540687236, "mean_cluster_cpu_util_max": 0.4820614320139902, "mean_cluster_mem_util_mean": 0.3054174506820661, "mean_cluster_mem_util_min": 0.29776655544074165, "mean_cluster_mem_util_max": 0.31401095467722956, "reward_consolidation_mean_mean": 0.9931666666666662, "reward_consolidation_mean_min": 0.5055555555555551, "reward_consolidation_mean_max": 1.7611111111111108, "reward_illegal_mean_mean": -0.2028333333333333, "reward_illegal_mean_min": -0.46666666666666656, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 3.544392333333334, "reward_accuracy_mean_min": 3.0053, "reward_accuracy_mean_max": 3.820266666666667, "reward_sla_mean_mean": -0.6058399999999999, "reward_sla_mean_min": -0.721111111111111, "reward_sla_mean_max": -0.4983333333333333, "reward_consolidation_sum_mean": 99.31666666666662, "reward_consolidation_sum_min": 50.555555555555515, "reward_consolidation_sum_max": 176.1111111111111, "reward_illegal_sum_mean": -20.28333333333333, "reward_illegal_sum_min": -46.66666666666666, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 354.4392333333334, "reward_accuracy_sum_min": 300.53000000000003, "reward_accuracy_sum_max": 382.0266666666667, "reward_sla_sum_mean": -60.583999999999996, "reward_sla_sum_min": -72.1111111111111, "reward_sla_sum_max": -49.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4307.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553, 475.9399999999999, 355.11222222222216, 412.1177777777777, 411.9699999999998, 357.6511111111108, 404.04111111111104, 381.21444444444415, 428.4955555555556, 377.05111111111086, 389.0255555555553, 354.77777777777743, 430.5511111111108, 395.9722222222217, 366.7511111111109, 406.35111111111104, 432.74666666666667, 379.2355555555552, 453.73111111111103, 395.601111111111, 393.7499999999997, 416.93222222222204, 413.9133333333332, 417.24111111111085, 411.9199999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [268.9088888888889, 347.87888888888875, 356.21444444444444, 288.57444444444434, 338.77777777777766, 316.48666666666657, 394.1233333333332, 351.21555555555534, 385.97777777777753, 328.26444444444434, 332.52999999999986, 345.85777777777736, 380.4522222222221, 353.6122222222221, 333.7711111111111, 381.82333333333315, 381.7844444444444, 376.62111111111125, 320.58666666666664, 325.8244444444442, 324.27444444444404, 305.3688888888887, 328.6566666666664, 293.14777777777755, 356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553, 475.9399999999999, 355.11222222222216, 412.1177777777777, 411.9699999999998, 357.6511111111108, 404.04111111111104, 381.21444444444415, 428.4955555555556, 377.05111111111086, 389.0255555555553, 354.77777777777743, 430.5511111111108, 395.9722222222217, 366.7511111111109, 406.35111111111104, 432.74666666666667, 379.2355555555552, 453.73111111111103, 395.601111111111, 393.7499999999997, 416.93222222222204, 413.9133333333332, 417.24111111111085, 411.9199999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2587192423645684, "mean_inference_ms": 2.2782123550247606, "mean_action_processing_ms": 0.09594642250855084, "mean_env_wait_ms": 1.6554849314737055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062808990478515625, "StateBufferConnector_ms": 0.003399372100830078, "ViewRequirementAgentConnector_ms": 0.08622050285339355}, "num_episodes": 24, "episode_return_max": 476.59222222222195, "episode_return_min": 268.9088888888889, "episode_return_mean": 372.8885666666665, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.40642375371368, "num_env_steps_trained_throughput_per_sec": 237.40642375371368, "timesteps_total": 97800, "num_env_steps_sampled_lifetime": 97800, "num_agent_steps_sampled_lifetime": 97800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 97800, "timers": {"training_iteration_time_ms": 10276.277, "restore_workers_time_ms": 0.012, "training_step_time_ms": 629.233, "sample_time_ms": 614.499, "synch_weights_time_ms": 13.321}, "counters": {"num_env_steps_sampled": 97800, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 652, "num_samples_added_to_queue": 97800}, "done": false, "training_iteration": 42, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-42", "timestamp": 1728650082, "time_this_iter_s": 10.123812437057495, "time_total_s": 435.6463463306427, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283c452e3b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 435.6463463306427, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.08, "ram_util_percent": 58.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 302461.0, "policy_loss": 298918.25, "entropy": 24.620641708374023, "entropy_coeff": 0.01, "var_gnorm": 16.31462287902832, "vf_loss": 361663.5, "vf_explained_var": -0.016872406005859375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 100200, "num_env_steps_trained": 99900, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 668, "num_samples_added_to_queue": 100200, "learner_queue": {"size_count": 333, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.287, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 1219.413, "learner_dequeue_time_ms": 10284.496}}, "env_runners": {"episode_reward_max": 476.59222222222195, "episode_reward_min": 324.75444444444423, "episode_reward_mean": 391.42414444444427, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 324.75444444444423}, "policy_reward_max": {"default_policy": 476.59222222222195}, "policy_reward_mean": {"default_policy": 391.42414444444427}, "custom_metrics": {"num_consolidated_mean": 1.6558000000000004, "num_consolidated_min": 1.43, "num_consolidated_max": 1.89, "num_overloaded_mean": 0.10980000000000002, "num_overloaded_min": 0.05, "num_overloaded_max": 0.2, "num_moves_mean": 8.5401, "num_moves_min": 8.01, "num_moves_max": 8.96, "mean_accuracy_mean": 40.288573333333325, "mean_accuracy_min": 40.01699999999999, "mean_accuracy_max": 40.64399999999999, "num_model_switches_mean": 5.338800000000001, "num_model_switches_min": 4.8, "num_model_switches_max": 5.89, "num_slav_mean": 0.10172283333333335, "num_slav_min": 0.08205, "num_slav_max": 0.12435, "cpu_conserved_cost_mean": 3.948, "cpu_conserved_cost_min": 3.28, "cpu_conserved_cost_max": 4.74, "mean_cluster_cpu_util_mean": 0.46308299606617964, "mean_cluster_cpu_util_min": 0.4509334305014541, "mean_cluster_cpu_util_max": 0.47685131606241427, "mean_cluster_mem_util_mean": 0.303913819146646, "mean_cluster_mem_util_min": 0.2973910283733746, "mean_cluster_mem_util_max": 0.31071487790263785, "reward_consolidation_mean_mean": 1.1055555555555554, "reward_consolidation_mean_min": 0.6111111111111106, "reward_consolidation_mean_max": 1.7611111111111108, "reward_illegal_mean_mean": -0.18299999999999997, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 3.589357, "reward_accuracy_mean_min": 3.222766666666667, "reward_accuracy_mean_max": 3.820266666666667, "reward_sla_mean_mean": -0.597671111111111, "reward_sla_mean_min": -0.721111111111111, "reward_sla_mean_max": -0.4983333333333333, "reward_consolidation_sum_mean": 110.55555555555553, "reward_consolidation_sum_min": 61.111111111111065, "reward_consolidation_sum_max": 176.1111111111111, "reward_illegal_sum_mean": -18.3, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 358.93570000000005, "reward_accuracy_sum_min": 322.2766666666667, "reward_accuracy_sum_max": 382.0266666666667, "reward_sla_sum_mean": -59.76711111111112, "reward_sla_sum_min": -72.1111111111111, "reward_sla_sum_max": -49.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3230.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553, 475.9399999999999, 355.11222222222216, 412.1177777777777, 411.9699999999998, 357.6511111111108, 404.04111111111104, 381.21444444444415, 428.4955555555556, 377.05111111111086, 389.0255555555553, 354.77777777777743, 430.5511111111108, 395.9722222222217, 366.7511111111109, 406.35111111111104, 432.74666666666667, 379.2355555555552, 453.73111111111103, 395.601111111111, 393.7499999999997, 416.93222222222204, 413.9133333333332, 417.24111111111085, 411.9199999999998, 424.7788888888888, 426.19888888888875, 416.57111111111095, 415.2099999999998, 441.39999999999986, 413.9499999999998, 388.4166666666665, 442.4799999999998, 382.80666666666656, 436.1066666666666, 377.64333333333303, 432.41888888888894, 418.02666666666664, 413.9999999999998, 417.32111111111107, 437.93999999999994, 411.8399999999998, 391.37666666666644, 426.29, 450.2733333333332, 392.2055555555553, 416.6299999999998, 408.99666666666644, 431.40999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [356.3644444444444, 331.9655555555554, 330.70111111111083, 340.7422222222221, 361.771111111111, 341.16999999999996, 431.2433333333333, 365.1133333333331, 372.46111111111077, 346.3311111111109, 354.86, 408.9399999999996, 351.01999999999975, 338.2344444444443, 371.712222222222, 379.2144444444441, 344.5988888888886, 396.64777777777755, 390.0388888888886, 351.8555555555554, 391.07222222222214, 368.01444444444445, 350.8999999999998, 390.7877777777776, 338.10888888888866, 353.16444444444437, 368.62555555555525, 352.13777777777767, 354.17222222222205, 343.6555555555553, 364.5022222222219, 429.95888888888874, 399.332222222222, 476.59222222222195, 420.2999999999999, 398.4266666666667, 324.75444444444423, 343.9211111111108, 348.712222222222, 443.9655555555555, 435.8155555555554, 390.83999999999975, 374.12222222222186, 393.90777777777737, 390.71333333333314, 358.13999999999993, 377.93222222222215, 385.1311111111108, 370.4066666666664, 345.8222222222221, 430.103333333333, 387.0055555555553, 475.9399999999999, 355.11222222222216, 412.1177777777777, 411.9699999999998, 357.6511111111108, 404.04111111111104, 381.21444444444415, 428.4955555555556, 377.05111111111086, 389.0255555555553, 354.77777777777743, 430.5511111111108, 395.9722222222217, 366.7511111111109, 406.35111111111104, 432.74666666666667, 379.2355555555552, 453.73111111111103, 395.601111111111, 393.7499999999997, 416.93222222222204, 413.9133333333332, 417.24111111111085, 411.9199999999998, 424.7788888888888, 426.19888888888875, 416.57111111111095, 415.2099999999998, 441.39999999999986, 413.9499999999998, 388.4166666666665, 442.4799999999998, 382.80666666666656, 436.1066666666666, 377.64333333333303, 432.41888888888894, 418.02666666666664, 413.9999999999998, 417.32111111111107, 437.93999999999994, 411.8399999999998, 391.37666666666644, 426.29, 450.2733333333332, 392.2055555555553, 416.6299999999998, 408.99666666666644, 431.40999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2584744558958231, "mean_inference_ms": 2.2734479543517794, "mean_action_processing_ms": 0.09582127365082453, "mean_env_wait_ms": 1.6535793089746451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006240129470825195, "StateBufferConnector_ms": 0.003438711166381836, "ViewRequirementAgentConnector_ms": 0.0870203971862793}, "num_episodes": 24, "episode_return_max": 476.59222222222195, "episode_return_min": 324.75444444444423, "episode_return_mean": 391.42414444444427, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99900, "num_env_steps_sampled": 100200, "num_env_steps_trained": 99900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.3454468401608, "num_env_steps_trained_throughput_per_sec": 233.3454468401608, "timesteps_total": 100200, "num_env_steps_sampled_lifetime": 100200, "num_agent_steps_sampled_lifetime": 100200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 100200, "timers": {"training_iteration_time_ms": 10249.944, "restore_workers_time_ms": 0.014, "training_step_time_ms": 648.257, "sample_time_ms": 632.859, "synch_weights_time_ms": 13.79}, "counters": {"num_env_steps_sampled": 100200, "num_env_steps_trained": 99900, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 99900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 668, "num_samples_added_to_queue": 100200}, "done": true, "training_iteration": 43, "trial_id": "2b9b9_00000", "date": "2024-10-11_13-34-53", "timestamp": 1728650093, "time_this_iter_s": 10.295079708099365, "time_total_s": 445.94142603874207, "pid": 784851, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0.2, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7283b80255d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7283bdf45c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.94142603874207, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.978571428571428, "ram_util_percent": 58.66428571428571}}
